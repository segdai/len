/*! optimus v0.1.0 Built at 2021-09-27 14:24 EDT */
angular.module("home",["config","spinner","dropdowns","stickyStack","escape","oolCookie","userService","webdvrResource","modal","escape","homeModules","preferences","alertBanner","ctaArrowLink","map","weather","isDeviceWidth","billpayWidget","onetCookies"]).controller("HomeCtrl",["$rootScope","$scope","$timeout","Config","ooluser","User","Preferences","Weather","isDeviceWidth","Cookies",function(a,b,c,d,e,f,g,h,i,j){function k(){r(o)===p.Blue?b.supportAppImage=q.Blue:r(o)===p.Purple?b.supportAppImage=q.Purple:r(o)===p.Teal?b.supportAppImage=q.Teal:r(o)===p.Orange?b.supportAppImage=q.Orange:r(o)===p.Yellow?b.supportAppImage=q.Yellow:r(o)===p.Green&&(b.supportAppImage=q.Green)}e.tv&&void 0===e.tv.numChannels&&(e.tv.numChannels=300),e.internet&&void 0===e.internet.devices&&(e.internet.devices=10),b.type="hotspots";var l=this;l.activeServiceDrawer="",l.myServices=[],l.basePhoneMenuUrl="",l.showSettings={tv:!1,phone:!1,internet:!1},l.isLaBoxUser=e.hasOOLSession?e.laBoxUser||e.laboxOrMini:"true"===j.getCookie("labox"),l.routerLink="/internet/manage-router",l.isStream=e.hasOOLSession?e.internet&&e.internet.stream:"stream"===j.getCookie("eqType");var m,n,o=$(".global-header").css("background-color"),p={Blue:"#19bce4",Purple:"#aa50aa",Teal:"#43d1b9",Orange:"#f58921",Green:"#a8d228",Yellow:"#f8bc00"},q={Blue:"optimum-app_blue",Purple:"optimum-app_purple",Teal:"optimum-app_teal",Orange:"optimum-app_orange",Green:"optimum-app_green",Yellow:"optimum-app_yellow"},r=function(a){if("#"===a.substr(0,1))return a;var b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a),c=parseInt(b[2],10),d=parseInt(b[3],10),e=parseInt(b[4],10),f=e|d<<8|c<<16,g="";return g=f.toString(16),0===c&&(g="00"+g),g=b[1]+"#"+g};k(),b.ooluser=e;var s=0,t=!1;e.hasOOLSession&&null!==e.p&&(s=e.p.email,t="active"===e.p.mus?!0:!1);var u=["cart","dvr","onDemand","onTonight","voiceMail","webMail","myServices","wifiUsage"];if(!t)for(var v=0;v<u.length;v++)"webMail"===u[v]&&u.splice(v,1);l.configs={},l.scrollToNextSection=function(a){var b="#"+a,c=$(b).offset().top-$("#header-wrapper").height();$("html,body").animate({scrollTop:c},"slow")},l.scrollToNextSectionMobile=function(a){var b="#"+a,c=$(b).offset().top;$("html,body").animate({scrollTop:c},"slow")},l.isTablet=i.tablet||/\bSilk\b/.test(navigator.userAgent),l.phoneFooterUpsellShow=!0,l.configs.criticalErrorConfig={type:"major",message:"We're sorry, you need to be behind a modem to create an Optimum ID"};var w=2500;l.currentLoggedInUser={corpId:"",hasSession:!1,optimumId:"",inbox:[],hasService:{internet:!1,phone:!1,tv:!1,dvr:!1}},l.userInput={homeLoginForm:{remember:!1,isNotValidOptimumId:!1,isNotValidPassword:!1}},l.activeModules={},l.model={faqSearchText:""};var x=function(){if(l.weather=h.get(),l.isTablet){var a=$("#sticky-container").css("background-color");$(".common-footer-links").css("padding","20px 0px 100px 0px"),$(".local-footer").css("background-color",a)}},y=function(){$.each(u,function(a,b){l.activeModules[b]=!1})},z=function(){y(),D(),B()},A=function(a,b){"webMail"!==a||t||(a="myServices"),"webMail"!==b||t||(b="myServices");for(var c=a?a:l.moduleDefaults.shift(),d=b?b:l.moduleDefaults.shift();c===d&&l.moduleDefaults.length>0;)a?d=l.moduleDefaults.shift():c=l.moduleDefaults.shift();l.moduleDefaults.length?(d||(console.debug("No services available to populate right module, using default: webMail",l.currentLoggedInUser.hasService),l.moduleDefaults.right="webMail"),c||(console.debug("No services available to populate left module, using default: wifiUsage",l.currentLoggedInUser.hasService),l.moduleDefaults.left="wifiUsage")):(console.debug("no defaults found for this user (disco'd), explicitly set defaults to  wifiUsage(L) / webMail(R)"),c="wifiUsage",d="webMail"),"undefined"!==reporting&&(reporting.setAttrs({prop8:c+"|"+d},!0),reporting.pageLoadAfter()),l.activeModules[c]="left",l.activeModules[d]="right"},B=function(){g.getModules().then(function(a){A(a.data.left,a.data.right)},function(){A()})},C=function(){var a=l.currentLoggedInUser;e.hasOOLSession&&(a.isPrimary=e.primary,a.hasSession=!0,a.optimumId=e.optimumId,a.corpId=e.corpId||"",a.hasService={internet:e.ool,phone:e.ov,tv:e.io,dvr:e.p?e.p.dvr&&1===e.p.dvr?!0:!1:!1})},D=function(){var a=l.currentLoggedInUser.hasService,b=[{module:"wifiUsage",service:"internet"},{module:"webMail",service:"internet"},{module:"myServices",service:"internet"},{module:"voiceMail",service:"phone"},{module:"onTonight",service:"tv"},{module:"dvr",service:"dvr"},{module:"onDemand",service:"tv"}];if(!t)for(var c=0;c<b.length;c++)"webMail"===b[c].module&&b.splice(c,1);l.moduleDefaults=_.map(_.filter(b,function(b){return a[b.service]}),function(a){return a.module})},E=function(a){var b=$("#"+a+"OptimumId").val(),c=$("#"+a+"Password").val();angular.isString(b)&&(b.match(/^\s+/)||b.match(/\s+$/))&&$("#"+a+"OptimumId").val(b=b.replace(/^\s+/,"").replace(/\s+$/,"")),angular.isString(c)&&(c.match(/^\s+/)||c.match(/\s+$/))&&$("#"+a+"Password").val(c=c.replace(/^\s+/,"").replace(/\s+$/,""));var d={isValidId:!1,isValidPassword:!1,optimumId:b,password:c};return""!==d.optimumId&&(d.isValidId=!0),""!==d.password&&(d.isValidPassword=!0),d};l.faqSearch=function(){"undefined"!==reporting&&reporting.trackClick(this,"Home - FAQ Search - "+l.model.faqSearchText),window.location="/FAQ#/list/kw/"+l.model.faqSearchText},l.closePhoneStickyFooter=function(){document.getElementById("local-phone-sticky-footer").className="phone-footer1",l.phoneFooterShow=!1},l.closePhoneUpsellStickyFooter=function(){document.getElementById("local-phone-upsell-sticky-footer").className="phone-footer1",l.phoneFooterUpsellShow=!1},l.loginUser=function(a){var b=E(a);if(b.isValidId&&b.isValidPassword)$("#"+a).attr("action",l.loginAction),document.cookie="unsanitizeId="+b.optimumId+";path=/;",$("#"+a).submit();else{var c=l.userInput[a];b.isValidId?b.isValidPassword||(c.isNotValidOptimumId=!1,c.isNotValidPassword=!0):(c.isNotValidOptimumId=!0,c.isNotValidPassword=!1)}},l.toggleUserInputRemember=function(a){l.userInput[a].remember=!l.userInput[a].remember},b.$on("moduleEvent",function(a,b){var c;if("module-select"===b.eventName){var d=l.activeModules,e={};c=d[b.oldModule],d[b.oldModule]=!1,d[b.newModule]=c;for(var f in d)"left"===d[f]?e.homeFunc1=f:"right"===d[f]&&(e.homeFunc2=f);"undefined"!==reporting&&(reporting.setAttrs({prop28:e.homeFunc1+"|"+e.homeFunc2},!0),reporting.setEvents(["event15","event16"]),reporting.sendAttrs(!0)),g.setModules(e).then(function(){console.log("successfully set module preferences")},function(){console.error("Error (Preferences Service) could not set module preferences")})}}),a.$on("webmailDetailsResponse",function(a,b){l.webMail=b}),a.$on("optimumEmailOptInResponse",function(a,b){l.imsEmailResponse=b.imsEmailResponse}),l.checkIsBehindTheModem=function(){var a=!1;n.getIsBehindAnyModem().then(function(b){b.data&&b.data.AccountNo&&(a=!0)}),a?window.location="/profile/create-optimum-id":(l.notBehindModemAlert=!0,c(function(){l.notBehindModemAlert=!1},w))};var F=function(){if(l.isBusinessAccount=e.p.biz&&1===e.p.biz,e.tv&&void 0===e.tv.numChannels&&(e.tv.numChannels=300),e.hasOOLSession){if(e.ool&&void 0!==e.internet.serviceLevel){var a="";void 0!==e.internet.downSpeed&&""!==e.internet.downSpeed&&(a+="<b>Download speeds up to "+e.internet.downSpeed.replace("m","M")),void 0!==e.internet.upSpeed&&""!==e.internet.upSpeed&&(a+=", <br/> Upload speeds up to "+e.internet.upSpeed.replace("m","M")+"</b>"),l.myServices.push({serviceName:"Internet",serviceLevel:e.internet.serviceLevel,serviceDetail:a}),l.hasMultipleDevices=1!==parseInt(e.internet.devices,10)}e.io&&void 0!==e.tv.serviceLevel&&(l.myServices.push({serviceName:"TV",serviceLevel:e.tv.serviceLevel,serviceDetail:e.laBoxUser?"Includes free access to On Demand, the Altice One App and more":"Includes free access to On Demand, the Optimum TV App and more."}),l.hasMultipleBoxes=1!==parseInt(e.tv.box,10)),e.ov&&l.myServices.push({serviceName:"Phone",serviceLevel:"Optimum Voice",serviceDetail:"Unlimited calling and over 20 calling features."}),l.myServices.length>=1&&(l.activeServiceDrawer=l.myServices[0].serviceName)}},G=function(){l.phoneFooterShow=!0,l.phoneFooterUpsellShow=!1};return l.changeServiceDetailsView=function(a){l.activeServiceDrawer=l.myServices[a].serviceName,"undefined"!==reporting&&reporting.trackClick(this,"Home| Home| Myservices "+l.myServices[a].serviceName)},l.init=function(){m=d.getValuesBySelector("*"),l.loginAction=m.link.processLogin,l.loginReferer=window.location.href,l.basePhoneMenuUrl=m.link.basePhoneMenuUrl,b.ooluser=e,n=new f,C(),e.hasOOLSession&&(z(),F(),G()),x(),l.displayAds=!0},l.init(),b.HomeCtrl=window.HomeCtrl=l}]);