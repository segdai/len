/*! optimus v0.1.0 Built at 2021-09-27 14:23 EDT */
function exists(a){return"undefined"!=typeof a&&null!==a}function getRandomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}function isMobile(){return/Android|Kindle|Silk|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)}function convertNodeListToArray(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b}function getDurationDisplay(a){var b=[],c=moment(a),d=moment.duration(c.valueOf()).hours(),e=moment.duration(c.subtract(d,"hour").valueOf()).minutes();return d>0&&b.push(d+"h"),e>0&&b.push(e+"m"),b.join(" ")}function trackHistoryURL(){function a(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){var e=$.trim(c[d]);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return""}function b(a,b){document.cookie=a+"="+b+";path=/;"}var c=[];null!==a("historyURL")&&void 0!==a("historyURL")&&""!==a("historyURL")&&(c=a("historyURL").toString().split(" ")),console.log(c);var d=escape(document.URL);if(null!==a("historyURL")&&void 0!==a("historyURL")&&""!==a("historyURL")){if(d!==c[c.length-1]){if($.inArray(d,c)>-1){var e=$.inArray(d,c);c.splice(e,1),c.push(d)}else c.push(d);c.length>maxHistoryURLSize&&c.shift()}b("historyURL",c.join(" "))}else c[0]=escape(document.URL),b("historyURL",c.join(" "));console.log(c)}function JScrollPaneVertical(a,b){function c(a,b){var e,g,h,i,l,m=!1,n=!1;H=a,void 0===I&&(console.log(b),i=b.scrollTop(),l=b.scrollLeft(),b.css({overflow:"hidden",padding:0}),J=b.innerWidth()+jb,K=b.innerHeight(),b.width(J),I=$('<div class="jspPane" />').css("padding",ib).append(b.children()),L=$('<div class="jspContainer" />').css({width:J+"px",height:K+"px"}).append(I).appendTo(b)),I.css("overflow","auto"),M=a.contentWidth?a.contentWidth:I[0].scrollWidth,N=I[0].scrollHeight,I.css("overflow",""),O=M/J,P=N/K,Q=P>1,R||Q?(b.addClass("jspScrollable"),e=H.maintainPosition&&(U||X),e&&(g=v(),h=w()),d(),f(),e&&(t(n?M-J:g,!1),s(m?N-K:h,!1)),y(),E(),H.enableKeyboardNavigation&&A(),H.clickOnTrack&&j(),C(),H.hijackInternalLinks&&D()):(b.removeClass("jspScrollable"),I.css({top:0,left:0,width:L.width()-jb}),z(),B(),k()),H.autoReinitialise&&!hb?hb=setInterval(function(){c(H)},H.autoReinitialiseDelay):!H.autoReinitialise&&hb&&clearInterval(hb),i&&(b.scrollTop(0),s(i,!1)),l&&(b.scrollLeft(0),t(l,!1)),void 0!==a.mouseScroll&&a.mouseScroll===!0&&G(),b.trigger("jsp-initialised",[Q])}function d(){Q&&(L.append($('<div class="jspVerticalBar" />').append($('<div class="jspCap jspCapTop" />'),$('<div class="jspTrack" />').append($('<div class="jspDrag" />').append($('<div class="jspDragTop" />'),$('<div class="jspDragBottom" />'))),$('<div class="jspCap jspCapBottom" />'))),Y=L.find(">.jspVerticalBar"),Z=Y.find(">.jspTrack"),S=Z.find(">.jspDrag"),H.showArrows&&(cb=$('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",h(0,-1)).bind("click.jsp",x),db=$('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",h(0,1)).bind("click.jsp",x),H.arrowScrollOnHover&&(cb.bind("mouseover.jsp",h(0,-1,cb)),db.bind("mouseover.jsp",h(0,1,db))),g(Z,H.verticalArrowPositions,cb,db)),ab=K,L.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){ab-=$(this).outerHeight()}),S.hover(function(){S.addClass("jspHover")},function(){S.removeClass("jspHover")}).bind("mousedown.jsp",function(a){$("html").bind("dragstart.jsp selectstart.jsp",x),S.addClass("jspActive");var b=a.pageY-S.position().top;return $("html").bind("mousemove.jsp",function(a){m(a.pageY-b,!1)}).bind("mouseup.jsp mouseleave.jsp",l),!1}),e())}function e(){Z.height(ab+"px"),U=0,_=H.verticalGutter+Z.outerWidth(),I.width(J-_-jb);try{0===Y.position().left&&I.css("margin-left",_+"px")}catch(a){}}function f(){N=I.outerHeight(),P=N/K,Q&&(bb=Math.ceil(1/P*ab),bb>H.verticalDragMaxHeight?bb=H.verticalDragMaxHeight:bb<H.verticalDragMinHeight&&(bb=H.verticalDragMinHeight),S.height(bb-8+"px"),T=ab-bb,n(U))}function g(a,b,c,d){var e,f="before",g="after";"os"===b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b===f?g=b:b===g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function h(a,b,c){return function(){return i(a,b,this,c),this.blur(),!1}}function i(a,b,c,d){c=$(c).addClass("jspActive");var e,f,g=!0,h=function(){0!==a&&kb.scrollByX(a*H.arrowButtonSpeed),0!==b&&kb.scrollByY(b*H.arrowButtonSpeed),f=setTimeout(h,g?H.initialDelay:H.arrowRepeatFreq),g=!1};h(),e=d?"mouseout.jsp":"mouseup.jsp",d=d||$("html"),d.bind(e,function(){c.removeClass("jspActive"),f&&clearTimeout(f),f=null,d.unbind(e)})}function j(){k(),Q&&Z.bind("mousedown.jsp",function(a){if(void 0===a.originalTarget||a.originalTarget===a.currentTarget){var b,c=$(this),d=c.offset(),e=a.pageY-d.top-U,f=!0,g=function(){var d=c.offset(),i=a.pageY-d.top-bb/2,j=K*H.scrollPagePercent,k=T*j/(N-K);if(0>e)U-k>i?kb.scrollByY(-j):m(i);else{if(!(e>0))return h(),void 0;i>U+k?kb.scrollByY(j):m(i)}b=setTimeout(g,f?H.initialDelay:H.trackClickRepeatFreq),f=!1},h=function(){b&&clearTimeout(b),b=null,$(document).unbind("mouseup.jsp",h)};return g(),$(document).bind("mouseup.jsp",h),!1}})}function k(){eb&&eb.unbind("mousedown.jsp"),Z&&Z.unbind("mousedown.jsp")}function l(){$("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),S&&(options.isDragEvent=!0,S.removeClass("jspActive")),V&&V.removeClass("jspActive")}function m(a,b){Q&&(0>a?a=0:a>T&&(a=T),void 0===b&&(b=H.animateScroll),b?kb.animate(S,"top",a,n):(S.css("top",a),n(a)))}function n(b){void 0===b&&(b=S.position().top),L.scrollTop(0),U=b;var c=0===U,d=U===T,e=b/T,f=-e*(N-K);(lb!==c||nb!==d)&&(lb=c,nb=d,a.trigger("jsp-arrow-change",[lb,nb,mb,ob])),q(c,d),I.css("top",f),a.trigger("jsp-scroll-y",[-f,c,d]).trigger("scroll")}function o(a,b){R&&(0>a?a=0:a>W&&(a=W),void 0===b&&(b=H.animateScroll),b?kb.animate(V,"left",a,p):(V.css("left",a),p(a)))}function p(b){void 0===b&&(b=V.position().left),L.scrollTop(0),X=b;var c=0===X,d=X===W,e=b/W,f=-e*(M-J);(mb!==c||ob!==d)&&(mb=c,ob=d,a.trigger("jsp-arrow-change",[lb,nb,mb,ob])),r(c,d),I.css("left",f),a.trigger("jsp-scroll-x",[-f,c,d]).trigger("scroll")}function q(a,b){H.showArrows&&(cb[a?"addClass":"removeClass"]("jspDisabled"),db[b?"addClass":"removeClass"]("jspDisabled"))}function r(a,b){H.showArrows&&(fb[a?"addClass":"removeClass"]("jspDisabled"),gb[b?"addClass":"removeClass"]("jspDisabled"))}function s(a,b){var c=a/(N-K);m(c*T,b)}function t(a,b){var c=a/(M-J);o(c*W,b)}function u(a,b,c){var d,e,f,g,h,i,j,k,l,m=0,n=0;try{d=$(a)}catch(o){return}for(e=d.outerHeight(),f=d.outerWidth(),L.scrollTop(0),L.scrollLeft(0);!d.is(".jspPane");)if(m+=d.position().top,n+=d.position().left,d=d.offsetParent(),/^body|html$/i.test(d[0].nodeName))return;g=w(),i=g+K,g>m||b?k=m-H.horizontalGutter:m+e>i&&(k=m-K+e+H.horizontalGutter),isNaN(k)||s(k,c),h=v(),j=h+J,h>n||b?l=n-H.horizontalGutter:n+f>j&&(l=n-J+f+H.horizontalGutter),isNaN(l)||t(l,c)}function v(){return-I.position().left}function w(){return-I.position().top}function x(){return!1}function y(){I.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){u(a.target,!1)})}function z(){I.find(":input,a").unbind("focus.jsp")}function A(){function b(){var a=X,b=U;switch(c){case 40:kb.scrollByY(H.keyboardSpeed,!1);break;case 38:kb.scrollByY(-H.keyboardSpeed,!1);break;case 34:case 32:kb.scrollByY(K*H.scrollPagePercent,!1);break;case 33:kb.scrollByY(-K*H.scrollPagePercent,!1);break;case 39:kb.scrollByX(H.keyboardSpeed,!1);break;case 37:kb.scrollByX(-H.keyboardSpeed,!1)}return d=a!==X||b!==U}var c,d,e=[];Q&&e.push(Y[0]),I.focus(function(){a.focus()}),a.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(a){if(a.target===this||e.length&&$(a.target).closest(e).length){var f=X,g=U;switch(a.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=a.keyCode,b();break;case 35:s(N-K),c=null;break;case 36:s(0),c=null}return d=a.keyCode===c&&f!==X||g!==U,!d}}).bind("keypress.jsp",function(a){return a.keyCode===c&&b(),!d}),H.hideFocus?(a.css("outline","none"),"hideFocus"in L[0]&&a.attr("hideFocus",!0)):(a.css("outline",""),"hideFocus"in L[0]&&a.attr("hideFocus",!1))}function B(){a.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function C(){if(location.hash&&location.hash.length>1){var a,b,c=escape(location.hash.substr(1));try{a=$("#"+c+', a[name="'+c+'"]')}catch(d){return}a.length&&I.find(c)&&(0===L.scrollTop()?b=setInterval(function(){L.scrollTop()>0&&(u(a,!0),$(document).scrollTop(L.position().top),clearInterval(b))},50):(u(a,!0),$(document).scrollTop(L.position().top)))}}function D(){$(document.body).data("jspHijack")||($(document.body).data("jspHijack",!0),$(document.body).delegate("a[href*=#]","click",function(a){var b,c,d,e,f,g,h=this.href.substr(0,this.href.indexOf("#")),i=location.href;if(-1!==location.href.indexOf("#")&&(i=location.href.substr(0,location.href.indexOf("#"))),h===i){b=escape(this.href.substr(this.href.indexOf("#")+1));try{c=$("#"+b+', a[name="'+b+'"]')}catch(j){return}c.length&&(d=c.closest(".jspScrollable"),e=d.data("jsp"),e.scrollToElement(c,!0),d[0].scrollIntoView&&(f=$(window).scrollTop(),g=c.offset().top,(f>g||g>f+$(window).height())&&d[0].scrollIntoView()),a.preventDefault())}}))}function E(){var a,b,c,d,e,f=!1;L.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=v(),b=w(),c=h.pageX,d=h.pageY,e=!1,f=!0}).bind("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=X,j=U;return kb.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i===X&&j===U}}).bind("touchend.jsp",function(){f=!1}).bind("click.jsp-touchclick",function(){return e?(e=!1,!1):void 0})}function F(){var b=w(),c=v();a.removeClass("jspScrollable").unbind(".jsp"),a.replaceWith(originalElement.append(I.children())),originalElement.scrollTop(b),originalElement.scrollLeft(c),hb&&clearInterval(hb)}function G(){a.bind("mousewheel DOMMouseScroll",function(a){void 0!==a.originalEvent.wheelDelta?a.originalEvent.wheelDelta/120>0?kb.scrollByY(-H.keyboardSpeed,!1):kb.scrollByY(H.keyboardSpeed,!1):a.originalEvent.detail/120<0?kb.scrollByY(-H.keyboardSpeed,!1):kb.scrollByY(H.keyboardSpeed,!1),a.preventDefault()})}var H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb=this,lb=!0,mb=!0,nb=!1,ob=!1;"border-box"===a.css("box-sizing")?(ib=0,jb=0):(ib=a.css("paddingTop")+" "+a.css("paddingRight")+" "+a.css("paddingBottom")+" "+a.css("paddingLeft"),jb=(parseInt(a.css("paddingLeft"),10)||0)+(parseInt(a.css("paddingRight"),10)||0)),$.extend(kb,{reinitialise:function(a){a=$.extend({},H,a),c(a)},scrollToElement:function(a,b,c){u(a,b,c)},scrollTo:function(a,b,c){t(a,c),s(b,c)},scrollToX:function(a,b){t(a,b)},scrollToY:function(a,b){s(a,b)},scrollToPercentX:function(a,b){t(a*(M-J),b)},scrollToPercentY:function(a,b){s(a*(N-K),b)},scrollBy:function(a,b,c){kb.scrollByX(a,c),kb.scrollByY(b,c)},scrollByX:function(a,b){var c=v()+Math[0>a?"floor":"ceil"](a),d=c/(M-J);o(d*W,b)},scrollByY:function(a,b){var c=w()+Math[0>a?"floor":"ceil"](a),d=c/(N-K);m(d*T,b)},positionDragX:function(a,b){o(a,b)},positionDragY:function(a,b){m(a,b)},animate:function(a,b,c,d){var e={};e[b]=c,a.animate(e,{duration:H.animateDuration,easing:H.animateEase,queue:!1,step:d})},getContentPositionX:function(){return v()},getContentPositionY:function(){return w()},getContentWidth:function(){return M},getContentHeight:function(){return N},getPercentScrolledX:function(){return v()/(M-J)},getPercentScrolledY:function(){return w()/(N-K)},getIsScrollableV:function(){return Q},getContentPane:function(){return I},scrollToBottom:function(a){m(T,a)},hijackInternalLinks:$.noop,destroy:function(){F()}}),c(b,a),H=$.extend({},options,H),$.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){H[this]=H[this]||H.speed})}Function.prototype.bind||(Function.prototype.bind=function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){return a.apply(c,b.concat(Array.prototype.slice.call(arguments)))}}),_.mixin({noop:function(){},nextCycle:function(a){return _.delay(a,0)},isDefined:function(a){return!_.isUndefined(a)},firstDefined:function(){return _.find(arguments,_.isDefined)},addCssClass:function(a,b){return _.contains(a,b)?a:String(a)+" "+$.trim(String(b))},addCssClassStrict:function(a,b){return _.isString(a)?_.contains(a,b)?a:a+" "+$.trim(String(b)):$.trim(b)},replaceArrayItems:function(a,b){return a.length=0,_.each(b,function(b){a.push(b)}),a},toggle:function(a,b){return _.isDefined(b)?Boolean(b):!a},initialUntilItem:function(a,b,c){c=_.firstDefined(c,!1);var d=_.indexOf(a,b);return a=convertNodeListToArray(a),a.slice(0,d+(c?1:0))},createObject:function(a){function b(){}return Object.create?Object.create(a):(b.prototype=a,new b)},decorate:function(a,b){return a=_.createObject(a),_.extend(a,b),a},arrayify:function(a){return _.isArray(a)?a:[a]},vsprintf:function(a,b){return vsprintf(a,b)},uniquePush:function(a,b){return _.contains(a,b)||a.push(b),a},chunk:function(a,b){if(_.isUndefined(b))return a;if(1>b)throw new Error("chunkSize must be a whole number");var c,d=[];return _.each(a,function(a,e){0===e%b&&(d.push([]),c=d.length-1),d[c].push(a)}),d},mapDeep:function(a,b){return _.isArray(a)?_.map(a,function(a){return _.mapDeep(a,b)}):_.isObject(a)?_.reduce(a,function(a,c,d){return a[d]=_.mapDeep(c,b),a},{}):b(a)}}),angular.module("alertDrawerMock",[]).controller("AlertDrawerMockCtrl",["$scope","AlertAPI",function(a,b){var c={isOpen:!1};a.drawerModel=c;var d=this;return a.$watch(function(){return b.type},function(){d.currentAlert=b.type}),a.$watch(function(){return b.index},function(){d.currentAlertIndex=b.index,null===d.currentAlertIndex&&(c.isOpen=!1)}),a.AlertDrawerMockCtrl=d}]).constant("MockDataOutage",{message:"Your TV, Phone, and Internet is up and running properly. But if you did encounter a service disruption in the future, there are a few simple fixes you could try.",status:"working"}).constant("MockDataAlerts",{_links:{self:{href:"/alert"}},_embedded:{alerts:[{_links:{self:{href:"/alert/cms-2214"}},corpIds:[7801,7802,7803,7804,7806,7808,7816,7817,7818,7819,7828,7836,7837,7839,7840,7844,7848,7858,7862,7864,7865,7866,7867,7868,7869,7870,7872,7873,7874,7875,7876,7877,7881,7882,7883,7896],date:13679649e5,id:2214,regions:["New York","Long Island","New Jersey","Connecticut","Westchester","The Bronx","Hudson Valley","Brooklyn"],summary:"Test Alert",title:"Service Outage"},{_links:{self:{href:"/alert/cms-2405"}},corpIds:[7801,7802,7803,7804,7806,7808,7816,7817,7818,7819,7828,7836,7837,7839,7840,7844,7848,7858,7862,7864,7865,7866,7867,7868,7869,7870,7872,7873,7874,7875,7876,7877,7881,7882,7883,7896],date:13680477e5,id:2405,regions:["New York","Long Island","New Jersey","Connecticut","Westchester","The Bronx","Hudson Valley","Brooklyn","LI"],summary:"This is just a summary of the alert, not the body of the alert.",title:"Alert With Body"},{_links:{self:{href:"/alert/cms-10006"}},corpIds:[7801,7802,7803,7804,7806,7808,7816,7817,7818,7819,7828,7836,7837,7839,7840,7844,7848,7858,7862,7864,7865,7866,7867,7868,7869,7870,7872,7873,7874,7875,7876,7877,7881,7882,7883,7896],date:13730598e5,id:10006,regions:["New York","Long Island","New Jersey","Connecticut","Westchester","The Bronx","Hudson Valley","Brooklyn","LI"],summary:"Test alert. Wooooooooh!",title:"Test"}]}}),angular.module("alertDrawer",["alertsService","ctaArrowLink"]).run(["$rootScope",function(a){var b={};a.once=function(a,c){return a in b||(b[a]=_.once(c)),b[a]}}]).factory("AlertAPI",function(){return{type:null,index:null,currentAlert:function(a){this.type=a},currentAlertIndex:function(a){this.index=a},clear:function(){this.type=null,this.index=null}}}).directive("alertDrawer",function(){return{restrict:"EA",scope:{},transclude:!0,replace:!0,controller:"AlertDrawerCtrl",templateUrl:"/parts/alert-drawer/alert-drawer.html",link:function(){}}}).controller("AlertDrawerCtrl",["$scope","$q","AlertAPI","Alerts","Outage","$cookies",function(a,b,c,d,e,f){function g(){if(l(),o.splice(n,1),o.length)j(m(n)?n:o.length-1),a.api.currentAlertIndex(o.length);else{a.currentAlert=null,a.api.clear();var b=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1");document.cookie="alrtDrwr=closed;path=/;domain="+b+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT")}}function h(){return 2===o.length?"1 more alert":o.length-1+" more alerts"}function i(){j(m(n+1)?n+1:0)}function j(a){n=a,k(a)}function k(b){o[b]&&(a.currentAlert=o[b],a.api.currentAlert(a.currentAlert.type))}function l(){s&&(s.linkTrackEvents="event3",s.events="event3",s.tl())}function m(a){return a>=0&&a<=o.length-1}d.getAlert=a.$root.once("Alerts",d.getAlert);var n=0,o=[],p={major:"warning-sign",minor:"time"};a.api=c,d.getCombinedAlerts().then(_.once(function(b){if(o=b.alerts,a.alerts=o,0!==o.length){var c=f.alertIds,d=[];void 0!==c&&(c=JSON.stringify(c).replace(/"/g,""),d=c.split(",").map(Number));var e=[];_.each(a.alerts,function(a){void 0!==a.id&&null!==a.id&&e.push(a.id)});for(var g=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1"),h=!0,i=0;i<e.length;i++)if(_.contains(d,e[i])===!1){h=!1;break}h||(document.cookie="alrtDrwr=true;path=/;domain="+g+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT")),document.cookie="alertIds="+e+";path=/;domain="+g+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT")}a.api.currentAlertIndex(o.length),k(n)})),a.reloadOutageRoute=function(){var b=window.location.href,c=b.indexOf("/support"),d=b.substring(c);d===a.currentAlert.link&&-1!==window.location.href.indexOf("#")&&window.location.reload();var e=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1");document.cookie="alrtDrwr=false;path=/;domain="+e+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT"),window.location.href=a.currentAlert.link},a.selectNextAlert=i,a.removeAlert=g,a.lookupIconForAlertType=p,a.lookupImgForOutageType=e.outageIcon,a.alerts=o,a.moreAlertsWording=h,a.currentAlert=null,a.drawerIsOpen=!1}]),angular.module("alertMulti",["alertBanner"]).directive("alertMulti",[function(){return{templateUrl:"/parts/alert-multi/alert-multi-template.html",restrict:"EA",scope:{alerts:"=alerts",update:"=update"},link:function(a){function b(){switch(type="major",a.currentAlertConfig.type&&(type=a.currentAlertConfig.type),$(".icons-color").removeClass("icons-major icons-minorWarning icons-success icons-minor"),a.currentBorderTheme="border-"+type,a.currentIconTheme="icons-"+type,a.currentPrevValue="",a.currentNextValue="",type){case"minor":a.currentAlertTheme="theme-primary",$(".icons-color").addClass("icons-minor");break;case"minorWarning":a.currentAlertTheme="theme-primary",$(".icons-color").addClass("icons-minorWarning");break;case"minorSuccess":a.currentAlertTheme="theme-primary",$(".icons-color").addClass("icons-success");break;case"success":a.currentAlertTheme="theme-success",$(".icons-color").addClass("icons-success");break;case"successLeaf":a.currentAlertTheme="theme-success",$(".icons-color").addClass("icons-success");break;default:a.currentAlertTheme="theme-alert",$(".icons-color").addClass("icons-major")}a.currentAlert===a.totalAlerts&&(a.currentNextValue=" not-visible"),1===a.currentAlert&&(a.currentPrevValue=" not-visible")}defaultObj={message:"test",type:"minorWarning",ctas:[]},a.currentAlertConfig=defaultObj,a.$watch("update",function(){if(a.alerts&&a.alerts.length>0){var c=function(a,b){return a&&!b?-1:b&&!a?1:a.actionAlert?-1:b.actionAlert?1:a.type&&!b.type?-1:!a.type&&b.type?1:"success"===a.type&&"success"!==b.type?-1:"success"!==a.type&&"success"===b.type?1:a.priority&&b.priority?a.priority>b.priority?1:-1:"major"===a.type&&"major"!==b.type?-1:"major"!==a.type&&"major"===b.type?1:-1};a.alerts=a.alerts.sort(c),a.showAlerts=!0,a.totalAlerts=a.alerts.length,a.currentAlert=1,a.getCurrentAlertConfig(),b()}else a.showAlerts=!1;$(".linked-anchor.account-activity").live("click",function(){window.location="/pay-bill/account-activity"}),$(".linked-anchor.automatic-payments").live("click",function(){window.location="/pay-bill/automatic-payments"}),$(".linked-anchor.payment-options").live("click",function(){window.location="/pay-bill/payment-options"}),$(".linked-anchor.manage-payments").live("click",function(){window.location="/pay-bill/manage-payments"})}),a.getCurrentAlertConfig=function(){a.alerts&&a.alerts.length>0&&a.alerts.length>a.currentAlert-1?a.currentAlertConfig=a.alerts[a.currentAlert-1]:(a.currentAlertConfig=defaultObj,a.showAlerts=!1),b()},a.nextAlert=function(){a.currentAlert<a.totalAlerts&&(a.currentAlert++,a.getCurrentAlertConfig())},a.prevAlert=function(){a.currentAlert>1&&(a.currentAlert--,a.getCurrentAlertConfig())},a.currentTotalText=function(){return""+a.currentAlert+" of "+a.totalAlerts}}}}]),angular.module("alertBanner",["ctaArrowLink","alertHelpers"]).directive("alertBanner",["bannerConverter","lpChecker",function(a,b){return{restrict:"EA",templateUrl:"/parts/alerts/alert-banner-template.html",replace:!0,scope:!0,link:function(c,d,e){if(c.model={},_.isDefined(e.config))c.$watch(e.config,function(d){c.model=a(_.clone(d)),b(c.model.lp)},!0);else{var f={},g=["title","message","icon","img","type","ctas","lp"];_.each(g,function(d){_.isDefined(e[d])&&c.$watch(e[d],function(e){f[d]=e,c.model=a(_.clone(f)),b(c.model.lp)})})}}}}]).factory("bannerConverter",["messageConverter",function(a){function b(a){return _.isString(a.icon)&&a.icon&&"icon-"!==a.icon.substr(0,5)&&(a.icon="icon-"+a.icon),a}return function(c){return b(a(c))}}]).factory("lpChecker",["$timeout",function(a){return function(b){b&&a(function(){console.log("About to call lpTag.newPage"),lpTag.newPage(window.location.href)},0,!1)}}]),setTimeout(function(){$(".dot.dot--dark-overlay").addClass("dotpie")},2e3),angular.module("alertHelpers",["ngSanitize"]).factory("messageConverter",["$sanitize",function(a){var b={major:{theme:"theme-alert",icon:"icon-exclamation-major"},minorWarning:{theme:"theme-primary",icon:"icon-exclamation-minor"},minor:{theme:"theme-primary",icon:"icon-pushpin"},minorSuccess:{theme:"theme-primary",icon:"icon-ok"},key:{theme:"theme-alert",icon:"icon-key"},success:{theme:"theme-success",icon:"icon-ok"},primary:{theme:"theme-primary",icon:"icon-ok"},successLeaf:{theme:"theme-success",icon:"icon-leaf"}};return function(c){function d(a){return a={title:a},e(a)}function e(c){if(c.ctas=c.ctas||[],c.type){var d=["major","minor","minorSuccess","key","minorWarning","success","primary","successLeaf"];if(!_.contains(d,c.type))throw"You asked for an alert model type of "+c.type+", but it must be one "+d.join(",")+"."}else c.type="major";return!c.title&&c.message&&(c.title=c.message,delete c.message),c.icon||c.img||(c.icon=b[c.type].icon),c.cssClass=_.addCssClassStrict(c.cssClass,b[c.type].theme),c.trusted||(c.title&&(c.title=a(c.title)),c.message&&(c.message=a(c.message))),c}if(_.isString(c))return d(c);if(_.isPlainObject(c))return e(c);throw"alert-helpers.js' messageConverter needs 'newConfig' to be a string or a plain object, but was instead: "+c}}]),angular.module("alertModal",["messages","alertHelpers"]).factory("alertModal",["$timeout","messageModal","messageConverter",function(a,b,c){var d=function(){function d(){f.length&&!g&&(g=!0,f.shift().open().then(function(){a(function(){g=!1,d()},500)}))}var e=this,f=[],g=!1;e.create=function(a){var e=b(c(a));return f.push(e),d(),e.willClose.promise}};return new d}]),angular.module("billpayWidget",["modal","panel","payBillResource","payBillUtils","spinner"]).directive("billpayWidget",["PayBillService","PayBillUtils",function(a,b){return{restrice:"EA",scope:{ooluser:"=ooluser"},templateUrl:"/parts/billpay-widget/billpay-widget-template.html",link:function(c){var d=moment().format("h:mm a");c.billpayData={};var e={main:{error:"Unable to access billing information at this time.",noBillpayAccess:"Please sign in as the primary user to view and pay your bill.",reauth:"Please sign in again to view and pay your bill.",unauth:"Please sign in to view and pay your bill.",creditOrCurrent:"No payment is due at this time",late:"Payment is past due",pastDue30:"Your account is past due",pastDue60:"Payment is required to prevent service interruption",preDeAuthBeforeStartDate:"",preDeAuthAfterStartDate:"Payment is due immediately",deAuth:"Payment is needed to restore your service"},payButton:{balance:"Make a payment",pastDue:"Pay now",deAuth:"Payment due immediately",creditOrCurrent:"View your bill",signIn:"Sign In"},toolTip:{lastPayment:'Payments may take up to 24 hours to appear here. All of your recently processed payments can be viewed in the <a href="pay-bill/account-activity">Account activity</a> section.',amountDue:"This is the total amount due on your Optimum account. It includes all credits and payments processed up through "+d+", today.",currentBalance:"This is the most current information available to both our systems and customer service agents. It includes all credits and payments processed up through "+d+", today.",currentBalanceWithPpv:"Pay Per View and On Demand services on your account have been suspended as you've exceeded your ordering limit.",pastDue:"Your Optimum account is past due. The last thing we want to do is interrupt or disconnect your service. Please pay this amount to prevent interruption of your service.",lateWithPpv:"",pastDue30WithPpv:"",pastDue60WithPpv:"",preDeAuth:"",preDeAuthWithPpv:"",deAuth:"",deAuthWithPpv:""}},f={login:"/login/?referer=%2fpay-bill%2f",viewMyBill:"/pay-bill/my-bill/",payBill:"pay-bill/payment-options/"};c.state={loading:!0,message:void 0,amountDue:void 0,dueDate:void 0,isAuthed:!1,isReauth:!1,error:!1,isPastDue:!1,pastDueAmount:void 0,lastPaymentDate:void 0,lastPaymentAmount:void 0,button:{text:e.payButton.balance,href:f.payBill},currentBalance:void 0,isBalanceCredit:!1,isCredit:!1,hasPpvInhibit:!1,deAuth:{startDate:void 0},toolTip:{lastPayment:e.toolTip.lastPayment,currentBalance:e.toolTip.currentBalance,pastDue:e.toolTip.pastDue,amountDue:e.toolTip.amountDue}};var g=function(){c.ooluser&&(c.state.isAuthed=i()),c.state.isAuthed?a.getBPGlobal({},function(a){c.billpayData=a;var d=b.currency(c.billpayData.pastDueAmount,!0),f=b.currency(c.billpayData.pastDueAmountWithPpv,!0);e.main.preDeAuthBeforeStartDate=c.billpayData.deAuthStartDate?"Your service could be interrupted on "+moment(c.billpayData.deAuthStartDate).format("MM/DD"):"",e.toolTip.lateWithPpv="Our records indicate that your account is past due. To bring your account current and restore your ability to order PPV & On Demand, a payment of "+f+" is required.",e.toolTip.pastDue30WithPpv="Your account is past due in the amount of "+d+". To prevent interruption of service, restore PPV/On Demand & avoid late/restore fees, payment of "+f+" is required.",e.toolTip.pastDue60WithPpv="Our records indicate that your account is significantly past due in the amount of "+d+". To prevent an interruption of all of your services, restore your ability to order PPV & On Demand and avoid late/restore service fees, an immediate payment of "+f+" is required.",e.toolTip.preDeAuth="Your account is past due in the amount of "+d+". To prevent interruption of service and avoid late/restore fees, this payment is required.",e.toolTip.preDeAuthWithPpv="Our records indicate that your account is significantly past due in the amount of "+d+". To prevent the impending interruption of all of your services, restore your ability to order PPV & On Demand and avoid late/restore service fees, an immediate payment of "+f+" is required.",e.toolTip.deAuth="Your service has been suspended due to non-payment. To restore your service, a minimum payment of "+d+" is required.",e.toolTip.deAuthWithPpv="Your service has been suspended due to non-payment. To restore your service and your ability to order PPV & On Demand, a minimum payment of "+f+" is required.",h()},function(a){"undefined"!=typeof a.Message&&"Reauthentication required"===a.Message?c.state.isReauth=!0:(c.state.error=!0,c.state.message=e.main.error),h()}):h()},h=function(){c.state.isAuthed&&!c.state.error?j():(c.state.button.href=f.login,c.state.button.text=e.payButton.signIn),c.state.loading=!1},i=function(){return c.ooluser.hasOOLSession?!c.ooluser.hasOOLSession||c.ooluser.primary||c.ooluser.p.bp?c.state.isReauth?(c.state.message=e.main.reauth,!1):!0:(c.state.message=e.main.noBillpayAccess,!1):(c.state.message=e.main.unauth,!1)},j=function(){c.state.hasPpvInhibit=c.billpayData.ppvInhibit,c.state.lastPaymentDate=c.billpayData.recentPayDate?moment(c.billpayData.recentPayDate,"MM/DD/YYY").format("MM/DD"):"",c.state.lastPaymentAmount=c.billpayData.recentPayAmount>0?b.currency(c.billpayData.recentPayAmount,!0):"",c.state.isBalanceCredit=c.billpayData.currentBalance<0,c.state.currentBalance=b.currency(c.billpayData.currentBalance,!0),c.state.toolTip.currentBalance=c.billpayData.ppvInhibit?e.toolTip.currentBalanceWithPpv:e.toolTip.currentBalance,c.state.amountDue=c.billpayData.amountDue>0?b.currency(c.billpayData.amountDue,!0):"",c.state.dueDate=moment(c.billpayData.dueDate,"MM/DD/YYY").format("MM/DD"),c.billpayData.amountDue<=0?(c.state.message=e.main.creditOrCurrent,c.state.button.text=e.payButton.creditOrCurrent,c.state.button.href=f.viewMyBill,c.billpayData.amountDue<0&&(c.state.isCredit=!0)):c.billpayData.dueDays>=0&&c.billpayData.amountDue>0&&""===c.billpayData.pastDue?c.state.message=e.main.inCycle:c.billpayData.dueDays<0&&c.billpayData.amountDue>0&&""===c.billpayData.pastDue?(c.state.message=e.main.late,c.state.toolTip.currentBalance=c.billpayData.ppvInhibit?e.toolTip.lateWithPpv:e.toolTip.currentBalance):""!==c.billpayData.pastDue&&("30"===c.billpayData.pastDue?(c.state.message=e.main.pastDue30,c.state.toolTip.pastDue=c.billpayData.ppvInhibit?e.toolTip.pastDue30WithPpv:e.toolTip.pastDue):(c.state.message=e.main.pastDue60,c.state.toolTip.pastDue=c.billpayData.ppvInhibit?e.toolTip.pastDue60WithPpv:e.toolTip.pastDue),c.state.isPastDue=!0,c.state.pastDueAmount=c.billpayData.pastDueAmountWithPpv>0?b.currency(c.billpayData.pastDueAmountWithPpv,!0):"",c.state.button.text=e.payButton.pastDue),(c.billpayData.preDeAuth||c.billpayData.deAuth)&&(c.state.button.text=e.payButton.deAuth,c.billpayData.preDeAuth?(c.state.message=new Date(c.billpayData.deAuthStartDate).getTime()>(new Date).getTime()?e.main.preDeAuthBeforeStartDate:e.main.preDeAuthAfterStartDate,c.state.toolTip.pastDue=c.billpayData.ppvInhibit?e.toolTip.preDeAuthWithPpv:e.toolTip.preDeAuth):(c.state.message=e.main.deAuth,c.state.toolTip.pastDue=c.billpayData.ppvInhibit?e.toolTip.deAuthWithPpv:e.toolTip.deAuth))};g()}}}]),angular.module("blockError",[]).directive("blockError",[function(){return{restrict:"EA",templateUrl:"/parts/block-error/block-error-template.html",scope:{fallBacklink:"@link",topic:"@topic"},link:function(){}}}]),angular.module("carousels",["dots","if","dvrRecord","ellipsis","poster","imgAlt","hover","isViewportSize"]).directive("carousel",["$timeout","limitToFilter","isViewportSize",function(a,b,c){return{restrict:"E",scope:{showHide:"=show",localItems:"=items",showMock:"=mock",isLazy:"=lazy",positionWithPosition:"=positionWithPosition",isIndented:"=indent",extraIndent:"=extraIndent",maxSets:"=maxSets",scrollByPixels:"=scrollByPixels",type:"=type"},transclude:!0,replace:!1,templateUrl:"/parts/carousels/carousels-tmpl.html",link:function(d,e){function f(){ib(),hb&&(Q.items=Q.generateMockElements(),ab=Q.items.length),p(),d.$emit("carouselEvent",{eventName:"load",eventTarget:$(e)}),k()?(S.addClass("art"),S.removeClass("block"),Q.isArtwork=!0):(S.addClass("block"),S.removeClass("art"),Q.isArtwork=!1),O(),i()}function g(){console.log("mock: test callback action")}function h(){var a=!1;(d.localItems[0]!==d.items[0]||d.localItems.length<d.items.length)&&(a=!0),Q.items=Q.localItems,O(),i(),a&&N()}function i(){var a;try{delete Q.maxItems}catch(b){}if(null!==(a=l())){var c=0,d=0,e=v();_.each(Q.items,function(b,f){return c+=(b.itemWidth||140)+(k()?28:0),c>e&&(d++,c=c-(k()?28:0)<=e?0:(b.itemWidth||140)+(k()?28:0)),d>=a?(Q.maxItems=f,!1):void 0})}}function j(){a(function(){var a,b=S.width();k()?(Q.isArtwork=!0,S.addClass("art"),S.removeClass("block"),angular.isNumber(b)&&b>100&&(a=Q.getLimitedItems().length*S.find(".item").outerWidth(!0))>10?T.width(a+10+"px"):T.width(""),T.height()<S.find(".poster").height()&&(T.css("height",S.find(".poster").height()),V.css("top",0),W.css("top",0))):(Q.isArtwork=!1,S.addClass("block"),S.removeClass("art"),T.width(""),T.css("max-height",fb)),p()
})}function k(){var a=!1;return"block"===Q.type?!1:"art"===Q.type?!0:($.each(Q.items,function(b,c){return c.artwork?(a=!0,!1):void 0}),a)}function l(){var a=Q.maxSets;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)&&a>0?a:null}function m(a){return parseInt(a.toString().match(/-(\d+)$/)[1],10)}function n(a,b){if(a.attr("id")){var c=Q.getLimitedItems()[m(a.attr("id"))];return b===!0?c.secondItem.action:c.action}console.warn("warning, item.attr(id) is undefined")}function o(a){return Q.getLimitedItems()[m(a.parents(".item").attr("id"))].buttons[a.attr("value")].action}function p(){gb=Q.isIndented?0===Q.getLimitedItems().length?[]:new Array(1+Math.ceil((T.width()-A(z()))/v())):0===Q.getLimitedItems().length?[]:new Array(Math.ceil(T.width()/v())),d.dots=gb}function q(a,b){var c="first"===a?0:"next"===a?G():I(),e=L()&&Q.isIndented?z():0;T.animate({left:c},eb,"swing",function(){"function"==typeof b&&setTimeout(function(){var a;b(),angular.isNumber(d.scrollByPixels)&&(a=S.find(".item"),a.each(function(a,b){b=$(b);var d=b.position().left,e=z()-c;return d===e||e>d&&d+b.outerWidth()>e?(D(a),!1):void 0})),Q.onScroll(Z,c,e)},eb)})}function r(){isMobile()||(L()?(S.removeClass("show-prev-ui"),M()?S.removeClass("show-next-ui"):S.addClass("show-next-ui")):M()?(S.addClass("show-prev-ui"),S.removeClass("show-next-ui")):(S.addClass("show-prev-ui"),S.addClass("show-next-ui")),bb=!0)}function s(){!isMobile()&&bb&&(S.removeClass("show-prev-ui"),S.removeClass("show-next-ui"),bb=!0)}function t(){bb&&r()}function u(){S.css("left",0),S.width(v()),S.removeClass("indented")}function v(){return Q.isIndented?$(window).width():$(e).offsetParent().width()-$(e).position().left}function w(){Q.isIndented&&(S.css("left",z()),S.width(A(z())),S.addClass("indented"),T.css("left",0))}function x(){var a=v();S.width(!isNaN(a)&&a>1?a:"")}function y(){return S.hasClass("indented")}function z(){return U[Q.positionWithPosition?"position":"offset"]().left+(angular.isNumber(Q.extraIndent)?Q.extraIndent:0)}function A(a){return v()-a}function B(){return y()?v()-z():angular.isNumber(d.scrollByPixels)?v()-$(S.find(".item")[Z]).offset().left:v()}function C(a){var b=0,c=-1,d=0,e=$(S.find(".item")),f=Z;if(e.size()*e.outerWidth(!0)>v())for(;Math.round(b)<B()&&c!==b&&-1!==f;)c=b,b+=$(e[f]).outerWidth(!0),d++,f=a?f-=1:f+=1;return d-1}function D(a){try{}catch(b){}Z=a}function E(){return Z}function F(a){var b,c=S.find(".item");b=a?$(c[E()-C(a)]).index():$(c[C()-1+E()]).index();try{}catch(d){}return b}function G(){return L()&&Q.isIndented?-1*(H()-z()):K()+-1*H()}function H(){var a=$(S.find(".item")[F()+1]).offset().left;return Q.isIndented||(a-=$(S).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(B()/d.scrollByPixels)),a}function I(){return K()+Math.abs(J())}function J(){var a=$(S.find(".item")[F(!0)]).offset().left;return Q.isIndented||(a-=$(S).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(Math.max(0,B())/d.scrollByPixels)),a}function K(){return $(S).find(".slide")[Q.isIndented?"offset":"position"]().left}function L(){return 1===Q.currentSet}function M(){return Q.currentSet===gb.length}function N(){q("first",function(){Q.currentSet=1,D(0)})}function O(){L()&&Q.isIndented?w():Q.isIndented?u():x(),j(),a(t,eb)}var P=500,Q=d,R=$(e).attr("id"),S=$(e).find(".carousel"),T=$(e).find(".slide");$(e).find(".item");var U=$(e).find(".dots"),V=$(e).find(".carousel-next"),W=$(e).find(".carousel-prev"),X=0;Q.currentSet=1;var Y,Z=0,ab=0,bb=!1,cb=!1,db="",eb=200,fb=60,gb=[],hb=Q.showMock?parseInt(Q.showMock,10):!1;Q.items=[],Q.load=function(){};var ib=function(){var a=function(a){var d=$(a.target),e={targetElem:d,clickedItem:d.is("li")?d:d.parents(".item"),clickedBtn:d.is("button")?d:d.closest("button").length>0?d.closest("button"):!1,clickedDVRRecord:d.is("dvr-record, [dvr-record]")||d.closest("dvr-record, [dvr-record]").length>0?d:!1,clickedInfoBlock:d.is(".info-block")?d:d.closest(".info-block")};if(e.clickedSecondItem=e.clickedInfoBlock.prev().is(".info-block"),e.clickedItem){if(isMobile()&&!cb&&!c.phone&&db!==e.clickedItem.attr("id"))return db=e.clickedItem.attr("id"),void 0;isMobile()&&!cb?Y=setTimeout(function(){b(a,e)},P):isMobile()||cb||b(a,e)}},b=function(a,b){b.clickedDVRRecord||(!b.clickedBtn&&n(b.clickedItem,b.clickedSecondItem)&&angular.isFunction(n)?n(b.clickedItem,b.clickedSecondItem)():b.clickedBtn&&o(b.clickedBtn)&&angular.isFunction(o)&&o(b.clickedBtn)()),d.$emit("carouselEvent",{eventName:"click",eventTarget:a.target})};e.bind("click",function(b){a(b)}),Q.isPast=function(a){return angular.isDate(a)&&a.getTime()<(new Date).getTime()},$(window).resize(function(){Q.$apply(function(){O(),i(),p()})}),$(e).mouseover(function(){r()}),$(e).mouseout(function(){s()}),W.click(function(){q("previous",function(){Q.currentSet--,D(F(!0))})}),V.click(function(){q("next",function(){Q.currentSet++,D(F()+1)})}),T.swipe({tap:function(b){(3!==b.which||2!==b.button)&&a(b)},swipe:function(a,b){Y&&clearTimeout(Y),isMobile()&&!cb&&("left"!==b||M()?"right"!==b||L()||(cb=!0,q("previous",function(){Q.currentSet--,D(F(!0)),cb=!1})):(cb=!0,q("next",function(){Q.currentSet++,D(F()+1),cb=!1})))},threshold:75}),Q.$watch("localItems",function(a){a&&(ab=d.localItems.length,setTimeout(function(){Q.$apply(p)},100),h())}),Q.$watch("localItems.length",function(a){a&&h()}),Q.$watch("showHide",function(){d.showHide===!0?($(e).removeClass("hidden"),O()):$(e).addClass("hidden")}),Q.$watch("isIndented",function(){O(),i()}),Q.onScroll=function(a,b,c){O(),d.$emit("carouselEvent",{carouselId:R,eventName:"scroll",eventTarget:S.find(".item")[a],offset:b,offsetDelta:b-X-c}),X=b}};Q.generateMockElements=function(){var a=[];switch(hb){case 1:for(var b=1;20>=b;b++)a.push({id:"item",action:g,artwork:"/parts/carousels/images/art"+b+".jpg",info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]});break;case 2:for(;20>=b;b++)a.push({id:"item",action:g,itemWidth:getRandomInt(10,200),info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]})}return a},Q.getLimitedItems=function(){return angular.isNumber(Q.maxItems)?b(Q.items,Q.maxItems):Q.items},f()}}}]),angular.module("cartfav",["movieCart","l","dropdowns","escape","ctaArrowLink","drawerRow","drawerGrid","inputRadio","linksDvrCart","filters","checkbox","pagination","modal","spinner","showBusy","ctaArrowLink","sticky","stickyStack","addItBack","alertBanner","alertModal","poster"]).controller("CartFavCtrl",["$scope","movieCart","alertModal","l","$log","ooluser",function(a,b,c,d,e,f){function g(){r.busyState="loading",h()}function h(){function a(a){var b=_.map(a.assets,d);_.replaceArrayItems(r.items,b),r.busyState="standby"}function c(a){e.log("ERROR LOADING CART ITEMS: ",a),r.alertBannerErrorLoadingCartItems.showing=!0,r.busyState="standby"}function d(a){function b(a,b){var c=(a-new Date)/864e5;return b>c?!0:!1}var c=a;return c.durationDisplay=getDurationDisplay(1e3*60*c.movieLength),c.dateEndsDisplay=moment(c.endDt).format("L"),c.isEndingSoon=b(new Date(c.endDt),25),c.isMarkedForRemoval=!1,c}b.getItems(a,c,!0)}function i(a){_.each(r.items,function(b){j(b,a)})}function j(a,b){a.isMarkedForRemoval=_.toggle(a.isMarkedForRemoval,b),a.isMarkedForRemoval&&r.isTrashMode===!1&&(r.isTrashMode=!0)}function k(a){r.isTrashMode=_.toggle(r.isTrashMode,a),r.isTrashMode||i(!1)}function l(a){function e(){a.isRemoved=!1,c.create(d[q].errorRemovingItem)}a.isRemoved=!0,r.errorSpoofing.removeItem?e():b.removeItem(a.id,null,e)}function m(a){function e(){a.isRemoved=!0,c.create(d[q].errorAddingItem)}a.isRemoved=!1,r.errorSpoofing.addBack?e():b.addItem(a.id,null,e)}function n(){function a(){r.busyState="removing",_.map(h,function(a){a.isRemoved=!0}),k(!1),r.errorSpoofing.multipleRemove&&(r.errorSpoofing.multipleRemove=!1,i.splice(2,0,88888)),b.removeMultipleItems(i,e,f,null)}function e(){g()}function f(a){function b(a){return _.filter(r.items,function(b){return _.contains(a,b.id)})}var e=b(a.remaining);_.map(e,function(a){a.isRemoved=!1,a.isMarkedForRemoval=!0}),k(!0),c.create({message:d[q].errorRemovingItems,ctas:[{label:d[q].buttonTryAgain,result:"retry"}]}).then(function(a){"retry"===a&&n()}),g()}function g(){r.busyState="standby"}var h=_.filter(r.items,function(a){return a.isMarkedForRemoval===!0}),i=_.pluck(h,"id");_.size(i)>r.multiRemoveItemsMax?c.create(d[q].warningSelectedTooMany):a()}function o(a){return e.log("mode: ",a),void 0===a&&(a=!r.errorSpoofing.removeItem),_.each(r.errorSpoofing,function(b,c){r.errorSpoofing[c]=a}),a}function p(a){window.location=a}if(f.laBoxUser=f.hasOOLSession?f.laBoxUser||f.laboxOrMini:"true"===Cookies.getCookie("labox"),-1!==window.location.pathname.indexOf("cart")&&f.laBoxUser)return window.location="/tv/favorites/";if(-1!==window.location.pathname.indexOf("favorites")&&!f.laBoxUser)return window.location="/tv/cart/";var q=f.laBoxUser?"favorites":"cart",r={busyState:"standby",alertBannerErrorLoadingCartItems:{showing:!1,type:"key",message:d[q].errorLoadingItems},isTrashMode:!1,sort:{selected:"title",options:[{value:"title",label:"Name"},{value:"price",label:"Price"}]},show1:{currentPage:0,selected:20,options:[{value:20,label:"Show 20"},{value:100,label:"Show 100"}]},show2:{currentPage:0,selected:20,options:[{value:20,label:"Show 20"},{value:100,label:"Show all"}]},view:{selected:"grid",options:["list","grid"]},errorSpoofing:{removeItem:!1,multipleRemove:!1,addBack:!1,exceededMultiRemoveMaxSelection:!1},spoofMode:o,items:[],itemsMarkedForRemovalCount:0,multiRemoveItemsMaxWarn:!0,multiRemoveItemsMax:10,addItem:m,removeItem:l,toggleTrashMode:k,toggleMarkedForRemoval:j,toggleAllMarkedForRemoval:i,executeMultipleRemove:n,isLaBoxCustomer:f.laBoxUser?!0:!1,cartfav:q,cartfavcap:"favorites"===q?"Favorites":"Cart"};g(),a.$watch("cart.items | filter:{isMarkedForRemoval:true}",function(a){r.itemsMarkedForRemovalCount=_.size(a)},!0),a.search=function(){var a=_.template("/search/#/tvOnDemand/<%= encodeURIComponent(query) %>");this.query&&p(a({query:_.str.trim(this.query)}))},a.cart=window.cart=r}]),angular.module("addItBack",[]).directive("addItBack",[function(){return{restrict:"E",scope:{item:"=data"},templateUrl:"/parts/cart-favorites/part-add-it-back.html"}}]),angular.module("cartmypicks",["movieCart","l","dropdowns","escape","ctaArrowLink","drawerRow","drawerGrid","inputRadio","linksDvrCart","filters","checkbox","pagination","modal","spinner","showBusy","ctaArrowLink","sticky","stickyStack","addItBack","alertBanner","alertModal","poster"]).controller("CartMyPicksCtrl",["$scope","movieCart","alertModal","l","$log","ooluser",function(a,b,c,d,e,f){function g(){r.busyState="loading",h()}function h(){function a(a){var b=_.map(a.assets,d);_.replaceArrayItems(r.items,b),r.busyState="standby"}function c(a){e.log("ERROR LOADING CART ITEMS: ",a),r.alertBannerErrorLoadingCartItems.showing=!0,r.busyState="standby"}function d(a){function b(a,b){var c=(a-new Date)/864e5;return b>c?!0:!1}var c=a;return c.durationDisplay=getDurationDisplay(1e3*60*c.movieLength),c.dateEndsDisplay=moment(c.endDt).format("L"),c.isEndingSoon=b(new Date(c.endDt),25),c.isMarkedForRemoval=!1,c}b.getItems(a,c,!0)}function i(a){_.each(r.items,function(b){j(b,a)})}function j(a,b){a.isMarkedForRemoval=_.toggle(a.isMarkedForRemoval,b),a.isMarkedForRemoval&&r.isTrashMode===!1&&(r.isTrashMode=!0)}function k(a){r.isTrashMode=_.toggle(r.isTrashMode,a),r.isTrashMode||i(!1)}function l(a){function e(){a.isRemoved=!1,c.create(d[q].errorRemovingItem)}a.isRemoved=!0,r.errorSpoofing.removeItem?e():b.removeItem(a.id,null,e)}function m(a){function e(){a.isRemoved=!0,c.create(d[q].errorAddingItem)}a.isRemoved=!1,r.errorSpoofing.addBack?e():b.addItem(a.id,null,e)}function n(){function a(){r.busyState="removing",_.map(h,function(a){a.isRemoved=!0}),k(!1),r.errorSpoofing.multipleRemove&&(r.errorSpoofing.multipleRemove=!1,i.splice(2,0,88888)),b.removeMultipleItems(i,e,f,null)}function e(){g()}function f(a){function b(a){return _.filter(r.items,function(b){return _.contains(a,b.id)})}var e=b(a.remaining);_.map(e,function(a){a.isRemoved=!1,a.isMarkedForRemoval=!0}),k(!0),c.create({message:d[q].errorRemovingItems,ctas:[{label:d[q].buttonTryAgain,result:"retry"}]}).then(function(a){"retry"===a&&n()}),g()}function g(){r.busyState="standby"}var h=_.filter(r.items,function(a){return a.isMarkedForRemoval===!0}),i=_.pluck(h,"id");_.size(i)>r.multiRemoveItemsMax?c.create(d[q].warningSelectedTooMany):a()}function o(a){return e.log("mode: ",a),void 0===a&&(a=!r.errorSpoofing.removeItem),_.each(r.errorSpoofing,function(b,c){r.errorSpoofing[c]=a}),a}function p(a){window.location=a}if(-1!==window.location.pathname.indexOf("cart")&&f.laBoxUser)return window.location="/tv/mypicks/";if(-1!==window.location.pathname.indexOf("mypicks")&&!f.laBoxUser)return window.location="/tv/cart/";var q=f.laBoxUser?"My Picks":"cart",r={busyState:"standby",alertBannerErrorLoadingCartItems:{showing:!1,type:"key",message:d[q].errorLoadingItems},isTrashMode:!1,sort:{selected:"title",options:[{value:"title",label:"Name"},{value:"price",label:"Price"}]},show1:{currentPage:0,selected:20,options:[{value:20,label:"Show 20"},{value:100,label:"Show 100"}]},show2:{currentPage:0,selected:20,options:[{value:20,label:"Show 20"},{value:100,label:"Show all"}]},view:{selected:"grid",options:["list","grid"]},errorSpoofing:{removeItem:!1,multipleRemove:!1,addBack:!1,exceededMultiRemoveMaxSelection:!1},spoofMode:o,items:[],itemsMarkedForRemovalCount:0,multiRemoveItemsMaxWarn:!0,multiRemoveItemsMax:10,addItem:m,removeItem:l,toggleTrashMode:k,toggleMarkedForRemoval:j,toggleAllMarkedForRemoval:i,executeMultipleRemove:n,isLaBoxCustomer:f.laBoxUser?!0:!1,cartpicks:q,cartpickscap:"My Picks"===q?"My picks":"Cart"};g(),a.$watch("cart.items | filter:{isMarkedForRemoval:true}",function(a){r.itemsMarkedForRemovalCount=_.size(a)},!0),a.search=function(){var a=_.template("/search/#/tvOnDemand/<%= encodeURIComponent(query) %>");this.query&&p(a({query:_.str.trim(this.query)}))},a.cart=window.cart=r}]),angular.module("addItBack",[]).directive("addItBack",[function(){return{restrict:"E",scope:{item:"=data"},templateUrl:"/parts/cart-mypicks/part-add-it-back.html"}}]),angular.module("checkbox",[]).directive("checkbox",["$parse","$interpolate",function(a,b){return{restrict:"C",require:"?ngModel",scope:!0,replace:!0,templateUrl:"/parts/checkbox/checkbox-template.html",link:function(c,d,e,f){function g(a){e.$observe(a,function(d){_.isDefined(d)&&(h[a]=b(d)(c))})}var h={isChecked:e.hasOwnProperty("checked"),isDisabled:!1,isPartial:!1,trueValue:!0,falseValue:!1};_.each(["trueValue","falseValue"],g);var i,j=a(e.group);j.assign&&(i=j(c),_.isArray(i)||(j.assign(c,[]),i=j(c)),i.push(h));var k=[];c.$watch(a(e.groupOwner),function(a){_.isArray(a)&&(k=a)}),h.onCheck=function(){e.disabled||d.is("[disabled]")||(h.isChecked=!h.isChecked)},c.$watch("checkbox.isChecked",function(a){h.isPartial=!1,_.each(k,function(b){b.isChecked=a}),f&&f.$setViewValue(a)}),c.$watch("$parent."+e.groupOwner,function(a){if(_.isArray(a)){var b=_.unique(_.pluck(a,"isChecked"));1===b.length?(h.isChecked=_.first(b),h.isPartial=!1):h.isPartial=!0}},!0),f&&(f.$render=function(){h.isChecked=f.$modelValue===h.trueValue},f.$parsers.push(function(a){return a?h.trueValue:h.falseValue})),c.$on("$destroy",function(){f&&f.$setViewValue(void 0),_.isArray(i)&&i.splice(_.indexOf(i,h),1)}),c.checkbox=h}}}]),angular.module("clickout",[]).directive("clickout",["$parse","$rootScope",function(a,b){var c=[];return $(document).on("click",function(a){0!==c.length&&b.$apply(function(){_.each(c,function(b){$.contains(b.elm[0],a.target)||b.callback(b.scope)})})}),function(b,d,e){var f={elm:d,scope:b,callback:a(e.clickout)};c.push(f),d.on("$destroy",function(){var a=_.indexOf(c,f);-1!==a&&c.splice(a,1)}),b.$on("$destroy",function(){var a=_.indexOf(c,f);-1!==a&&c.splice(a,1)})}}]),angular.module("cmsNavigation",[]).directive("cmsNavigation",[function(){return{restrict:"EA",transclude:!0,template:"<div ng-transclude ></div>",link:function(a,b){var c=0,d=[],e=0,f=!1;setTimeout(function(){a.getMenu(),f=!0},100),$(window).resize(function(){c=0,d=[],e=0,f===!0&&a.getMenu()}),a.getMenu=function(){var a=0;if(b.width("auto"),b.find("li:visible").each(function(){c=c+parseInt($(this).width(),10)+parseInt($(this).css("padding-right"),10)+parseInt($(this).css("padding-left"),10),c>parseInt(b.width(),10)&&(0===a&&(a=c-(parseInt($(this).width(),10)+parseInt($(this).css("padding-right"),10)+parseInt($(this).css("padding-left"),10)),b.width(a+parseInt($(this).css("padding-right"),10)+"px")),d.push({title:$(this).get(0).outerHTML}))}),d.length>0){b.next(".moreItems").remove();var e="<div class='moreItems'><ul class='show-more'><li class='size dropdown-section'><div><span class='options'>More</span> <span class='downarrow'></span></div></li>";0!==d.length&&(e+="<div class='more-items' style='display:none'>",$.each(d,function(a,b){e+=b.title}),e+="</div></ul></div>",b.after(e))}angular.element(".subnav li").click(function(){$(this).parents("ul").next(".moreItems").find(".more-items").hide(),$(this).parents("ul").next(".moreItems").find(".dropdown-section").show(),$(this).parents("ul").next(".moreItems").find("ul").addClass("show-more"),$(this).parents("ul").next(".moreItems").find("ul").removeClass("list")}),angular.element(".more-items li").click(function(){$(this).parent().prev("li").is(":hidden")?($(this).parent().prev("li").show(),$(this).siblings().show(),$(this).parents("ul").addClass("list"),$(this).parents("ul").removeClass("show-more"),$(this).find("span").remove()):($(this).parent().prev("li").hide(),$(this).siblings().hide(),$(this).parents("ul").removeClass("list"),$(this).parents("ul").addClass("show-more"),$(this).find("a").after("<span class='downarrow'></span>"))}),angular.element(".dropdown-section").click(function(){$(this).parent("ul").hasClass("show-more")?($(this).next("div").css("display","block"),$(this).parent("ul").removeClass("show-more"),$(this).parent("ul").addClass("list"),$(this).parent("ul").find(".more-items").find("li").show(),$(this).next("div").find("li span").remove()):($(this).parent("ul").removeClass("list"),$(this).parent("ul").addClass("show-more"),$(this).parent("ul").find(".more-items").find("li").hide())})}}}}]),angular.module("commonFooter",["config","noSpecialchar"]).controller("CommonFooterCtrl",["$rootScope","$scope","Config",function(a,b,c){var d=this,e={INTERNET:"/internet",PAYBILL:"/pay-bill",TV:"/tv"},f="/FAQ/#/list/kw/";d.footerSearchVal="",d.fullYear=(new Date).getFullYear(),d.isESI={common:!1,internet:!1,paybill:!1,tv:!1};var g=function(){var a=window.location.pathname,b="common";a.indexOf(e.TV)>=0?b="tv":a.indexOf(e.INTERNET)>=0?b="internet":a.indexOf(e.PAYBILL)>=0&&(b="paybill"),d.isESI[b]=!0};return d.faqSearch=function(){window.location=f+d.footerSearchVal},d.init=function(){g()},d.init(),d.isEspanolLang=c.isEspanolLang,d.twitterLink=c.getValuesBySelector("link.twitterURL"),b.CommonFooterCtrl=d}]),angular.module("commonHeader",["config","oolCookie","supportService","sheet","checkbox","webdvrResource","webmailService","outageService","alertsService","phoneService","dropdowns","spinner","alertDrawer","ctaArrowLink","drawer","payBillResource","stickyStack","searchResource","ngSanitize","payBillUtils","dvrRecordingModel","ellipsis","isDeviceWidth","filters","ngCookies","onetCookies","serverUserAgentService","alertsService","userService","cookieLoggerService","ecomm","yextSearch"]).controller("CommonHeaderCtrl",["$rootScope","$scope","$timeout","Config","ooluser","Support","WebDVR","WebDVRs","Webmail","Outage","ServerUserAgent","Phone","PayBillService","AlertAPI","SearchService","PayBillUtils","Alerts","$window","recordingModel","isDeviceWidth","ServiceAppointment","$q","$cookies","Cookies","User","CookieLogger","NestService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){function B(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return decodeURIComponent(e[1])}}function C(a){if(a&&a.status&&a.status.statusCode&&a.status.statusCode.length>0&&0===parseInt(a.status.statusCode,10)){b.globalBP=a,b.dueAmount=a.amountDue,a.dueDays>=0&&(b.dueDays=a.dueDays),b.systemDate=a.systemDate,b.dueDate=a.dueDate,b.dueDate=a.dueDate,b.payment=a.defaultPmNickname,b.nextstmtdate=a.nextStatementDate,b.receivedPayDate=a.recentPayDate,b.receivedPayAmount=a.recentPayAmount,b.scheduledPayment=a.hasScheduledPayment,b.hasAutoPay=a.hasAutoPay,b.pastDue=a.pastDueAmount,b.scheduledPayAmount=a.scheduledPayAmount,b.scheduledPayDate=a.scheduledPayDate,b.scheduledPayNickname=a.scheduledPayNickname,b.numPaymentMethods=0,b.wrt=a.wrt,b.currentAccountNumber||(b.currentAccountNumber=a.accountNumber),a.csrId&&$(".csr-div").removeClass("hidden"),void 0!==b.payment&&(b.numPaymentMethods=1),parseFloat(b.dueAmount,0)>0?b.positiveBalance=!0:0===parseFloat(b.dueAmount,0)?b.zeroBalance=!0:parseFloat(b.dueAmount,0)<0&&(b.negativeBalance=!0,b.negativeBalanceValue=-b.dueAmount),b.negativeBalance&&b.wrt&&0!==b.wrt&&(b.hasWriteOff=!0),b.enrolled=b.hasAutoPay?"Y"===b.scheduledPayment?!0:!1:"Y"===b.scheduledPayment?!0:!1;var c=U.testValue(b.hasAutoPay,"Y"),d=U.testValue(b.scheduledPayment,"Y");b.autopayscheduled=!1,b.autopaynoscheduled=!1,b.noautopayscheduled=!1,b.noautopaynoscheduled=!1,c&&d?b.autopayscheduled=!0:c&&!d?b.autopaynoscheduled=!0:!c&&d?b.noautopayscheduled=!0:c||d||(b.noautopaynoscheduled=!0),b.pastDueAvailable=0!==parseFloat(b.pastDue,0)?!0:!1}else hb.mainError=!0,hb.mainErrorMsg="Server Error",b.bpGlobalError=!0}function D(){hb.mainError=!0,hb.mainErrorMsg="Server Error",b.bpGlobalError=!0}function E(a){a&&a.ebillInformationOutputs?(b.toAcctEbillInfo=p.computeToAcctEbillInfo(a),b.blockedAccount=b.toAcctEbillInfo&&(b.toAcctEbillInfo.classCodeInd||b.toAcctEbillInfo.manualBlockInd)?!0:!1):(hb.mainError=!0,hb.mainErrorMsg="Server Error")}function F(){hb.mainError=!0,hb.mainErrorMsg="Server Error"}function G(c){if(b.toAcctType=null,a.acctDetail){var d=p.getObjInArrayByValue(a.acctDetail,"active",!0),e=d.accountType;"2"===e&&(b.toAcctType="2"),"3"===e&&(b.toAcctType="1")}else b.toAcctType="0";b.clickedLink=c,m.toggleAccount(H,I,b.toAcctType)}function H(a){if(m.checkSuccess(a))switch(b.clickedLink){case"linkPayment":window.location="/pay-bill/payment-options/";break;case"linkManage":window.location="/pay-bill/manage-payments/";break;case"linkAuto":window.location="/pay-bill/automatic-payments/";break;case"linkAccount":window.location="/pay-bill/account-activity/";break;case"linkPayBill":window.location="/pay-bill/"}else G(b.clickedLink)}function I(a,c){if(a&&401===c){var d="";switch(b.refererUrl="/pay-bill",b.clickedLink){case"linkPayment":b.refererUrl=b.refererUrl+"/payment-options";break;case"linkManage":b.refererUrl=b.refererUrl+"/manage-payments";break;case"linkAuto":b.refererUrl=b.refererUrl+"/automatic-payments";break;case"linkAccount":b.refererUrl=b.refererUrl+"/account-activity";break;case"linkPayBill":b.refererUrl=b.refererUrl}d=U.currentLoggedInUser.hasSession?b.refererUrl:Y.LOGIN+"?referer="+escape(b.refererUrl),window.location=d}}function J(){b.input=!1,U.searchTerm=""}function K(){return"undefined"==typeof U.searchTerm||""===U.searchTerm||0===U.searchTerm.length?!1:!0}function L(){$("section").each(function(){"common_header"!==$(this).attr("id")&&$(this).addClass("auto_complete_display_none")})}function M(){$("section").each(function(){$(this).removeClass("auto_complete_display_none")})}function N(){/\bSilk\b/.test(navigator.userAgent)&&($("div.internet-menu").css("margin-left","-11px"),$("div.support-ddmenu").css("margin-left","-4px")),null!=navigator.vendor&&navigator.userAgent.match(/Nexus 7/)&&($("div.internet-menu").css("margin-left","-15px"),$("div.support-ddmenu").css("margin-left","-8px"))}function O(){/(signin.optimum.net|idcenter.services.optimum.net)$/.test(window.location.hostname.toLowerCase())&&window.location.replace("https://www.optimum.net"+window.location.pathname+window.location.search)}var P="",Q="";void 0!==x.getCookie("oolsub")&&(P=x.getCookie("oolsub")),window.populateLivePersonSDEs=function(){y.getoolSession().success(function(a){lpTag.sdes=lpTag.sdes||[],Q=a.oolsession?a.oolsession:"",lpTag.sdes.push({type:"ctmrinfo",info:{userName:P,socialId:Q}})},function(){console.log("error in getting user oolsession")}),lpTag.sdes.push({type:"ctmrinfo",info:{userName:P,socialId:""}})},a.chatNow=function(){console.error("Attempted use of legacy Creative Virtual!")};var R={};b.bpGlobalError=!1,$(".selectFromArrow").live("mouseover",function(){$(".selectFromArrow").removeClass("selected")});var S,T=0;document.onkeydown=function(a){var c=$(".selectFromArrow");if(b.inputFocus===!0){var d=a||window.event;switch(d.keyCode){case 38:b.inputFocus=!0,S&&S.length>0?(S.removeClass("selected"),T--,T=0>T?c.length-1:T,S=c.eq(T).addClass("selected").focus()):S=c.last().addClass("selected").focus();break;case 40:b.inputFocus=!0,S&&S.length>0?(S.removeClass("selected"),T++,T=T>c.length?0:T,S=c.eq(T).addClass("selected").focus()):S=c.eq(0).addClass("selected").focus();break;case 13:S&&S.length>0&&S.trigger("click")}}},$("#global-input").live("focusout",function(){b.inputFocus=!1}),$("#mobile-global-input").live("focus",function(){b.inputFocus=!0});var U=this,V=window.location.href;b.imageBaseURL=d.getValuesBySelector("link.cdn.images"),U.isEspanolLang=!1,a.isEspanolLang=!1,-1!==V.indexOf("espanol")&&(U.isEspanolLang=!0,a.isEspanolLang=!0),a.fnCloseMobileFlyOut=function(){a.rootShowingMobileMenu&&c(function(){$("#menubutton").trigger("click")},0)};var W,X="Sign in with your Optimum ID",Y={PROFILE:"/profile/",LOGIN:"/login/"},Z=t.desktop||t.largeDesktop||$("body.ie8").length>0,ab=$("body.ie9").length>0?!0:!1,bb=function(){return k.getServerUserAgent().then(function(a){return""===a&&(a=navigator.userAgent),null!==a.match(/msie 7/i)&&-1!==a.indexOf("Trident")})},cb=function(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],{name:"IE",version:a[1]||""}):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!=a)?{name:"Opera",version:a[1]}:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),{name:c[0],version:c[1]})},db={},eb="",fb={isOpen:!1,cookieChecked:!1};b.drawerModel=fb,b.blockedCorp=!1;var gb="/support/outage/#/UnauthenticatedUserOutage";U.gsaResult={status:{code:0,description:""},token:"",results:[]},U.veveoResult={status:{code:0,description:""},token:"",results:[]},U.googleResult={status:{code:0,description:""},token:"",results:[]},U.showDeprecatedBrowserBanner=!1,U.showIEBrowserIcon=!1,U.showDeprecatedBrowserMsg=!1,U.deprecatedBrowserName="Internet Explorer",U.showCompatModeMsg=!1,U.currentMenuSelection="",U.helloMessage={text:"",link:"#"},U.currentLoggedInUser={corpId:"",hasSession:!1,optimumId:"",inbox:{emails:[],messageCount:-1},phone:{count:0,messages:[]},hasService:{internet:!1,phone:!1,eMail:!1,tv:!1,dvr:!1,musActive:!1}},U.showingMobileMenu=!1,U.showingMobileSearchBar=!1,U.serviceStatus={outage:{init:!1},messages:{init:!1},support:{init:!1},webmail:{init:!1},ims:{hasLoaded:!1,wasSuccessful:!1,serviceAttempts:0}},U.userInput={signinForm:{remember_bool:!1,remember_string:"no",isNotValidOptimumId:!1,isNotValidPassword:!1},paybillForm:{remember_bool:!1,remember_string:"no",isNotValidOptimumId:!1,isNotValidPassword:!1}},U.loginFormAction="",U.loginFormReferer="";var hb={};b.model=hb,b.reloadOutageRoute=function(){-1!==window.location.href.indexOf("#")&&window.location.reload(),window.location.href=U.outage.link},b.currency=p.currency,U.checkBPUnAuthorized=function(){var a=!0,b=document.cookie;null!==b&&(b=unescape(b));for(var c=b.split(";"),d=0;d<c.length;d++){var e=c[d].split("="),f=e[0];f=f.replace(" ","");var g=e[1];if("oolp_"===f&&g&&""!==g&&(g=JSON.parse(g),g.p&&1===g.p.bp))return!1}return a},U.secondmodel=!1,void 0===w.s_p_a?U.softPavedAccount=!1:void 0===w.s_p_a_Checked?(x.setCookie("s_p_a_Checked","true",{path:"/"}),U.softPavedAccount=!0):U.softPavedAccount=!1,U.showSecondModel=function(){U.secondmodel=!0,U.softPavedAccount=!1},U.closeSecondModel=function(){U.secondmodel=!1,U.softPavedAccount=!1},U.goToChangePass=function(){x.setCookie("fromModal","true",{path:"/"}),window.location="/profile/change-password/?id="+U.currentLoggedInUser.optimumId};var ib=new Date;b.currentDate=ib.getMonth()+"/"+ib.getDate()+"/"+ib.getFullYear(),b.isunAuthorized=this.checkBPUnAuthorized(),b.getGlobal=function(){if(hb.mainError=!1,hb.mainErrorMsg="",!b.isunAuthorized){var a={};a.system="Portal",m.getBPGlobal(a,C,D),m.getPaymentMethods(a,E,F)}},U.testValue=function(a,b){return a?(a=$.trim(String(a).toUpperCase()),b=b.toUpperCase(),a!==b?!1:!0):!1},"true"===B("e")&&(b.enrolled=!0),B("pm")&&(b.numPaymentMethods=parseInt(B("pm"),10)),b.getGlobal(),A.getNestSecurityFlags().then(function(a){if(null!==a&&void 0!==a){var c=a.data.blockedCorps;U.ooluser.hasOOLSession&&-1!==c.indexOf(U.ooluser.corpId)&&(b.blockedCorp=!0)}},function(){}),b.getPaymentText=function(){return b.numPaymentMethods>0?null!==b.payment&&""!==b.payment?p.currency(b.dueAmount)+" now with "+p.truncateName(b.payment):p.currency(b.dueAmount)+" now":p.currency(b.dueAmount)+" now"};var jb={MILLI_TO_SECONDS:1e3,SECONDS_IN_HOUR:3600},kb=function(a){var b=!1,c=d.getValuesBySelector("cookie.expirationTimeToCheck"),e=(new Date).getTime(),f=e/jb.MILLI_TO_SECONDS,g=f-a,h=g/jb.SECONDS_IN_HOUR;return h>=c&&(b=!0),b};b.refererUrl="",U.checkingSession=function(a){var c=kb(e.t);if(!U.currentLoggedInUser.hasSession||c){switch(b.refererUrl="/pay-bill",a){case"linkPayment":b.refererUrl=b.refererUrl+"/payment-options";break;case"linkManage":b.refererUrl=b.refererUrl+"/manage-payments";break;case"linkAuto":b.refererUrl=b.refererUrl+"/automatic-payments";break;case"linkAccount":b.refererUrl=b.refererUrl+"/account-activity";break;case"linkPayBill":b.refererUrl=b.refererUrl}var d=Y.LOGIN+"?referer="+escape(b.refererUrl);window.location.href=d}else G(a)},U.outage={className:"",icon:"",message:"",status:"",link:""},U.dvrMenu={scheduledRecordings:[],nextThreeRecordings:[],alertNoScheduled:!1,alertNoService:!1},U.basePhoneMenuUrl="",U.webmailLink="",U.ooluser=e;var lb=function(){var a=U.currentLoggedInUser;e.hasOOLSession&&(a.isPrimary=e.primary,a.hasSession=!0,a.optimumId=e.optimumId,a.corpId=e.corpId||"",a.isBiz=e.p.biz&&1===e.p.biz,a.hasService={internet:e.ool,eMail:1===e.p.email?!0:!1,phone:e.ov,tv:e.io,dvr:e.p?e.p.dvr&&1===e.p.dvr?!0:!1:!1,musActive:"active"===e.p.mus?!0:!1})},mb=function(){var a=/Windows NT 6.1/.test(navigator.userAgent),b=/Windows NT 6.2/.test(navigator.userAgent),c=a||b;return c},nb=function(){return 1===window.location.pathname.indexOf("service-appointments")?"":-1===window.location.pathname.indexOf("login")?"?referer="+escape(window.location.href):""},ob=function(){var a=U.helloMessage,b=U.currentLoggedInUser,c=b.hasSession;a.text=c?"Hi "+b.optimumId:X,a.link=c?Y.PROFILE:Y.LOGIN+nb()},pb=function(a){var c=!$(a.target).closest(".global-nav-primary__item").length&&!$(a.target).closest(".global-nav-secondary__item").length;c&&b.$apply(function(){U.currentMenuSelection=""})},qb=function(){if(""!==U.currentMenuSelection&&"chatBot"!==U.currentMenuSelection){var c="";switch(U.currentMenuSelection){case"profile":c+=U.currentLoggedInUser.hasSession?Y.PROFILE:Y.LOGIN+nb();break;case"phone":c=U.basePhoneMenuUrl;break;case"smarthome-info":c+="/"+U.currentMenuSelection;break;case"tv":c+=b.blockedCorp&&!U.labox?"/pages/transition-tv.html":"/"+U.currentMenuSelection;break;default:c+="/"+U.currentMenuSelection+"/"}window.location.href=c}else"chatBot"===U.currentMenuSelection&&a.chatNow()},rb=function(a){var b=$("#"+a+"OptimumId").val(),c=$("#"+a+"Password").val();
angular.isString(b)&&(b.match(/^\s+/)||b.match(/\s+$/))&&$("#"+a+"OptimumId").val(b=b.replace(/^\s+/,"").replace(/\s+$/,"")),angular.isString(c)&&(c.match(/^\s+/)||c.match(/\s+$/))&&$("#"+a+"Password").val(c=c.replace(/^\s+/,"").replace(/\s+$/,""));var d={isValidId:!1,isValidPassword:!1,optimumId:b,password:c};return""!==d.optimumId&&(d.isValidId=!0),""!==d.password&&(d.isValidPassword=!0),d},sb=function(){var a=U.serviceStatus;a.support.init||tb(),a.outage.init||(U.currentLoggedInUser.hasSession?vb():(a.outage.init=!0,ub("User not logged in","")))},tb=function(){var a=U.currentLoggedInUser.corpId;f.getSupportNumber(a).then(function(){U.serviceStatus.support.init=!0},function(){})},ub=function(a,c){var d={ERROR:"round-circle primary","USER NOT LOGGED IN":"round-circle secondary",OUTAGE_ON_ACCOUNT:"round-circle alert",RECENTLY_CLEARED:"round-circle primary",NO_OUTAGE:"round-circle primary",OFFLINE:"round-circle primary",NON_PAY:"round-circle alert",VOD_HOLD:"round-circle primary",PLANNED_MAINTENANCE:"round-circle primary",NODE_DISTRESS:"round-circle primary"};U.outage={className:d[a.toUpperCase()],icon:j.outageIcon(a.toUpperCase()),message:j.outageCopy("menu",a.toUpperCase()),status:a,link:""===c?gb:c},"USER NOT LOGGED IN"===a.toUpperCase()&&(b.mobileOutageStatus=a,b.mobileOutageclassName=U.outage.className,b.mobileOutageIcon=U.outage.icon,b.mobileOutageMessage=U.outage.message)},vb=function(){j.getProcessedOutagePromise().then(function(c){var d=c.outageStatus?c.outageStatus.toUpperCase():"ERROR",e=a.currentOutageLink;"User not logged in"!==c.outageStatus&&null!=c.accountSummary&&("NON_PAY"===c.accountSummary.accountPaymentStatus?d="NON_PAY":c.accountSummary.serviceOutageReported&&"RECENTLY_CLEARED"!==d?d="OUTAGE_ON_ACCOUNT":"VOD_HOLD"===c.accountSummary.accountPaymentStatus?d="VOD_HOLD":c.accountSummary.plannedMaintenance&&c.accountSummary.nodeInDistress&&c.accountSummary.devicesOffline?d="PLANNED_MAINTENANCE":c.accountSummary.plannedMaintenance&&!c.accountSummary.nodeInDistress&&c.accountSummary.devicesOffline?d="PLANNED_MAINTENANCE":!c.accountSummary.plannedMaintenance&&c.accountSummary.nodeInDistress&&c.accountSummary.devicesOffline?d="OFFLINE":c.accountSummary.plannedMaintenance||c.accountSummary.nodeInDistress||!c.accountSummary.devicesOffline?c.accountSummary.plannedMaintenance&&c.accountSummary.nodeInDistress&&!c.accountSummary.devicesOffline?d="PLANNED_MAINTENANCE":c.accountSummary.plannedMaintenance||!c.accountSummary.nodeInDistress||c.accountSummary.devicesOffline?c.accountSummary.nodeInDistress||c.accountSummary.devicesOffline||!c.accountSummary.plannedMaintenance||(d="PLANNED_MAINTENANCE"):d="NODE_DISTRESS":d="OFFLINE"),ub(d,e),b.mobileOutageStatus=d,b.mobileOutageclassName=U.outage.className,b.mobileOutageIcon=U.outage.icon,b.mobileOutageMessage=U.outage.message},function(){})},wb=function(){U.currentLoggedInUser.hasService.dvr&&!U.dvrMenu.scheduledRecordings.length&&xb()},xb=function(){var a=4;U.loadingScheduledRecordings=!0,g.queryMultipleDVRs(a,function(b){U.dvrMenu.scheduledRecordings=b,0===b.length?(U.loadingScheduledRecordings=!1,U.dvrMenu.alertNoScheduled=!0):(b=_.sortBy(b,function(a){return a.Program.StartTime.valueOf()}),yb(b,a))},function(){U.dvrMenu.alertNoService=!0})},yb=function(a,b){for(var c,d,e,f=b?b:4,g=[],h=0;f>h&&h<a.length;h++){var i=!1;d=moment(a[h].Program.StartTime),d=d.format("YYYY-MM-DD[T]HH:mm"),e=moment(a[h].Program.EndTime),e=e.format("YYYY-MM-DD[T]HH:mm"),"HD"===a[h].HDTV&&(i=!0),c={thumb:a[h].thumbUrl,href:"/tv/asset/#/tvprograms/record/"+d+"/"+e+"/"+a[h].Program.callsign+"/"+i,title:a[h].Title},g.push(c)}U.loadingScheduledRecordings=!1,g.length<=f?U.dvrMenu.nextThreeRecordings=g:U.dvrMenu.alertNoScheduled=!0},zb=function(){U.currentLoggedInUser.hasService.phone&&(U.serviceStatus.messages.init||Ab())},Ab=function(){l.getVoicemailCounter().then(function(a){a.data&&200===a.status&&(U.serviceStatus.messages.init=!0,Bb(a.data))},function(){})},Bb=function(a){var b=U.currentLoggedInUser.phone;b.count=a.count||0},Cb=function(){var b=U.serviceStatus.webmail;b.init||(e.hasOOLSession&&e.p&&null!==e.p.mus?"active"===e.p.mus?(Db(),setInterval(Db,db.timer.webmail)):"hold"===e.p.mus?a.$emit("webmailDetailsResponse",{wasSuccessful:!1,holdEntitlement:!0}):a.$emit("webmailDetailsResponse",{wasSuccessful:!1,noEntitlement:!0}):a.$emit("webmailDetailsResponse",{wasSuccessful:!1,noEntitlement:!0}))},Db=function(){U.serviceStatus.webmail,i.getEmailMetaData()};U.isActiveMenu=function(a){return U.currentMenuSelection===a},U.handleMenuBlur=function(){Z&&(U.currentMenuSelection="")},U.handleMenuFocus=function(a){Z&&(U.currentMenuSelection=a)},U.handleMenuSelect=function(a){U.currentMenuSelection===a?qb():U.currentMenuSelection=a},U.closeDeprecatedBrowserBanner=function(){var a=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1"),b=(new Date).getTime();U.showDeprecatedBrowserBanner=!1,document.cookie=escape("browserDepCheck")+"="+escape(b)+";path=/;domain="+a},U.toggleMobileMenuDisplay=function(){U.showingMobileMenu=!U.showingMobileMenu,a.rootShowingMobileMenu=U.showingMobileMenu;var c=U.currentLoggedInUser,d=c.hasService,e={showingMobileMenu:U.showingMobileMenu,hasSession:c.hasSession,optimumId:c.optimumId,helloMessage:U.helloMessage,mobileOutageStatus:b.mobileOutageStatus,mobileOutageclassName:b.mobileOutageclassName,mobileOutageIcon:b.mobileOutageIcon,mobileOutageMessage:b.mobileOutageMessage,hasService:{tv:d.tv,internet:d.internet,eMail:d.musActive,phone:d.phone},badge:{tv:d.tv?!0:!1,internet:d.musActive?c.inbox.messageCount:-1,phone:d.phone?c.phone.count:!1,support:U.currentAlertIndex},link:{phone:U.basePhoneMenuUrl,webmail:U.webmailLink,signout:eb,outage:c.hasSession?a.currentOutageLink:gb}};a.$emit("mobileMenuDisplayToggle",e)},U.toggleMobileSearchBarDisplay=function(){$("#search_auto_phone").removeClass("hidden"),U.showingMobileSearchBar=!U.showingMobileSearchBar,U.showingMobileSearchBar?($("#mobile-global-input").focus(),$("#phone_header").addClass("auto_complete_display_none"),"undefined"!=typeof U.searchTerm&&U.searchTerm.length>0&&L(),$("#phone-search").removeClass("auto_complete_display_none")):(b.inputFocus=!1,$("#phone_header").removeClass("auto_complete_display_none"),$("#phone-search").addClass("auto_complete_display_none"),M())},U.toggleUserInputRemember=function(a){U.userInput[a].remember_bool=!U.userInput[a].remember_bool,U.userInput[a].remember_string=U.userInput[a].remember_bool?"yes":"no"},U.handleUserSignout=function(){var a=eb+nb();document.cookie="createOptimumIdMenuShow=;Expires=Thu, 01 Jan 1970 00:00:01 GMT;",window.location=a},U.handleUserLogin=function(a){var b=rb(a);if(b.isValidId&&b.isValidPassword)$("#"+a).attr("action",U.loginFormAction),$("#"+a).submit();else{var c=U.userInput[a];b.isValidId?b.isValidPassword||(c.isNotValidOptimumId=!1,c.isNotValidPassword=!0):(c.isNotValidOptimumId=!0,c.isNotValidPassword=!1)}},U.showSearchDropDown=!1,U.googleSuggestionFailed=!1,U.gsaSuggestionFailed=!1,U.veveoSuggestionFailed=!1,U.loadingGoogle=!0,U.loadingGsa=!0,U.loadingVeveo=!0,U.supportNavReqd=!1,U.loading="Data Loading",U.truncateText=function(a,b){if(""===a)return a;var c=/<b>/g,d=/<\/b>/g,e=(a.match(c)||[]).length;if(a&&a.length>b+7*e){var f=a.substring(0,b+7*e);return(f.match(c)||[]).length!==(f.match(d)||[]).length&&(f+="</b>"),f+"..."}return a},U.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/",faqSearch:"/FAQ#/list/kw/"},U.searchThis=function(a,b){if(window.location=b===U.searchCategory.support?b+a+"/true":b+a,reporting&&"/search/"===window.location.pathname){var c=decodeURI(a);reporting.srchterm(c)}J()},U.goToSearch=function(a){K()&&(a===U.searchCategory.support?U.supportNavReqd?(window.location=a+U.searchTerm+"/true",U.supportNavReqd=!1):window.location=a+U.searchTerm+"/false":window.location=a+U.searchTerm,reporting&&"/search/"===window.location.pathname&&reporting.srchterm(U.searchTerm),J())},U.phoneGoToSearch=function(a){K()&&(U.goToSearch(a),U.toggleMobileSearchBarDisplay())},U.phoneSearchThis=function(a,b){U.toggleMobileSearchBarDisplay(),U.searchThis(a,b)},U.init=function(){db=d.getValuesBySelector("*"),O(),lb(),U.labox=U.ooluser.hasOOLSession?U.ooluser.laBoxUser||U.ooluser.laboxOrMini:"true"===x.getCookie("labox"),U.pickerSelected=null!=x.getCookie("labox")?!0:!1,U.stream=e.hasOOLSession?e.internet&&e.internet.stream:"stream"===x.getCookie("eqType"),z.checkSanity();var a=function(){return bb().then(function(a){if(a)return U.showCompatModeMsg=a,!0;U.showDeprecatedBrowserMsg=!0;var b=db.deprecatedBrowserCheckTime,c=w.browserDepCheck,d=$("body.ie8").length?!0:!1,e=$("body.ie9").length>0?!0:!1,f=/MSIE 10/i.test(navigator.userAgent),g=cb(),h="firefox"===g.name.toLowerCase()&&parseInt(g.version,10)<=46;h&&(U.deprecatedBrowserName="Firefox");var i=!1;if(c){c=parseInt(c,10);var j=c+b,k=(new Date).getTime();k>j&&(i=!0)}else i=!0;return(e||d||f||h)&&i})};a().then(function(a){U.showDeprecatedBrowserBanner=a}),U.showIEBrowserIcon=mb(),N(),ob();var c=U.serviceStatus;c.outage.init||(U.currentLoggedInUser.hasSession?vb():(c.outage.init=!0,ub("User not logged in",""))),zb(),Cb(),eb=db.link.processSignout,U.basePhoneMenuUrl=db.link.basePhoneMenuUrl,U.loginFormAction=db.link.processLogin,U.loginFormReferer=window.location.href,U.webmailLink=db.link.webmail,U.managedRouterLink=db.link.managedRouterSettings,U.searchTerm="",b.inputFocus=!1},a.$on("refreshEmailCookies",function(){i.refreshEmailCookies()}),a.$on("webmailDetailsResponse",function(a,b){U.currentLoggedInUser.inbox.emails=b.webmail||[],U.currentLoggedInUser.inbox.messageCount=b.messageCount||0,U.currentLoggedInUser.inbox.dateFormat=angular.isObject(b)?b.dateFormat:""}),b.$watch("CommonHeaderCtrl.searchTerm",function(){""===U.searchTerm&&(U.showSearchDropDown=!1),"undefined"!=typeof U.searchTerm&&U.showingMobileSearchBar&&(0===U.searchTerm.length?M():L())}),b.$watch("CommonHeaderCtrl.currentMenuSelection",function(a,b){if(a&&a!==b&&a!==W){switch(W=a,a){case"tv":wb();break;case"phone":zb();break;case"internet":Cb();break;case"profile":break;case"paybill":break;case"support":sb();break;case"":U.showSearchDropDown=!1;break;case"search":return;case"chatBot":}U.showSearchDropDown=!1}});var Eb=function(){if(ab){var a={signin:$("div.signin-profile"),paybill:$("div.paybill-menu"),support:$("div.support-ddmenu")},b=fb.isOpen?144:35;for(var c in a)a[c].css("top",b+"px")}if(fb.isOpen&&_.isNull(x.getCookie("alertEventLogged"))){Fb();var d=function(a,b){var c=new Date;c.setTime(c.getTime()+1e3*a),x.setCookie(b,"true",{expires:c.toGMTString(),path:"/"})};d(1800,"alertEventLogged")}};b.$watch(function(){return n.type},function(){U.currentAlert=n.type}),b.$watch(function(){return n.index},function(){U.currentAlertIndex=n.index;var b="false"===x.getCookie("alrtDrwr")?!1:!0,c=U.currentAlertIndex?!0:!1;"/support/outage/#/PendingVOD"===a.currentOutageLink&&(c=!1),!c||b||fb.cookieChecked||(c=!1,fb.cookieChecked=!0),fb.isOpen=c,Eb()}),U.toggleAlertDrawer=function(){fb.isOpen=!fb.isOpen;var a=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1");document.cookie="alrtDrwr="+fb.isOpen+";path=/;domain="+a+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT"),Eb()},U.init(),U.switchStyles=function(){return U.showingMobileSearchBar&&0===U.searchTerm.length?"dim_background":U.showingMobileSearchBar&&U.searchTerm.length>0&&b.inputFocus?"auto_complete_display_block":"auto_complete_display_none"},$(window).resize(function(){$(window).width()>=978&&U.showingMobileSearchBar&&U.toggleMobileSearchBarDisplay()}),$("#mobile-global-input").keypress(function(a){13===a.which&&U.phoneGoToSearch(U.searchCategory.faqSearch)}),$("#global-input").keypress(function(a){13===a.which&&U.goToSearch(U.searchCategory.faqSearch)}),$(document).ready(function(){$("#site-wrapper").on("touchstart",pb),jQuery(function(){Modernizr.input.placeholder||($(this).find("#global-input[placeholder]").each(function(){""===$(this).val()&&$(this).val($(this).attr("placeholder"))}),$("#global-input[placeholder]").focus(function(){$(this).val()===$(this).attr("placeholder")&&($(this).val(""),$(this).addClass("placeholder-text"))}).blur(function(){(""===$(this).val()||$(this).val()===$(this).attr("placeholder"))&&($(this).val($(this).attr("placeholder")),$(this).addClass("placeholder-text"))}),$("#global-input[placeholder]").closest("form").submit(function(){$(this).find("[placeholder]").each(function(){$(this).val()===$(this).attr("placeholder")&&$(this).val("")})}))})}),b.seleniumMarker="CommonHeaderCtrl in common-header.js loaded!";var Fb=function(){var a="";q.getCombinedAlerts().then(function(b){angular.forEach(b.alerts,function(b){a+="outage"===b.source?"System Outage Alert":b.primaryMessage}),reporting.setAttrs({eVar24:a}),reporting.sendAttrs(!0)})},Gb=function(){U.serviceStatus.ims.hasLoaded=!1,R.getOptimumIds().then(function(b){if(e.primary){var c=new Date;c.setTime(c.getTime()+6e5);var d=c.toGMTString();0===b.data.allowedRemaining||"0"===b.data.allowedRemaining?x.setCookie("createOptimumIdMenuShow","false",{expires:d,path:"/"}):x.setCookie("createOptimumIdMenuShow","true",{expires:d,path:"/"})}var f=!1;b.data&&b.data.ids&&b.data.ids.forEach(function(a){a.id===optimumId&&(f=a.emailEnabled)}),U.serviceStatus.ims.hasLoaded=!0,U.serviceStatus.ims.wasSuccessful=!0,U.currentLoggedInUser.hasService.imsEmail=f,a.$emit("optimumEmailOptInResponse",{imsEmailResponse:{emailEnabled:f,wasSuccessful:!0}})},function(){U.serviceStatus.ims.hasLoaded=!0,U.serviceStatus.ims.wasSuccessful=!1,a.$emit("optimumEmailOptInResponse",{imsEmailResponse:{wasSuccessful:!1}})})},Hb=function(){U.serviceStatus.ims.hasLoaded=!1,R.getIMS(optimumId).then(function(b){U.serviceStatus.ims.hasLoaded=!0,U.serviceStatus.ims.wasSuccessful=!0,U.currentLoggedInUser.hasService.imsEmail=b.data.optedInOptimumEmail,a.$emit("optimumEmailOptInResponse",{imsEmailResponse:{emailEnabled:b.data.optedInOptimumEmail,wasSuccessful:!0}})},function(){U.serviceStatus.ims.hasLoaded=!0,U.serviceStatus.ims.wasSuccessful=!1,a.$emit("optimumEmailOptInResponse",{imsEmailResponse:{wasSuccessful:!1}})})},Ib=function(){if(e.hasOOLSession){R=new y,optimumId=e.optimumId;var a=window.location.pathname;"/home/"===a||"/home"===a||"/"===a?e.primary?Gb():Hb():e.primary&&_.isNull(x.getCookie("createOptimumIdMenuShow"))&&Gb()}};return Ib(),b.getMaxHousholdIdReached=function(){var a=x.getCookie("createOptimumIdMenuShow");return null===x.getCookie("createOptimumIdMenuShow")?a=!1:showMenushowMenu=x.getCookie("createOptimumIdMenuShow"),a},b.CommonHeaderCtrl=U}]),angular.module("ctaArrowLink",["dots"]).directive("ctaArrowLink",[function(){return{restrict:"A",scope:!0,transclude:!0,replace:!0,templateUrl:"/parts/cta-link/cta-link-template.html",compile:function(a,b){var c=a.find("a"),d=["ngHref","href","target","type","rel","ping","media","hreflang","download"];return _.each(b,function(a,b){_.contains(d,b)&&("nghref"===b.toLowerCase()&&(b="ng-href"),c.attr(b,a))}),function(a,b,c){a.iconClass="icon-arrow-right",_.isDefined(c.icon)&&a.$watch(c.icon,function(b){a.iconClass=b})}}}}]),angular.module("displayLoading",["spinner"]).directive("displayLoading",[function(){return{transclude:!0,template:'<div>  <div spinner ng-show="displayLoading" class="vpadding-m block-align-center" data-length="1" data-radius="10"></div>  <div ng-transclude ng-hide="displayLoading"></div></div>',scope:{displayLoading:"="}}}]),angular.module("doc",["escape","filters","dots","dropdownDoc","ngSanitize"]).directive("doc",["$controller","$compile",function(a,b){return{restrict:"EA",scope:!0,terminal:!0,controller:["$attrs","$filter","$scope",function(a,b,c){function d(a){var b={directive:"icon-pencil",filter:"icon-filter",service:"icon-cog",css:"icon-eye-open"};if(!_.contains(_.keys(b),a))throw a+" is not a valid type; must be one of: "+_.keys(b).join(", ");return b[a]}this.title=a.title||"Part",this.slug=b("slugify")(a.title),this.sections=[],this.addDemo=function(a){this.sections.push(this.processTitle(a))},this.processTitle=function(a){var b=this.sections.length;return a||"Demo"+(2>b?"":b)},this.types=_((a.types||a.type||"directive").split(",")).map(function(a){return _.str.trim(a)}).invoke("toLowerCase").unique().map(function(a){return{name:a,cssClass:d(a)}}).valueOf(),c.DocCtrl=this,c.docTitle=this.title,c.docSlug=this.slug,c.types=this.types}],link:function(c,d,e){function f(b,c){var d,f=e.controller||_.str.classify(e.title)+"DocCtrl";try{d=a(f,{$scope:c})}catch(g){if(e.controller)throw g}return d?$(b).find(".doc__body").data("$ngControllerController",d).end():b}var g='<div id="{{docSlug}}" class="container doc-container"><header class="doc__header hflow grid-gutters-margin align-children-middle"><a class="inline-block doc-title doc__title inherited" href="#{{docSlug}}" ng-bind-html="docTitle"></a><div ng-repeat="type in types" title="{{type.name}}" class="doc__type-icon dot" ng-class="\'doc__type-\'+type.name+\'-icon\'"><i ng-class="type.cssClass"></i></div></header><div class="doc__body">'+d.html()+"</div>"+"</div>",h=c.$new();d.html(b(f(g,h))(h))}}}]).directive("docDemo",["$filter",function(a){return{restrict:"EA",transclude:!0,replace:!0,scope:!0,template:'<section id="{{docSlug}}" class="doc__demo"><a class="inline-block doc-title doc__demo__title" href="#{{docSlug}}" ng-bind-html="demoTitle"></a><div class="doc__demo__body" ng-transclude></div></section>',link:function(b,c,d){var e=b.DocCtrl;e.addDemo(d.title),b.demoTitle=e.processTitle(d.title),b.docSlug=a("slugify")(e.title+"-"+b.demoTitle)}}}]),angular.module("dotsDoc",["doc","dots"]).controller("DotsDocCtrl",["$scope",function(){}]),angular.module("dots",[]).directive("dot",function(){return{restrict:"C",transclude:!0,template:'<span class="dot-inner" ng-transclude></span>'}}),angular.module("drawerGrid",["drawerRow"]).directive("drawerGrid",[function(){return{restrict:"EA",transclude:!0,scope:!0,templateUrl:"/parts/drawer-grid/drawer-grid-template.html",link:function(a,b,c){a.customRowItem=a.$eval(c.templateRowItem),a.customDrawer=a.$eval(c.templateDrawer),a.currentRow=null,a.data=[],a.isCurrentRow=function(b){return _.isEqual(b,a.currentRow)},a.setCurrentRow=function(b){a.currentRow=b},a.$watch(c.data,function(b){a.data=b},!0)}}}]),angular.module("drawerRow",["drawer","filters","panel"]).directive("drawerRow",["$rootScope","$parse",function(a,b){return{restrict:"EA",transclude:"element",templateUrl:"/parts/drawer-row/drawer-row-template.html",replace:!0,scope:!0,compile:function(){return function(a,c,d){function e(){var a=c.find(".drawer-row__item").eq(_.indexOf(f.items,f.currentItem)),b=c.find(".drawer-row__drawer__tip");if(a.length){var d=a.position(),e=a.width(),g=d.left+e/2-b.outerWidth()/2;b.css({left:g})}}var f={items:[1,2,3,4,5],currentItem:null,currentItemSelected:null,columnSize:"auto",getColumnSize:function(){return"auto"===f.columnSize?12/Math.floor(f.items.length):f.columnSize}};a.drawerRowID=_.uniqueId("drawerRowID_"),d.columnSize&&(f.columnSize=a.$eval(d.columnSize)),d.data&&a.$watch(d.data,function(a){f.items=a},!0),_.isDefined(d.open)&&a.$watch(d.open,function(a){a||(f.currentItemSelected=null)}),a.isCurrentItem=function(a){return a===f.currentItemSelected},a.toggleItem=function(b,c){c=_.firstDefined(c,!a.isCurrentItem(b)),c===!0?a.setCurrentItem(b):c===!1&&(f.currentItemSelected=null)},a.toggleCurrentItem=function(b){a.toggleItem(f.currentItemSelected,b)},a.setCurrentItem=function(c){return a.isCurrentItem(c)?!1:(f.currentItem=c,f.currentItemSelected=c,d.onItemSelect&&b(d.onItemSelect)(a,{$event:{itemSelected:c}}),e(),void 0)},a.isDrawerOpen=function(){return f.currentItemSelected},a.templateForRowItem=(a.$eval(d.templateRowItem)||"default-drawer-row-row-item")+".html",a.templateForDrawer=(a.$eval(d.templateDrawer)||"default-drawer-row-drawer")+".html",a.drawerRowModel=f,window.drawerRowModel=f,$(window).on("resize",e)}}}}]),angular.module("drawer",[]).directive("drawer",[function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"/parts/drawer/drawer-template.html",scope:!0,link:function(a,b,c){function d(a){a&&b.addClass("js-suppress-animation");var d={marginTop:null},e={height:null};f.direction=c.direction,"up"===c.direction?e.height=f.isOpen?g.outerHeight():0:d.marginTop=f.isOpen?0:-1*g.outerHeight(),g.outerHeight()>0&&(g.css(d),b.css(e)),_.nextCycle(function(){a&&b.removeClass("js-suppress-animation")})}function e(){g.is(":visible")&&d(!0)}var f={isOpen:!1,direction:"down",animate:!0},g=b.children();_.has(c,"open")&&a.$watch(c.open,function(a){f.isOpen=Boolean(a),d()}),_.has(c,"closed")&&a.$watch(c.closed,function(a){f.isOpen=!Boolean(a),d()}),d(!0),g.on("resize",e),a._drawerModel=f}}}]),angular.module("dropdownsdate",["clickout","ngSanitize","toggle","sheetdate","if","isViewportSize"]).directive("dropdowndate",["$compile","$parse","$rootScope","isViewportSize",function(a,b,c,e){function f(a,b){return a.selectFirstFound(_.arrayify(b)).outerHtml()}function g(a,b,c){a.find(c).attr("ng-bind-html",null).attr("ng-bind",null).html(b)}var h=[{sourceSelector:"[handle-template]",destSelector:".dropdown__selected"},{sourceSelector:"[option-template]",destSelector:".dropdown__option"},{sourceSelector:["[option-phone-template]","[option-template]"],destSelector:".dropdown-sheet__option"}];return{restrict:"EA",require:["toggle","?ngModel"],transclude:"element",scope:{isDateValid:"=isDateValid",startDate:"=startdate",endDate:"=enddate",selectedDate:"=date",errorClass:"@errorClass"},replace:{model:"=ngModel"},templateUrl:"/parts/dropdown-date/dropdown-date-template.html",compile:function(a,i,j){return j(c,function(b){b.hasContent()&&_.each(h,function(c){g(a,f(b,c.sourceSelector),c.destSelector)})}),function(a,f,g,h){function i(a,b,c){var d=new Date(a,b-1,c),e=""+d.getFullYear()+(d.getMonth()+1)+d.getDate(),f=""+a+b+c;return f===e&&d>q&&r>d}function j(a){a&&(t.currentOption=a)}if(!$.fn.bootstrapDP&&$.fn.datepicker){var k=_.cloneDeep($.fn.datepicker);$.fn.bootstrapDP=k}var l=f.find(".dateInputTxt"),n=f.find(".ddPicker"),o=h[0];h[1];var p,q=null,r=null,s=function(a){if(a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null};a.$watch("startDate",function(a){t.setStartDate(a)}),a.$watch("endDate",function(a){t.setEndDate(a)}),e.phone||(p=n.bootstrapDP(),q&&p.bootstrapDP("setStartDate",q),r&&p.bootstrapDP("setEndDate",r),p.hide(),p.on("changeDate",function(b){a.dropdown.updateDate(b.format)}));var t={currentOption:"",inSheet:f.closest(".sheetdate").length>0,updateDate:function(b){return"invalid"===b?(a.$apply(function(){a.isDateValid=!1}),void 0):(n.removeClass(a.errorClass),l.removeClass(a.errorClass),t.currentOption=b,t.displayText=b,this.applyDate(b),void 0)},applyDate:function(b){a.selectedDate=b,a.isDateValid=!0},setStartDate:function(a){var b=s(a);b&&(q=b),p&&p.bootstrapDP("setStartDate",q)},setEndDate:function(a){var b=s(a);b&&(r=b),p&&p.bootstrapDP("setEndDate",r)},selectOptionByIndex:function(a){j(t.options[a])},selectOptionByValue:function(a){j(_.find(t.options,{value:a}))},options:[],loadOptions:function(){},clearOptions:function(){t.options=[]},appendOption:function(){},prependOption:function(){},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},addPlaceholderAttribute:function(){g.placeholder&&t.prependOption(g.placeholder,"")},toggle:function(b){if(o.toggle(b),p)if(o.isToggle()){if(3===t.currentOption.split("/").length&&a.isDateValid){var c=t.currentOption.replace("///g","-"),d=c;p.data({date:d}).bootstrapDP("update").children("input").val(d)}p.show()}else p.hide()},isOpen:!1,isDisabled:!1};_.has(g,"disabled")&&a.$watch(b(g.disabled),function(a){t.isDisabled=Boolean(a)}),t.addPlaceholderAttribute(),c.$broadcast("initialised"),a.$watch("selectedDate",function(a){a&&t.currentOption!==a&&t.updateDate(a)}),l.live("focus",function(){isMobile()||t.toggle()}),l.live("input",function(){if(this.value=this.value.replace(/[^0-9/ ]/g,""),3===this.value.split("/").length)if(m=parseInt(this.value.split("/")[0],10),d=parseInt(this.value.split("/")[1],10),y=parseInt(this.value.split("/")[2],10),$(this).removeClass(a.errorClass),i(y,m,d)){t.updateDate(this.value);var b=this.value.replace("///g","-"),c=b;p.data({date:c}).bootstrapDP("update").children("input").val(c)}else a.dateValid=!1,$(this).addClass(a.errorClass),t.updateDate("invalid");else a.dateValid=!1,$(this).addClass(a.errorClass),t.updateDate("invalid")}),a.dropdown=t}}}}]),angular.module("dropdownDvr",["dropdowns","webdvrResource","errorHandler","config"]).controller("dropdownDvr",["$rootScope","WebDVR","WebDVRs","Config",function(a,b,c,d){a.dvrs=c;var e=_.partialRight(_.map,function(a){return a.deviceimg&&(a.deviceimgsrc=d.getValuesBySelector("link.cdn.images")+"/devices/"+a.deviceimg+"_large.png"),"Multi-Room DVR"===a.boxAlias&&(a.boxAlias="DVR"),{value:a.boxSerialNumber,label:a}}),f={box:{},boxSerial:"",boxOptions:e(a.dvrs),loading:!0,loadUsersDvr:function(){var b=_.find(c,{boxSerialNumber:f.boxSerial});b&&f.box.boxSerialNumber!==b.boxSerialNumber&&(f.box=b,a.$broadcast("dropdownDvr.change",f))}};a.$watch("dvrs",function(a){_.isEmpty(a)||(f.loading=!1,f.boxes=a,f.boxOptions=e(a),f.loadUsersDvr())},!0),_.isEmpty(c)&&b.query(angular.noop,function(){dvr.isLoadingRecordings=!1}),a.dvrdrop=a.dvrdrop||f}]),angular.module("dropdowninternet",["dropdowns","webdvrResource","errorHandler","config"]).directive("dropdownInternet",["$compile","$parse","$rootScope","transcludeTemplates",function(a,b,c,d){return{restrict:"EA",require:["toggle","?ngModel"],scope:!0,transclude:"element",replace:!0,templateUrl:"/parts/dropdown-internet/dropdown-internet-template.html",compile:function(a,e,f){return f(c,function(b){d(a,b),b.hasContent()&&a.find(".text-truncate").removeClass("text-truncate").children().addClass("text-truncate")}),function(a,c,d,e){function f(){var b;a.$watch(function(){angular.equals(b,i.$viewValue)||(b=angular.copy(i.$viewValue),i.$render())})}function g(a){var b,c,d;if(k.isMultiple){if(0===k.options.length)return;angular.isArray(a)?(b=a,j=_.map(b,function(a){return _.find(k.options,{value:a})})):null===a.value||angular.isString(a.value)&&""===a.value?j=[]:-1!==(c=_.findIndex(j,a))?j.splice(c,1):j.push(a),1===j.length?k.currentOption=j[0]:j.length>1?(k.currentOption={label:j.length+" selected"},j=_.sortBy(j,function(a){return _.indexOf(k.options,_.find(k.options,a))})):k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value}),k.isAlwaysPlaceholder&&(k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value})),0===j.length&&angular.isArray(b)?b.length=0:b=_.map(j,function(a){return a.value}),i&&(angular.isArray(i.$viewValue)?(d=i.$viewValue,d.length=0,_.each(b,function(a){d.push(a)}),i.$setViewValue(d)):i.$setViewValue(b))}else a&&(k.currentOption=k.isAlwaysPlaceholder?_.find(k.options,function(a){return null===a.value||""===a.value}):a,j=[a],i&&i.$setViewValue(a.value))}var h=e[0],i=e[1],j=[],k={currentOption:null,inSheetAccordion:c.closest(".sheet").length>0&&c.is(".dropdown--accordion"),selectOptionByIndex:function(a){g(k.options[a])},selectOptionByValue:function(a){k.isMultiple&&_.isArray(a)?g(a):g(_.find(k.options,{value:a}))},options:[],loadOptions:function(a){k.clearOptions(),_.each(a,k.appendOption),k.addPlaceholderAttribute(),i&&i.$modelValue?k.selectOptionByValue(i.$modelValue):k.selectOptionByIndex(0)},clearOptions:function(){k.options=[]},appendOption:function(){k.options.push(k.formatOption.apply(null,arguments))},prependOption:function(){k.options.unshift(k.formatOption.apply(null,arguments))},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},isSelected:function(a){return _.contains(j,a)},valueIsEmpty:function(a){return null===typeof a.value||""==typeof a.value},addPlaceholderAttribute:function(){d.placeholder&&k.prependOption(d.placeholder,"")},maybeToggle:function(){k.isMultiple||k.isAccordion||k.toggle()},toggle:function(a){k.options&&k.options.length>1&&h.toggle(a)},isPagination:!1,isOpen:!1,isDisabled:!1,isAlwaysPlaceholder:!1,isMultiple:!1,isAccordion:c.is(".dropdown--accordion")};_.has(d,"alwaysPlaceholder")&&a.$watch(b(d.alwaysPlaceholder),function(a){k.isAlwaysPlaceholder=Boolean(a)}),_.has(d,"multiple")&&a.$watch(b(d.multiple),function(a){k.isMultiple=Boolean(a),k.isMultiple&&f(),c.toggleClass("dropdown--multiple",k.isMultiple)}),_.has(d,"disabled")&&a.$watch(b(d.disabled),function(a){k.isDisabled=Boolean(a)}),_.has(d,"pagination")&&(k.isPagination=!0),a.$watch(d.toggle,function(){$(document).ready(function(){$(".js-add-ddfix .sheet__body").height=$(window).height()})}),k.addPlaceholderAttribute(),k.selectOptionByIndex(0),_.has(d,"options")&&a.$watch(d.options,function(a){a?k.loadOptions(a):k.clearOptions()},!0),i&&(i.$render=function(){k.selectOptionByValue(i.$modelValue)}),a.dropdown=k}}}}]).directive("textTruncateJs",[function(){return{restrict:"C",link:function(a,b){function c(){b.hide(),_.nextCycle(function(){b.css({width:b.parent().width()}),b.show()})}_.nextCycle(c),a.$watch(function(){return b.width()},function(){c()});var d=!1;setInterval(function(){var a=b.is(":visible");a&&a!==d&&(c(),d=!0)},150)}}}]);var sheetHeight=$(".js-add-ddfix .sheet__body").height()+$(".js-add-ddfix .sheet__head").height(),windowHeight=$(window).height();$(".dropdown").click(function(){$(".js-add-ddfix").height=windowHeight}),angular.module("dropdowns",["clickout","ngSanitize","toggle","sheet","if","isViewportSize","transcludeTemplates"]).directive("dropdownSimple",["$compile","$parse","$rootScope","transcludeTemplates",function(a,b,c,d){return{restrict:"EA",require:["toggle","?ngModel"],scope:!0,transclude:"element",replace:!0,templateUrl:"/parts/dropdown-simple/dropdown-simple-template.html",compile:function(a,e,f){return f(c,function(b){d(a,b),b.hasContent()&&a.find(".text-truncate").removeClass("text-truncate").children().addClass("text-truncate")}),function(a,d,e,f){function g(){var b;a.$watch(function(){angular.equals(b,j.$viewValue)||(b=angular.copy(j.$viewValue),j.$render())})}function h(a){var b,d,e;if(l.isMultiple){if(0===l.options.length)return;angular.isArray(a)?(b=a,k=_.map(b,function(a){return _.find(l.options,{value:a})})):null===a.value||angular.isString(a.value)&&""===a.value?k=[]:-1!==(d=_.findIndex(k,a))?k.splice(d,1):k.push(a),1===k.length?l.currentOption=k[0]:k.length>1?(l.currentOption={label:k.length+" selected"},k=_.sortBy(k,function(a){return _.indexOf(l.options,_.find(l.options,a))})):l.currentOption=_.find(l.options,function(a){return null===a.value||""===a.value}),l.isAlwaysPlaceholder&&(l.currentOption=_.find(l.options,function(a){return null===a.value||""===a.value})),0===k.length&&angular.isArray(b)?b.length=0:b=_.map(k,function(a){return a.value}),j&&(angular.isArray(j.$viewValue)?(e=j.$viewValue,e.length=0,_.each(b,function(a){e.push(a)}),j.$setViewValue(e)):j.$setViewValue(b))}else a&&(l.isAlwaysPlaceholder?l.currentOption=_.find(l.options,function(a){return null===a.value||""===a.value}):(l.currentOption=a,l.mobileDatePickerTimes&&(c.fallDST=a.fallDST,11===c.timeIndexLimit&&(l.disableOptionMobileDatePicker=c.todaysTimeIndex-4),c.springDSTMobile&&!c.mobileDatePickerMeridianChangeToPM&&(24===l.options.length&&l.options.splice(4,2),c.timeIndexLimit=10,l.disableOptionMobileDatePicker=c.todaysTimeIndex-6,c.springDSTMobile=!1),c.fallDSTMobile&&!c.mobileDatePickerMeridianChangeToPM&&(24===l.options.length&&l.options.splice(4,0,{value:"1:00",label:"1:00"},{value:"1:30",label:"1:30"}),c.timeIndexLimit=12,l.disableOptionMobileDatePicker=c.todaysTimeIndex-2,c.fallDSTMobile=!1)),l.mobileDatePickerDates&&(c.mobileDatePickerDateChanged=0!==_.findIndex(l.options,a)?!0:!1)),k=[a],j&&j.$setViewValue(a.value))
}console.log("attrs "+e);var i=f[0],j=f[1],k=[],l={mobileDatePickerDates:d.is(".mobileDatePickerDates"),mobileDatePickerTimes:d.is(".mobileDatePickerTimes"),currentOption:null,disableOptionMobileDatePicker:0,inSheetAccordion:d.closest(".sheet").length>0&&d.is(".dropdown--accordion"),selectOptionByIndex:function(a){h(l.options[a])},selectOptionByValue:function(a){l.isMultiple&&_.isArray(a)?h(a):h(_.find(l.options,{value:a}))},options:[],loadOptions:function(a){l.clearOptions(),_.each(a,l.appendOption),l.addPlaceholderAttribute(),j&&j.$modelValue?l.selectOptionByValue(j.$modelValue):l.selectOptionByIndex(0)},clearOptions:function(){l.options=[]},appendOption:function(){l.options.push(l.formatOption.apply(null,arguments))},prependOption:function(){l.options.unshift(l.formatOption.apply(null,arguments))},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},isSelected:function(a){return _.contains(k,a)},valueIsEmpty:function(a){return null===typeof a.value||""==typeof a.value},addPlaceholderAttribute:function(){e.placeholder&&l.prependOption(e.placeholder,"")},maybeToggle:function(){l.isMultiple||l.isAccordion||l.toggle()},toggle:function(a){i.toggle(a)},isOpen:!1,isDisabled:!1,isAlwaysPlaceholder:!1,isMultiple:!1,isAccordion:d.is(".dropdown--accordion")};_.has(e,"alwaysPlaceholder")&&a.$watch(b(e.alwaysPlaceholder),function(a){l.isAlwaysPlaceholder=Boolean(a)}),_.has(e,"multiple")&&a.$watch(b(e.multiple),function(a){l.isMultiple=Boolean(a),l.isMultiple&&g(),d.toggleClass("dropdown--multiple",l.isMultiple)}),_.has(e,"disabled")&&a.$watch(b(e.disabled),function(a){l.isDisabled=Boolean(a)}),a.$watch(e.toggle,function(){$(document).ready(function(){$(".js-add-ddfix .sheet__body").height=$(window).height()})}),l.addPlaceholderAttribute(),l.selectOptionByIndex(0),_.has(e,"options")&&a.$watch(e.options,function(a){a?l.loadOptions(a):l.clearOptions()},!0),j&&(j.$render=function(){l.selectOptionByValue(j.$modelValue)}),a.dropdown=l}}}}]);var sheetHeight=$(".js-add-ddfix .sheet__body").height()+$(".js-add-ddfix .sheet__head").height(),windowHeight=$(window).height();$(".dropdown").click(function(){$(".js-add-ddfix").height=windowHeight}),angular.module("dropdowns").directive("dropdown",["$compile","$parse","$rootScope","transcludeTemplates",function(a,b,c,d){return{restrict:"EA",require:["toggle","?ngModel"],scope:!0,transclude:"element",replace:!0,templateUrl:"/parts/dropdown/dropdown-template.html",compile:function(a,e,f){return f(c,function(b){d(a,b),b.hasContent()&&a.find(".text-truncate").removeClass("text-truncate").children().addClass("text-truncate")}),function(a,c,d,e){function f(){var b;a.$watch(function(){angular.equals(b,i.$viewValue)||(b=angular.copy(i.$viewValue),i.$render())})}function g(a){var b,c,d;if(k.isMultiple){if(0===k.options.length)return;angular.isArray(a)?(b=a,j=_.map(b,function(a){return _.find(k.options,{value:a})})):null===a.value||angular.isString(a.value)&&""===a.value?j=[]:-1!==(c=_.findIndex(j,a))?j.splice(c,1):j.push(a),1===j.length?k.currentOption=j[0]:j.length>1?(k.currentOption={label:j.length+" selected"},j=_.sortBy(j,function(a){return _.indexOf(k.options,_.find(k.options,a))})):k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value}),k.isAlwaysPlaceholder&&(k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value})),0===j.length&&angular.isArray(b)?b.length=0:b=_.map(j,function(a){return a.value}),i&&(angular.isArray(i.$viewValue)?(d=i.$viewValue,d.length=0,_.each(b,function(a){d.push(a)}),i.$setViewValue(d)):i.$setViewValue(b))}else a&&(k.currentOption=k.isAlwaysPlaceholder?_.find(k.options,function(a){return null===a.value||""===a.value}):a,j=[a],i&&i.$setViewValue(a.value))}a.isViewportSize=isViewportSize;var h=e[0],i=e[1],j=[],k={currentOption:null,isGuideJumpTo:c.is(".guideJumpTo"),inSheetAccordion:c.closest(".sheet").length>0&&c.is(".dropdown--accordion"),selectOptionByIndex:function(a){g(k.options[a])},selectOptionByValue:function(a){k.isMultiple&&_.isArray(a)?g(a):g(_.find(k.options,{value:a}))},options:[],loadOptions:function(a){k.clearOptions(),_.each(a,k.appendOption),k.addPlaceholderAttribute(),i&&i.$modelValue?k.selectOptionByValue(i.$modelValue):k.selectOptionByIndex(0)},clearOptions:function(){k.options=[]},appendOption:function(){k.options.push(k.formatOption.apply(null,arguments))},prependOption:function(){k.options.unshift(k.formatOption.apply(null,arguments))},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},isSelected:function(a){return _.contains(j,a)},valueIsEmpty:function(a){return null===typeof a.value||""==typeof a.value},addPlaceholderAttribute:function(){d.placeholder&&k.prependOption(d.placeholder,"")},maybeToggle:function(){k.isMultiple||k.isAccordion||(void 0!==options.isDragEvent&&options.isDragEvent!==!0&&k.toggle(),options.isDragEvent=!1)},applyScroll:function(){c.is(".guideJumpTo")&&($("#jumpDropDown").hasClass("jspScrollable")||(k.options.mouseScroll=!0,new JScrollPaneVertical($("#jumpDropDown"),k.options)))},toggle:function(a){k.isDisabled||(k.options&&k.options.length>1?h.toggle(a):void 0!==d.showtoggle&&k.options&&k.options.length>0&&h.toggle(a))},isPagination:!1,isOpen:!1,isDisabled:!1,isAlwaysPlaceholder:!1,isMultiple:!1,isAccordion:c.is(".dropdown--accordion")};_.has(d,"alwaysPlaceholder")&&a.$watch(b(d.alwaysPlaceholder),function(a){k.isAlwaysPlaceholder=Boolean(a)}),_.has(d,"multiple")&&a.$watch(b(d.multiple),function(a){k.isMultiple=Boolean(a),k.isMultiple&&f(),c.toggleClass("dropdown--multiple",k.isMultiple)}),_.has(d,"disable")&&a.$watch(b(d.disable),function(a){k.isDisabled=Boolean(a)}),_.has(d,"pagination")&&(k.isPagination=!0),a.$watch(d.toggle,function(){$(document).ready(function(){$(".js-add-ddfix .sheet__body").height=$(window).height()})}),k.addPlaceholderAttribute(),k.selectOptionByIndex(0),_.has(d,"options")&&a.$watch(d.options,function(a){a?k.loadOptions(a):k.clearOptions()},!0),i&&(i.$render=function(){k.selectOptionByValue(i.$modelValue)}),a.dropdown=k}}}}]).directive("textTruncateJs",[function(){return{restrict:"C",link:function(a,b){function c(){b.hide(),_.nextCycle(function(){b.css({width:b.parent().width()}),b.show()})}_.nextCycle(c),a.$watch("currentOption.label",function(){return b.width()},function(){c()});var d=!1;setInterval(function(){var a=b.is(":visible");a&&a!==d&&(c(),d=!0)},150)}}}]);var sheetHeight=$(".js-add-ddfix .sheet__body").height()+$(".js-add-ddfix .sheet__head").height(),windowHeight=$(window).height();$(".dropdown").click(function(){$(".js-add-ddfix").height=windowHeight}),angular.module("dvrParts",["dots","displayLoading","poster"]).directive("programItem",[function(){return{restrict:"EA",scope:!0,transclude:!0,replace:!0,templateUrl:"/parts/dvr-parts/program-item.html",link:function(a,b,c){a.programItem=a.$eval(c.data),c.data&&a.$watch(c.data,function(b){a.programItem=b[0]||b,a.series=b})}}}]).directive("buttonRemoveRecordings",[function(){return{restrict:"EA",replace:!0,template:'<button  class="btn btn--secondary"  ng-click="remove.startFlow()"  ng-disabled="!remove.selected.length">  <i class="icon-trash"></i>  <span ng-bind-html="l.dvr.remove.series[dvr.recordingType][remove.localeParams.seriesSelectionCount].mobileButtonLabel | s:remove.localeParams"></span></button>'}}]).directive("buttonConfirmRemoveRecordings",[function(){return{restrict:"EA",replace:!0,template:'<button  class="btn btn--secondary"  ng-show="remove.status == \'confirm\'"  ng-click="remove.removeRecordings(remove.selected)"  ng-bind-html="l.dvr.remove[remove.quantityType][dvr.recordingType][remove.localeParams.seriesSelectionCount][remove.status].continueButtonLabel | s:remove.localeParams"></button>'}}]).directive("recordingItemPhone",[function(){return{restrict:"EA",scope:!0,template:'<div class="recording-item padding-s theme-white">  <div class="hbeam full-width">    <div>      <h4>{{series[0].Title}}</h4>      <p>{{series[0].displayDuration}}</p>    </div>    <div class="align-right align-middle">      <p ng-hide="remove.mode" ng-bind-html="series[0].displayShowTime"></p>      <input        ng-show="remove.mode"        ng-model="remove.model[series[0].id]"        ng-change="remove.addRecording(series[0].id, series)"        class="checkbox checkbox--secondary"      >    </div>  </div></div>'}}]),angular.module("dvrRecord",["modal","escape","panel","radio","spinner","webdvrResource","dropdownDvr","dropdowns","filters","notice","oolCookie","program","errorHandler","tvListings","ngCookies","onetCookies"]).directive("dvrRecord",["WebDVR","$log","$rootScope","$rootElement","$compile","$notice","ooluser","Program","getRecordedState","$cookieStore","$window","Cookies",function(a,b,c,d,e,f,g,h,i,j,k,l){g.laBoxUser=g.hasOOLSession?g.laBoxUser||g.laboxOrMini:"true"===l.getCookie("labox"),c.recordingItem=0,c.currentRecording=0;var m,n,o,p=[],q=!1,r=!1;return{restrict:"EA",transclude:!0,replace:!1,scope:{program:"=",outlineStyle:"=",showIcon:"=",trackclick:"@"},template:['<a class="btn btn--primary"','  ng-show="haveDVR && program.dvrRecorded && !program.fromEPG"','  ng-click="remove(program)"','  ><i ng-show="showIcon" class="onet-icons-close"></i>Cancel recording</a>','<a class="btn btn--primary"','   ng-show="haveDVR && !program.dvrRecorded && program.dvrScheduled && !program.seriesButton && !program.fromEPG"','   ng-click="remove(program)"','   ><i ng-show="showIcon" class="onet-icons-close"></i>Cancel recording</a>','<a class="btn btn--primary"','   ng-show="haveDVR && !program.dvrRecorded && program.dvrScheduled && program.seriesButton && !program.fromEPG"','   ng-click="remove(program)"','   ><i ng-show="showIcon" class="onet-icons-close"></i>Cancel Series</a>','<a class="btn btn--primary"','   ng-click="record(program)"','ng-show="(haveDVR && !(program.dvrRecorded || program.dvrScheduled || program.alreadyAired) && program && !program.fromEPG)"','   ><i ng-show="showIcon" class="icon-circle"></i>Record</a>','<a class="btn btn--primary "','  ng-show="program.hasDvr && program.dvrRecorded && program.fromEPG"','  ng-click="remove(program)"','  ><i class="recBadge"></i>Cancel recording</a>','<a class="btn btn--primary"','   ng-show="program.hasDvr && !program.dvrRecorded && program.dvrScheduled && !program.seriesButton && program.fromEPG"','   ng-click="remove(program)"','   ><i class="recBadge"></i>Cancel recording</a>','<a class="btn btn--primary"','   ng-show="program.hasDvr && !program.dvrRecorded && program.dvrScheduled && program.seriesButton && program.fromEPG"','   ng-click="remove(program)"','   ><i class="recBadge"></i>Cancel Series</a>','<a class="btn btn--primary"','   ng-click="record(program)"','   ng-show="(program && program.hasDvr && !(program.dvrRecorded || program.dvrScheduled || program.alreadyAired) && program.fromEPG)"','   ><i class="recBadge"></i>Record</a>','<a class="btn btn--primary"','   ng-click="goToLogin(program)"','   ng-show="program.clickEventDetails && program.needLogin"','   ><i class="recBadge"></i>Record</a>','<a class="btn btn--primary"','   ng-href="/login?referer={{windowHref}}"','   ng-show="program && needLogin && !program.clickEventDetails && !program.fromEPG"','   ><i ng-show="showIcon" class="icon-circle"></i>Record</a>'].join(""),link:function(b,j,l){function s(){var a="/parts/dvr-record/record-show-card-tmpl.html",b=_.template('<div id="recordShowCard" ng-include="\'<%= templateUrl %>\'"></div>',{templateUrl:a});d.find("#recordShowCard").length||e(b)(c,function(a){d.append(a)})}var t=b;t.$watch("program",function(a){i(a)},!0),t.$watch("program.loading",function(a,b){a!==b&&i(t.program)}),t.windowHref=window.location.href,s(),r=!0,a.query(function(a){console.log("dvrs.length "+a.length),a.length>0?(n=a[0].recording(),o=a[0].boxAlias,_.each(a,function(a,b){var c=a.boxAlias;angular.isString(c)&&""!==c||(c="DVR "+b+1),p.push(c)}),b.defaultBoxAlias=m=a[0].boxAlias||"Manage",b.haveDVR=q=!0,b.needLogin=needLogin=!1,calledBack=!0):(b.haveDVR=q=!1,b.needLogin=needLogin=!1)},function(){b.haveDVR=q=!1,b.needLogin=needLogin=!0}),b.ooluser=g,b.notifyNoDVR=function(){f.add("Sorry, we could not connect to your DVR. Please try again later.","error")},b.record=function(a){void 0===l.trackclick&&void 0!==a.trackClick&&"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:"Record_bttm"}),reporting.setAttrs({prop10:"Record_bttm"}),reporting.sendAttrs(!0)),void 0!==l.trackclick&&"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:l.trackclick}),reporting.setAttrs({prop10:l.trackclick}),reporting.sendAttrs(!0)),programModel=new h(a);var c=programModel.toRecording();b.$emit("dvrRecord.click",c,a)},b.remove=function(a){console.log("Inside scope.remove"),programModel=new h(a);var c=programModel.toRecording();b.$emit("dvrRemove.click",c,a)},b.goToLogin=function(a){document.cookie="clickEventDetails="+a.clickEventDetails+"; path=/;expires="+u(),k.location=a.loginUrl};var u=function(){var a=new Date;a.setTime(a.getTime()+3e5);var b=a.toGMTString();return b}}}}]).factory("getRecordedState",["$log","$rootScope","WebDVR",function(a,b,c){function d(b,d,e){return e&&(n=!1,o=!1,p=!1),p?(angular.isFunction(d)&&d(),void 0):o?(b(),void 0):(m.push(b),n||(n=!0,c.query(function(b){function c(){if(d--,a.log("Outstanding DVR requests",d),0===d)for(o=!0;m.length>0;)m.pop()()}var d=0;b.length>0?(DvrRecording=b[0].recording(),h=b[0].boxAlias,_.each(b,function(a,b){var e=a.boxAlias;DvrRecording=a.recording(),angular.isString(e)&&""!==e||(e="DVR "+b+1),l.push(e),d+=2,j[e]=DvrRecording.query({scheduled:!1},c,c),k[e]=DvrRecording.query({scheduled:!0},c,c)}),i=b[0].boxAlias||"Manage"):p=!0},function(){p=!0})),void 0)}function e(a,b){var c="MM-DD-YY HHmmss",d=moment(a.StartTime,c).toDate(),e=(moment(a.EndTime,c).toDate(),b.startTime),f=b.endTime;return(angular.isUndefined(e)||!angular.isDate(e))&&(e=b.start_time),(angular.isUndefined(f)||!angular.isDate(f))&&(f=b.end_time),d.getTime()<f.getTime()&&d.getTime()>=e.getTime()}function f(a){b.displayTd=!1,a.seriesButton=!1,angular.isObject(a)&&((angular.isDefined(a.endTime)&&a.endTime.getTime()<(new Date).getTime()||angular.isDate(a.end_time)&&a.end_time.getTime()<(new Date).getTime())&&(a.alreadyAired=!0),_.each(l,function(b){var c=!1;return angular.isUndefined(a.cs)&&angular.isString(a.channel_callsign)&&(a.cs=a.channel_callsign),_.each(j[b].concat(k[b]),function(d){if(angular.isObject(d)){if(angular.isObject(d.RecordedProgElement)&&angular.isObject(d=d.RecordedProgElement.Program)&&d.callsign===a.cs&&e(d,a))return a.dvrRecorded=b,a.recStartTime=d.StartTime,c=!0,!1;if(angular.isObject(d.SchProgElement)&&angular.isObject(d=d.SchProgElement.Program)&&d.callsign===a.cs&&e(d,a))return a.dvrScheduled=b,a.recStartTime=d.StartTime,g(b,d,a),c=!0,!1}}),c?!1:void 0}),b.displayTd=!0,a.loadingDVRState=!1)}function g(a,c,d){b.seriesidCount=0,_.each(k[a],function(a){angular.isObject(a.SchProgElement)&&angular.isObject(a=a.SchProgElement.Program)&&a.callsign===d.cs&&(angular.isDefined(c.SeriesId)&&a.SeriesId===c.SeriesId?b.seriesidCount=b.seriesidCount+1:b.currentRecording=a)}),(b.seriesidCount>1||"series"===b.currentRecording.Scope&&(0===b.currentRecording.Save||b.currentRecording.Save>1))&&(d.seriesButton=!0)}var h,i,j={},k={},l=[],m=[],n=!1,o=!1,p=!1,q=function(a,b,c){angular.isObject(a)&&(a.loadingDVRState=!0),d(function(){f(a),angular.isFunction(b)&&b(a)},function(){angular.isObject(a)&&(a.loadingDVRState=!1)},c)};return q.addScheduledRecording=function(a,c,d,e){var f=!1;d.startTime<e&&(f=!0);var g="MM-DD-YY HHmmss";angular.isUndefined(k[a])&&(k[a]=[]),k[a].push({SchProgElement:{Program:{callsign:c,StartTime:moment(angular.isDate(d.startTime)?d.startTime:d.start_time).format(g),EndTime:moment(angular.isDate(d.endTime)?d.endTime:d.end_time).format(g),Save:b.recordingItem.save,Scope:b.recordingItem.scope}}}),q(d,null,f)},q.CancelScheduledRecording=function(a,b,c){c.dvrScheduled=!1,k[a]=_.reject(k[a],function(a){return angular.isObject(a.SchProgElement)&&angular.isObject(a=a.SchProgElement.Program)&&a.callsign===c.cs&&e(a,c)?a:void 0}),j[a]=_.reject(j[a],function(a){return angular.isObject(a.RecordedProgElement)&&angular.isObject(a=a.RecordedProgElement.Program)&&a.callsign===c.cs&&e(a,c)?a:void 0}),q(c),c.dvrScheduled=!1,c.dvrRecorded=!1},q}]).controller("recordShowCard",["$rootScope","$scope","WebDVR","WebDVRs","dvrUser","getRecordedState","$route","Cookies","ooluser",function(a,b,c,d,e,f,g,h,i){var j=h.getCookie("epg"),k={};j&&j.length>0&&(k=JSON.parse(j));var l=k.lineupId,m={isOpen:!1,setup:!0,waiting:!1,success:!1,error:!1,errorMessage:"",unAuthorized:!1,states:["setup","waiting","success","error"],moveTo:function(a){var b=this;_.each(this.states,function(c){b[c]=c===a})},close:function(){this.isOpen=!1,this.moveTo("setup")},wait:function(){this.moveTo("waiting")},confirm:function(){var a=m.recording;this.moveTo("success"),a.count=a.save?a.save:"All",4===a.filter&&(a.count+=" new")},alert:function(a){this.moveTo("error"),this.recording.error=a||"There was an error while scheduling your recording."},getRecording:function(){var a=m.recording,b=a.box,c=b.recording(),d="YYYYMMDDHHmmss",e={call_sign:a.call_sign,start_time:a.start_time.format(d),end_time:a.isRSDVR()?a.end_time.format(d):a.end_time.add(a.end,"seconds").format(d),time:moment().valueOf(),rec_type:"series"===a.scope?1:0,save_days:"series"===a.scope&&a.isRSDVR()?a.keep_series_mrdvr:"series"!==a.scope||a.isRSDVR()?a.keep:0,save_episodes:a.save,all_episodes:a.filter,showEndTime:a.isRSDVR()?a.end_time.add(a.end,"seconds").format(d):a.end_time.format(d),quality:a.isRSDVR()||a.laBoxUser?a.quality:b.is_hd?"hd":"sd",dvrAlias:a.program.dvrScheduled?a.program.dvrScheduled:a.program.dvrRecorded,startTime:a.program.recStartTime,rsdvrlineupid:l};return i.laBoxUser&&(e.stationId=a.program.tribuneId?a.program.tribuneId:"",e.episodeStop=a.end/60,e.rsdvrlineupid=i.elineupId),new c(e)},checkUnAuthorized:function(){console.log("Recording error==="+this.recording.error),"Not Authorized to Record"===this.recording.error&&(this.recording.error="You're trying to record a program on a channel that you do not currently receive. You can add it now by going to channel 902 and choosing the TV package that includes the channel you'd like to see.",this.unAuthorized=!0)},getDay:function(){var a,b=new Date,c=new Array(7);c[0]="Sunday",c[1]="Monday",c[2]="Tuesday",c[3]="Wednesday",c[4]="Thursday",c[5]="Friday",c[6]="Saturday";var d=c[b.getDay()];return a=d.substr(0,3)},getTime:function(){var a,b=new Date,c=b.getHours(),d=b.getMinutes();return 10>d&&(d="0"+d),a=c>11?"PM":"AM",c+":"+d+" "+a},record:function(){this.wait(),this.unAuthorized=!1;var b=this.getRecording(),c=this;b.$save(function(){g.reload(),c.confirm(),a.$emit("dvrRecording.schedule",b),f.addScheduledRecording(c.recording.box.boxAlias,c.recording.call_sign,c.recording.program,b.time)},function(a){c.alert(a),c.checkUnAuthorized()})}},n={isOpen:!1,setup:!0,waiting:!1,success:!1,error:!1,states:["setup","waiting","success","error"],errorMessage:"",moveTo:function(a){var b=this;_.each(this.states,function(c){console.log("in moveTo"),b[c]=c===a})},close:function(){console.log("in close"),this.isOpen=!1,this.moveTo("setup")},wait:function(){this.moveTo("waiting")},confirm:function(){this.moveTo("success")},alert:function(a){this.moveTo("error"),this.errorMessage=a||"There was an error while cancelling your recording."},cancel:function(){this.wait();var b=m.getRecording(),c=d,e=c[0].recording();angular.forEach(c,function(a){a.boxAlias===b.dvrAlias&&(e=a.recording())});var h=function(){a.$emit("dvrRecording.cancel",b),g.reload(),n.confirm(),f.CancelScheduledRecording(b.dvrAlias,m.recording.call_sign,m.recording.program)},i=function(a){n.alert(a)};e.destroySingle(b,h,i)}},o={start:["On time"],endTimeDisabled:["On time"],end:[{value:0,label:"On time"},{value:60,label:"1 min"},{value:120,label:"2 min"},{value:300,label:"5 min"},{value:600,label:"10 min"},{value:900,label:"15 min"},{value:1800,label:"30 min"},{value:3600,label:"60 min"},{value:5400,label:"90 min"},{value:7200,label:"2 hrs"},{value:10800,label:"3 hrs"}],save:[{value:0,label:"All Episodes"},{value:5,label:"5 Episodes"},{value:4,label:"4 Episodes"},{value:3,label:"3 Episodes"},{value:2,label:"2 Episodes"},{value:1,label:"1 Episode"}],keep_series_mrdvr:[{value:99,label:"Until I delete"},{value:0,label:"Until space needed"}],keep_episode_mrdvr:[{value:1,label:"1 Day"},{value:2,label:"2 Days"},{value:7,label:"7 Days"},{value:14,label:"14 Days"},{value:99,label:"Until I delete"},{value:0,label:"Until space needed"}],keep_series_localdvr:[{value:0,label:"Until I delete"}],keep_episode_localdvr:[{value:1,label:"1 Day"},{value:2,label:"2 Days"},{value:7,label:"7 Days"},{value:14,label:"14 Days"},{value:0,label:"Until I delete"}],filter:[{value:4,label:"New Episodes Only"},{value:1,label:"All Episodes"}],quality:[{value:"hd",label:"HDTV rooms only"},{value:"hdsd",label:"All rooms (HD & SD)"},{value:"sd",label:"All rooms in SD"}]};m.recording={box:{},title:"",episode:"",scope:"series",end:0,keep:14,save:3,keep_series_mrdvr:0,filter:4,isSeries:function(){return"series"===this.scope},isEpisode:function(){return"episode"===this.scope},isMovie:function(){return"movie"===this.scope},isRSDVR:function(){return"RSDVR VIRTUAL STB"===this.box.devicetype},options:o,laBoxUser:i.laBoxUser},e.webdvr.areTermsRead=!1,a.recordingItem=m.recording,b.acceptWebdvrTerms=function(){e.webdvr.areTermsRead&&(m.wait(),c.signup(function(){m.moveTo("setup"),e.webdvr.areTermsAccepted=!0},function(a){m.alert(a)}))},b.submitAcceptWebdvrTerms=function(){b.acceptWebdvrTerms()},b.dvrUser=e,a.$on("dropdownDvr.change",function(a,c){m.recording.box=c.box,(m.recording.isRSDVR()||i.laBoxUser)&&(m.recording.quality="hd");var d=c.box.devicetype;-1!==d.indexOf("8300")?(b.isdisable=!0,$("#end1").addClass("is-disabled")):(b.isdisable=!1,$("#end").removeClass("is-disabled"))}),angular.isObject(a.dvrdrop)&&angular.isObject(a.dvrdrop.box)&&(m.recording.box=a.dvrdrop.box),a.$on("dvrRecord.click",function(a,b,c){if((m.recording.isRSDVR()||i.laBoxUser)&&(m.recording.quality="hd"),m.recording.keep=14,m.recording.keep_series_mrdvr=0,void 0===c.trackClick&&(reporting.setAttrs({eVar10:"Record"}),reporting.sendAttrs(!0)),_.extend(m.recording,{program:c},b),m.isOpen=!0,console.log("Program StartTime :"+c.startTime),console.log("Program start_time :"+c.start_time),console.log("Program has Series :"+c.hasSeries),c.hasSeries===!1?$("#series").css("display","none"):$("#series").css("display",""),!angular.isUndefined(c.startTime)||!angular.isUndefined(c.start_time)){var d=angular.isUndefined(c.startTime)?moment(c.start_time).format("ddd"):moment(c.startTime).format("ddd"),e=angular.isUndefined(c.startTime)?moment(c.start_time).format("h:mma"):moment(c.startTime).format("h:mma");o.filter=[{value:1,label:"All Episodes"},{value:4,label:"New Episodes Only"},{value:3,label:"All at "+e},{value:5,label:"All at "+e+" "+"on"+" "+d}]}}),a.$on("dvrRemove.click",function(a,b,c){console.log("in dvrRemove.click function"),_.extend(m.recording,{program:c},b),n.isOpen=!0,console.log("removeRecording.isOpen : "+n.isOpen)}),b.request=m,b.removeRecording=n}]),angular.module("dynamicGrid",[]).directive("dynamicGrid",[function(){return{restrict:"E",scope:{items:"="},transclude:!0,replace:!0,templateUrl:"/parts/dynamic-grid/dynamic-grid-template.html",link:function(a,b,c){function d(a,b,c){for(var d=a.slice(0),e=c/b,f=[];d.length;)f.push(d.splice(0,e));return f}a.items=a.items||function(){throw"bootsrap-grid needs a valid 'items' attribute! It should look something like this: <div bootstrap-grid items='myItemsArray'></div>"}(),a.spanWidth=c.spanWidth,a.parentSpanWidth=c.parentSpanWidth,a.spanWidth>=1&&a.spanWidth<=12||(a.spanWidth=3),a.parentSpanWidth>=1&&a.parentSpanWidth<=12||(a.parentSpanWidth=12),a.rows=d(a.items,a.spanWidth,a.parentSpanWidth)}}}]);var ellipsesTooltipModule=angular.module("ellipsesTooltipModule",["toolTip"]);ellipsesTooltipModule.directive("ellipsesTooltip",["$timeout",function(a){return{restrict:"AEC",scope:!0,link:function(b,c,d){function e(){t=n.wrapInner("<div/>").children(),t.contents().detach().end().append(q.clone(!0)).find("br").replaceWith("<br />").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var b=!1,c=!1;s.afterElement&&(b=s.afterElement.clone(!0),b.show(),s.afterElement.detach()),j(t,r)&&(c="true"===d.istooltip?i(t,n,t,r,b):f(t,n,t,r,b)),t.replaceWith(t.contents()),t=null,s.isTruncated=c,a(function(){m.find("a.readmore").css("float","right")})}function f(a,b,c,d,e){var f=!1;return a.contents().detach().each(function(){var g=this,h=$(g);return f?!0:(a.append(h),e&&a.append(e),j(c,d)&&3===g.nodeType&&(f=i(h,b,c,d,e)),void 0)}),f}function g(a){for(var b=a.innerHeight(),c=["paddingTop","paddingBottom"],d=0,e=c.length;e>d;d++){var f=parseInt(a.css(c[d]),10);isNaN(f)&&(f=0),b-=f}return b}function h(a,b){return"string"==typeof a?(a=$(a,b),a.length?a:!1):a.jquery?a:!1}function i(a,c,e,f){for(var g=a[0],h=l(g),i=-1!==h.indexOf(" ")?" ":"",m="letter"===f.wrap?"":i,n=h.split(m),o=-1,p=-1,q=0,r=n.length-1;r>=q&&(0!==q||0!==r);){var s=Math.floor((q+r)/2);if(s===p)break;p=s,"true"===d.istooltip?(k(g,n.slice(0,p+1).join(m)),a.append("<div class='tip'>"+f.ellipsis+"<span class='tooltipB'> <p>"+b.prevContent+"</p></span></div>")):k(g,n.slice(0,p+1).join(m)+f.ellipsis),j(e,f)?r=p:(o=p,q=p)}return!0}function j(a,b){return a.innerHeight()>b.maxHeight}function k(a,b){a.textContent=a.innerText=a.data=b}function l(a){var b=a.textContent||a.innerText||a.data;return b?b:""}var m=c,n=m,o={after:"a.readmore"},p={ellipsis:"...",wrap:"leters",lastCharacter:{},after:null},q=m.contents(),r=$.extend(!0,{},p,o),s={},t=null;s.afterElement=h(r.after,n),s.isTruncated=!1,a(function(){if(b.prevContent=m.contents().text(),m.outerHeight()>50){q=m.contents();var a="Read more";"true"!==d.istooltip&&m.append('<a class="more-link readmore">'+a+'<i class="icon-caret-down"></i></a>'),s.afterElement=h(r.after,n)}r.maxHeight=g(n),e()},100),m.on("click",".readmore",function(){-1!==m.find("a").text().indexOf("Read more")?(m[0].childNodes[0].textContent=b.prevContent,m.text(b.prevContent),m.css("height","auto"),m.removeClass("setHeight"),m.append('<a class="more-link readmore readless">  Read less<i class="icon-caret-down"></i></a>')):(m.css("height",r.maxHeight),m.addClass("setHeight"),m.append('<a class="more-link readmore readless">  Read more<i class="icon-caret-down"></i></a>'),e())})}}}]),angular.module("ellipsis",[]).directive("ellipsis",[function(){return function(a,b,c){function d(a){var c,d;"nowrap"===b.css("whiteSpace")?(b.css({overflow:"hidden",textOverflow:"ellipsis"}),b.text(a)):(c=!b.is(":visible"),c&&(d=b.closest(":visible").children().has(b).show()),b.trigger("destroy.dot"),b.text(a),b.dotdotdot(),c&&angular.isDefined(d)&&d.css("display",""))}c.$observe("ellipsis",d),a.$watch(function(){return b.width()},function(){d(c.ellipsis)})}}]),angular.module("pberrmsgs",[]).directive("errormsg",[function(){return{restrict:"E",templateUrl:"/parts/error-msg/error-msg-template.html",scope:{message:"@message",show:"@show",multiMsg:"=multiMsg",msgUpdate:"@msgUpdate"},link:function(a){a.init=function(b){angular.isArray(b)?(a.totalAlerts=b.length,a.multiple=!0,a.currentAlert=1,b.length>1?a.multiple=!0:b&&b[0]&&(a.message=b[0],a.multiple=!1)):b&&b[0]&&(a.message=b[0],a.multiple=!1)},a.init(a.multiMsg),a.$watch("msgUpdate",function(){a.init(a.multiMsg)},!0),a.getCurrentAlert=function(){return a.multiple?a.multiMsg[a.currentAlert-1]:void 0},a.currentTotalText=function(){return""+a.currentAlert+" of "+a.totalAlerts},a.nextAlert=function(){a.currentAlert++},a.prevAlert=function(){a.currentAlert--}}}}]),function(){function a(a){return a.replace(/\=""|\=''/g,"")}angular.module("escape",[]).directive("escape",[function(){return{priority:1e3,terminal:!0,compile:function(b,c){function d(a){return _.map(a.split("\n"),function(a){return"  "===a.substring(0,2)&&(a=a.substring(2)),a}).join("\n")}b.text(d(c.escape||a(b.html())))}}}]).directive("codeblock",[function(){return{restrict:"E",priority:1e3,terminal:!0,compile:function(b,c){var d,e;c["for"]?(d=$(c["for"]),e=d.length?d.outerHtml():b.html()):e=b.html(),b.replaceWith($("<pre/>").text(a(e)).outerHtml())}}}])}(),angular.module("faqSearch",["faqService","noSpecialchar","oolCookie","formTools"]).directive("faqSearch",[function(){return{restrice:"EA",scope:{faqtab:"=faqtab",keyword:"=keyword",faqproduct:"=faqproduct"},templateUrl:"/parts/faq-search/faq-search-template.html",controller:["$rootScope","$scope","$location","$window","Cookies","FaqService",function(a,b,c,d,e,f){b.showDropdown=!1,b.callChat=function(){a.chatNow()};var g=function(){if(b.selectedProduct={},b.faqproduct.pId){var a=b.products.find(function(a){return a.id===b.faqproduct.pId});if(b.selectedProduct.id=a.id,b.selectedProduct.name=a.name,b.faqproduct.subpId){var c=a.subs.find(function(a){return a.id=b.faqproduct.subpId});b.selectedProduct.categoryId=c.id,b.selectedProduct.category=c.name}}},h=function(){var a="es"===e.getCookie("MP_LANG")?"esp":"opt";f.getProducts(a).then(function(a){b.products=a.data;var c={id:-1,name:"All"};b.products.unshift(c),b.faqproduct&&g()})};h(),b.toggleDropdown=function(a){b.showDropdown=!b.showDropdown,a.stopPropagation()},d.onclick=function(){b.showDropdown&&(b.showDropdown=!1,b.apply())},b.dropdownClicked=function(a){b.products[a].showCatergories=!b.products[a].showCatergories},b.setSearchProduct=function(a,c){b.selectedProduct={},b.selectedProduct.id=b.products[a].id,b.selectedProduct.name=b.products[a].name,c>=0&&(b.selectedProduct.category=b.products[a].subs[c].name,b.selectedProduct.categoryId=b.products[a].subs[c].id),b.showDropdown=!b.showDropdown},b.getSearchFaqs=function(){var a="/";if((b.keyword||b.selectedProduct&&-1!==b.selectedProduct.id)&&(a+="list",b.selectedProduct&&-1!==b.selectedProduct.id&&(a=a+"/p/"+b.selectedProduct.id,b.selectedProduct.categoryId&&(a=a+"&"+b.selectedProduct.categoryId)),b.keyword&&(a=a+"/kw/"+b.keyword),"undefined"!==reporting))if(b.keyword?reporting.setAttrs({prop6:b.keyword}):reporting.setAttrs({prop6:""}),b.selectedProduct&&-1!==b.selectedProduct.id){var d=b.selectedProduct.name;b.selectedProduct.categoryId&&(d=d+"-"+b.selectedProduct.category),reporting.setAttrs({prop40:d})}else reporting.setAttrs({prop40:""});c.path(a)}}]}}]),angular.module("filters",[]).filter("roundDown",function(){return function(a){return Math.floor(a)}}).filter("roundHalfUp",function(){return function(a){return Math.round(a)}}).filter("hoursAndMinutes",function(){return function(a){var b,c;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)?(b=Math.floor(a/60),c=a%60,(b>0?b+"h ":"")+(0===b||c>0?c+"m":"")):""}}).filter("chunk",function(){return function(a,b){function c(a){return a.$$hashKey||(a.$$hashKey=d()),a}function d(){for(var a,b=e.length;b;){if(b--,a=e[b].charCodeAt(0),57===a)return e[b]="A",e.join("");if(90!==a)return e[b]=String.fromCharCode(a+1),e.join("");e[b]="0"}return e.unshift("0"),e.join("")}if(!_.isUndefined(a)){if(_.isUndefined(b))return a;var e=["0","0","0"],f=_.map(_.chunk(a,b),c);return f}}}).filter("moment",function(){return _.memoize(function(a,b){var c,d,e;return moment.isMoment(a)?angular.isObject(b)&&b.hasOwnProperty("calendar")?(c=angular.toJson(b),angular.isUndefined(moment.langData(c))&&(e=moment.lang(),moment.lang(c,_.extend({},b)),moment.lang(e)),d=moment(a),d.lang(c),d.calendar()):a.format(b):a},function(a,b){return angular.toJson({input:a,format:b})})}).filter("slugify",function(){return function(a){return _.str.slugify(a)}}).filter("skipLimit",[function(){return function(a,b,c){return angular.isArray(a)&&c>=0?a.slice(b,b+c):a}}]),angular.module("floater",[]).directive("floater",["$window","$timeout",function(a,b){return{link:function(a,c){var d=$(window),e=$(c);
b(function(){var a=e.offset().top;a-=80,d.on("scroll",function(){d.scrollTop()>=a?(e.parents("#sub-header").next(".floater-header").hasClass("floater-header")||e.parents("#sub-header").after("<div class='floater-header'></div>"),$(".floater-section").width()>768&&$(".floater-header").addClass("activebanner"),$(".drawer.is-open").length<=0?$("#sub-header").addClass("fixed"):$("#sub-header").removeClass("fixed"),$("#sub-header").addClass("fixed")):($(".floater-section").removeClass("activebanner"),$("#sub-header").removeClass("fixed"))})})}}}]),angular.module("formTools",["config","text-mask"]).directive("optMaxlength",[function(){function a(a){return angular.isUndefined(a)||""===a||null===a||a!==a}return{require:"ngModel",link:function(b,c,d,e){if(d.optMaxlength){console.log("attrs.optMaxlength:"+d.optMaxlength);var f=parseInt(d.optMaxlength,10),g=function(b){return!a(b)&&b.length>f?(e.$setValidity("maxlength",!1),b):(e.$setValidity("maxlength",!0),b)};e.$parsers.push(g),e.$formatters.push(g)}}}}]).directive("optMinlength",[function(){function a(a){return angular.isUndefined(a)||""===a||null===a||a!==a}return{require:"ngModel",link:function(b,c,d,e){if(d.optMinlength){var f=parseInt(d.optMinlength,10),g=function(){var b=$(c).val();return!a(b)&&b.length<f?(e.$setValidity("minlength",!1),b):(e.$setValidity("minlength",!0),b)};c.on("keyup",g),c.on("paste",function(b){var c;return b.originalEvent.clipboardData?c=(b.originalEvent||b).clipboardData.getData("text/plain"):window.clipboardData&&(c=window.clipboardData.getData("text")),!a(c)&&c.length<f?(e.$setValidity("minlength",!1),c):(e.$setValidity("minlength",!0),c)}),e.$formatters.push(g)}}}}]).directive("maxLengthMessage",[function(){function a(a){return angular.isUndefined(a)||""===a||null===a||a!==a}return{require:"ngModel",link:function(b,c,d,e){if(b.showMaxLengthMsg=!1,d.maxlength){var f=parseInt(d.maxlength,10),g=function(c){var d=/^[a-zA-Z0-9_]*$/;return!a(c)&&c.length+1>f&&$(this).keypress()&&c.match(d)?(b.showMaxLengthMsg=!0,setTimeout(function(){b.showMaxLengthMsg=!1},2e3),c):(b.showMaxLengthMsg=!1,c)};e.$parsers.push(g),e.$formatters.push(g)}}}}]).filter("passwordStrength",function(){return function(a){var b=function(a){var b=0;for(i=0;i<a.length-1;i++)a.charAt(i)===a.charAt(i+1)&&b++;return b},c=function(a){return 0===a?"TOO SHORT":38>a?"TOO WEAK":a>=38&&63>a?"MEDIUM":a>=63&&88>a?"STRONG":a>=88?"VERY STRONG":void 0},d=function(a){return 0===a?"#D6001A":38>a?"#FF7F32":a>=38&&63>a?"#FFC72C":a>=63&&88>a?"#FFC72C":a>=88?"#00AA13":void 0},e=function(a){var c=8,d=4,e=3,f=1,g=1,h=1,i=1,j=4,k=15;return score=0,"undefined"==typeof a||a.length<c?0:(score+=(a.length-b(a))*d,a.match("((.*[0-9]){"+e+"})")&&a.match("((.*[a-zA-Z]){"+j+"})")?score+=k:a.match("((.*[0-9]){2})")&&a.match("((.*[a-zA-Z]){"+j+"})")&&(score+=k-5),f&&a.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(score+=10),g&&i&&a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)&&(score+=15),a.match(/[a-zA-Z]+\d+[a-zA-Z]+/)&&(score+=15),a.match(/\d+[a-zA-Z]+\d+/)&&(score+=15),g&&i&&!h&&(a.match(/^\w+$/)||a.match(/^\d+$/))&&(score-=10),isRepetitionOrSequence(a)&&(score=37),score>100?100:score)},f=e(a),g=c(f),h=d(f);return{percent:f,text:g,color:h}}}).filter("phoneFilter",function(){return function(a){if(a){var b=/^[1-9]{1}[0-9]{9}$/;if(b.test(a))return a.substr(0,3)+" "+a.substr(3,3)+"-"+a.substr(6,4)}return a}}).directive("phoneNumber",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){if(!("undefined"!=typeof c.required&&c.required||"undefined"!=typeof a&&""!==a))return d.$setValidity("phoneNumber",!0),"";var b="undefined"==typeof a?"":a.replace(/\(|\)|-| /g,"");return!isNaN(b)&&b>=2e9&&9999999999>=b?(d.$setValidity("phoneNumber",!0),b):(d.$setValidity("phoneNumber",!1),void 0)})}}}).directive("inversePattern",function(){return{require:"ngModel",link:function(a,b,c,d){var e=c.inversePattern;e.match(/^\/(.*)\/$/)&&(e=new RegExp(e.substr(1,e.length-2))),d.$parsers.unshift(function(a){return a.match(e)?(d.$setValidity("inversePattern",!1),void 0):(d.$setValidity("inversePattern",!0),a)})}}}).filter("telephoneNumber",function(){return function(a){for(var b=["("],c=0;c<a.length;c++)3===c?b.push(") "):6===c?b.push(" - "):10===c&&b.push(" "),b.push(a.charAt(c));return b.join("")}}).directive("passwordValidation",[function(){return{require:"ngModel",link:function(a,b,c,d){a.safeApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?this.$eval(a):this.$apply(a)};var e=null;b.bind("focus",function(){d.$focused=!0}),b.bind("blur",function(){d.$focused=!1}),b.bind("keyup",function(){clearTimeout(e),e=setTimeout(function(){var c=/^[a-zA-Z0-9_]*$/,e=$(b).val();try{if(e.length<6||e.length>32)return d.$setValidity("length",!1),d.$message="Your password must be between 6-32 characters. Please try again.",void 0;if(!e.match(c))return d.$setValidity("characters",!1),d.$message="Your password can contain only letters and numbers. No special characters are allowed.",void 0;d.$setValidity("length",!0),d.$setValidity("characters",!0),d.$message=$filter("passwordStrength")(e).text}finally{a.safeApply()}},500)})}}}]).directive("matches",function(){return{require:"ngModel",scope:{expectedValue:"&matches"},link:function(a,b,c,d){var e=a.expectedValue();if(!("$parsers"in e&&"$viewValue"in e&&"$dirty"in e))throw"matches has to referer to another form controller";e.$parsers.unshift(function(a){var b=d.$viewValue===a;return d.$setValidity("matches",b),e.$dirty&&"function"==typeof d.showValidationMsg&&d.showValidationMsg(!1,1),a}),d.$parsers.unshift(function(a){return d.$setValidity("matches",e.$viewValue===a),a})}}}).directive("notEqual",function(){return{require:"ngModel",link:function(a,b,c,d){var e;c.$observe("notEqual",function(a){e=a,d.$setValidity("notEqual",!angular.isString(e)||""===e||e!==d.$viewValue),b.trigger("keyup")}),d.$parsers.unshift(function(a){return d.$setValidity("notEqual",!angular.isString(e)||""===e||e!==a),a})}}}).directive("checkEmail",function(){return{require:"ngModel",link:function(a,b,c,d){var e,f;c.$observe("checkEmail",function(a){e=a+"@optimum.net",f=a+"@optonline.net",d.$setValidity("checkEmail",!angular.isString(e)||""===e||e!==d.$viewValue&&f!==d.$viewValue),b.trigger("keyup")});var g=function(a){return d.$setValidity("checkEmail",!angular.isString(e)||""===e||e!==a&&f!==a),a};d.$parsers.unshift(g),a.$watch(c.ngModel,g)}}}).directive("confirmPassword",[function(){return{require:"ngModel",link:function(a,b,c,d){b.bind("focus",function(){a.isConPassFocus=!0}),b.bind("blur",function(){a.isConPassFocus=!1}),a.safeApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?this.$eval(a):this.$apply(a)};var e=null,f=function(a,b){a===b?(d.$setValidity("passwordMatch",!0),d.$message="Confirm password matches."):(d.$setValidity("passwordMatch",!1),d.$message="Your entries in the password fields do not match. Please try again.")};a.$watch(c.confirmPassword,function(a){e=a;var b=d.$viewValue;d.$dirty&&f(b,e)}),d.$parsers.unshift(function(b){return e=void 0===a.password?a.model.password:a.password.password,b===e?(d.$setValidity(c.name,!0),b):(d.$setValidity(c.name,!1),b)})}}}]).directive("optimumIdInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.optimumIdInput,g=null,h=function(a){var b=/[^\w|\.|\-|_*]|^\.|^-|^_|\.$|-$|_$|(-|_|\.)\1+/;return a.length<4?(e.$message=f.errors.tooShort,e.$setValidity(d.name,!1),!1):a.length>14?(e.$message=f.errors.tooLong,e.$setValidity(d.name,!1),!1):a.match(b)?(e.$message=f.errors.beginChars,e.$setValidity(d.name,!1),!1):!0},i=function(){return!0},j=function(){var a=$(c).val();h(a)&&i(a,"")&&(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(j,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("firstNameInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.firstNameInput,g=null,h=function(){var a=$(c).val();-1!==a.indexOf(".")||-1!==a.indexOf("_")||-1!==a.indexOf("-")?(e.$message=f.errors.invalidChars,e.$setValidity(d.name,!1)):0===a.length?(e.$message=f.errors.tooShort,e.$setValidity(d.name,!1)):(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(h,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("lastNameInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.lastNameInput,g=null,h=function(){var a=$(c).val();-1!==a.indexOf(".")||-1!==a.indexOf("_")||-1!==a.indexOf("-")?(e.$message=f.errors.invalidChars,e.$setValidity(d.name,!1)):0===a.length?(e.$message=f.errors.tooShort,e.$setValidity(d.name,!1)):(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(h,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("zipCodeInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.zipCodeInput,g=null,h=function(){var a=$(c).val();isNaN(a)?(e.$message=f.errors.invalidChars,e.$setValidity(d.name,!1)):a.length>5?(e.$message=f.errors.tooLong,e.$setValidity(d.name,!1)):(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(h,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("firstName",function(){return{require:"ngModel",link:function(a,b,c,d){var e=/[^\x00-\x7F]+/,f=function(a){return a?0===a.length||a.length>15?(d.$setValidity(c.name,!1),a):a.length>0&&a.match(e)?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a):(d.$setValidity(c.name,!1),a)};a.$watch(c.ngModel,f),d.$parsers.unshift(f)}}}).directive("lastName",function(){return{require:"ngModel",link:function(a,b,c,d){var e=/[^\x00-\x7F]+/,f=function(a){return a?0===a.length||a.length>25?(d.$setValidity(c.name,!1),a):a.length>0&&a.match(e)?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a):(d.$setValidity(c.name,!1),a)};a.$watch(c.ngModel,f),d.$parsers.unshift(f)}}}).directive("zipCode",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){var b=/^[0-9]{5}$/;return a&&a.length>0&&!a.match(b)?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a)};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("optimumId",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){return a.length<4?(d.$setValidity(c.name,!1),void 0):a.length>14?(d.$setValidity(c.name,!1),void 0):"."===a[0]||"-"===a[0]||"_"===a[0]?(d.$setValidity(c.name,!1),void 0):"."===a[a.length-1]||"-"===a[a.length-1]||"_"===a[a.length-1]?(d.$setValidity(c.name,!1),void 0):(d.$setValidity(c.name,!0),a)})}}}).directive("password",["$filter",function(a){var b=function(b){return b.length>=8&&!isRepetitionOrSequence(b)&&!/[^a-zA-Z0-9$]/.test(b)&&a("passwordStrength")(b).percent<38};return{require:"ngModel",link:function(a,c,d,e){c.on("paste",function(a){var c;a.originalEvent.clipboardData?c=(a.originalEvent||a).clipboardData.getData("text/plain"):window.clipboardData&&(c=window.clipboardData.getData("text")),f("pasteEvent",a,c),e.$setValidity("repeatedSequential",!isRepetitionOrSequence(c)),e.$setValidity("strength",!b(c))}),c.bind("keydown",function(b){var c=void 0===a.password?a.model.password:a.password.password;f("keyEvent",b,c)}),c.on("keyup",function(){var a=$(c).val();e.$setValidity("repeatedSequential",!isRepetitionOrSequence(a)),e.$setValidity("strength",!b(a))});var f=function(b,c,d){var f=!1,g=/^[a-zA-Z0-9_]*$/;"number"==typeof this.selectionStart&&this.selectionEnd-this.selectionStart>0&&(f=!0);var h=d.length,i=c.keyCode?c.keyCode:c.which;if((h>=32&&"keyEvent"===b||h>32&&"pasteEvent"===b)&&!f){if(!(i>=35&&40>=i||46===i||8===i||9===i))return"keyEvent"===b&&c.preventDefault(),d.match(g)&&("keyEvent"===b?a.showMaxLengthMsg=!0:e.$setValidity("maxlength",!1)),setTimeout(function(){a.showMaxLengthMsg=!1},2e3),!1;8!==i&&46!==i||33!==h||"keyEvent"!==b||e.$setValidity("maxlength",!0)}else a.showMaxLengthMsg=!1,e.$setValidity("maxlength",!0)};e.$parsers.unshift(function(b){var c=/^[a-zA-Z0-9_]*$/;return void 0!==b&&b.match(c)?(targetInput=void 0===a.password?a.model.confirmPassword:a.password.passwordMatch,b===targetInput?(e.$setValidity(d.name,!0),a.resetPassword?a.resetPassword.confirmPassword.$setValidity("confirmPassword",!0):a.changePasswdForm?a.changePasswdForm.passwordMatch.$setValidity("passwordMatch",!0):a.secondaryIdForm?a.secondaryIdForm.confirmPassword.$setValidity("confirmPassword",!0):a.customerInfoForm?a.customerInfoForm.confirmPassword.$setValidity("confirmPassword",!0):a.resetPasswordForm&&a.resetPasswordForm.confirmPassword.$setValidity("confirmPassword",!0),b):(e.$setValidity(d.name,!0),b)):(e.$setValidity(d.name,!1),b)})}}}]).directive("alphanumeric",function(){return{require:"ngModel",link:function(a,b,c,d){b.on("keyup",function(){var a=$(b).val(),c=/[^a-zA-Z0-9$]/;return d.$setValidity("alphanumeric",!c.test(a)),a}),b.on("paste",function(a){var b;a.originalEvent.clipboardData?b=(a.originalEvent||a).clipboardData.getData("text/plain"):window.clipboardData&&(b=window.clipboardData.getData("text"));var c=/[^a-zA-Z0-9$]/;return d.$setValidity("alphanumeric",!c.test(b)),b})}}}).directive("numericOnly",function(){return{require:"ngModel",link:function(a,b,c,d){b.on("input",function(){var b=this;b.value.match(/\D/)&&a.$apply(function(){b.value=b.value.replace(/\D/g,"")})}),d.$parsers.unshift(function(a){return a?a.replace(/[^0-9]/g,""):a})}}}).directive("allowNumericOnly",function(){return{restrict:"A",link:function(a,b){b.on("keydown",function(a){return 64===a.which||16===a.which?!1:a.which>=48&&a.which<=57?!0:a.which>=96&&a.which<=105?!0:[8,13,27,37,38,39,40].indexOf(a.which)>-1?!0:(a.preventDefault(),!1)})}}}).directive("email",function(){return{require:"ngModel",link:function(a,b,c,d){var e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=function(a){return a?a.match(e)?(d.$setValidity(c.name,!0),a):(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a)};a.$watch(c.ngModel,f),d.$parsers.unshift(f)}}}).directive("altEmail",function(){return{require:"ngModel",link:function(a,b,c,d){var e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=function(b){if(b){if(b.length>0&&!b.match(e))return d.$setValidity(c.name,!1),b;if(b.toLowerCase()===a.optimumIdEmail.toLowerCase())return d.$setValidity(c.name,!1),b}return d.$setValidity(c.name,!0),b};a.$watch(c.ngModel,f),d.$parsers.unshift(f)}}}).directive("formatPhone",["$filter",function(a){return{require:"ngModel",link:function(b,c,d,e){c.on("input paste keyup",function(a){var b=a.keyCode?a.keyCode:a.which,c=this.value,d=null,f=!1,h=null,i=null;if("number"==typeof this.selectionStart&&this.selectionEnd-this.selectionStart>0&&(f=!0),h=4===this.selectionStart||8===this.selectionStart?this.selectionStart+1:this.selectionStart,i=4===this.selectionEnd||8===this.selectionEnd?this.selectionEnd+1:this.selectionEnd,!(b>=35&&40>=b||46===b||b>=8&&9>=b||f)){if(d=c.replace(/[^\d]/g,""),d.length>3&&d.length<6?c=d.substr(0,3)+" "+d.substring(3):d.length>6&&(c=d.substr(0,3)+" "+d.substr(3,3)+"-"+d.substr(6,4)),this.value=c,this.createTextRange){var j=this.createTextRange();j.moveEnd("character",i),j.moveStart("character",h)}else this.setSelectionRange&&this.setSelectionRange(h,i);g(this.value)}e.$setViewValue(this.value)});var f=function(b){return a("phoneFilter")(b)},g=function(b){if(b){var c=/\d{3}[ ]\d{3}[-]\d{4}/;return 10===b.length&&(b=a("phoneFilter")(b)),c.test(b)?(e.$setValidity(d.name,!0),b):(e.$setValidity(d.name,!1),b)}return e.$setValidity(d.name,!0),b};b.$watch(d.ngModel,g),e.$parsers.unshift(g),e.$formatters.push(f)}}}]).directive("phone",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){return a?isNaN(a)?(d.$setValidity(c.name,!1),a):a.length>0&&10!==a.length?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a):void 0};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("altPhone",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){if(a&&a.length>0){if(isNaN(a))return d.$setValidity(c.name,!1),a;if(10!==a.length)return d.$setValidity(c.name,!1),a}return d.$setValidity(c.name,!0),a};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("accountIdFormat",["textMaskDirective",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=function(a){return a.length>0&&"0"!==a[0]?[/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/]:[/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/]};b.textMask={mask:f,placeholderChar:" ",guide:!1},a[0].link(b,c,d,e),e.$parsers.unshift(function(a){var b=0;if(void 0===a)return e.$setValidity(d.name,!1),e.$setValidity("minlength",!0),a;if(a=a.replace(/-/g,""),a.length<12&&"0"!==a[0])return e.$setValidity("minlength",!1),e.$setValidity(d.name,!0),a;if(a.length<13&&"0"===a[0])return e.$setValidity("minlength",!1),e.$setValidity(d.name,!0),a;for(var c=a.split("-").join(""),f=0;f<c.length;f++)c[f]>=0&&c[f]<=9||(b=1);return 1===b?(e.$setValidity(d.name,!1),a):0===b?c.length>=13&&"0"!==c[0]||c.length>=14&&"0"===c[0]?(e.$setValidity("maxlength",!1),e.$setValidity(d.name,!1),a):12===c.length&&"0"!==c[0]||"0"===c[0]&&13===c.length?(e.$setValidity("maxlength",!0),e.$setValidity("minlength",!0),e.$setValidity(d.name,!0),a):(e.$setValidity("minlength",!0),e.$setValidity(d.name,!0),a):(e.$setValidity(d.name,!0),a)})}}}]).directive("validationMsg",function(){return{template:["<div ng-transclude><div>"].join(""),restrict:"A",replace:!0,transclude:"element",scope:{messages:"=messages",inputElement:"@validationMsg",showHint:"@showHint",delay:"@delay"},link:function(a,b,c){if(!c.validationMsg)throw"[Form-tools: validationMessage] validationMsg has no form input defined";var d=c.validationMsg.split("."),e=d.shift(),f=b.closest("[name='"+e+"']").find("[name='"+d.pop()+"']"),g=a.$parent.$eval(c.validationMsg),h=a.$parent.$eval(e);if(!g)throw"[Form-tools: validationMessage] validationMsg specifies an invalid input element";if(!a.messages)throw"[Form-tools: validationMessage] 'messages' is not valid";var i=null,j=a.messages.errors?a.messages.errors:{},k=a.messages.hint,l=a.messages.defaultError,m=a.messages.success,n=c.delay?parseInt(c.delay,10):750;a.$$nextSibling.message={value:"",type:void 0},void 0!==c.showHint&&(i=setTimeout(function(){o(k,"hint")},50));var o=function(b,c){a.$$nextSibling.message&&(a.$$nextSibling.message.type=c,a.$$nextSibling.message.value=b,a.$$phase||a.$$nextSibling.$digest())},p=function(){a.showHint=!1;var b=g.$viewValue.split("-").join("");if(g.$invalid){var c=l;for(var d in j)g.$error[d]&&g.$dirty&&(c=j[d]);if(g.$dirty&&g.$error.maxlength&&g.$error.password&&j.maxlength?c=j.maxlength:g.$dirty&&(g.$error.maxlength||b.length>=13&&"0"!==b[0]||g.$error.maxlength||b.length>=14&&"0"===b[0])&&j.maxlength&&"accountNumber"===g.$name&&(c=j.maxlength),"accountNumber"===g.$name)for(var e=0;e<b.length;e++)if(!(b[e]>=0&&b[e]<=9||"-"===b[e])){c=j.alphanumeric;break}o(c,"error")}else if("accountNumber"===g.$name)for(var f=0,h=0;h<g.$viewValue.length;h++)if(f="0"!==b[0]&&12===b.length?0:"0"===b[0]&&13===b.length?0:1,1===f)for(var i in b)b[i]>=0&&b[i]<=9||"-"===b[i]?"0"!==b[0]&&b.length>=13||"0"===b[0]&&b.length>=14?o(a.messages.errors.maxlength,"error"):"0"===b[0]&&b.length<=12&&o(a.messages.errors.minlength,"error"):o(a.messages.errors.alphanumeric,"error");else o(m,"success");else o(m,"success")};f.bind("focus",function(){g.$wasFocused=!0,o(k,"hint")}),f.bind("input keyup paste",function(){null!==i&&clearTimeout(i),g.$wasFocused&&o(k,"hint"),i=setTimeout(p,n)}),f.bind("keydown",function(){null!==i&&clearTimeout(i),g.$wasFocused&&o(k,"hint"),i=setTimeout(p,n)}),g.showValidationMsg=function(a,b){null!==i&&clearTimeout(i);var c=function(){a?o(k,"hint"):p()};i=setTimeout(c,b?b:n)},h.showValidationMsgs||(h.showValidationMsgs=function(a){var b=function(c){c&&c.showValidationMsg&&c.showValidationMsg.call(c,a),_.each(_.filter(c,function(a){return"object"==typeof a}),b)};_.each(h,b)})}}}).directive("autoTabOn",function(){return{restrict:"A",name:"autoTabOn",replace:!1,transclude:!1,scope:{tabPredicate:"&autoTabOn"},link:function(a,b){if("input"!==b[0].localName.toLowerCase())throw"AutoTabOn can only be applied to an input element";if(!b.attr("tabIndex"))throw"AutoTabOn requires the tabIndex attribute to be set";a.elementFocused=!1,a.elementSelected=!1,b.focus(function(){a.elementFocused=!0}),b.blur(function(){a.elementFocused=!1}),b.select(function(){a.elementSelected=!0}),b.keyup(function(c){var d=48;if(c.which>=d&&a.elementFocused)if(!a.elementSelected&&a.tabPredicate()){var e=parseInt(b.attr("tabIndex"),10)+1,f=angular.element('[tabIndex*="'+e+'"]');0!==f.length&&(f.focus(),f.select())}else a.elementSelected=!1})}}}).directive("ngFocus",["$parse",function(a){return function(b,c,d){var e=a(d.ngFocus);c.on("focus",function(a){b.$apply(function(){e(b,{$event:a})})})}}]).directive("ngBlur",["$parse",function(a){return function(b,c,d){var e=a(d.ngBlur);c.on("blur",function(a){b.$apply(function(){e(b,{$event:a})})})}}]);var isRepetitionOrSequence=function(a){var b=/(.)\1{3,}/;if(a.length>7){var c=a.toLowerCase().split("");if(a.toLowerCase().match(b))return!0;for(var d=3;d<a.length;d++){if(c[d].charCodeAt(0)===c[d-3].charCodeAt(0)+3&&c[d].charCodeAt(0)===c[d-2].charCodeAt(0)+2&&c[d].charCodeAt(0)===c[d-1].charCodeAt(0)+1)return!0;if(c[d].charCodeAt(0)===c[d-3].charCodeAt(0)-3&&c[d].charCodeAt(0)===c[d-2].charCodeAt(0)-2&&c[d].charCodeAt(0)===c[d-1].charCodeAt(0)-1)return!0}}return!1};angular.module("gadgetCarousels",["dots","if","dvrRecord","ellipsis","poster","imgAlt","hover","isViewportSize"]).directive("carouselGadget",["$timeout","limitToFilter","isViewportSize",function(a,b,c){return{restrict:"AE",scope:{showHide:"=show",localItems:"=items",showMock:"=mock",isLazy:"=lazy",positionWithPosition:"=positionWithPosition",isIndented:"=indent",extraIndent:"=extraIndent",maxSets:"=maxSets",scrollByPixels:"=scrollByPixels",type:"=type"},transclude:!0,replace:!1,templateUrl:"/parts/gadget-carousels/gadget-carousels-template.html",link:function(d,e){function f(){nb(),mb&&(P.items=P.generateMockElements(),ab=P.items.length),p(),d.$emit("carouselEvent",{eventName:"load",eventTarget:$(e)}),k()?(R.addClass("art"),R.removeClass("block"),P.isArtwork=!0):(R.addClass("block"),R.removeClass("art"),P.isArtwork=!1),N(),i()}function g(){console.log("mock: test callback action")}function h(){var a=!1;(d.localItems[0]!==d.items[0]||d.localItems.length<d.items.length)&&(a=!0),P.items=P.localItems,N(),i(),a&&M()}function i(){var a;try{delete P.maxItems}catch(b){}if(null!==(a=l())){var c=0,d=0,e=u();_.each(P.items,function(b,f){return c+=b.itemWidth||140,c>e&&(d++,c=c-(k()?28:0)<=e?0:b.itemWidth||140),d>=a?(P.maxItems=f,!1):void 0})}}function j(){a(function(){var a,b=R.width();k()?(P.isArtwork=!0,R.addClass("art"),R.removeClass("block"),angular.isNumber(b)&&b>100&&(a=P.getLimitedItems().length*R.find(".item").outerWidth(!0))>10?S.width(a+10+"px"):S.width(""),S.height()<R.find(".poster").height()&&(S.css("height",R.find(".poster").height()),U.css("top",0),V.css("top",0))):(P.isArtwork=!1,R.addClass("block"),R.removeClass("art"),S.width(""),S.css("max-height",ib)),p()})}function k(){var a=!1;return"block"===P.type?!1:"art"===P.type?!0:($.each(P.items,function(b,c){return c.artwork?(a=!0,!1):void 0}),a)}function l(){var a=P.maxSets;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)&&a>0?a:null}function m(a){return parseInt(a.toString().match(/-(\d+)$/)[1],10)}function n(a,b){if(a.attr("id")){var c=P.getLimitedItems()[m(a.attr("id"))];return b===!0?c.secondItem.action:c.action}console.warn("warning, item.attr(id) is undefined")}function o(a){return P.getLimitedItems()[m(a.parents(".item").attr("id"))].buttons[a.attr("value")].action}function p(){jb=P.isIndented?0===P.getLimitedItems().length?[]:new Array(1+Math.ceil((S.width()-z(y()))/u())):0===P.getLimitedItems().length?[]:new Array(Math.ceil(S.width()/u())),d.dots=jb}function q(a,b){var c=!0;if(void 0===$(R.find(".item")[E()+1]).offset()&&"next"===a&&(c=!1,R.removeClass("show-next-ui")),kb===!0&&"previous"===a&&(R.removeClass("show-prev-ui"),c=!1),c===!0){var d="first"===a?0:"next"===a?F():H();K()&&P.isIndented?y():0,(lb===d||d>lb-200)&&0!==lb&&"next"===a&&0!==d&&(d=2*lb),S.animate({left:d},hb,"swing",function(){"function"==typeof b&&setTimeout(function(){b()},hb)}),lb=d,"next"===a&&(P.currentSet++,C(E()+1)),"previous"===a&&(P.currentSet--,P.currentSet<0&&(P.currentSet=1),C(E(!0)))}}function r(){isMobile()||(K()?(R.removeClass("show-prev-ui"),L()?R.removeClass("show-next-ui"):R.addClass("show-next-ui")):kb===!0?(R.removeClass("show-prev-ui"),R.addClass("show-next-ui")):L()?(R.addClass("show-prev-ui"),R.removeClass("show-next-ui")):void 0===$(R.find(".item")[E()+1]).offset()?(R.removeClass("show-next-ui"),R.addClass("show-prev-ui")):(R.addClass("show-prev-ui"),R.addClass("show-next-ui")),eb=!0),isMobile()&&(K()?(R.removeClass("show-prev-ui"),L()?R.removeClass("show-next-ui"):R.addClass("show-next-ui")):kb===!0?(R.removeClass("show-prev-ui"),R.addClass("show-next-ui")):L()?(R.addClass("show-prev-ui"),R.removeClass("show-next-ui")):void 0===$(R.find(".item")[E()+1]).offset()?(R.removeClass("show-next-ui"),R.addClass("show-prev-ui")):(R.addClass("show-prev-ui"),R.addClass("show-next-ui")),eb=!0)}function s(){eb&&r()}function t(){R.css("left",0),R.width(u()),R.removeClass("indented")}function u(){return P.isIndented?$(window).width()-$(e).position().left:$(e).offsetParent().width()-$(e).position().left}function v(){P.isIndented&&(R.css("left",y()),R.width(z(y())),R.addClass("indented"),S.css("left",0))}function w(){var a=u();R.width(!isNaN(a)&&a>1?a:"")}function x(){return R.hasClass("indented")}function y(){return T[P.positionWithPosition?"position":"offset"]().left+(angular.isNumber(P.extraIndent)?P.extraIndent:0)}function z(a){return u()-a}function A(){return x()?u()-y():angular.isNumber(d.scrollByPixels)?u()-$(R.find(".item")[Y]).offset().left:u()}function B(a){var b=0,c=-1,d=0,e=$(R.find(".item")),f=Y;if(e.size()*e.outerWidth(!0)>u())for(;Math.round(b)<A()&&c!==b&&-1!==f;)c=b,b+=$(e[f]).outerWidth(!0),d++,f=a?f-=1:f+=1;return d-1}function C(a){try{var b=d.localItems[a].maintitle+d.localItems[a].title;setTimeout(function(){angular.element('div[data-title="'+b+'"]').siblings().hide(),angular.element('div[data-title="'+b+'"]').show()},500),angular.element('li[data="'+b+'"]').siblings().removeClass("active"),angular.element('li[data="'+b+'"]').addClass("active")}catch(c){}Y=a}function D(){return Y}function E(a){var b,c=R.find(".item");b=a?$(c[D()-B(a)]).index():$(c[B()-1+D()]).index();try{d.localItems[b].maintitle+d.localItems[b].title,Z=b+1,0===bb&&(db=b+1,cb=Z)}catch(e){}return b}function F(){return K()&&P.isIndented?-1*(G()-y()):J()+-1*G()}function G(){var a=$(R.find(".item")[E()+1]).offset().left,b=$(e).position().left,c=a-b;return Z===cb?(a=c,bb=Z,cb=0):db===Z&&(a=c),P.isIndented||(a-=$(R).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(A()/d.scrollByPixels)),console.log("return part"+a),a}function H(){return J()+Math.abs(I())}function I(){var a=$(R.find(".item")[E(!0)]).offset().left;return P.isIndented||(a-=$(R).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(Math.max(0,A())/d.scrollByPixels)),a}function J(){return $(R).find(".slide")[P.isIndented?"offset":"position"]().left}function K(){return 1===P.currentSet}function L(){return P.currentSet===jb.length}function M(){q("first",function(){P.currentSet=1,C(0)})}function N(){K()&&P.isIndented?v():P.isIndented?t():w(),j(),a(s,hb)}var O=500,P=d,Q=$(e).attr("id"),R=$(e).find(".carousel"),S=$(e).find(".slide");$(e).find(".item");var T=$(e).find(".dots"),U=$(e).find(".carousel-next"),V=$(e).find(".carousel-prev"),W=0;P.currentSet=1;var X,Y=0,Z=0,ab=0,bb=0,cb=0,db=0,eb=!1,fb=!1,gb="",hb=200,ib=60,jb=[],kb=!1,lb=0,mb=P.showMock?parseInt(P.showMock,10):!1;P.items=[],P.load=function(){};var nb=function(){function a(a){l=a.touches[0].clientX,m=a.touches[0].clientY}function b(a){V.unbind("touchmove"),V.unbind("touchend"),Math.abs(l-j)>maxMove||Math.abs(m-k)>maxMove||d.$apply(function(){fn(d,{$event:a})})}var f=function(a){var b=$(a.target),d={targetElem:b,clickedItem:b.is("li")?b:b.parents(".item"),clickedBtn:b.is("button")?b:b.closest("button").length>0?b.closest("button"):!1,clickedDVRRecord:b.is("dvr-record, [dvr-record]")||b.closest("dvr-record, [dvr-record]").length>0?b:!1,clickedInfoBlock:b.is(".info-block")?b:b.closest(".info-block")};if(d.clickedSecondItem=d.clickedInfoBlock.prev().is(".info-block"),d.clickedItem){if(isMobile()&&!fb&&!c.phone&&gb!==d.clickedItem.attr("id"))return gb=d.clickedItem.attr("id"),void 0;isMobile()&&!fb?X=setTimeout(function(){g(a,d)},O):isMobile()||fb||g(a,d)}},g=function(a,b){b.clickedDVRRecord||(!b.clickedBtn&&n(b.clickedItem,b.clickedSecondItem)&&angular.isFunction(n)?n(b.clickedItem,b.clickedSecondItem)():b.clickedBtn&&o(b.clickedBtn)&&angular.isFunction(o)&&o(b.clickedBtn)()),d.$emit("carouselEvent",{eventName:"click",eventTarget:a.target})};e.bind("click",function(a){f(a)}),P.isPast=function(a){return angular.isDate(a)&&a.getTime()<(new Date).getTime()},$(window).resize(function(){P.$apply(function(){N()})}),$(e).mouseover(function(){r()}),r(),$(e).mouseout(function(){}),V.click(function(a){q("previous",function(){$(a.target).hasClass("icon-arrow-left")?parseInt($(a.target).parent().next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):$(a.target).hasClass("half-circle--left")?parseInt($(a.target).next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):kb=!1,R.addClass("show-next-ui")})}),U.click(function(){q("next",function(){kb=!1,R.addClass("show-prev-ui")})});var j,k,l,m;V.bind("touchstart",function(c){c.preventDefault(),q("previous",function(){$(c.target).hasClass("icon-arrow-left")?parseInt($(c.target).parent().next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):$(c.target).hasClass("half-circle--left")?parseInt($(c.target).next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):(kb=!1,R.addClass("show-prev-ui")),R.addClass("show-next-ui")}),j=l=c.touches[0].clientX,k=m=c.touches[0].clientY,V.bind("touchend",b),V.bind("touchmove",a)}),U.bind("touchstart",function(c){c.preventDefault(),q("next",function(){kb=!1}),j=l=c.touches[0].clientX,k=m=c.touches[0].clientY,V.bind("touchend",b),V.bind("touchmove",a)}),P.$watch("localItems",function(a){a&&(ab=d.localItems.length,setTimeout(function(){P.$apply(p)},100),h())}),P.$watch("localItems.length",function(a){a&&h()}),P.$watch("showHide",function(){d.showHide===!0?($(e).removeClass("hidden"),N()):$(e).addClass("hidden")}),P.$watch("isIndented",function(){N(),i()}),P.onScroll=function(a,b,c){d.$emit("carouselEvent",{carouselId:Q,eventName:"scroll",eventTarget:R.find(".item")[a],offset:b,offsetDelta:b-W-c}),W=b}};P.generateMockElements=function(){var a=[];switch(mb){case 1:for(var b=1;20>=b;b++)a.push({id:"item",action:g,artwork:"/parts/carousels/images/art"+b+".jpg",info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]});
break;case 2:for(;20>=b;b++)a.push({id:"item",action:g,itemWidth:getRandomInt(10,200),info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]})}return a},P.getLimitedItems=function(){return angular.isNumber(P.maxItems)?b(P.items,P.maxItems):P.items},f()}}}]);var maxHistoryURLSize=5;angular.module("homeModules",["bestBets","wifiService","phoneService","miniGuideResource","onDemandResource","webdvrResource","spinner","checkbox","ellipsis","oolCookie","poster","ctaArrowLink","isViewportSize","config","dvrRecordingModel","onetCookies"]).directive("homeModule",["$rootScope","Config","BestBets","Wifi","Phone","MiniGuide","OnDemand","WebDVR","ooluser","$filter","$timeout","isViewportSize","recordingModel","Cookies",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return{restrict:"A",scope:{type:"=moduleType",active:"=",webmail:"=",imsemailresponse:"="},replace:!0,templateUrl:"/parts/home-modules/home-modules-template.html",link:function(a,d){var f=a,j=$(d).find(".dropdown-module-prefs");$(d).find(".module-select");var m,o,p=500,q=5e3;a.showLink=!0,a.openExchangeMail=!1,f.module={},f.module.initialized=!1,f.module.noEntitlement=!1,f.module.loading=!1,f.module.error=!1,f.module.isLabox=i.hasOOLSession?i.laBoxUser||i.laboxOrMini:"true"===n.getCookie("labox"),f.isViewportSize=l;var r=[{selected:!1,id:"voiceMail",title:"Voicemail"},{selected:!1,id:"onDemand",title:"On Demand"},{selected:!1,id:"wifiUsage",title:"WiFi"},{selected:!1,id:"webMail",title:"Email"},{selected:!1,id:"myServices",title:"My services"},{selected:!1,id:"cart",title:f.module.isLabox?"Favorites":"Cart"},{selected:!1,id:"onTonight",title:"TV best bets"},{selected:!1,id:"dvr",title:"DVR"}];if(i.p&&"inactive"===i.p.mus)for(var s=0;s<r.length;s++)"webMail"===r[s].id&&r.splice(s,1);var t={corpId:"",hasSession:!1,optimumId:"",inbox:[],hasService:{internet:!1,eMail:!1,phone:!1,tv:!1,dvr:!1}},u=["answered","flagged","draft","deleted","seen","forwarded","unseen"];f.$watch("active",function(){for(var a in f.active)f.active.hasOwnProperty(a)&&(a===f.type&&f.active[a]?($(d).addClass(f.active[a]),$(d).removeClass("hidden"),f.module.initialized?A():B()):a!==f.type||f.active[a]?f.active[a]&&(o=a):($(d).addClass("hidden"),$(d).removeClass("left right")));A()},!0),j.click(function(){$(this).find(".menu").show()}),j.mouseleave(function(){m=setTimeout(function(){j.find(".menu").hide()},p)}),j.find(".menu").mouseenter(function(){m&&clearTimeout(m)});var v=function(d){var j=f.module;j.id=d,window.location.host;var l=b.getValuesBySelector("*").link.webmail;switch(d){case"wifiUsage":j.displayStyle="wifi",j.hasWifiUsage=!1,j.service="Optimum Wifi",j.title="Stay connected",j.mobileTitle="Stay connected",j.link={mobileTitle:"Learn more",title:"Learn more",href:"/pages/covid-19.html"};break;case"onDemand":j.displayStyle="artwork",j.service="Optimum TV",j.title="On Demand",j.mobileTitle="On Demand",j.link={title:"All titles",mobileTitle:"All Titles",href:"/tv/asset/"},j.loading=!0,j.items=[],g.getNewlyOnDemand(function(a){if(a.assets){for(var b=0,c=3;c>b;b++)a.assets[b]&&j.items.push({title:a.assets[b].title,artwork:a.assets[b].getArtwork(),href:"/tv/asset/#/movie/"+a.assets[b].id});j.loading=!1}else j.error=!0},function(){j.error=!0});break;case"voiceMail":j.displayStyle="list",j.title="Voicemail",j.service="Optimum Voice",j.linkMoreInfo="/support/phone",j.link={title:"All messages",mobileTitle:"Go to Voicemail",href:b.getValuesBySelector("*").link.basePhoneMenuUrl+"/Voicemail"},t.hasService.phone||(a.showLink=!1),j.loading=!0,j.items=[],e.getStatus().then(function(a){if(j.noEntitlement=!1,a.data){var b=a.data.count;j.mobileCount=b,j.mobileCountMessage=a.data.status,j.mobileIcon="icon-phone",j.loading=!1,j.items=0===b?null:[!0]}},function(a){console.error(a),j.error=!0,j.loading=!1});break;case"webMail":j.displayStyle="list",j.title="Email",j.mobileTitle="Email",j.service="Optimum Email",j.link={},j.holdEntitlement=!1,j.emailsProcessed=!1,j.imsResponseProcessed=!1;var m=function(){j.imsemailresponse=f.imsemailresponse,j.hasinternetservice=t.hasService.internet,j.error=!1,j.noEntitlement=!1,j.holdEntitlement=!1;var a={title:"Get a mailbox",mobileTitle:"Get a mailbox",href:"/profile/household-ids",message:"You currently do not have an Optimum email account.",submessage:"As an Optimum online subscriber, creating one is free. And easy"};i.hasOOLSession&&i.p&&(null!==i.p.mus?"active"===i.p.mus?(j.noEntitlement=!1,j.link={title:"Open email box",mobileTitle:"Open inbox",href:l}):"hold"===i.p.mus?(j.holdEntitlement=!0,j.link={message:"User account temporarily unavailable for system maintenance."}):"inactive"===i.p.mus?(j.noEntitlement=!0,j.link=a):"disabled"===i.p.mus?(j.noEntitlement=!0,j.link=a):"deleted"===i.p.mus?(j.noEntitlement=!0,j.link=a):(j.error=!0,j.link={title:"Open email box",mobileTitle:"Open inbox",href:l},j.loading=!1):(j.error=!0,j.link={title:"Open email box",mobileTitle:"Open inbox",href:l},j.loading=!1)),j.imsResponseProcessed=!0,z()},n=function(){if(j.loading=!0,$.isEmptyObject(f.webmail))j.error=!0,j.link={title:"Open email box",mobileTitle:"Open inbox",href:l},j.loading=!1;else{var a=f.webmail;if(a.wasSuccessful&&a.webmail)for(var b=0,c=a.webmail.length;c>b;b++)j.items.push({leftColumn:a.webmail[b].subject,rightColumn:a.webmail[b].date,status:a.webmail[b].status&&_.contains(u,a.webmail[b].status)?a.webmail[b].status:"",link:a.webmail[b].link});j.mobileCount=a.messageCount,j.mobileIcon="icon-envelope-alt",j.webmailDateFormat=a.dateFormat,j.emailsProcessed=!0,m()}};t.hasService.internet?i.hasOOLSession?(j.items=[],f.$watch("webmail",n,!0),k(function(){j.emailsProcessed=!0},q)):(j.error=!0,j.link={title:"Open email box",mobileTitle:"Open inbox",href:l},j.loading=!1):(j.noEntitlement=!0,j.link={title:"Learn more",mobileTitle:"Learn more",href:"https://www.optimum.net/support/contact-us",message:"You currently do not have an Optimum email account."},j.loading=!1);break;case"cart":j.displayStyle="artwork",j.title=f.module.isLabox?"Favorites":"Cart",j.service="Optimum TV",j.link={title:"All titles",mobileTitle:"All titles",href:f.module.isLabox?"/tv/favorites/":"/tv/cart/"},t.hasService.tv?(j.loading=!0,j.items=[],g.MovieCart.getItems(function(a){if(a.assets){for(var c=0;3>c;c++)a.assets[c]&&j.items.push({artwork:b.getValuesBySelector("endpoint.api.vodimage")+a.assets[c].id+"?deviceName=iPad&artName=VOD%20-%20POSTERS",href:f.module.isLabox?"/tv/favorites/":"/tv/cart/"});j.mobileCount=a.ids.length}else j.mobileCount=0;j.mobileIcon=f.module.isLabox?"onet-icons-heart-full":"icon-shopping-cart",j.loading=!1},function(a){console.error(a),j.error=!0},!0,6)):j.noEntitlement=!0;break;case"onTonight":j.displayStyle="list",j.title="TV best bets",j.mobileTitle="TV best bets",j.service="Optimum TV",j.link={title:"All shows",mobileTitle:"Channel Guide",href:"/tv/guide"},j.loading=!0,j.items=[],c.getOnTonight().then(function(a){var b=a.data;_.each(b,function(a,b){if(4>b){var c=moment(a.time,"YYYY-MM-DD HH:mm:ss");j.items.push({leftColumn:a.title,rightColumn:c.format("h:mma")})}}),j.items.length?j.loading=!1:j.error=!0},function(a){j.error=!0,console.error(a)});break;case"dvr":j.displayStyle="list",j.title="DVR",j.service="Optimum TV",t.hasService.dvr?(j.loading=!0,j.items=[],f.dvrLimit=4,h.queryMultipleDVRs(f.dvrLimit,function(a){a=_.sortBy(a,function(a){return a.Program.StartTime}).reverse(),_.each(a,function(a){j.items.push({leftColumn:a.Title,rightColumn:moment(a.Program.StartTime).format("MM[/]DD")})}),j.loading=!1},function(){j.error=!0,j.loading=!1}),j.link={title:"All scheduled recordings",mobileTitle:"All Recordings",href:"/tv/dvr/#/scheduled"}):(j.noEntitlement=!0,j.link={title:"Learn more",mobileTitle:"Learn more",href:"/FAQ#/answers/a_id/2580"});break;case"myServices":j.displayStyle="list",j.title="My services",j.linkMoreInfo="",j.link={mobileTitle:"See offers",title:"See my offers and upgrades",href:"/upgrades#/"},angular.forEach(HomeCtrl.myServices,function(a){"Internet"===a.serviceName?j.internetServiceLevel=a.serviceLevel:"TV"===a.serviceName?j.tvServiceLevel=a.serviceLevel:"Phone"===a.serviceName&&(j.phoneServiceLevel=a.serviceLevel)}),j.hasInternetService=t.hasService.internet,j.hasTvService=t.hasService.tv,j.hasPhoneService=t.hasService.phone}},w=function(){return moment().format("h:mm a")},x=function(){$.each(r,function(a,b){b.id===f.type?b.selected=!0:b.id===o?b.opposite=!0:b.opposite&&delete b.opposite}),f.module.menuItems=r},y=function(){var a=t;i.hasOOLSession&&(a.isPrimary=i.primary,a.hasSession=!0,a.optimumId=i.optimumId,a.corpId=i.corpId||"",a.hasService={internet:"undefined"==typeof i.m2m?i.ool:i.ool&&!i.m2m,eMail:1===i.p.email?!0:!1,phone:i.ov,tv:i.io,dvr:i.p?i.p.dvr&&1===i.p.dvr?!0:!1:!1})},z=function(){"webMail"===f.type?f.module.emailsProcessed&&f.module.imsResponseProcessed&&(f.module.loading=!1):f.module.loading=!1};f.module.select=function(a){var b=!0;f.module.id===a&&(b=!1),f.$emit("moduleEvent",{eventName:"module-select",oldModule:f.module.id,newModule:a})};var A=function(){x()},B=function(){y(),v(f.type),f.module.timestamp=w(),x(),f.module.initialized=!0}}}}]),function(){var a=[];angular.module("hover",["isViewportSize"]).directive("hoverOn",["$parse","isViewportSize",function(b,c){return function(d,e,f){var g=b(f.hoverOn),h=function(a){d.$apply(function(){g(d,{$event:a})})};e.on("mouseenter",h),c.tablet&&e.swipe({tap:function(){var b=_.find(a,{element:e[0]});angular.isObject(b)&&(b.hovered=!0),h.apply(this,Array.prototype.slice.apply(arguments))}})}}]).directive("hoverOff",["$parse","isViewportSize",function(b,c){return isMobile()&&!c.phone&&$(document.documentElement).swipe({tap:function(b){var c=this;_.each(_.filter(a,{hovered:!0}),function(a){var d=$(b.target),e=$(a.element);d.is(e)||$.contains(a.element,b.target)||(a.hovered=!1,a.callback.call(c,b))})}}),function(d,e,f){var g=b(f.hoverOff),h=function(a){d.$apply(function(){g(d,{$event:a})})};e.on("mouseleave",h),isMobile()&&!c.phone&&(a.push({element:e[0],callback:h,hovered:!1}),d.$on("$destroy",function(){a.splice(_.indexOf(a,_.find(a,{callback:h})),1)}))}}])}(),angular.module("if",[]).directive("if",[function(){return{transclude:"element",priority:1e3,terminal:!0,restrict:"A",compile:function(a,b,c){return function(a,b,d){var e,f;a.$watch(d["if"],function(d){e&&(e.remove(),e=void 0),f&&(f.$destroy(),f=void 0),d&&(f=a.$new(),c(f,function(a){e=a,b.after(a)}))})}}}}]),angular.module("imgAlt",["if","ngSanitize"]).factory("ImageValidator",["$log",function(a){return function(b){return function(c,d,e){d=d||angular.noop,e=e||angular.noop,$.fn.imagesLoaded?$("<img>").attr("src",c).imagesLoaded({done:function(a){b.$apply(function(){d(a)})},fail:function(){b.$apply(e)}}):a.warn("Error detected while trying to use the imagesLoaded plugin. Make sure the correct jQuery object was used")}}}]).directive("imgAlt",["ImageValidator",function(a){return{replace:!0,transclude:!0,template:'<div class="img-alt group">  <div class="img-alt__inner" ng-class="{\'img-alt--fallback\': isFallback}" ng-style="widthAndHeight">    <div if="url" class="img-alt__graphic" ng-style="ieCSSFilters"></div>    <div ng-show="isFallback">      <div ng-transclude></div>    </div>  </div></div>',scope:!0,link:function(b,c,d){function e(){return f&&!b.isFallback||!f}var f=!1,g=!1;b.isFallback=!0,"true"===d.isFallback&&(b.isFallback=!0,f=!0),b.$watch(d.isFallback,function(a){!g&&a&&(b.isFallback=a,f=!_.isUndefined(a))}),d.$observe("url",function(c){b.url=c,"false"!==c&&""!==c?(b.ieCSSFilters={"background-image":"url('"+c+"')"},b.widthAndHeight={},Modernizr.backgroundsize||(b.ieCSSFilters.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')",b.ieCSSFilters["-ms-filter"]="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')",b.ieCSSFilters["background-image"]="none"),e()&&a(b)(c,function(a){var c,e;if(g=!0,b.isFallback=!1,angular.isUndefined(d.noAutosize)&&angular.isObject(a)&&angular.isObject(a[0])){var f=function(){for(var a=arguments.length,b=0;a>b;b++){var c=arguments[b];if(angular.isNumber(c)&&c>0)return c}return 0};c=f(a[0].naturalWidth,a[0].width,a.width()),e=f(a[0].naturalHeight,a[0].height,a.height()),c&&e||(g=!0,b.isFallback=!0),b.widthAndHeight.width=c+"px",b.widthAndHeight.height=e+"px"}},function(){g=!0,b.isFallback=!0})):(b.ieCSSFilters={},g=!0,b.isFallback=!0)}),d.$observe("label",function(a){b.title=a})}}}]),angular.module("inputLocation",["googleMap"]).directive("inputLocation",["$parse","googleMap",function(a,b){return{scope:!0,link:function(c,d,e){d.on("click",function(){b.loadScript()});var f={};c.locationSearch=f,b.getPromise().then(function(b){var g,h={types:["(regions)"],componentRestrictions:{country:"us"}},i=a(e.locationChange);f.autocomplete=new b.maps.places.Autocomplete(d[0],h),f.refresh=function(){g.geocode({address:d.val()},function(a,c){c===b.maps.GeocoderStatus.OK&&f.doCallback({lat:a[0].geometry.location.lat(),lng:a[0].geometry.location.lng()})})},f.doCallback=function(a){c.$apply(function(){i(c,{$event:a})})},e.instance&&a(e.instance).assign(c.$parent,f),d.bind("focusin",function(){$(document).keypress(function(a){13===a.which&&f.refresh()})}),g=new b.maps.Geocoder,b.maps.event.addListener(f.autocomplete,"place_changed",function(){var a=f.autocomplete.getPlace();a.geometry&&f.doCallback({lat:a.geometry.location.lat(),lng:a.geometry.location.lng()})})})}}}]),angular.module("inputRadio",[]).directive("inputRadio",["inputBoolModelFactory",function(a){return{require:"ngModel",link:function(b,c,d,e){function f(){g(d.value===e.$modelValue)}function g(a){i.isTrue=Boolean(a),h(i.isTrue)}function h(a){c.toggleClass("is-true is-frozen",a).toggleClass("is-false",!a)}var i=a();c.addClass("input-radio"),e.$render=f,c.on("click",function(){i.isTrue===!1&&(g(!0),e.$setViewValue(d.value),b.$apply())})}}}]).factory("inputBoolModelFactory",[function(){return function(){return{isDisabled:!1,isTrue:!1}}}]),angular.module("installationcalendarslot",[]).directive("installationcalendarslot",["ServiceAppointment",function(a){var b=a,c=b.getAvailableTimeSlots();return{restrict:"E",templateUrl:"/parts/installation-calendar-slot/installation-calendar-slot-template.html",link:function(a){function b(){console.log("somya"+$(this).attr("timeSlot"))}function d(a,b){var c;return 4===a||6===a||9===a||11===a?c=30:(c=31,2===a&&(c=0!==b/4-parseInt(b/4,0)?28:0!==b/100-parseInt(b/100,0)?29:0!==b/400-parseInt(b/400,0)?28:29)),c}function e(a){var b="";if(6>a||a>0)switch(a){case 0:b="Sun";break;case 1:b="Mon";break;case 2:b="Tue";break;case 3:b="Wed";break;case 4:b="Thur";break;case 5:b="Fri";break;case 6:b="Sat"}return b}function f(a){var b="";if(a>0||13>a)switch(a){case 1:b="January";break;case 2:b="February";break;case 3:b="March";break;case 4:b="April";break;case 5:b="May";break;case 6:b="June";break;case 7:b="July";break;case 8:b="August";break;case 9:b="September";break;case 10:b="October";break;case 11:b="November";break;case 12:b="December"}return b}a.month="";var g=new Date,h=g.getDate(),i=g.getMonth()+1;a.month=f(i);for(var j=g.getFullYear(),k=g.getDay(),l=0,m=$(document.createElement("tr"));7>l;){var n=$(document.createElement("th"));$(n).text(e(k)),k++,l++,7===k&&(k=0),$(m).append($(n))}$("#calendarTable").append($(m));for(var o=d(i,j),p=1,q=$(document.createElement("tr")),r=1;42>p;){8===r&&($("#calendarTable").append($(q)),q=$(document.createElement("tr")),r=1),h-1===o&&(h=1,a.month+=12!==i?"/"+f(i+1):"/"+f(1));for(var s=$(document.createElement("td")),t="",u=0;u<c.length;u++){var v=c[u].TIMEDISPLAY.split(",")[0],w=new Date(v);i===w.getMonth()+1&&h===w.getDate()&&(t+=c[u].TIMEDISPLAY.split(",")[1]+" ")}""!==t?($(s).attr("timeSlot",t),$(s).addClass("slotAvaliable"),$(s).on("click",b())):$(s).addClass("slotNotAvaliable"),$(s).text(h),$(q).append($(s)),r++,h++,p++}}}}]),angular.module("isDeviceWidth",[]).run(["$rootScope","isDeviceWidth",function(a,b){a.isDeviceWidth=b,window.isDeviceWidth=b}]).service("isDeviceWidth",["$rootScope",function(a){function b(a){_.each(c,function(b,d){c[d]=d===a})}var c={phone:!1,tablet:!1,desktop:!1,largeDesktop:!1},d={phone:"(max-device-width: 767px)",tablet:"(min-device-width: 768px) and (max-device-width: 979px)",desktop:"(min-device-width: 980px) and (max-device-width: 1199px)",largeDesktop:"(min-device-width: 1200px)"};return _.each(d,function(c,d){enquire.register(c,function(){a.$apply(function(){b(d)})})}),enquire.listen(100),c}]),angular.module("isViewportSize",[]).run(["$rootScope","isViewportSize",function(a,b){a.isViewportSize=b,window.isViewportSize=b}]).service("isViewportSize",["$rootScope",function(a){function b(a){_.each(c,function(b,d){c[d]=d===a})}var c={phone:!1,tablet:!1,desktop:!1,largeDesktop:!1},d={phone:"(max-width: 767px)",tablet:"(min-width: 768px) and (max-width: 979px)",desktop:"(min-width: 980px) and (max-width: 1199px)",largeDesktop:"(min-width: 1200px)"};return _.each(d,function(c,d){enquire.register(c,function(){a.$apply(function(){b(d)})})}),enquire.listen(100),c}]);var options={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8,isDragEvent:!1};angular.module("scrollPane",[]).directive("scrollPaneVertical",[function(){return{restrict:"A",link:function(a,b){var c=$(b);new JScrollPaneVertical(c,options)}}}]),angular.module("jssi",["if"]).directive("jssi",["$log",function(){return{replace:!0,template:'<div ng-include="jssi.url"></div>',scope:!0,link:function(a,b,c){a.jssi={},c.$observe("jssi",function(b){if(angular.isString(b)&&""!==b&&"false"!==b)a.jssi.url=CacheKeyURL(b);else try{delete a.jssi.url}catch(c){}})}}}]).factory("CacheKeyURL",[function(){function a(a){var c;return _.each(b,function(b){b=b.replace(/^\s+/,"").replace(/\s+$/,"");var d=b.indexOf("="),e=b.substr(0,d),f=b.substr(d+1,b.length);return a===e&&f.match(/\S/)?(c=f,!1):void 0}),c}var b=document.cookie.split(";"),c=a("cachekeys"),d="",e="",f="";return angular.isString(c)&&_.each(c.replace(/^"/,"").replace(/"$/,"").split("|"),function(a){var b=a.split("="),c=b.shift(),g=b.join("=");c=c.replace(/^\s+/,"").replace(/\s+$/,""),g=g.replace(/^\s+/,"").replace(/\s+$/,""),"ZIP"===c?d=g:"CORP"===c?e=g:"REGION"===c&&(f=g)}),function(a){return angular.isString(a)?a.replace(/@Zipcode@/g,d).replace(/@Corp@/g,e).replace(/@Region@/g,f):a}}]),angular.module("keyEvents",[]).directive("onKeyup",["$parse",function(a){return function(b,c,d){var e=a(d.onKeyup);c.bind("keyup",function(a){b.$apply(function(){e(b,{$event:a})})})}}]).directive("onKeydown",["$parse",function(a){return function(b,c,d){var e=a(d.onKeydown);c.bind("keydown",function(a){b.$apply(function(){e(b,{$event:a})})})}}]).directive("onKeypress",["$parse",function(a){return function(b,c,d){var e=a(d.onKeypress);c.bind("keypress",function(a){b.$apply(function(){e(b,{$event:a})})})}}]),angular.module("l",[]).run(["$rootScope","l",function(a,b){a.l=b}]).filter("s",function(){return function(){var a;try{a=_.vsprintf(_.first(arguments),_.rest(arguments))}finally{return a}}}).value("l",{map:{hotspots:{intro:"Get internet throughout your neighborhood at these hotspots."},stores:{intro:"Find an Optimum Store near you"}},dvr:{episodesTable:{duration:"Length",time:"Date & time",series:"Series",episode:"Episode"},empty:{scheduled:{title:"You don't have any scheduled recordings",body:""},recorded:{title:"Your DVR is empty",body:""}},remove:{modeButtonLabel:{recorded:"Delete Recordings",scheduled:"Cancel Recordings"},single:{scheduled:{single:{buttonLabel:"Cancel 1 recording",mobileButtonLabel:"Cancel 1 recording",confirm:{title:"Cancel <strong>%(recordingName)s</strong>?",continueButtonLabel:"Yes, Cancel 1 recording",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(recordingName)s</strong>..."},success:{title:"<strong>%(recordingName)s</strong> has been Canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}}},recorded:{single:{buttonLabel:"Delete 1 recording",mobileButtonLabel:"Delete 1 recording",confirm:{title:"Delete <strong>%(recordingName)s</strong>?",continueButtonLabel:"Yes, Delete 1 recording",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(recordingName)s</strong>..."},success:{title:"<strong>%(recordingName)s</strong> has been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}}}},series:{recorded:{single:{buttonLabel:"Delete %(removeCount)s recording",mobileButtonLabel:"Delete %(removeCount)s recording",confirm:{title:"Delete <strong>%(removeCount)s recording</strong>?",continueButtonLabel:"Yes, Delete <strong>%(removeCount)s recording</strong>",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(removeCount)s recording</strong>..."},success:{title:"<strong>%(removeCount)s episode of %(recordingName)s</strong> has been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}},plural:{buttonLabel:"Delete %(removeCount)s recordings",mobileButtonLabel:"Delete %(removeCount)s recordings",confirm:{title:"Delete <strong>%(removeCount)s recordings</strong>?",continueButtonLabel:"Yes, Delete <strong>%(removeCount)s recordings</strong>",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(removeCount)s recordings</strong>..."},success:{title:"<strong>%(removeCount)s episodes of %(recordingName)s</strong> have been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}}},scheduled:{single:{buttonLabel:"Cancel %(seriesRemoveCount)s recording",mobileButtonLabel:"Cancel %(seriesRemoveCountSelected)s recording",confirm:{title:"Cancel all <strong>%(seriesRemoveCountSelected)s recording</strong> of %(recordingName)s?",continueButtonLabel:"Yes, Cancel <strong>%(seriesRemoveCountSelected)s recording</strong>",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(seriesRemoveCountSelected)s recording</strong> of %(recordingName)s..."},success:{title:"<strong>%(recordingName)s</strong> has been canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>.",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}},plural:{buttonLabel:"Cancel %(seriesRemoveCount)s recordings",mobileButtonLabel:"Cancel %(seriesRemoveCountSelected)s recordings",confirm:{title:"Cancel <strong>%(seriesRemoveCountSelected)s recordings</strong>?",continueButtonLabel:"Yes, Cancel <strong>%(seriesRemoveCountSelected)s recordings</strong>",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(seriesRemoveCountSelected)s recordings</strong>..."},success:{title:"<strong>%(recordingName)s</strong> has been canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}}}},multiple:{scheduled:{plural:{buttonLabel:"Cancel %(seriesRemoveCount)s recordings",mobileButtonLabel:"Cancel %(seriesRemoveCountSelected)s recordings",confirm:{title:"Cancel <strong>%(seriesRemoveCountSelected)s recordings</strong>?",continueButtonLabel:"Yes, Cancel %(seriesRemoveCountSelected)s recording",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(seriesRemoveCountSelected)s recordings</strong>..."},success:{title:"<strong>%(seriesRemoveCountSelected)s recordings</strong> have been Canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}}},recorded:{plural:{buttonLabel:"Delete %(removeCount)s recording",mobileButtonLabel:"Delete %(removeCount)s recording",confirm:{title:"Delete <strong>%(removeCount)s recordings</strong>?",continueButtonLabel:"Yes, Delete <strong>%(removeCount)s recording</strong>",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(removeCount)s recording</strong>..."},success:{title:"<strong>%(removeCount)s recordings</strong> have been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}}}}}},cableBoxes:{copy:{quickSettings:"Quick Settings",parentalControls:"Parental Controls",purchasePIN:"Purchase Pin",favorites:"Favorite Channels",guide:"Guide Preferences",otherSettings:"Other Settings"},language:{description:"When the channel offers alternative audio, such as as second audio language, with the TV picture. Where SAP is available, the voice over will be in English."},soundAndPicture:{validation:{aspectRatio:"To choose 4:3, you must change Display resolution to 480p or 480i.",displayResolution:"To choose %(displayResolution)s, you must change Aspect ratio to 16:9.",volumeControl:"You cannot choose Fixed, because Closed Captioning is set to On with Mute."}},timeBlock:{lead:"Time blocks allow you to block programs in a particular time range, for a single day, a range of days, or a day of the week such as every Saturday. You can set up time blocks up to 14 days in advance.",leadStrong:"You must enter a Parental Control PIN using your remote in order to watch blocked times.",heading:"Block TV viewing on this cable box"},timers:{invalid:"Turn on time must be before turn off time."},content:{D:{title:"Suggestive dialogue, drugs",description:"Suggestive dialogue usually sexual in nature, or drug use."},FV:{title:"Fantasy violence",description:"Includes more fantasy and violence than most TV-Y7 programs."},"L/SL":{title:"Strong, coarse language",description:"Strong, coarse, or graphic language"},N:{title:"Nudity",description:"Nudity implied or explicit sexual situations"},S:{title:"Sexual situations",description:"Implied or explicit sexual situations"},BN:{title:"Brief nudity",description:"Some exposure, generally not sexually oriented"},V:{title:"Violence",description:"Graphic or intense violence"},AT:{title:"Adult themes",description:"Portrays violence, sexual situations or drug use"}},verify:{purchase:{title:"Verify Purchase PIN",name:"Purchase PIN",lead:{copy:"To copy your purchase PIN, please verify your PIN for %(copyFrom)s.",edit:"To edit your purchase PIN, please verify your PIN for %(copyFrom)s."}},parentalControl:{title:"Verify Parental Control PIN",name:"Parental Control PIN",lead:{copy:"To copy parental controls, please verify your PIN for %(copyFrom)s.",edit:""}}}},cart:{errorLoadingItems:"Sorry, there was a problem loading your cart items.",errorRemovingItem:"Sorry, there was a problem removing your cart item.",errorInitiallyAddingItem:"Sorry, there was a problem adding the item to your cart.",errorRemovingItems:"Sorry, there was a problem removing items from your cart.",buttonTryAgainSimple:"Try again",buttonTryAgain:"Try again to remove remaining items",errorAddingItem:"Sorry, there was a problem adding an item back to your cart.",warningSelectedTooMany:"You have selected more than ten items to delete. You can only delete ten items at one time. Please change your selection."},favorites:{errorLoadingItems:"Sorry, there was a problem loading your favorite items.",errorRemovingItem:"Sorry, there was a problem removing your favorite item.",errorInitiallyAddingItem:"Sorry, there was a problem adding the item to your favorites.",errorRemovingItems:"Sorry, there was a problem removing items from your favorites.",buttonTryAgainSimple:"Try again",buttonTryAgain:"Try again to remove remaining items",errorAddingItem:"Sorry, there was a problem adding an item back to your favorites.",warningSelectedTooMany:"You have selected more than ten items to delete. You can only delete ten items at one time. Please change your selection."},internet:{security:{download:"Download Security Suite",remember:"Please rememeber next time you are on your desktop",responseMessages:{accountOne:{start:"Your Optimum Online account is currently not eligible for this promotion. Please contact us",end:"to update your account status."},accountTwo:"Your Optimum Online Account has exceeded the maximum number of licenses available",general:"An error occurred while processing your request. Please return to the Security Package page to resubmit your request",success:"Thank you for requesting your FREE Internet Security package. <br><br> As soon as your request has been processed, you will receive a Welcome e-mail from our partner CA. This e-mail will be sent to your Optimum Online & regular e-mail address and will include instructions for downloading and installing your security package."}}},session:{expired:"Your session has expired. Login required."},network:{noPrograms:"No programs found",unableToLoad:"Unable to load program data"},dates:{today:"Today",tomorrow:"Tomorrow"}}),angular.module("lightBox",["modal","panel"]).directive("lightBox",[function(){return{templateUrl:"/parts/light-box/light-box-template.html",restrict:"AE",scope:!0,link:function(a,b,c){var d="light-box-"+c.contentid;$("#"+d).length?(a.title=$("#"+d).children(".title-"+c.contentid).html(),a.bodycontent=$("#"+d).children(".content-"+c.contentid).html(),a.linktitle=$("#"+d).children(".linktext-"+c.contentid).html(),a.type=angular.lowercase($("#"+d).children(".type-"+c.contentid).text())):(a.bodycontent="",a.linktitle="",a.type="",c.title=""),a.openLightbox=function(a){$(a.target).next().find(".disclaimer .disclaimer-window").show(),$(a.target).next().find(".disclaimer").addClass("show").delay(5).queue(function(){$("body").addClass("stop-scroll"),$(this).removeClass("invisible").addClass("visible"),$(this).dequeue()})},a.closeLightbox=function(a){$(a.target).parents(".disclaimer").removeClass("visible").addClass("invisible").delay(605).queue(function(){$(this).find(".disclaimer-window").attr("style",null),$("body").removeClass("stop-scroll"),$(this).removeClass("show"),$(this).dequeue()})},a.openmodel=function(){a.showModal=!0},a.closeModal=function(){a.showModal=!1}}}}]),angular.module("linksDvrCart",["movieCart","oolCookie","if","webdvrResource","onetCookies"]).controller("linksDvrCart",["$scope","movieCart","ooluser","WebDVR","$rootScope","Cookies",function(a,b,c,d,e,f){function g(a){var b=!1;d.query(function(){b=!0}),a.hasDvr=function(){return b}}c.laBoxUser=c.hasOOLSession?c.laBoxUser||c.laboxOrMini:"true"===f.getCookie("labox"),a.ooluser=c,b.getItems(function(b){a.movieCart=b.ids.length}),e.$watch("cartCount",function(b,c){c!==b&&(a.movieCart=b)}),g(a.ooluser)}]),angular.module("macAddressInput",["keyEvents"]).directive("macAddressInput",["macAddressSeps",function(a){return{replace:!1,require:"ngModel",scope:!0,template:'<span ng-switch="isMobile">  <span ng-switch-when="true">    <input type="text"      ng-model="mobileDigits.value"      ng-change="mobileChange(mobileDigits.value)"      mac-address-seps      maxlength="17"    />  </span>  <span ng-switch-when="false">    <input type="text"      ng-model="digit.value"      ng-repeat="digit in digits"      class="small input pin-input"      on-keydown="keyDown($event, $index)"      ng-change="change($index, digit.value)"      placeholder="00"      maxlength="2"    />  </span></span>',link:function(b,c,d,e){function f(a){angular.isUndefined(h)&&(h=c.find("input")),$(h[a]).focus()
}function g(a){return angular.isUndefined(a)||""===a||null===a||a!==a}var h;b.digits=[{},{},{},{},{},{}],b.mobileDigits={},b.isMobile=isMobile(),e.$render=function(){var c,d=e.$viewValue;angular.isString(d)?(d=d.replace(/[^\dA-Fa-f]/g,""),c=angular.extend(["","","","","",""],d.split("")),_.each(b.digits,function(a){a.value=c.shift()}),b.mobileDigits.value=a(d)):(_.each(b.digits,function(a){a.value=""}),b.mobileDigits.value="")},b.keyDown=function(a,c){8===a.keyCode&&c>0&&""===b.digits[c].value&&(b.digits[c-1].value=b.digits[c-1].value.replace(/[\dA-Fa-f]$/,""),f(c-1),a.preventDefault())},b.change=function(c,d){b.mobileDigits.value=_.reduce(b.digits,function(a,b){return b.value=b.value.replace(/[^\dA-Fa-f]/g,""),a+b.value},""),e.$setViewValue(b.mobileDigits.value),b.mobileDigits.value=a(b.mobileDigits.value),c<b.digits.length-1&&d.match(/[\dA-Fa-f]{2}/)&&f(c+1)},b.mobileChange=function(c){angular.isString(c)&&""!==c?(c=a(c).replace(/[^\dA-Fa-f]/g,""),digits=angular.extend(["","","","","",""],c.split("")),_.each(b.digits,function(a){a.value=digits.shift()})):_.each(b.digits,function(a){a.value=""}),e.$setViewValue(c)};var i,j=d.ngPattern,k=function(a,b){return g(b)||a.test(b)?(e.$setValidity("pattern",!0),b):(e.$setValidity("pattern",!1),void 0)};j&&(j.match(/^\/(.*)\/$/)?(j=new RegExp(j.substr(1,j.length-2)),i=function(a){return k(j,a)}):i=function(a){var c=b.$eval(j);if(!c||!c.test)throw new Error("Expected "+j+" to be a RegExp but was "+c);return k(c,a)},e.$formatters.push(i),e.$parsers.push(i))}}}]).factory("macAddressSeps",[function(){return function(a){return a.replace(/[^\dA-Fa-f]/g,"").replace(/([\dA-Fa-f]{2})(?=[\dA-Fa-f])/g,"$1:").replace(/^([\d:A-Fa-f]{17})[\d:A-Fa-f]+$/,"$1")}}]).directive("macAddressSeps",["macAddressSeps",function(a){return function(b,c){c.live("blur",function(){this.value=a(this.value)}).live("keyup",function(){var b,c,d;b=a($(this).val()),c=this.selectionStart,d=!0,c>=this.value.length&&(d=!1),this.value!==b&&(this.value=b,d&&(this.selectionStart=c,this.selectionEnd=c))})}}]),angular.module("googleMapsAsync",[]).factory("googleMapsAsync",["$rootScope","$q",function(a,b){function c(){if(!g){var a=document.createElement("script");a.type="text/javascript",a.src="https://maps.googleapis.com/maps/api/js?libraries=places&client="+e+"&channel=optimum_dot_net&callback=initializeGoogleMap",document.body.appendChild(a),g=!0}}function d(){return f.promise}var e="gme-alticeusa",f=b.defer(),g=!1;return window.initializeGoogleMap=function(){a.$apply(function(){f.resolve()})},{load:c,getPromise:d}}]),angular.module("googleMapsInfoBox",["googleMapsAsync"]).factory("InfoBox",["googleMapsAsync",function(a){return a.getPromise().then(function(){function a(a){a=a||{},google.maps.OverlayView.apply(this,arguments),this.content_=a.content||"",this.disableAutoPan_=a.disableAutoPan||!1,this.maxWidth_=a.maxWidth||0,this.pixelOffset_=a.pixelOffset||new google.maps.Size(0,0),this.position_=a.position||new google.maps.LatLng(0,0),this.zIndex_=3,this.boxClass_=a.boxClass||"infoBox",this.boxStyle_=a.boxStyle||{},this.closeBoxMargin_=a.closeBoxMargin||"4px",this.closeBoxURL_=a.closeBoxURL,this.infoBoxClearance_=a.infoBoxClearance||new google.maps.Size(1,1),this.isHidden_=a.isHidden||!1,this.alignBottom_=a.alignBottom||!1,this.pane_=a.pane||"floatPane",this.enableEventPropagation_=a.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.moveListener_=null,this.contextListener_=null,this.fixedWidthSet_=null}return a.prototype=new google.maps.OverlayView,a.prototype.createInfoBoxDiv_=function(){var a,b=this,c=function(a){a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},d=function(a){a.returnValue=!1,a.preventDefault&&a.preventDefault(),b.enableEventPropagation_||c(a)};this.div_||(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(a=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-a.left-a.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),this.enableEventPropagation_||(this.eventListener1_=google.maps.event.addDomListener(this.div_,"mousedown",c),this.eventListener2_=google.maps.event.addDomListener(this.div_,"click",c),this.eventListener3_=google.maps.event.addDomListener(this.div_,"dblclick",c),this.eventListener4_=google.maps.event.addDomListener(this.div_,"mouseover",function(){this.style.cursor="default"})),this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",d),google.maps.event.trigger(this,"domready"))},a.prototype.getCloseBoxImg_=function(){var a="";return""!==this.closeBoxURL_&&(a="<img",a+=" src='"+this.closeBoxURL_+"'",a+=" align=right",a+=" style='",a+=" position: relative;",a+=" cursor: pointer;",a+=" margin: "+this.closeBoxMargin_+";",a+="'>"),a},a.prototype.addClickHandler_=function(){var a;""!==this.closeBoxURL_?(a=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(a,"click",this.getCloseClickHandler_())):this.closeListener_=null},a.prototype.getCloseClickHandler_=function(){var a=this;return function(b){b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation(),a.close(),google.maps.event.trigger(a,"closeclick")}},a.prototype.panBox_=function(a){var b,c,d=0,e=0;if(!a&&(b=this.getMap(),b instanceof google.maps.Map)){b.getBounds().contains(this.position_)||b.setCenter(this.position_),c=b.getBounds();var f=b.getDiv(),g=f.offsetWidth,h=f.offsetHeight,i=this.pixelOffset_.width,j=this.pixelOffset_.height,k=this.div_.offsetWidth,l=this.div_.offsetHeight,m=this.infoBoxClearance_.width,n=this.infoBoxClearance_.height,o=this.getProjection().fromLatLngToContainerPixel(this.position_);o.x<-i+m?d=o.x+i-m:o.x+k+i+m>g&&(d=o.x+k+i+m-g),this.alignBottom_?o.y<-j+n+l?e=o.y+j-n-l:o.y+j+n>h&&(e=o.y+j+n-h):o.y<-j+n?e=o.y+j-n:o.y+l+j+n>h&&(e=o.y+l+j+n-h),(0!==d||0!==e)&&(b.getCenter(),b.panBy(d,e))}},a.prototype.setBoxStyle_=function(){var a,b;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",b=this.boxStyle_;for(a in b)b.hasOwnProperty(a)&&(this.div_.style[a]=b[a]);"undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},a.prototype.getBoxWidths_=function(){var a,b={top:0,bottom:0,left:0,right:0},c=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(a=c.ownerDocument.defaultView.getComputedStyle(c,""),a&&(b.top=parseInt(a.borderTopWidth,10)||0,b.bottom=parseInt(a.borderBottomWidth,10)||0,b.left=parseInt(a.borderLeftWidth,10)||0,b.right=parseInt(a.borderRightWidth,10)||0)):document.documentElement.currentStyle&&c.currentStyle&&(b.top=parseInt(c.currentStyle.borderTopWidth,10)||0,b.bottom=parseInt(c.currentStyle.borderBottomWidth,10)||0,b.left=parseInt(c.currentStyle.borderLeftWidth,10)||0,b.right=parseInt(c.currentStyle.borderRightWidth,10)||0),b},a.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},a.prototype.draw=function(){this.createInfoBoxDiv_();var a=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=a.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(a.y+this.pixelOffset_.height)+"px":this.div_.style.top=a.y+this.pixelOffset_.height+"px",this.div_.style.visibility=this.isHidden_?"hidden":"visible"},a.prototype.setOptions=function(a){"undefined"!=typeof a.boxClass&&(this.boxClass_=a.boxClass,this.setBoxStyle_()),"undefined"!=typeof a.boxStyle&&(this.boxStyle_=a.boxStyle,this.setBoxStyle_()),"undefined"!=typeof a.content&&this.setContent(a.content),"undefined"!=typeof a.disableAutoPan&&(this.disableAutoPan_=!0),"undefined"!=typeof a.maxWidth&&(this.maxWidth_=a.maxWidth),"undefined"!=typeof a.pixelOffset&&(this.pixelOffset_=a.pixelOffset),"undefined"!=typeof a.alignBottom&&(this.alignBottom_=a.alignBottom),"undefined"!=typeof a.position&&this.setPosition(a.position),"undefined"!=typeof a.zIndex&&this.setZIndex(a.zIndex),"undefined"!=typeof a.closeBoxMargin&&(this.closeBoxMargin_=a.closeBoxMargin),"undefined"!=typeof a.closeBoxURL&&(this.closeBoxURL_=a.closeBoxURL),"undefined"!=typeof a.infoBoxClearance&&(this.infoBoxClearance_=a.infoBoxClearance),"undefined"!=typeof a.isHidden&&(this.isHidden_=a.isHidden),"undefined"!=typeof a.enableEventPropagation&&(this.enableEventPropagation_=a.enableEventPropagation),this.div_&&this.draw()},a.prototype.setContent=function(a){this.content_=a,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof a.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+a:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(a)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof a.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+a:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(a))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},a.prototype.setPosition=function(a){this.position_=a,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},a.prototype.setZIndex=function(a){this.zIndex_=a,this.div_&&(this.div_.style.zIndex=a),google.maps.event.trigger(this,"zindex_changed")},a.prototype.getContent=function(){return this.content_},a.prototype.getPosition=function(){return this.position_},a.prototype.getZIndex=function(){return this.zIndex_},a.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},a.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},a.prototype.open=function(a,b){var c=this;b&&(this.position_=b.getPosition(),this.moveListener_=google.maps.event.addListener(b,"position_changed",function(){c.setPosition(this.getPosition())})),this.setMap(a),this.div_&&this.panBox_()},a.prototype.close=function(){this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListener1_&&(google.maps.event.removeListener(this.eventListener1_),google.maps.event.removeListener(this.eventListener2_),google.maps.event.removeListener(this.eventListener3_),google.maps.event.removeListener(this.eventListener4_),this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.eventListener4_=null),this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},a})}]),angular.module("googleMapsRichMarker",["googleMapsAsync"]).factory("RichMarker",["googleMapsAsync",function(a){return a.getPromise().then(function(){function a(a){var c=a||{};this.ready_=!1,this.dragging_=!1,void 0===a.visible&&(a.visible=!0),void 0===a.shadow&&(a.shadow="7px -3px 5px rgba(88,88,88,0.7)"),void 0===a.anchor&&(a.anchor=b.BOTTOM),this.setValues(c)}a.prototype=new google.maps.OverlayView,window.RichMarker=a,a.prototype.getVisible=function(){return this.get("visible")},a.prototype.getVisible=a.prototype.getVisible,a.prototype.setVisible=function(a){this.set("visible",a)},a.prototype.setVisible=a.prototype.setVisible,a.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())},a.prototype.visible_changed=a.prototype.visible_changed,a.prototype.setFlat=function(a){this.set("flat",!!a)},a.prototype.setFlat=a.prototype.setFlat,a.prototype.getFlat=function(){return this.get("flat")},a.prototype.getFlat=a.prototype.getFlat,a.prototype.getWidth=function(){return this.get("width")},a.prototype.getWidth=a.prototype.getWidth,a.prototype.getHeight=function(){return this.get("height")},a.prototype.getHeight=a.prototype.getHeight,a.prototype.setShadow=function(a){this.set("shadow",a),this.flat_changed()},a.prototype.setShadow=a.prototype.setShadow,a.prototype.getShadow=function(){return this.get("shadow")},a.prototype.getShadow=a.prototype.getShadow,a.prototype.flat_changed=function(){this.ready_&&(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},a.prototype.flat_changed=a.prototype.flat_changed,a.prototype.setZIndex=function(a){this.set("zIndex",a)},a.prototype.setZIndex=a.prototype.setZIndex,a.prototype.getZIndex=function(){return this.get("zIndex")},a.prototype.getZIndex=a.prototype.getZIndex,a.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())},a.prototype.zIndex_changed=a.prototype.zIndex_changed,a.prototype.getDraggable=function(){return this.get("draggable")},a.prototype.getDraggable=a.prototype.getDraggable,a.prototype.setDraggable=function(a){this.set("draggable",!!a)},a.prototype.setDraggable=a.prototype.setDraggable,a.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())},a.prototype.draggable_changed=a.prototype.draggable_changed,a.prototype.getPosition=function(){return this.get("position")},a.prototype.getPosition=a.prototype.getPosition,a.prototype.setPosition=function(a){this.set("position",a)},a.prototype.setPosition=a.prototype.setPosition,a.prototype.position_changed=function(){this.draw()},a.prototype.position_changed=a.prototype.position_changed,a.prototype.getAnchor=function(){return this.get("anchor")},a.prototype.getAnchor=a.prototype.getAnchor,a.prototype.setAnchor=function(a){this.set("anchor",a)},a.prototype.setAnchor=a.prototype.setAnchor,a.prototype.anchor_changed=function(){this.draw()},a.prototype.anchor_changed=a.prototype.anchor_changed,a.prototype.htmlToDocumentFragment_=function(a){var b=document.createElement("DIV");if(b.innerHTML=a,1===b.childNodes.length)return b.removeChild(b.firstChild);for(var c=document.createDocumentFragment();b.firstChild;)c.appendChild(b.firstChild);return c},a.prototype.removeChildren_=function(a){if(a)for(var b;b=a.firstChild;)a.removeChild(b)},a.prototype.setContent=function(a){this.set("content",a)},a.prototype.setContent=a.prototype.setContent,a.prototype.getContent=function(){return this.get("content")},a.prototype.getContent=a.prototype.getContent,a.prototype.content_changed=function(){function a(a){e.getDraggable()&&(a.preventDefault&&a.preventDefault(),a.returnValue=!1)}function b(){e.draw()}if(this.markerContent_){this.removeChildren_(this.markerContent_);var c=this.getContent();if(c){"string"==typeof c&&(c=c.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),c=this.htmlToDocumentFragment_(c)),this.markerContent_.appendChild(c);for(var d,e=this,f=this.markerContent_.getElementsByTagName("IMG"),g=0;d=f[g];g++)google.maps.event.addDomListener(d,"mousedown",a),google.maps.event.addDomListener(d,"load",b);google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}},a.prototype.content_changed=a.prototype.content_changed,a.prototype.setCursor_=function(a){if(this.ready_){var b="";-1!==navigator.userAgent.indexOf("Gecko/")?("dragging"===a&&(b="-moz-grabbing"),"dragready"===a&&(b="-moz-grab"),"draggable"===a&&(b="pointer")):(("dragging"===a||"dragready"===a)&&(b="move"),"draggable"===a&&(b="pointer")),this.markerWrapper_.style.cursor!==b&&(this.markerWrapper_.style.cursor=b)}},a.prototype.startDrag=function(a){if(this.getDraggable()&&!this.dragging_){this.dragging_=!0;var b=this.getMap();this.mapDraggable_=b.get("draggable"),b.set("draggable",!1),this.mouseX_=a.clientX,this.mouseY_=a.clientY,this.setCursor_("dragready"),this.markerWrapper_.style.MozUserSelect="none",this.markerWrapper_.style.KhtmlUserSelect="none",this.markerWrapper_.style.WebkitUserSelect="none",this.markerWrapper_.unselectable="on",this.markerWrapper_.onselectstart=function(){return!1},this.addDraggingListeners_(),google.maps.event.trigger(this,"dragstart")}},a.prototype.stopDrag=function(){this.getDraggable()&&this.dragging_&&(this.dragging_=!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())},a.prototype.drag=function(a){if(!this.getDraggable()||!this.dragging_)return this.stopDrag(),void 0;var b=this.mouseX_-a.clientX,c=this.mouseY_-a.clientY;this.mouseX_=a.clientX,this.mouseY_=a.clientY;var d=parseInt(this.markerWrapper_.style.left,10)-b,e=parseInt(this.markerWrapper_.style.top,10)-c;this.markerWrapper_.style.left=d+"px",this.markerWrapper_.style.top=e+"px";var f=this.getOffset_(),g=new google.maps.Point(d-f.width,e-f.height),h=this.getProjection();this.setPosition(h.fromDivPixelToLatLng(g)),this.setCursor_("dragging"),google.maps.event.trigger(this,"drag")},a.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_),this.setCursor_("")},a.prototype.addDragging_=function(a){if(a){var b=this;this.draggableListener_=google.maps.event.addDomListener(a,"mousedown",function(a){b.startDrag(a)}),this.setCursor_("draggable")}},a.prototype.addDraggingListeners_=function(){var a=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(b){a.drag(b)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){a.stopDrag(),a.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(window,"mousemove",function(b){a.drag(b)},!0),google.maps.event.addDomListener(window,"mouseup",function(){a.stopDrag()},!0)]},a.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var a,b=0;a=this.draggingListeners_[b];b++)google.maps.event.removeListener(a);this.draggingListeners_.length=0}},a.prototype.getOffset_=function(){var a=this.getAnchor();if("object"==typeof a)return a;var c=new google.maps.Size(0,0);if(!this.markerContent_)return c;var d=this.markerContent_.offsetWidth,e=this.markerContent_.offsetHeight;switch(a){case b.TOP_LEFT:break;case b.TOP:c.width=-d/2;break;case b.TOP_RIGHT:c.width=-d;break;case b.LEFT:c.height=-e/2;break;case b.MIDDLE:c.width=-d/2,c.height=-e/2;break;case b.RIGHT:c.width=-d,c.height=-e/2;break;case b.BOTTOM_LEFT:c.height=-e;break;case b.BOTTOM:c.width=-d/2,c.height=-e;break;case b.BOTTOM_RIGHT:c.width=-d,c.height=-e}return c},a.prototype.onAdd=function(){if(this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute"),this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex()),this.markerWrapper_.style.display=this.getVisible()?"":"none",!this.markerContent_){this.markerContent_=document.createElement("DIV"),this.markerWrapper_.appendChild(this.markerContent_);var a=this;google.maps.event.addDomListener(this.markerContent_,"click",function(){google.maps.event.trigger(a,"click")}),google.maps.event.addDomListener(this.markerContent_,"mouseover",function(){google.maps.event.trigger(a,"mouseover")}),google.maps.event.addDomListener(this.markerContent_,"mouseout",function(){google.maps.event.trigger(a,"mouseout")})}this.ready_=!0,this.content_changed(),this.flat_changed(),this.draggable_changed();var b=this.getPanes();b&&b.overlayMouseTarget.appendChild(this.markerWrapper_),google.maps.event.trigger(this,"ready")},a.prototype.onAdd=a.prototype.onAdd,a.prototype.draw=function(){if(this.ready_&&!this.dragging_){var a=this.getProjection();if(a){var b=this.get("position"),c=a.fromLatLngToDivPixel(b),d=this.getOffset_();this.markerWrapper_.style.top=c.y+d.height+"px",this.markerWrapper_.style.left=c.x+d.width+"px";var e=this.markerContent_.offsetHeight,f=this.markerContent_.offsetWidth;f!==this.get("width")&&this.set("width",f),e!==this.get("height")&&this.set("height",e)}}},a.prototype.draw=a.prototype.draw,a.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_),this.removeDragListeners_()},a.prototype.onRemove=a.prototype.onRemove;var b={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};return window.RichMarkerPosition=b,a})}]),angular.module("mapMarkerNext",["googleMapsRichMarker","googleMapsInfoBox","pins"]).directive("mapMarker",["$q","RichMarker","InfoBox",function(a,b,c){return{restrict:"A",require:"^map",replace:!0,scope:!0,transclude:!0,templateUrl:"/parts/map/map-marker-template.html",link:function(d,e,f,g){function h(a){k=new a({content:m,map:g.googleMap,flat:!0}),k.setPosition(new google.maps.LatLng(o.lat,o.lon)),"outdoor"in o?o.outdoor===!1?(k.setZIndex(3),google.maps.event.addListener(k,"ready",function(){e.show()})):k.setZIndex(2):google.maps.event.addListener(k,"ready",function(){e.show()})}function i(a){var b="";return b="outdoor"in a?a.outdoor===!1?new google.maps.Size(-185,-15):new google.maps.Size(-185,-48):new google.maps.Size(-185,-22)}function j(a){l=new a({content:n,boxClass:"map-infobox-outer",pane:"overlayMouseTarget",alignBottom:!0,pixelOffset:i(d.item),closeBoxURL:""}),"outdoor"in o?o.outdoor===!1&&d.$watch("item.selected",function(a){a?(k.setZIndex(4),l.open(g.googleMap,k)):l.close()}):d.$watch("item.selected",function(a){a?(k.setZIndex(4),l.open(g.googleMap,k)):l.close()})}var k,l,m=e.find(".marker")[0],n=e.find(".infobox")[0],o=d.$eval(f.item);d.item=o,e.hide(),a.all([b,c,g.promiseToReturnGoogleMap()]).then(function(a){h(a[0]),j(a[1])}),d.$on("DESELECT_MARKER",function(){o.selected=!1,currentSelectedMarker="","outdoor"in o?o.outdoor===!1&&k.setZIndex(3):k.setZIndex(2)}),d.$on("$destroy",function(){k&&k.setMap(null),l&&l.close()})}}}]),angular.module("map",["config","googleMapsAsync","mapMarkerNext","modal","spinner","alertModal","showBusy","downloadAssistant","isViewportSize","ngCookies"]).directive("errSrc",function(){return{link:function(a,b,c){b.bind("error",function(){b.attr("src",c.errSrc)})}}}).filter("startFrom",function(){return function(a,b){return b=+b,a.slice(b)}}).filter("capitalize",function(){return function(a){return a?a[0].toUpperCase()+a.slice(1):void 0}}).controller("MapCtrl",["$scope","$http","$q","Config","googleMapsAsync","alertModal","DownloadAssistant","isViewportSize","$cookies","$timeout",function(a,b,c,d,e,f,g,h,k){function l(a){for(bb.itemsInSameLatLon=[],i=0;i<bb.items.length;i++)bb.items[i].lat===a.lat&&bb.items[i].lon===a.lon&&"OUTDOOR"!==bb.items[i].type&&bb.itemsInSameLatLon.push(bb.items[i]);if(bb.itemsOnMoreHover="",bb.visibleMoreFlag=!1,bb.itemsInSameLatLon.length>5)for(bb.visibleMoreFlag=!0,j=5;j<bb.itemsInSameLatLon.length;j++)bb.itemsOnMoreHover+=bb.itemsInSameLatLon[j].name+"\n"}function m(){bb.currentPage=bb.currentPage-1,0===bb.currentPage&&(bb.visibleNearestStoreFlag=!0)}function n(){bb.currentPage=bb.currentPage+1,bb.visibleNearestStoreFlag=!1}function o(){return b({url:d.getValuesBySelector("endpoint.api.map_public")+"/map/hotspot/meta/categories",method:"GET"}).success(function(a){var b=[db],c=[],d=[],e=[""],f=0;c[f]=db,d[f]="";for(var g in a)"NONE"!==g&&"_links"!==g&&(f++,b.push(a[g]),0!==f&&(c[f]=a[g]),d[f]=g,e.push(g));bb.model.categories=b,bb.model.searchCategories=e,bb.model.categoriesLabel=c,bb.model.categoriesName=d}).error(function(){})}function p(){if(a.maploaded=!0,y(),navigator.geolocation&&(bb.geolocationEnabled=!0),!bb.initialized){bb.busyState="loading";var b=[{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]}];e.getPromise().then(function(){bb.geocoder=new google.maps.Geocoder,bb.googleMap=new google.maps.Map(bb.googleMapElement),bb.googleMap.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,scrollwheel:!1,zoom:16,styles:b}),bb.autocomplete=new google.maps.places.Autocomplete(bb.autocompleteInput),bb.autocompletePP=new google.maps.places.Autocomplete(bb.autocompleteInputPP),r(),bb.googleMapDeferred.resolve(bb.googleMap),bb.initialized=!0,Z=new google.maps.places.PlacesService(bb.googleMap),ab=new google.maps.places.AutocompleteService}),e.load()}}function q(){bb.visibleNearestStoreFlag=!0,bb.currentPage=0,bb.busyState="loading";var a=V(bb.mapCenter.lat,bb.mapCenter.lon),b=bb.googleMap.getBounds().getSouthWest(),d=bb.googleMap.getBounds().getNorthEast(),e=b.lat(),f=b.lng(),g=d.lat(),h=d.lng(),i={"area.minLat":e,"area.minLon":f+(Math.abs(a.lng())-Math.abs(bb.mapCenter.lon)),"area.maxLat":g,"area.maxLon":h,sortBy:"distance"},j={};switch(bb.mapType){case"hotspots":i.pageSize=100,i.distance=5,i.categoriesString=bb.model.categories[bb.model.currentCategory]===db?"":bb.model.categoriesName[bb.model.currentCategory],c.all([N(i)]).then(function(a){G(a[0].data),bb.busyState="standby"},function(a){bb.busyState="standby",console.log("hotspots"),K(a)});break;case"stores":i.pageSize=8,i.byType="Optimum Store",j=angular.copy(i),j.pageSize=1,c.all([M(j),L(i)]).then(function(){F(bb.items,bb.nearestStore),bb.busyState="standby"},function(){bb.busyState="standby",console.log("stores"),K(error)});break;case"business":i.pageSize=100,i.distance=5,i.categoriesString=bb.model.categories[bb.model.currentCategory]===db?"":bb.model.categoriesName[bb.model.currentCategory],c.all([N(i)]).then(function(a){G(a[0].data),setTimeout(function(){$("div .item-primary").length>0&&($("div .item-primary").css({"padding-top":"21px"}),$("div .item-primary").css({"padding-right":"21px"}),$("div .item-primary").css({"padding-bottom":"28px"}),$("div .item-primary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"})),$("div .item-secondary").length>0&&($("div .item-secondary").css({"padding-top":"21px"}),$("div .item-secondary").css({"padding-right":"21px"}),$("div .item-secondary").css({"padding-bottom":"28px"}),$("div .item-secondary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"}))}),bb.busyState="standby"},function(a){bb.busyState="standby",console.log("business again"),K(a)});break;case"storesAndPaymentCenters":i.pageSize=8,i.byType="Optimum Store",j=angular.copy(i),j.pageSize=1,j.byType="Optimum Store",c.all([M(j),L(i)]).then(function(){F(bb.items,bb.nearestStore),bb.busyState="standby"},function(){bb.busyState="standby",K(error)})}""!==cb&&S(cb)}function r(){google.maps.event.addListener(bb.googleMap,"dragend",function(){bb.initialized&&bb.googleMap.getBounds()&&(cb="",a.$apply(q()))}),google.maps.event.addListener(bb.googleMap,"projection_changed",function(){var a=d.getValuesBySelector("endpoint.api.map")+"map/geolocate";if(k.cachekeys){for(var c="",e=k.cachekeys.replace('"',"").split("|"),f=0;f<e.length;f++)e[f].indexOf("ZIP=")>-1&&(c=e[f].replace("ZIP=",""));a+="/zipcode/"+c}else a+="/zipcode/11801";b({url:a,method:"GET"}).success(function(a){a.location&&a.location.latLon&&a.location.latLon.lat&&a.location.latLon.lon?"business"===bb.mapType?O(s(bb.userAddressString.blat,bb.userAddressString.blon),!0):"storesAndPaymentCenters"===bb.mapType||O(s(a.location.latLon.lat,a.location.latLon.lon),!0):x()||O(null,!0)}).error(function(){x()||O(null,!0)})}),google.maps.event.addListener(bb.googleMap,"zoom_changed",function(){bb.initialized&&bb.googleMap.getBounds()&&bb.zoomControls&&a.$apply(q()),bb.zoomControls=!0}),google.maps.event.addListener(bb.googleMap,"resize",function(){X()}),google.maps.event.addListener(bb.autocomplete,"place_changed",function(){bb.autocompleteDirty=!1,v()}),google.maps.event.addListener(bb.autocompletePP,"place_changed",function(){bb.autocompleteDirty=!1,w()})}function s(a,b){return{"near.lat":a,"near.lon":b}}function t(){bb.initialized||p()}function u(){bb.model.currentCategoryName=bb.model.categoriesName[bb.model.currentCategory],cb="",""!==$("#map_autocomplete").val()?O(null,!1):""!==$("#map_autocomplete_payin").val()?O(null,!1):P()}function v(){function b(){O(s(d.geometry.location.lat(),d.geometry.location.lng()),!0),"business"===bb.mapType&&S(bb.items[0]),bb.mapReslt="result"}function c(){bb.mapReslt="noresult"}cb="",bb.visibleNearestStoreFlag=!0;var d=bb.autocomplete.getPlace();angular.isObject(d)&&angular.isObject(d.geometry)&&!bb.autocompleteDirty?b():bb.autocompleteInput.value.match(/\S/)?(bb.mapReslt="result",ab.getPlacePredictions({input:bb.autocompleteInput.value},function(e,f){a.$apply(function(){f===google.maps.places.PlacesServiceStatus.OK&&e.length>0?(bb.autocompleteInput.value=e[0].description,Z.getDetails({reference:e[0].reference},function(e,f){a.$apply(function(){f===google.maps.places.PlacesServiceStatus.OK?(d=e,b()):c()})})):c()})})):c()}function w(){function b(){O(s(d.geometry.location.lat(),d.geometry.location.lng()),!0),"business"===bb.mapType&&S(bb.items[0]),bb.mapReslt="result"}function c(){bb.mapReslt="noresult"}console.log("searchWithAutocompleteValuePP"),cb="",bb.visibleNearestStoreFlag=!0;var d=bb.autocompletePP.getPlace();angular.isObject(d)&&angular.isObject(d.geometry)&&!bb.autocompleteDirty?b():bb.autocompleteInputPP.value.match(/\S/)?(bb.mapReslt="result",ab.getPlacePredictions({input:bb.autocompleteInputPP.value},function(e,f){a.$apply(function(){f===google.maps.places.PlacesServiceStatus.OK&&e.length>0?(bb.autocompleteInputPP.value=e[0].description,Z.getDetails({reference:e[0].reference},function(e,f){a.$apply(function(){f===google.maps.places.PlacesServiceStatus.OK?(d=e,b()):c()})})):c()})})):c()}function x(){return bb.initialized||p(),bb.geolocationEnabled&&navigator.geolocation?(navigator.geolocation.getCurrentPosition(function(a){O(s(a.coords.latitude,a.coords.longitude),!0)},function(){}),!0):!1}function y(){W(),"hotspots"===bb.mapType?bb.mapTypeString="hotspots":"stores"===bb.mapType?bb.mapTypeString="Optimum Stores":"storesAndPaymentCenters"===bb.mapType?bb.mapTypeString="Payment Centers":"business"===bb.mapType&&(bb.mapTypeString="Business")}function z(a){if(bb.lastSearchParams.pageSize="hotspots"===bb.mapType?null:8,!_.contains(bb.validTypes,a))throw"'"+a+"' is not a recognized map type. Currently only these are: "+bb.validTypes.join();a!==bb.mapType&&(bb.mapType=a,bb.nearestStore=null,bb.items=[],bb.initialized&&O(null,!0)),y()}function A(a){bb.lastSearchParams.pageSize=null,bb.userAddressString.blat!==a.lat&&bb.userAddressString.blon!==a.lon&&(bb.userAddressString.blat=a.lat,bb.userAddressString.blon=a.lon)}function B(a){a?(bb.zoomControls=!1,"hotspots"!==bb.mapType&&"business"!==bb.mapType||0!==bb.model.currentCategory?bb.googleMap.setZoom(bb.mapCenter.zoom):bb.googleMap.setZoom(15),bb.googleMap.getProjection()?bb.googleMap.panTo(V(bb.mapCenter.lat,bb.mapCenter.lon)):bb.googleMap.panTo(new google.maps.LatLng(bb.mapCenter.lat,bb.mapCenter.lon))):X()}function C(a){return bb.indoorCount=0,_.map(a,function(a){var b=a;if(b.lat=b.latLon.lat,b.lon=b.latLon.lon,b.street=b.street,b.city=b.city,b.state=b.state,b.providerName=b.provider.name,b.categoryAsInDBItems=[],-1!==b.categoryAsInDB.indexOf("/")){b.categoryAsInDB=b.categoryAsInDB.split("/");
for(var c=0;c<b.categoryAsInDB.length;c++)b.categoryAsInDBItems.push({catIndex:c,category:b.categoryAsInDB[c]})}else b.categoryAsInDBItems.push({catIndex:0,category:b.categoryAsInDB});return b.category=b.category,"businesssr"===b.accountType.toLowerCase()?(b.type="INDOOR",bb.indoorCount=bb.indoorCount+1,b.name||(b.name="indoor hotspot")):"cablevision"===b.providerName.toLowerCase()&&b.outdoor===!0?(b.type="OUTDOOR",b.name||(b.name="outdoor hotspot")):"cablevision"===b.providerName.toLowerCase()&&b.outdoor===!1?(b.type="INDOOR",bb.indoorCount=bb.indoorCount+1,b.name||(b.name="indoor hotspot")):b.outdoor===!0?(b.type="PARTNER_OUTDOOR",b.name||(b.name="partner outdoor hotspot")):(b.type="PARTNER_INDOOR",bb.indoorCount=bb.indoorCount+1,b.name||(b.name="partner indoor hotspot")),b.selected=!1,b})}function D(a){return _.map(a,function(a){var b=a;b.lat=b.latLon.lat,b.lon=b.latLon.lon,b.category="NONE";var c="";return(null===b.hours||"null"===b.hours)&&(b.hours=""),c=b.hours,""!==c&&(-1!==c.indexOf("Sunday")&&(c=c.replace("Monday",bb.weekDays.Sunday),b.hours=c),-1!==c.indexOf("Monday")&&(c=c.replace("Monday",bb.weekDays.Monday),b.hours=c),-1!==c.indexOf("Tuesday")&&(c=c.replace("Tuesday",bb.weekDays.Tuesday),b.hours=c),-1!==c.indexOf("Wednesday")&&(c=c.replace("Wednesday",bb.weekDays.Wednesday),b.hours=c),-1!==c.indexOf("Thursday")&&(c=c.replace("Thursday",bb.weekDays.Thursday),b.hours=c),-1!==c.indexOf("Friday")&&(c=c.replace("Friday",bb.weekDays.Friday),b.hours=c),-1!==c.indexOf("Saturday")&&(c=c.replace("Saturday",bb.weekDays.Saturday),b.hours=c)),b.type="OPTIMUM_STORE"===b.type?"primary":"secondary","primary"===b.type?b.name="Optimum Store":"secondary"!==b.type||b.name||(b.name="Payment Center"),b.selected=!1,b})}function E(a){var b=a;b.lat=b.latLon.lat,b.lon=b.latLon.lon,b.category="NONE";var c="";return(null===b.hours||"null"===b.hours)&&(b.hours=""),c=b.hours,""!==c&&(-1!==c.indexOf("Sunday")&&(c=c.replace("Monday",bb.weekDays.Sunday),b.hours=c),-1!==c.indexOf("Monday")&&(c=c.replace("Monday",bb.weekDays.Monday),b.hours=c),-1!==c.indexOf("Tuesday")&&(c=c.replace("Tuesday",bb.weekDays.Tuesday),b.hours=c),-1!==c.indexOf("Wednesday")&&(c=c.replace("Wednesday",bb.weekDays.Wednesday),b.hours=c),-1!==c.indexOf("Thursday")&&(c=c.replace("Thursday",bb.weekDays.Thursday),b.hours=c),-1!==c.indexOf("Friday")&&(c=c.replace("Friday",bb.weekDays.Friday),b.hours=c),-1!==c.indexOf("Saturday")&&(c=c.replace("Saturday",bb.weekDays.Saturday),b.hours=c)),b.type="nearestStore",b.name="Optimum Store",b.selected=!1,b}function F(a,b){return _.filter(a,function(a){return a.street!==b.street})}function G(a){if(0===bb.model.categories.length&&a.categoriesFacet&&a.categoriesFacet.length>0){var b=[],c=[],d=[];d[0]=db;for(var e=0,f=a.categoriesFacet.length;f>e;e++)"NONE"!==a.categoriesFacet[e].catName?(c[e]=a.categoriesFacet[e].label,b[e]=a.categoriesFacet[e].catName,d[e]=a.categoriesFacet[e].label):(b[e]=db,c="",d[e]=db);bb.model.categories=b,bb.model.categoriesLabel=d}if(""!==cb)S(cb);else if(a.mapCenter){if(bb.mapCenter=a.mapCenter,a._embedded&&a._embedded.results){if(a._embedded.results.length>1){var g=_.uniq(a._embedded.results,function(a){return JSON.stringify(a)});a._embedded.results=g}var h=_.arrayify(a._embedded.results);Q(C(h))}}else bb.mapCenter=H(bb.lastSearchParams["near.lat"],bb.lastSearchParams["near.lon"],13),Q([])}function H(a,b,c){return{all:!0,lat:a,lon:b,zoom:c}}function I(a){if(""!==cb)S(cb);else if(a.mapCenter){if(bb.mapCenter=a.mapCenter,a._embedded&&a._embedded.results){var b=_.arrayify(a._embedded.results);storeItems=D(b),Q(storeItems),console.log("storesLoadSuccess before selectItem"),T(storeItems[0])}}else bb.mapCenter=H(bb.lastSearchParams["near.lat"],bb.lastSearchParams["near.lon"],13),Q([])}function J(a){a&&a._embedded&&a._embedded.results&&(bb.nearestStore=E(a._embedded.results,!0))}function K(a,b){f.create("Sorry, there was a problem loading the map data: Status "+b),B(!1)}function L(a){return console.log("getLoadAllStoresPromise"),b({url:d.getValuesBySelector("endpoint.api.map")+"/map/store/marker/search",method:"GET",params:a}).success(I).error(K)}function M(a){return b({url:d.getValuesBySelector("endpoint.api.map")+"/map/store/marker/search",method:"GET",params:a}).success(J).error(function(){})}function N(a){return b({url:d.getValuesBySelector("endpoint.api.map")+"map/hotspot/marker/search?"+(new Date).getTime(),method:"GET",params:a,cache:!1}).success(function(){}).error(K)}function O(a){bb.currentPage=0,bb.initialized||p(),bb.busyState="loading",a=a||{},a=_.defaults(a,bb.lastSearchParams),bb.lastSearchParams=a;var b={};switch(bb.mapType){case"hotspots":a.pageSize=100,a.distance=5,a.categoriesString=bb.model.categories[bb.model.currentCategory]===db?"":bb.model.categoriesName[bb.model.currentCategory],c.all([N(a)]).then(function(a){G(a[0].data),B(!0),bb.busyState="standby"},function(a){bb.busyState="standby",console.log("hotspots again"),K(a)});break;case"business":a.pageSize=100,a.distance=5,a.categoriesString=bb.model.categories[bb.model.currentCategory]===db?"":bb.model.categoriesName[bb.model.currentCategory],c.all([N(a)]).then(function(a){G(a[0].data),B(!0),S(bb.items[0]),setTimeout(function(){$("div .item-primary").length>0&&($("div .item-primary").css({"padding-top":"21px"}),$("div .item-primary").css({"padding-right":"21px"}),$("div .item-primary").css({"padding-bottom":"28px"}),$("div .item-primary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"})),$("div .item-secondary").length>0&&($("div .item-secondary").css({"padding-top":"21px"}),$("div .item-secondary").css({"padding-right":"21px"}),$("div .item-secondary").css({"padding-bottom":"28px"}),$("div .item-secondary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"}))}),bb.busyState="standby"},function(a){bb.busyState="standby",console.log("business again"),K(a)});break;case"stores":a.pageSize=8,a.distance=500,a.byType="Optimum Store",b=angular.copy(a),b.pageSize=1,c.all([M(b),L(a)]).then(function(){F(bb.items,bb.nearestStore),B(!0),bb.busyState="standby"},function(){bb.busyState="standby",B(!0)});break;case"storesAndPaymentCenters":a.pageSize=8,a.distance=500,a.byType="Optimum Store",b=angular.copy(a),b.pageSize=1,b.byType="Optimum Store",c.all([M(b),L(a)]).then(function(){F(bb.items,bb.nearestStore),bb.busyState="standby",B(!0)},function(){bb.busyState="standby",B(!0)})}""!==cb&&S(cb)}function P(){var a=bb.googleMap.getCenter();O({"near.lat":a.lat(),"near.lon":a.lng()})}function Q(a){_.replaceArrayItems(bb.items,a)}function R(a){var b="",c={street:a.street||"",city:a.city||"",state:a.state||"",zip:a.zip||""};for(var d in c)b+=c[d],""!==c[d]&&"zip"!==d&&(b+="+");return b=""!==b?encodeURIComponent(b):""}function S(a){if("hotspots"===bb.mapType&&"OUTDOOR"===a.type)return a.selected=!1,void 0;if(a.selected)a.selected=!1;else if(W(),h.phone){var b=g.getPlatformURL("mapsURL")||d.getValuesBySelector("link.mapDefault"),c=0===b.indexOf("geo:")?!0:!1,e=a.lat+","+a.lon,f=R(a),i=(c?"?":"&")+"q=",j=b;j+=c?e:"?ll="+e,j+=i+f,window.location.href=j}else("hotspots"===bb.mapType||"business"===bb.mapType||"storesAndPaymentCenters"===bb.mapType)&&bb.itemsOnMoreHoverFun(a),a.selected=!0,cb=a,bb.googleMap.panTo(V(a.lat,a.lon))}function T(a){return"hotspots"===bb.mapType&&"OUTDOOR"===a.type?(a.selected=!1,void 0):(console.log("selectDesktpItem : - "+bb.mapType),a.selected?a.selected=!1:(W(),h.phone||(("hotspots"===bb.mapType||"business"===bb.mapType||"storesAndPaymentCenters"===bb.mapType)&&bb.itemsOnMoreHoverFun(a),a.selected=!0,cb=a,bb.googleMap.panTo(V(a.lat,a.lon)))),void 0)}function U(a){a.selected=!1,cb=""}function V(a,b){var c,d=$(bb.googleMap.getDiv()).width(),e=d/2;c="business"===bb.mapType?(d-20)/2:(d-400)/2;var f=e-c,g=Math.pow(2,bb.googleMap.getZoom()),h=new google.maps.LatLng(a,b),i=bb.googleMap.getProjection().fromLatLngToPoint(h),j=new google.maps.Point(f/g,0),k=new google.maps.Point(i.x-j.x,i.y+j.y);return bb.googleMap.getProjection().fromPointToLatLng(k)}function W(){a.$broadcast("DESELECT_MARKER","Calling all markers, please deselect yourselves!"),cb="",console.log("deselectAllItems")}function X(){bb.googleMap.panTo(new google.maps.LatLng(bb.lastSearchParams["near.lat"],bb.lastSearchParams["near.lon"]))}function Y(){return bb.googleMapDeferred.promise}var Z,ab,bb={model:{currentCategory:0,categories:[],categoriesLabel:[],categoriesName:[],searchCategories:[],currentCategoryName:""},zoomControls:!0,changeDropdown:u,clickDropdown:t,googleMapElement:void 0,googleMap:void 0,geocoder:void 0,autocomplete:void 0,googleMapDeferred:c.defer(),promiseToReturnGoogleMap:Y,initialized:!1,geolocationEnabled:!1,mapType:"hotspots",validTypes:["hotspots","stores","storesAndPaymentCenters","business"],busyState:"standby",lastSearchParams:{pageSize:8,sortBy:"distance",distance:2,"near.lat":40.65,"near.lon":-73.94999999999999},userAddressString:{blat:"",blon:""},mapTypeString:"",mapCenter:void 0,items:[],legendSize:8,legendStoreSize:4,legendStoreStartFrom:"",legendStorePrevPage:m,legendStoreNextPage:n,weekDays:{Sunday:"Sun",Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat"},indoorCount:0,itemsOnMoreHoverFun:l,itemsInSameLatLon:[],visibleMoreFlag:!1,visibleNearestStoreFlag:!0,itemsOnMoreHover:"",nearestStore:void 0,markers:[],nextPage:"",prevPage:"",currentPage:0,init:p,setMapType:z,setAddress:A,searchWithAutocompleteValue:v,searchWithAutocompleteValuePP:w,searchGeolocate:x,loadItems:O,selectItem:S,selectDesktopItem:T,deselectItem:U,deviceTrack:function(){return h.phone||h.tablet?"input-group":"input-group gautocompletePaybill"},testingLocation:function(a){console.log("Testing location: ",a)},mapReslt:"result"},cb="",db="All hotspots";return o(),bb.handleKeyUp=function(a){return(10===a.which||13===a.which)&&v(),!0},bb.handleKeyUpPP=function(a){return(10===a.which||13===a.which)&&w(),!0},a.MapCtrl=bb}]).directive("map",[function(){return{restrict:"A",replace:!0,scope:{type:"=type",address:"=address"},controller:"MapCtrl",templateUrl:"/parts/map/map-template.html",transclude:!0,link:function(a,b,c,d){d.googleMapElement=b.find("#map_canvas")[0],d.autocompleteInput=b.find("#map_autocomplete")[0],d.autocompleteInputPP=b.find("#map_autocomplete_payin")[0],$(d.autocompleteInput).bind("focus",function(){d.initialized||d.init()}),$(d.autocompleteInputPP).bind("focus",function(){d.initialized||d.init()}),$(d.autocompleteInput).bind("keypress input change",function(){d.autocompleteDirty=!0}),$(d.autocompleteInputPP).bind("keypress input change",function(){d.autocompleteDirty=!0}),a.$watch(c.init,function(a){a&&d.init()}),a.$watch("type",function(){d.setMapType(a.type)}),a.$watch("address",function(){"business"===d.mapType&&void 0!==a.address.lat&&void 0!==a.address.lon&&d.setAddress(a.address)})}}}]),angular.module("messageModal",["modalDialog","messageModel","messagePanel"]).factory("messageModal",["modalDialog","messageModel",function(a,b){function c(a){return{templateUrl:"/parts/messages/message-modal/message-modal-template.html",controller:["$scope","model","dialog",function(a,b,c){a.dialog=c,a.model=b}],cssClassModal:d(a.cssClassModal),cssClass:a.cssClass||"theme-white",resolve:{model:function(){return b({sheetTitle:a.sheetTitle,title:a.title,message:a.message,theme:a.theme||a.cssClass,icon:a.icon,ctas:a.ctas})}}}}function d(a){return _.addCssClassStrict(a,"modal-message")}return function(b){return a(c(b))}}]),angular.module("messageModel",[]).factory("messageModel",[function(){function a(a){return _.isString(a)&&a&&"icon-"!==a.substr(0,5)&&(a="icon-"+a),a}function b(a){if(a=a||[],_.isEmpty(_.filter(a,{result:"cancel"}))){var b={label:_.isEmpty(a)?"Okay":"Cancel",result:"cancel",cssClass:a[0]&&a[0].cssClass?a[0].cssClass:""};a.push(b)}return _.each(a,function(a){a.cssClass=_.addCssClass(a.cssClass,"btn--dark-overlay")}),a}return function(c){return c=_.clone(c),c.icon=a(c.icon),c.ctas=b(c.ctas),c.theme=c.theme||"white",c.sheetTitle=c.sheetTitle||"Message",c}}]),angular.module("messagePanel",["if","messageModel","isViewportSize","panel"]).directive("messagePanel",["messageModel","isViewportSize","$parse",function(a,b,c){return{restrict:"EA",templateUrl:"/parts/messages/message-panel/message-panel-template.html",scope:!0,link:function(d,e,f){var g={},h=["header","title","message","icon","ctas","sheetTitle"];_.each(h,function(b){_.isDefined(f[b])&&d.$watch(f[b],function(c){g[b]=c,d.messagePanel=a(_.clone(g))})}),d.resolve=function(a){f.onResolve&&c(f.onResolve)(d,{$event:a})};var i="white";f.theme&&d.$watch(f.theme,function(a){a=a||f.theme;var b="theme-";i=_.str.startsWith(a,b)?_.str.splice(a,0,b.length):a}),d.contentClasses=function(){return o={},o["theme-"+i]=!b.phone,o["theme-content-"+i]=b.phone,o},d.sheetHeaderClasses=function(){return b.phone?"theme-"+i:""}}}}]),angular.module("messages",["messagePanel","messageModel","messageModal"]),angular.module("meter",[]).directive("meter",[function(){return{restrict:"E",replace:!0,template:'<div class="meter"><div class="meter__amount" ng-style="{width:percentage + \'%\'}"></div></div>',scope:{value:"@",max:"@"},controller:["$scope",function(a){function b(){return 100*(a.value/a.max)||0}a.$watch("value + max",function(){a.percentage=b()})}]}}]),angular.module("modalDialog",["modal","panel","ngSanitize","dots","if"]).provider("modalDialog",[function(){var a='<div modal class="modal-dialog modal--responsive" toggle="dialog.isOpen" ng-class="dialog.options.cssClassModal"></div>';this.$get=["$compile","$rootScope","$document","templateToPromise","$q","$controller","injectResolve",function(b,c,d,e,f,g,h){function i(b){var d=this;return d.options=b||{},d.template=$(a),d.isOpen=!1,d.willClose=f.defer(),d.willResolve=f.all([h(d.options.resolve||{}),e(d.options)]).then(function(a){var b=a[0],e=a[1];return d.template.html(e),b.dialog=d,b.$scope=_.firstDefined(b.$scope,c.$new()),b}),d}return i.prototype.open=function(){var a=this;return a.isOpen=!0,a.willResolve.then(function(b){a._appendDom(b)}),a.willClose.promise},i.prototype.close=function(a){this.isOpen&&(this.isOpen=!1,this.willClose.resolve(a),this._removeDom())},i.prototype._appendDom=function(a){var c=this;c.options.controller&&c.template.contents().data("ngControllerController",g(c.options.controller,a)),c._el=b(c.template.clone())(a.$scope),d.find("body").append(c._el)},i.prototype._removeDom=function(){this._el.remove(),delete this._el},function(a){return new i(a)}}]}]).factory("templateToPromise",["$http","$templateCache","$q",function(a,b,c){return function(d){return d.templateUrl?a.get(d.templateUrl,{cache:b}).then(function(a){return a.data}):d.template?c.when(d.template):void 0}}]).factory("injectResolve",["$injector","$q",function(a,b){return function(c){function d(b){return _.isString(b)?a.get(b):a.invoke(b)}return b.all(_.map(c,d)).then(function(a){return _.zipObject(_.keys(c),a)})}}]),angular.module("modal",[]).directive("modal",["$document","$window",function(a,b){var c=a.find("body"),d=a.find("html"),e=0;return{restrict:"EA",replace:!0,transclude:!0,scope:!0,templateUrl:"/parts/modal/modal-template.html",compile:function(a,f,g){return function(a,f,h){function i(b){27===b.which&&(a.$broadcast("modal.close"),b.preventDefault(),c.removeClass("is-modal-mode"),f.hide(),e--,0>e&&(e=0),a.$apply())}var j={},k={};a=a.$new(),g(a,function(a){f.find(".modal__inner").append(a)}),a.modal={isActive:!1},a.$watch(h.toggle,function(g){var h=!1;g&&!a.modal.isActive?(c.is(".is-modal-mode")||(j.top=c.scrollTop(),j.left=c.scrollLeft(),k.top=d.scrollTop(),k.left=d.scrollLeft(),c.addClass("is-modal-mode")),e++):!g&&a.modal.isActive&&(e--,0>e&&(e=0),0===e&&(h=!0,c.removeClass("is-modal-mode"))),h&&setTimeout(function(){b.scrollTo(j.left||k.left,j.top||k.top)},100),Boolean(g)?(f.show(),a.modal.isActive=!0,c.on("keydown",i)):(a.modal.isActive=!1,c.off("keydown",i))}),a.$on("$destroy",function(){a.modal.isActive&&(e--,0>e&&(e=0),0===e&&c.removeClass("is-modal-mode"))})}}}}]),angular.module("moreContributors",[]).directive("moreContributors",[function(){return{restrict:"EA",templateUrl:"/parts/more-contributors/more-contributors-template.html",scope:{actorslist:"=actorslist",moreContributorsMax:"=maxlimt"},link:function(a){a.$watch("actorslist",function(b){void 0!==b&&""!==b&&null!==b&&(a.actors=b.split(","))}),a.getMoreContributors=function(b){a.moreContributors=!0,setTimeout(function(){var a=$(b.target).parents(".metadata-links").find(".scroll-pane");a.hasClass("jspScrollable")||(options.mouseScroll=!0,new JScrollPaneVertical(a,options))},100)},a.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/"},a.actorSearch=function(b){return"undefined"!==reporting&&(reporting.setEvents(["event17"]),reporting.sendAttrs(!0)),null===b||void 0===b?!1:(b='"'+b.replace(/"/g,"")+'"',window.location=a.searchCategory.ondemand+b+"/false",void 0)},a.moreContributorsValueToggle=function(){a.moreContributors=!1}}}}]),angular.module("nestModal",["toggle"]).directive("nestModal",["$document","$window","$parse",function(a,b,c){var d=a.find("body"),e=a.find("html"),f=0;return{restrict:"EA",replace:!0,require:"?toggle",transclude:!0,scope:!0,templateUrl:"/parts/nest-modal/nest-modal-template.html",compile:function(){return function(a,g,h,i){function j(b){27===b.which&&(b.preventDefault(),d.removeClass("is-modal-mode"),g.hide(),f--,0>f&&(f=0),a.$apply())}var k={},l={};if(a.modal={isActive:!1},a.$watch(h.toggle,function(c){var h=!1;c&&!a.modal.isActive?(d.is(".is-modal-mode")||(k.top=d.scrollTop(),k.left=d.scrollLeft(),l.top=e.scrollTop(),l.left=e.scrollLeft(),d.addClass("is-modal-mode")),f++):!c&&a.modal.isActive&&(f--,0>f&&(f=0),0===f&&(h=!0,d.removeClass("is-modal-mode"))),h&&setTimeout(function(){b.scrollTo(k.left||l.left,k.top||l.top)},100),Boolean(c)?(g.show(),a.modal.isActive=!0,d.on("keydown",j)):(a.modal.isActive=!1,d.off("keydown",j))}),a.close=void 0,h.hasOwnProperty("closeAction"))if(_.isEmpty(h.closeAction))a.close=i?function(){i.toggle(!1)}:function(){g.addClass("hidden")};else{var m=c(h.closeAction);a.close=function(){m(a)}}a.$on("$destroy",function(){a.modal.isActive&&(f--,0>f&&(f=0),0===f&&d.removeClass("is-modal-mode"))})}}}}]),angular.module("noSpecialchar",[]).directive("noSpecialchar",function(){return{require:"ngModel",restrict:"A",link:function(a,b,c,d){d.$parsers.push(function(a){if(null==a)return"";var b=a.replace(/[^\w\s\+\-\|]/gi,"");return b!==a&&(d.$setViewValue(b),d.$render()),b})}}}),angular.module("notice",[]).directive("notices",["$notice","$compile",function(a,b){return{restrict:"E",replace:!0,scope:!0,template:['<ul class="notices">','<li ng-repeat="notice in notices" class="added">','<div class="notice">','<p class="notice-message notice-{{notice.level}}" ng-bind="notice.message"></p>',"</div>","</li>","</ul>"].join(""),link:function(c,d,e){var f,g,h;f=a.all(),g=c.$eval(e.begin)||0,h=c.$eval(e.end),c.notices=f.slice(g,h),c.$on("notice.add",function(){c.notices=f.slice(g,h)}),c.$watch("notices",function(){}),b(d.contents())(c)}}}]).factory("$notice",["$rootScope",function(a){var b={notices:[],add:function(b,c){c=c||"info";var d={message:b,level:c};return this.notices.push(d),a.$broadcast("notice.add",d)},all:function(){var b=this.notices;return a.$broadcast("notices.all",!0),b},dismiss:function(b){return this.notices.splice(b,1),a.$broadcast("notices.remove",!0)},count:function(){return a.$broadcast("notices.count",!0),this.notices.length},clear:function(){return a.$broadcast("notices.clear",!0),this.notices=[]}};return b}]),angular.module("offsetTop",[]).directive("offsetTop",["$parse",function(a){return{link:function(b,c,d){function e(){f(b,c.offset().top)}var f=a(d.offsetTop).assign;e(),b.$on("offsetTop.recalculate",e)}}}]),angular.module("onceWithinViewport",[]).directive("onceWithinViewport",["$rootScope",function(a){function b(a){var b=a.getBoundingClientRect();return(0!==b.top||0!==b.bottom||0!==b.left||0!==b.right)&&b.top<=$(window).height()&&b.left<=$(window).width()}function c(){try{clearTimeout(d)}catch(c){}$("html").is(".is-sheet-mode")||(console.log("onceWithinViewport triggered"),d=setTimeout(function(){var c,d;0!==e.length&&a.$apply(function(){for(c=e.length-1;c>=0;c--)d=e[c],angular.isObject(d)?(d.scope.inViewport=b(d.el))&&e.splice(c,1):console.error("scopeAndElement is undefined")})},100))}var d,e=[];return $(window).on("DOMContentLoaded load scroll resize",c),{transclude:!0,scope:!0,template:'<div>  <div ng-hide="inViewport || forceInViewport" ng-style="inlineStyles" class="once-within-viewport--placeholder"></div>  <div ng-transclude if="inViewport || forceInViewport"></div></div>',link:function(a,b,d){function f(c){g=setInterval(function(){var c=a.inViewport&&b.height();c!==!1&&0!==c&&(a.height=c,a.inlineStyles.height=c+"px",clearInterval(g))},c)}var g,h={el:b[0],scope:a};a.height=0,a.inlineStyles={},a.inViewport=!1,d.$observe("onceWithinViewport",function(b){a.forceInViewport=!!b&&"false"!==b}),f(2e3),e.push(h),b.on("$destroy",function(){var a=_.indexOf(e,h);a>-1&&e.splice(a,1)}),c()}}}]),angular.module("onyxVodTopPicks",["vod","movieCart","oolCookie","poster","onetCookies"]).directive("onyxVodTopPicks",function(){return{restrict:"EA",templateUrl:"/parts/onyx-vod-top-picks/onyx-vod-top-picks-template.html",scope:{topPicks:"=items"},controller:["$scope","Vod","$http","movieCart","$notice","OnDemand","ooluser","$timeout","Config","$window","Cookies",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:a}),reporting.setAttrs({prop10:a}),reporting.sendAttrs(!0))}var m=$(window).width();a.windowHref=window.location.href,g.laBoxUser=g.hasOOLSession?g.laBoxUser||g.laboxOrMini:"true"===k.getCookie("labox"),a.ooluser=g,a.isExpanded=!0;var n=1e4,o="Vod_more_info",p=i.getValuesBySelector("vodTopPicks");a.$watch("topPicks",function(c,d){if(c!==d)if(a.showCarousel=c.showCarouselFlag===!0?!0:!1,a.topPicksItems=c.titles.slice(0,p.maxItems),n=c.carouselAutoCycle?c.carouselAutoCycle:p.autoCycleTime,a.getTapDetail=function(a){l(o),window.location.href="/tv/asset/#/movie/"+a},_.map(a.topPicksItems,function(c){if(c.isSD=null!==c.sd_asset&&void 0!==c.sd_asset&&""!==c.sd_asset?!0:!1,c.isHD=null!==c.hd_asset&&void 0!==c.hd_asset&&""!==c.hd_asset?!0:!1,void 0!==c.rental_period&&""!==c.rental_period&&null!==c.rental_period&&(c.rental_period_hour=Math.floor(c.rental_period/3600)),null===c.stream_length||void 0===c.stream_length)c.duration=!1;else{c.duration=!0;var d=Math.floor(c.stream_length/60);c.stream_length_hours=d;var e=Math.floor(c.stream_length%60);c.stream_length_mins=e}var f=b.getrating(c.rating);c.tprating=f.content_rating,c.starRating=f.critics_rating;var g=b.getindicators(c.indicators);c.cc=g._cc,a.getCartDetails(c)}),isViewportSize.phone&&isDeviceWidth.phone){if(767>m&&$(".carousel").carousel({interval:1e8}),769>m){var e=$(".description-text").height();setTimeout(function(){var a=$(".carousel-indicators li.active").first().attr("data-slide-to");"0"===a&&(100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."}))},250),$(".carousel-inner").swipe({swipeLeft:function(){$(this).parent().carousel("next"),100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},swipeRight:function(){$(this).parent().carousel("prev"),100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},tap:function(b){($(b.target).hasClass("img-alt")===!0||$(b.target).hasClass("carouselImg")===!0||$(b.target).hasClass("img-alt__graphic")===!0)&&h(function(){var b=$(".carousel-indicators li.active").first().attr("data-slide-to"),c=a.topPicksItems[b].id;l(o),window.location.href="/tv/asset/#/movie/"+c},5)},threshold:50})}}else $(".carousel").carousel({interval:n,pause:"none"}),setTimeout(function(){var a=$(".description-text").height();100>a?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},250),$(document).on("mouseenter","[id=carouselItemId]",function(){$(".carousel").carousel("pause")}),$(document).on("mouseleave","[id=carouselItemId]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),$(document).on("click","[data-slide=next]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),$(document).on("click","[data-slide=prev]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),a.getDetail=function(a){l(o),window.location.href="/tv/asset/#/movie/"+a},$(".carousel").on("slid.bs.carousel",function(){setTimeout(function(){$(".carousel-indicators li").size();var a=$(".carousel-indicators li.active").first().attr("data-slide-to"),b=$(".description-text").height();"0"===a?100>b?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."}):100>b?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},80)})}),a.removeFromCart=function(b){void 0!==b.onDemandAsset&&b.onDemandAsset.removeFromCart(angular.noop,a.notifyNoCart)},a.getCartDetails=function(a){var c=a.hd_asset||a.sd_asset;b.VodMovieCart.contains(c,function(b){a.inCart=b.inCart,a.inCartHd=b.hd_asset,a.inCartSd=b.sd_asset})},a.addToCart=function(b){void 0!==b.onDemandAsset&&b.onDemandAsset.addToCart(angular.noop,a.notifyNoCart)},a.removeFromCart=function(c,d){var e=d?"Vod_remove_cart_hd":"Vod_remove_cart_sd";b.removeFromCart(c,e,function(b){"SUCCESS"===b.status&&a.changeState(c,d,!1)})},a.removeFromFavorites=function(c){var d="Vod_remove_cart_hd",e=!0,f=c.hd_asset;c.inCartHd||(d="Vod_remove_cart_sd",e=!1,f=c.sd_asset),b.removeFromCart(f,d,function(b){"SUCCESS"===b.status&&a.changeState(f,e,!1)})},a.addToCart=function(c,d){var e=d?"Vod_cart_hd":"Vod_cart_sd";g.hasOOLSession?b.addToCart(c,e,function(b){"SUCCESS"===b.status&&a.changeState(c,d,!0)}):(l(e),j.location.href="/login?referer="+window.location.href)},a.addToFavorites=function(c){var d="Vod_cart_hd",e=!0,f=c.hd_asset;c.hd_asset||(d="Vod_cart_sd",e=!1,f=c.sd_asset),g.hasOOLSession?b.addToCart(f,d,function(b){"SUCCESS"===b.status&&a.changeState(f,e,!0)}):(l(d),j.location.href="/login?referer="+window.location.href)},a.changeState=function(b,c,d){if(c===!0){var e=_.find(a.topPicksItems,{hd_asset:b});void 0!==e&&(e.inCartHd=d,e.inCart=e.inCartHd===!1&&e.inCartSd===!1?!1:!0)}if(c===!1){var f=_.find(a.topPicksItems,{sd_asset:b});void 0!==f&&(f.inCartSd=d,f.inCart=f.inCartHd===!1&&f.inCartSd===!1?!1:!0)}}}]}}).filter("getRatingClass",function(){return function(a){return null!==a?"":"0-0"}}),angular.module("pagination",["summarize","dropdowns"]).directive("pagination",["$parse","summarize",function(a,b){return{restrict:"E",templateUrl:"/parts/pagination/pagination-template.html",scope:{current:"=",itemsTotal:"=",itemsPerPage:"=",onChange:"&"},link:function(a,c,d){function e(){if(a.current>a.count)for(var b=a.current-1;b;){if(b<a.count){a.current=b;break}b--}}function f(c){a.pageNums=a.count?_.range(0,a.count):[],a.pageNumsOptions=_.map(a.pageNums,function(a){return{label:a+1,value:a}});var d={focus:c,displayCount:a.countDisplay};a.pages=_.map(b(a.pageNums,d),g)}function g(a){var b={};return b.isSeparator=!_.isNumber(a),b.index=b.isSeparator?null:a,b.display=b.isSeparator?a:a+1,b}function h(b,c,e){_.isDefined(d[b])?a[b]=_.isFunction(e)?e(d[b]):d[b]:_.isDefined(c)&&(a[b]=c)}h("countDisplay",7,a.$eval),f(a.current),a.m={current:a.current},a.$watch("current + itemsTotal + itemsPerPage",function(){a.count=Math.ceil(a.itemsTotal/a.itemsPerPage),e(),f(a.current),a.m.current=a.current}),a.$watch("m.current",function(){a.current=a.m.current}),a.selectPage=function(b){_.isNumber(b)&&(a.current=b,a.onChange({$event:{pageNum:b}}))}}}}]).filter("page",function(){return function(a,b,c){if(c=parseInt(c,0),!_.isUndefined(a)){if(a.length<c)return a;var d=c*b,e=d+c;return a.slice(d,e)}}}),angular.module("summarize",[]).factory("summarize",function(){return function(a,b){b=_.firstDefined(b,{}),a=_.clone(a);var c=_.firstDefined(b.divideText,"..."),d=_.firstDefined(b.focus,0),e=_.firstDefined(b.displayCount,10),f=a.length;a.length-1;var g=0;if(e>f)return a;maxHalf=Math.floor(e/2),minHalf=Math.round(e/2);var h=Math.max(d-maxHalf,0),i=Math.min(d+minHalf,f);return h-=Math.max(minHalf-i+d,0),i+=Math.max(maxHalf-h-d,0),_array=a.slice(h,i),h>g&&_array.splice(0,2,_.first(a),c),f>i&&_array.splice(-2,2,c,_.last(a)),_array}}),angular.module("panel",["toggle"]).directive("panel",["$parse",function(a){return{templateUrl:"/parts/panel/panel-template.html",restrict:"EA",transclude:!0,require:"?toggle",replace:!0,scope:!0,link:function(b,c,d,e){if(b.close=void 0,d.hasOwnProperty("closeAction"))if(_.isEmpty(d.closeAction))b.close=e?function(){e.toggle(!1)}:function(){c.addClass("hidden")};else{var f=a(d.closeAction);b.close=function(){f(b)}}b.$on("modal.close",function(){b.close&&b.close()})}}}]),angular.module("payBillCsr",["config"]).directive("payBillCsr",["Config",function(){return{templateUrl:"/parts/pay-bill-csr/pay-bill-csr-template.html",link:function(){}}}]),angular.module("paybillsheader",["modal","panel","payBillResource","pbsucmsgs","pberrmsgs","payBillUtils","spinner","transferModal","moveTransferService","acctChecksum"]).directive("paybillheader",["PayBillService","PayBillUtils","ooluser","$rootScope","MoveTransferService",function(a,b,c,d,e){return{restrict:"E",templateUrl:"/parts/pay-bill-header/pay-bill-header-template.html",link:function(c){function f(a){d.$broadcast("bpGlobalSuccess",a),utils.handleSuccessfullResponse(a,c,{noClear:!0})&&(c.globalBP=a,d.systemDate=a.systemDate,d.dueAmount=a.amountDue,d.dueDate=a.dueDate,d.lastAmount=a.statementBalance,d.lastAmount&&(d.statements=!0),h(),a.csrId&&(c.csrId=!0))}function g(a){d.$broadcast("bpGlobalError",a),utils.handleErrorResponse(model)}function h(){a.getPaymentMethods({},i,j)}function i(a){d.$broadcast("ebillInfoSuccess",a);var b=90;if(c.showSpinner=!1,null!==a.discoDate){if(c.disconnectDate=utils.parseDate(a.discoDate),c.pastAcctAvlDateFull=utils.addDays(c.disconnectDate,b),c.pastAcctAvlDateFull=utils.dateToString(c.pastAcctAvlDateFull),c.pastAcctAvlDateFull&&null!==c.pastAcctAvlDateFull){var e=c.pastAcctAvlDateFull.split("/").join(""),f=e.substring(0,2),g=e.substring(2,4),h=e.substring(6,8);c.showDate=f+"/"+g+"/"+h}c.tempDate=c.pastAcctAvlDateFull.split("/"),c.pastAcctAvlDate=c.tempDate[0]+"/"+c.tempDate[1]}c.pbDataLoaded=!0,c.ebillInfo=a,c.toAcctEbillInfo=utils.computeToAcctEbillInfo(c.ebillInfo),c.ebillInfo.ebillInformationOutputs.length>1?(c.isMoved=!0,c.movedAcctNumber=utils.formatAccountNumber(c.toAcctEbillInfo.accountNum),c.acctMovedText="Available until "+c.pastAcctAvlDate):c.acctMovedText="",c.firstPageLoad&&c.toggleAccountHead()}function j(a){d.$broadcast("ebillInfoError",a),c.showSpinner=!1}function k(b){if(d.$broadcast("toggleAccountSuccess",b),c.firstPageLoad=!1,a.checkSuccess(b)){if(c.toggleAcctResponse=b,c.showAcctText=b.accounts.length?!0:!1,1===b.accounts.length)for(var e=0;e<b.accounts.length;e++)c.showAcctDropdown=!1,c.pageHasLoaded=!0,c.displayAccountNumber=utils.formatAccountNumber(b.accounts[e].accountNumber).toString();else if(Number(utils.getURLParameter("ppi")>0)){c.showAcctDropdown=!1,c.pageHasLoaded=!0;
for(var f=0;f<b.accounts.length;f++)"0"===b.accounts[f].accountType&&(c.displayAccountNumber=utils.formatAccountNumber(b.accounts[f].accountNumber).toString())}else c.showAcctDropdown=!0,c.pageHasLoaded=!0;var g=-1;if(b.accounts.length&&!Number(utils.getURLParameter("ppi")>0))for(var h=0;h<b.accounts.length;h++)c.accounts=2===b.accounts.length?[b.accounts[0],b.accounts[1]]:[b.accounts[0],b.accounts[2],b.accounts[1],b.accounts[3]],b.accounts[h].active?(g=h,"0"===c.accounts[h].accountType||"1"===c.accounts[h].accountType?c.accounts.length>2?c.model.accountOptions[h]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phonet-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[h].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[h]={label:{text:utils.formatAccountNumber(c.accounts[h].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}):("0"!==c.accounts[h].accountType||"1"!==c.accounts[h].accountType)&&c.fromflag&&(c.accounts.length>2?c.model.accountOptions[h]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phone-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[h].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[h]={label:{text:utils.formatAccountNumber(c.accounts[h].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}))):"0"===c.accounts[h].accountType||"1"===c.accounts[h].accountType?c.accounts.length>2?c.model.accountOptions[h]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phone-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[h].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[h]={label:{text:utils.formatAccountNumber(c.accounts[h].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}):("0"!==c.accounts[h].accountType||"1"!==c.accounts[h].accountType)&&c.fromflag&&(c.accounts.length>2?c.model.accountOptions[h]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phone-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[h].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[h]={label:{text:utils.formatAccountNumber(c.accounts[h].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[h].accountNumber)}));d.acctDetail=b.accounts;var i=utils.getObjInArrayByValue(d.acctDetail,"active",!0);c.activeAcctNum=i.accountNumber,model.account=utils.formatAccountNumber(c.activeAcctNum),c.activeAcctEbillInfo=utils.computeActiveAcctEbillInfo(i.accountNumber,c.ebillInfo),c.acctType=i.accountType,d.isPaperBill=c.activeAcctEbillInfo&&c.activeAcctEbillInfo.isPaperBill?!0:!1,d.hasAutoPay=c.activeAcctEbillInfo&&c.activeAcctEbillInfo.hasAutoPay?!0:!1,c.activeAcctEbillInfo&&c.activeAcctEbillInfo.email?$("#emailInputPBill").val(c.activeAcctEbillInfo.email):c.enrollClicked=!0,c.activeAcctEbillInfo.isFrom&&(d.showMakeSection=!1),p()}}function l(a){d.$broadcast("toggleAccountError",a),c.showSpinner=!1}function m(){a.getPaymentMethods({},n,o)}function n(a){c.ebillInfo=a,p()}function o(){c.showSpinner=!1}function p(){t.init(),console.log("Inside transfer modal handler"),c.moveTransferService.setEBillResponse(c.ebillInfo),c.isServiceAvailable=t.isServiceAvailable(),c.isModalNeeded=t.isModalNeeded(),d.isGetStartedClicked&&(c.isModalNeeded=!0),c.isModalNeeded&&(console.log("If is modal needed then inside transfer modal transfer"),t.updateTransferData())}function q(b){b.mailNotifyInd=!0,b.paperBillInd=!0,utils.clearAllMessages(model),a.updateCommunication(b,r,s)}function r(a){c.showSpinner=!1,utils.handleSuccessfullResponse(a,c,{scroll:"header"})?c.emailupdate?(c.emailupdate=!1,c.activeAcctEbillInfo.isPaperBill!==model.allowEmail?(data={},data.email=$("#emailInputPBill").val(),q(data)):(model.popupSuccessMsg="Details updated successfully",d.isPaperBill=!1)):(model.successMsg="Thanks for enrolling in paperless billing. Way to save some trees!<br>Notifications about your account and new statements will be sent to&nbsp"+data.email+".",utils.addSuccessLeafToAlerts(c,"Thanks for enrolling in paperless billing. Way to save some trees!<br>Notifications about your account and new statements will be sent to&nbsp"+data.email+"."),c.paperlessBilling(!1),d.isPaperBill=!1,"undefined"!==reporting&&(reporting.setEvents(["event39"]),reporting.sendAttrs(!0))):c.paperlessBilling(!1),c.showAlert=!0}function s(){c.showSpinner=!1}c.model.paperless=!1,c.model.showCancel=!1,c.enrollClicked=!1,c.currentAccountNumber="",c.displayAccountNumber="",c.csrId=!1,c.model.changed=!1,c.showSpinner=!1,utils=b,c.showAcctDropdown=!1,c.model.accountOptions=[],c.disconnectDate="",c.isMoved=!1,c.acctMovedText="",c.fromflag=!0,c.accountNumber=[],d.showMakeSection=!0,d.showOptOut=!0,c.acctType=null,c.firstPageLoad=!0,c.$watch("model.account",function(a){0===a||1===a||2===a||3===a?(model.account=c.model.accountOptions[a].label.text,d.accountNoSelected=model.account):d.accountNoSelected=model.account}),d.$watch("isGetStartedClicked",function(a,b){console.log("isGetStartedClicked newval: "+a+"oldVal: "+b),a&&(d.isGetStartedClicked=!0,m())}),c.enrollCheck=function(){return c.model?!c.model.allowEnroll:!0},c.paperlessOption=function(){$("#emailInputPBill").val()===c.activeAcctEbillInfo.email?c.model.paperless=!1:c.model.paperLessCancel=!0},c.togglePaperCancel=function(a){c.model.paperLessCancel=a?!1:!0},c.checkForCancelPopup=function(){c.DDIOffer?window.location.href="/showtimeoffer":c.isIntlPostPaid?history.go(-1):window.location.href="/pay-bill"},c.checkCancel=function(){c.model.changed?c.model.showCancel=!0:utils.isPrevDomainSame()?history.go(-1):window.location.href="/pay-bill"},c.toggleCancel=function(a){c.model.showCancel=a?!0:!1},c.paperlessBilling=function(a){$("#emailInputPBill").val(c.activeAcctEbillInfo.email),$("#emailInputPBill").removeClass("error-input"),$("#headerEmailError").addClass("hidden"),c.enrollClicked=c.activeAcctEbillInfo&&c.activeAcctEbillInfo.email?!1:!0,a?c.model.paperless=!0:(c.model.paperless=!1,c.model.paperLessCancel=!1)},d.isPaperBill=!1,c.pbDataLoaded=!1,c.getGlobalPB=function(){a.getBPGlobal({},f,g)},c.toggleAccountHead=function(){c.acctType?a.toggleAccount(k,l,c.acctType):a.toggleAccount(k,l)};var t=function(){function a(){c.modalNeeded=!1,c.moveTransferService=e,c.moveTransferService.displayModal=!1}function b(){if(c.ebillInfo&&c.ebillInfo.ebillInformationOutputs){for(var a,b=!1,d=!1,e=!1,f=!1,g=0;g<c.ebillInfo.ebillInformationOutputs.length;g++)a=c.ebillInfo.ebillInformationOutputs[g],a.isFrom?(b=a.paymentMethods.length>0,f=a.manualBlockInd||a.classCodeInd):(d=a.paymentMethods.length>0,e=a.manualBlockInd||a.classCodeInd);if(b&&!d&&!e&&!f&&1!==c.ebillInfo.mtAknowInd)return!0}return!1}function f(){var a=!0;if(!c.isServiceAvailable)return!1;if(d.acctDetail)for(var b=0;b<d.acctDetail.length;b++)if("1"===d.acctDetail[b].accountType||"3"===d.acctDetail[b].accountType)return d.showOptOut=!1,!1;if(!c.getStartedFlag&&(c.ebillInfo&&0===c.ebillInfo.apOptOut||0===c.ebillInfo.pmOptOut))return!1;var e=utils.get_cookie("remind_later");return e?(console.log("Remind eme later value is set"),!1):a}function g(){c.responseModal=c.moveTransferService.getEbillResponse(),utils.computeDaysRemaining(h,c.disconnectDate,c.systemDate),c.showTransferModal=!0}var h=90;return{init:a,isServiceAvailable:b,isModalNeeded:f,updateTransferData:g}}();d.$on("accountToggleSuccess",function(){c.getGlobalPB()}),c.emailupdate=!1,c.enrollPaperBill=function(){c.showSpinner=!0,c.enrollClicked=!0,data={},data.email=$("#emailInputPBill").val(),data.origMailNotifyInd=c.activeAcctEbillInfo.mailNotifyInd,data.origPaperBillInd=c.activeAcctEbillInfo.isPaperBill,data.origEmail=c.activeAcctEbillInfo.email,data.mailNotifyInd=!0,data.paperBillInd=!1,a.updateCommunicationNew(data,r,s)},$("#emailInputPBill").live("focusout",function(){utils.isEmail(this.value)?(c.$apply(function(){c.enrollClicked=!1}),$("#emailInputPBill").removeClass("error-input"),$("#headerEmailError").addClass("hidden")):(c.$apply(function(){c.enrollClicked=!0}),$("#emailInputPBill").addClass("error-input"),$("#headerEmailError").removeClass("hidden"))}),$("#emailInputPBill").live("keyup",function(){utils.isEmail(this.value)?(c.$apply(function(){c.enrollClicked=!1}),$("#emailInputPBill").removeClass("error-input"),$("#headerEmailError").addClass("hidden")):(c.$apply(function(){c.enrollClicked=!0}),$("#emailInputPBill").addClass("error-input"),$("#headerEmailError").removeClass("hidden"))}),c.getGlobalPB()}}}]),angular.module("pinInputHideshow",["keyEvents"]).directive("pinInputHideshow",[function(){return{replace:!1,require:"ngModel",scope:!0,template:'<span ng-hide="model.showPassword">    <input type="password"      ng-model="digit.value"      ng-repeat="digit in digits"      class="short input pin-input"      ng-class="{error: model.pinerror}"      on-keydown="keyDown($event, $index)"      ng-change="change($index, digit.value)"      maxlength="1"    /></span><span ng-show="model.showPassword">    <input type="text"      ng-model="digit.value"      ng-repeat="digit in digits"      class="short input pin-input"      ng-class="{error: model.pinerror}"      on-keydown="keyDown($event, $index)"      ng-change="change($index, digit.value)"      maxlength="1"    /></span>',link:function(a,b,c,d){function e(c){g=a.model.showPassword?b.find("input[type='text']"):b.find("input[type='password']"),$(g[c]).focus()}function f(a){return angular.isUndefined(a)||""===a||null===a||a!==a}var g;a.digits=[{},{},{},{}],a.mobileDigits={},d.$render=function(){var b;angular.isString(d.$viewValue)?(b=angular.extend(["","","",""],d.$viewValue.split("")),_.each(a.digits,function(a){a.value=b.shift()}),a.mobileDigits.value=d.$viewValue):(_.each(a.digits,function(a){a.value=""}),a.mobileDigits.value="")},a.keyDown=function(b,c){8===b.keyCode&&c>0&&""===a.digits[c].value&&(a.digits[c-1].value="",e(c-1)),32===b.keyCode&&b.preventDefault()},a.change=function(b,c){a.mobileDigits.value=_.reduce(a.digits,function(a,b){return b.value=b.value.replace(/\D/g,""),a+b.value},""),d.$setViewValue(a.mobileDigits.value),b<a.digits.length-1&&c.match(/\d/)&&e(b+1)},a.mobileChange=function(b){angular.isString(b)&&""!==b?(digits=angular.extend(["","","",""],b.split("")),_.each(a.digits,function(a){a.value=digits.shift()})):_.each(a.digits,function(a){a.value=""}),d.$setViewValue(b)};var h,i=c.ngPattern,j=function(a,b){return f(b)||a.test(b)?(d.$setValidity("pattern",!0),b):(d.$setValidity("pattern",!1),void 0)};i&&(i.match(/^\/(.*)\/$/)?(i=new RegExp(i.substr(1,i.length-2)),h=function(a){return j(i,a)}):h=function(b){var c=a.$eval(i);if(!c||!c.test)throw new Error("Expected "+i+" to be a RegExp but was "+c);return j(c,b)},d.$formatters.push(h),d.$parsers.push(h))}}}]),angular.module("pinInput",["keyEvents"]).directive("pinInput",[function(){return{replace:!1,require:"ngModel",scope:!0,template:'<span ng-switch="isMobile">  <span ng-switch-when="true">    <input type="password"      ng-model="mobileDigits.value"      ng-change="mobileChange(mobileDigits.value)"      maxlength="4"    />  </span>  <span ng-switch-when="false">    <input type="password"      ng-model="digit.value"      ng-repeat="digit in digits"      class="short input pin-input"      on-keydown="keyDown($event, $index)"      ng-change="change($index, digit.value)"      maxlength="1"    />  </span></span>',link:function(a,b,c,d){function e(a){angular.isUndefined(g)&&(g=b.find("input")),$(g[a]).focus()}function f(a){return angular.isUndefined(a)||""===a||null===a||a!==a}var g;a.digits=[{},{},{},{}],a.mobileDigits={},a.isMobile=isMobile(),d.$render=function(){var b;angular.isString(d.$viewValue)?(b=angular.extend(["","","",""],d.$viewValue.split("")),_.each(a.digits,function(a){a.value=b.shift()}),a.mobileDigits.value=d.$viewValue):(_.each(a.digits,function(a){a.value=""}),a.mobileDigits.value="")},a.keyDown=function(b,c){8===b.keyCode&&c>0&&""===a.digits[c].value&&(a.digits[c-1].value="",e(c-1))},a.change=function(b,c){a.mobileDigits.value=_.reduce(a.digits,function(a,b){return b.value=b.value.replace(/\D/g,""),a+b.value},""),d.$setViewValue(a.mobileDigits.value),b<a.digits.length-1&&c.match(/\d/)&&e(b+1)},a.mobileChange=function(b){angular.isString(b)&&""!==b?(digits=angular.extend(["","","",""],b.split("")),_.each(a.digits,function(a){a.value=digits.shift()})):_.each(a.digits,function(a){a.value=""}),d.$setViewValue(b)};var h,i=c.ngPattern,j=function(a,b){return f(b)||a.test(b)?(d.$setValidity("pattern",!0),b):(d.$setValidity("pattern",!1),void 0)};i&&(i.match(/^\/(.*)\/$/)?(i=new RegExp(i.substr(1,i.length-2)),h=function(a){return j(i,a)}):h=function(b){var c=a.$eval(i);if(!c||!c.test)throw new Error("Expected "+i+" to be a RegExp but was "+c);return j(c,b)},d.$formatters.push(h),d.$parsers.push(h))}}}]),angular.module("pins",[]).directive("pin",["$interpolate",function(a){return{restrict:"C",scope:!0,templateUrl:"/parts/pins/pin-template.html",link:function(b,c,d){b.content=null,d.$observe("content",function(c){c&&(b.content=a(c)(b))})}}}]).directive("pinHalo",["$interpolate",function(a){return{restrict:"C",scope:!0,templateUrl:"/parts/pins/pin-halo-template.html",link:function(b,c,d){b.content=null,d.$observe("content",function(c){c&&(b.content=a(c)(b))})}}}]).directive("pinImage",["$interpolate",function(a){return{restrict:"C",scope:!0,transclude:!0,templateUrl:"/parts/pins/pin-image-template.html",link:function(b,c,d){b.content=null,d.$observe("content",function(c){c&&(b.content=a(c)(b))})}}}]),angular.module("platformPlayerTutorial",[]).directive("platformPlayerTutorial",function(){return{restrict:"EA",scope:!0,transclude:!0,replace:!1,templateUrl:"/parts/platform-player-tutorial/platform-player-tutorial-template.html",link:function(a,b){var c=a;c.guid||"";var d=function(a){var b=_.uniqueId(a);return b},e=c.playerId||d("p"),f=c.releaseListId||d("rl"),g=c.releaseModelId||d("rm");d("s"),c.playerId=e,c.releaseListId=f,c.releaseModelId=g,c.isActive=function(){return c.tutorialViewCtrl.isCurrentRow(c.drawerRowID)&&c.drawerRowModel.currentItemSelected},c.$watch("tutorialViewCtrl.isCurrentRow(drawerRowID)",function(){var a=c.tutorialViewCtrl.isCurrentRow(c.drawerRowID);a?$("#singularPlatformPlayer").appendTo(b):c.drawerRowModel.currentItemSelected=null}),c.$watch("drawerRowModel.currentItemSelected",function(){return c.isActive()?(c.guid=c.drawerRowModel.currentItemSelected.guid,$("#singularPlatformPlayer").scope().autoplay=!0,$("#singularPlatformPlayer").scope().guid=c.guid,void 0):(c.guid=null,!c.drawerRowModel.currentItemSelected&&c.tutorialViewCtrl.isCurrentRow(c.drawerRowID)&&($("#singularPlatformPlayer").scope().guid=c.guid),void 0)})}}}),angular.module("platformPlayer",[]).directive("platformPlayer",function(){return{restrict:"E",scope:{guid:"=",autoplay:"=",playerId:"=",releaseListId:"=",releaseModelId:"="},transclude:!0,replace:!1,templateUrl:"/parts/platform-player/platform-player-template.html",link:function(a){a.hashstring=function(){return(a.autoplay?"autoplay|":"")+a.guid},a.$watch("guid",function(){if(a.guid){var b,c=a.guid.split(";")[0],d=a.guid.split(";")[1];b=d&&/\bMP_LANG=es\b/.test(document.cookie)?d:c;var e="VoHPaA2I";a.iframeURL="https://cdn.jwplayer.com/players/"+b+"-"+e+".html"}else a.iframeURL="about:blank"})}}}),angular.module("poster",["if","ngSanitize","imgAlt"]).directive("poster",[function(){return{restrict:"EA",replace:!0,template:'<div class="poster">  <div img-alt no-autosize url="{{posterModel.url}}" is-fallback="true">    <div class="poster__fallback-text" ng-bind-html="posterModel.title"></div>  </div></div>',scope:!0,link:function(a,b,c){a.posterModel={},a.posterModel.noImage="No Image Found";var d,e,f;c.$observe("type",function(a){d=a}),c.$observe("types",function(a){f=a}),c.$observe("label",function(b){e=b,"Genre"===d||"Phrase"===d||"Personality"===d||"Concept"===d||"Music Artist"===d||"Artist"===d||"Channel Collection"===d||"Player"===d||"Team"===d||"Language"===d||"Collection"===d||"Channel"===d?(console.log("in title",d+": "+e),a.posterModel.title=d+": "+e):a.posterModel.title="Genre"===f||"Phrase"===f||"Personality"===f||"Concept"===f||"Music Artist"===f||"Artist"===f||"Channel Collection"===f||"Player"===f||"Team"===f||"Language"===f||"Collection"===f||"Channel"===f?f+": "+e:e+"<br>"+"(No Image Found)"}),c.$observe("url",function(b){"Genre"===d||"Phrase"===d||"Personality"===d||"Concept"===d||"Music Artist"===d||"Artist"===d||"Channel Collection"===d||"Player"===d||"Team"===d||"Language"===d||"Collection"===d||"Channel"===d?(a.posterModel.url=null,a.posterModel.title=d+": "+e):"Genre"===f||"Phrase"===f||"Personality"===f||"Concept"===f||"Music Artist"===f||"Artist"===f||"Channel Collection"===f||"Player"===f||"Team"===f||"Language"===f||"Collection"===f||"Channel"===f?(a.posterModel.url=null,a.posterModel.title=f+": "+e):a.posterModel.url=b}),c.$observe("width",function(b){a.posterModel.width=b})}}}]),function(){function a(a){return new b(a)}function b(a){return this.options=_.defaults(a,{mayLoop:!0}),this.options.lowerLimit=0,this.currentIndex=0,this}function c(a,b,c){return a>c?a:c>b?b:c}angular.module("queue",[]).factory("queue",function(){return a}),b.prototype.next=function(){return this.move(1),this},b.prototype.previous=function(){return this.move(-1),this},b.prototype.goto=function(a){return this.currentIndex=c(this.options.lowerLimit,this.options.upperLimit,a),this},b.prototype.length=function(){return this.options.upperLimit+1},b.prototype.remove=function(a){function b(a){return a>c.options.upperLimit||a<c.options.lowerLimit}var c=this;return b(a)?!1:1===this.length()?(this.currentIndex=null,this.options.upperLimit=null,this):((a===this.options.upperLimit&&this.currentIndex===this.options.upperLimit||a<this.currentIndex)&&(this.currentIndex-=1),this.options.upperLimit-=1,this)},b.prototype.move=function(a){function b(a){return a>f.options.upperLimit?a-f.options.upperLimit:a<f.options.lowerLimit?Math.abs(a):0}function d(a){switch(a){case"-":return f.options.upperLimit;case"+":return f.options.lowerLimit;default:throw a+" is not a valid direction! Should be - for backward or + for forward"}}function e(a,b,c){switch(a){case"+":return b+c;case"-":return b-c}}var f=this;if(0===a)return this;if(!this.options.mayLoop)return this.currentIndex=c(this.options.lowerLimit,this.options.upperLimit,this.currentIndex+a),this;var g=Math.abs(a),h=a>0?"+":"-",i=Math.floor(g/(this.options.upperLimit+1)),j=(this.options.upperLimit+1)*i,k=g-j,l=e(h,this.currentIndex,k),m=b(l);return m&&(l=e(h,d(h),m-1)),this.currentIndex=l,this}}(),angular.module("radio",[]).directive("radio",["$parse",function(){return{restrict:"C",replace:!0,transclude:!0,scope:!0,template:["<div",' ng-class="{'," 'is-checked': radioButton.checked,"," 'not-checked': !radioButton.checked",' }"',">",'<div class="radio-inner" ng-transclude></div>',"</div>"].join(""),link:function(a,b){var c=angular.element(b).find(":input")[0];angular.element(c).hide(),angular.element(b).on("click",function(){c.click()}),a.radioButton=c}}}]),angular.module("recordingExpandable",[]).directive("recordingExpandable",["$parse",function(a){return{restrict:"E",scope:!0,templateUrl:"/parts/recording-expandable/recording-expandable-template.html",controller:["$scope","$attrs",function(b,c){var d={isOpen:!1,isDisabled:!1};b.toggleExpandable=function(){d.isDisabled||(d.isOpen=!d.isOpen)},b.$watch(a(c.disabled),function(a){d.isDisabled=Boolean(a)}),b.expandable=d}]}}]),angular.module("reportingTools",[]).factory("ReportingEvents",[function(){return{ResetPassword:{Load:{events:"event5"},SendMethod:{events:"event6"},SecurityQuestions:{events:"event7"},EnterNewPassword:{events:"event8"},End:{events:"event9"}},call:function(a){reporting.mixin(a),reporting.call()}}}]).directive("reportingClick",[function(){return{restrict:"A",scope:!0,link:function(a,b,c){$(b).click(function(){var b=a.$eval(c.reportingClick);"object"==typeof b&&(reporting.mixin(b),reporting.click())})}}}]),angular.module("scrollPagination",[]).directive("scrollPagination",[function(){return{transclude:!0,template:"<div ng-transclude></div>",scope:{list:"=list",scrollPagination:"=scrollPagination"},link:function(a,b){function c(){if(e.pageSize<0)e.head=0,e.foot=0;else{var c=b.scrollTop();e.head=Math.max(Math.floor(c/e.height)-(e.extraHead||0),0),e.foot=Math.max((angular.isArray(a.list)?a.list.length:0)-e.head-e.pageSize,0)}}var d,e=a.scrollPagination;a.$watch("list.length",function(){b.scrollTop(0),c()}),a.$watch("scrollPagination.pageSize",c),b.on("scroll",function(){try{clearTimeout(d)}catch(b){}d=setTimeout(function(){a.$apply(c)},40)}),c()}}}]),angular.module("scrollbarWidth",[]).factory("scrollbarWidth",[function(){var a,b,c=$(document.createElement("div")).css({overflowY:"scroll",width:"100px",position:"absolute",top:"-1000px",left:"-1000px"}).append(b=$(document.createElement("div")));return $("body").append(c),a=100-b.width(),c.remove(),a}]),angular.module("serviceCalendar",["radio"]).directive("serviceCalendar",["$rootScope",function(a){return{restrict:"EA",transclude:"true",scope:{timeslots:"=timeslots",selectedslot:"=selectedslot"},templateUrl:"/parts/service-calendar/service-calendar-template.html",link:function(b){function c(){var a=new Date;a.setDate(a.getDate()+29);var b=new Date;return a.getMonth()>b.getMonth()?!0:!1}function d(){for(var a=1;42>=a;a++)$("#date-"+a).text(""),$("#date-"+a).removeClass("slotNotAvaliable"),$("#date-"+a).removeClass("pastDays");b.showlastRowCalendar=!0,b.showNextMonth=!0,b.showPreviousMonth=!0,b.slotsFetched=""!==b.selectedslot?!0:!1}function e(a){b.selectedslot="",b.slotsJson=[];for(var c=$(a).attr("slottime"),d=$(a).attr("slotdate"),e=d,f=e,g=c.split(","),h=0;h<g.length;h++){var i={},j=g[h];i.value=f+","+j,i.display=j;for(var k="",l=j.split("-"),m=l.length,n=0;m>n;n++){var o="";if(2!==l[n].split(":").length){var p=l[n].substring(l[n].length-2,l[n].length);p=":00"+p.toLowerCase();var q=l[n].substring(0,l[n].length-2)+p.toLowerCase();o=q}else o=l[n];n!==m-1&&(o+=" - "),k+=o}i.displaywithcolon=k,b.slotsJson.push(i),b.slotsFetched=!0}}function f(a,b){return new Date(b,a,0).getDate()}b.month="",b.slotsFetched=!1;var g=b.selectedslot;b.loadCalendar_month=function(a){d(),"present"===a?b.showPreviousMonth=!1:"next"===a&&(b.showNextMonth=!1);var c,h,i,j,k,l,m=new Date,n=m.getDate(),o=m.getMonth(),p=m.getFullYear(),q=f(o+1,p);if("present"===a)for(c=0,h=new Date(p,o,1),i=h.getDay(),j=moment(m).format("MMMM"),l=1,k=i+1;l!==q+1;)$("#date-"+k).html("<div id = dateSlot-"+l+">"+l+"</div>"),l===n&&$("#date-"+k).children().addClass("today"),n>l?$("#date-"+k).children().addClass("pastDays"):(l!==n&&$("#date-"+k).children().addClass("slotNotAvaliable"),c++),c>30&&$("#date-"+k).children().addClass("pastDays"),l++,k++;else if("next"===a)for(c=30-(q-n),11===o?(p+=1,h=new Date(p,0,1)):h=new Date(p,o+1,1),i=h.getDay(),o=h.getMonth(),q=f(o+1,p),j=moment(h).format("MMMM"),l=1,k=i+1;l!==q+1;)$("#date-"+k).html("<div id = dateSlot-"+l+">"+l+"</div>"),l>c?$("#date-"+k).children().addClass("pastDays"):$("#date-"+k).children().addClass("slotNotAvaliable"),l++,k++;for(var r=0;r<b.timeslots.availableTimeSlots.length;r++){var s=b.timeslots.availableTimeSlots[r].quotaGroupDay,t=s.split("-"),u=t[0],v=t[1],w=t[2],x=b.timeslots.availableTimeSlots[r].slotTimeDesc,y=new Date;if(y.setFullYear(u,v-1,w),o===y.getMonth()&&p===y.getFullYear()){var z="",A=y.getDate();"present"===a?$("#dateSlot-"+A).removeClass("slotNotAvaliable").addClass("slotAvaliable"):"next"===a&&c>=A&&$("#dateSlot-"+A).removeClass("slotNotAvaliable").addClass("slotAvaliable"),$("#dateSlot-"+A).attr("slotDate",s),z=$("#dateSlot-"+A).attr("slotTime"),void 0!==z?(z=z+","+x,$("#dateSlot-"+A).attr("slotTime",z)):$("#dateSlot-"+A).attr("slotTime",x)}}if(b.month=j+" "+p,b.showlastRowCalendar=""===$("#date-36").text()?!1:!0,g){var B=moment(g.split(",")[0]).format("MMMM");if(B===j){var C=Number(moment(g.split(",")[0]).format("DD")).toString();$("#dateSlot-"+C).addClass("slotSelected"),e("#dateSlot-"+C),b.slotsFetched=!0}else b.slotsFetched=!1}else b.slotsFetched=!1},b.loadCalendar_month("present"),b.showNextMonth=c(),$(".slotAvaliable").live("click",function(){$(this).hasClass("pastDays")||($(".slotAvaliable").removeClass("slotSelected"),$(this).addClass("slotSelected"),g=$(this).attr("slotDate"),e(this),b.$apply())}),b.newValue=function(a){b.selectedslot=a},b.chatNow=function(){a.chatNow()}}}}]),angular.module("sheetdate",["toggle","isViewportSize"]).directive("sheetdate",["$window","$parse","isViewportSize",function(a,b,c){return{restrict:"EA",require:"?toggle",transclude:!0,replace:!0,templateUrl:"/parts/sheet-date/sheet-date-template.html",link:function(d,e,f,g){if(!$.fn.bootstrapDP&&$.fn.datepicker){var h=_.cloneDeep($.fn.datepicker);$.fn.bootstrapDP=h}var i=function(a){if(a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null},j=null,k=null,l=null;if(c.phone){d.$watch("startDate",function(a){var b=i(a);b&&(j=b),l&&l.bootstrapDP("setStartDate",j)}),d.$watch("endDate",function(a){var b=i(a);b&&(k=b),l&&l.bootstrapDP("setEndDate",k)}),d.$watch(f.toggle,function(b){if(Boolean(b)&&3===d.dropdown.currentOption.split("/").length){var c=d.dropdown.currentOption.replace("///g","-"),e=c;l.data({date:e}).bootstrapDP("update").children("input").val(e)}$(a.document.body).toggleClass("is-sheet-mode",Boolean(b))});var m=".ddPickerMobi";l||(l=e.find(m).bootstrapDP(),j&&l.bootstrapDP("setStartDate",j),k&&l.bootstrapDP("setEndDate",k),l.show(),l.on("changeDate",function(a){d.dropdown.updateDate(a.format)}))}var n={title:"",closeLabel:""};f.$observe("sheetTitleText",function(a){n.title=a}),f.$observe("sheetCloseText",function(a){n.closeLabel=a||"Back"}),d.sheet=n,d.sheetCloseAction=b(f.sheetCloseAction)(d)||g.toggle}}}]),angular.module("sheet",["toggle"]).directive("sheet",["$window","$parse",function(a,b){return{restrict:"A",require:"?toggle",transclude:!0,scope:!0,replace:!0,template:'<div class="sheet">  <div class="sheet__inner">    <header class="sheet__head theme--primary" ng-show="sheet.title">      <div class="container">        <div class="hbeam full-width text-unspace vpadding-s">          <div class="align-middle">            <h1 ng-bind="sheet.title"></h1>          </div>          <div class="align-right align-middle">            <button class="btn btn--heading" ng-bind="sheet.closeLabel" ng-click="sheetCloseAction()"></button>          </div>        </div>      </div>    </header>    <div class="sheet__body container vpadding-m" ng-transclude>    </div>  </div></div>',link:function(c,d,e,f){function g(b){var c,d=$(a.document.documentElement),e=$(a.document.body),f=!1,g=!1;b!==!0||d.is(".is-sheet-mode")?b===!1&&d.is(".is-sheet-mode")&&k&&(f=!0,e.css("height",""),d.toggleClass("is-sheet-mode",b)):(j.top=e.scrollTop(),j.left=e.scrollLeft(),g=!0,k=!0,d.toggleClass("is-sheet-mode",b)),f?a.scrollTo(j.left,j.top):g&&(c=e.height())<a.outerHeight&&e.height(c+50)}function h(a){_.contains(l,a)&&(i.animateToward=a,d.removeClass(m).addClass("sheet--anim-"+a))}var i={title:e.sheetTitleText||"",closeLabel:e.sheetCloseText||"",animateToward:""},j={},k=!1;e.$observe("sheetTitleText",function(a){i.title=a}),e.$observe("sheetCloseText",function(a){i.closeLabel=a||"Back"}),c.sheetCloseAction=b(e.sheetCloseAction)(c)||f.toggle,c.$watch(e.toggle,function(a){g(Boolean(a))}),c.$on("$destroy",function(){g(!1)});var l=["top","right","bottom","left"],m="sheet--anim-top sheet--anim-right sheet--anim-bottom sheet--anim-left";h(e.animateToward||"right"),e.animateToward&&c.$watch(i.animateToward,h),c.sheet=i,window.sheet=i}}}]),angular.module("showBusy",["spinner"]).directive("showBusy",[function(){return{transclude:!0,templateUrl:"/parts/show-busy/show-busy-template.html",scope:{showBusy:"="}}}]).directive("hideBusy",[function(){return{transclude:!0,templateUrl:"/parts/show-busy/hide-busy-template.html",scope:{hideBusy:"="}}}]),angular.module("showOnSuccess",[]).directive("showOnSuccess",["$http","$q",function(a,b){function c(a){return a.status>=200&&a.status<300}return function(d,e,f){f.$observe("showOnSuccess",function(d){angular.isString(d)&&""!==d?(e.hide(),a.get(d,{cache:!0}).then(function(a){return c(a)?a:b.reject(a)}).then(function(){e.show()},function(){e.hide()})):e.hide()})}}]),angular.module("slideToggle",[]).directive("slideToggle",[function(){return{restrict:"A",replace:!0,scope:{setState:"=",setLabel:"=",onEvent:"&"},templateUrl:"/parts/slide-toggle/slide-toggle-template.html",link:function(a,b,c){if(c.id,a.setLabel)var d=a.setLabel[0],e=a.setLabel[1];var f=function(){void 0===d&&(d="On"),void 0===e&&(e="Off");var a="";a=e.length>d.length?e.length:d.length,a>3?b.addClass("lrgtoggle"):b.addClass("smltoggle")};f()}}}]),angular.module("smartCarousels",["dots","if","ellipsis","poster","imgAlt","hover","isViewportSize","vod","onetCookies"]).directive("smartCarousels",["$timeout","limitToFilter","isViewportSize","ooluser","Vod","$location","$window","Cookies",function(a,b,c,d,e,f,g,h){return d.laBoxUser=d.hasOOLSession?d.laBoxUser||d.laboxOrMini:"true"===h.getCookie("labox"),{restrict:"EA",scope:{showHide:"=show",localItems:"=items",showMock:"=mock",isLazy:"=lazy",positionWithPosition:"=positionWithPosition",isIndented:"=indent",extraIndent:"=extraIndent",maxSets:"=maxSets",scrollByPixels:"=scrollByPixels",type:"=type",isVod:"=vod"},transclude:!0,replace:!1,templateUrl:"/parts/smart-carousels/smart-carousels-template.html",link:function(c,f,h){function i(){lb(),ib&&(S.items=S.generateMockElements(),cb=S.items.length),r(),c.$emit("carouselEvent",{eventName:"load",eventTarget:$(f)}),n()?(U.addClass("art"),U.removeClass("block"),S.isArtwork=!0):(U.addClass("block"),U.removeClass("art"),S.isArtwork=!1),Q(),l()}function j(){console.log("mock: test callback action")}function k(){var a=!1;(c.localItems[0]!==c.items[0]||c.localItems.length<c.items.length)&&(a=!0),S.items=S.localItems,Q(),l(),a&&P()}function l(){var a;try{delete S.maxItems}catch(b){}if(null!==(a=o())){var c=0,d=0,e=x();_.each(S.items,function(b,f){return c+=(b.itemWidth||140)+(n()?28:0),c>e&&(d++,c=c-(n()?28:0)<=e?0:(b.itemWidth||140)+(n()?28:0)),d>=a?(S.maxItems=f,!1):void 0})}}function m(){a(function(){var a,b=U.width();if(n()){if(S.isArtwork=!0,U.addClass("art"),U.removeClass("block"),void 0!==c.isVod&&c.isVod!==!1)if(angular.isNumber(b)&&b>100&&S.getLimitedItems().length*U.find(".item").outerWidth(!0)>10){var d=0,e=0;setTimeout(function(){$.each(U.find(".item"),function(){e+=1,d+=parseInt($(this).outerWidth(!0),10)}),e===U.find(".item").length&&(V.width(d+10+"px"),r())},20)}else V.width("");else angular.isNumber(b)&&b>100&&(a=S.getLimitedItems().length*U.find(".item").outerWidth(!0))>10?V.width(a+10+"px"):V.width("");V.height()<U.find(".poster").height()&&(V.css("height",U.find(".poster").height()),X.css("top",0),Y.css("top",0))}else S.isArtwork=!1,U.addClass("block"),U.removeClass("art"),V.width(""),V.css("max-height",gb);
r()})}function n(){var a=!1;return"block"===S.type?!1:"art"===S.type?!0:($.each(S.items,function(b,c){return c.artwork?(a=!0,!1):void 0}),a)}function o(){var a=S.maxSets;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)&&a>0?a:null}function p(a){return parseInt(a.toString().match(/-(\d+)$/)[1],10)}function q(a,b){if(a.attr("id")){var c=S.getLimitedItems()[p(a.attr("id"))];return b===!0?c.secondItem.action:c.action}}function r(){if(S.isIndented)hb=0===S.getLimitedItems().length?[]:new Array(1+Math.ceil((V.width()-C(B()))/x()));else{var a=U.width();U.width()<767&&(a=U.width()-4*f.parent().position().left),hb=0===S.getLimitedItems().length?[]:new Array(Math.ceil(V.width()/a))}c.dots=hb}function s(a,b){var d="first"===a?0:"next"===a?I():K(),e=N()&&S.isIndented?B():0;V.animate({left:d},fb,"swing",function(){"function"==typeof b&&setTimeout(function(){var a;b(),angular.isNumber(c.scrollByPixels)&&(a=U.find(".item"),a.each(function(a,b){b=$(b);var c=b.position().left,e=B()-d;return c===e||e>c&&c+b.outerWidth()>e?(F(a),!1):void 0})),S.onScroll(bb,d,e)},fb)})}function t(){isMobile()||(N()?(U.removeClass("show-prev-ui"),O()?U.removeClass("show-next-ui"):U.addClass("show-next-ui")):O()?(U.addClass("show-prev-ui"),U.removeClass("show-next-ui")):(U.addClass("show-prev-ui"),U.addClass("show-next-ui")),db=!0)}function u(){!isMobile()&&db&&(U.removeClass("show-prev-ui"),U.removeClass("show-next-ui"),db=!0)}function v(){db&&t()}function w(){U.css("left",0),U.width(x()),U.removeClass("indented")}function x(){return void 0!==h.cusclass?S.isIndented?$("."+h.cusclass).width():$(f).offsetParent().width()-$(f).position().left:S.isIndented?$(window).width():$(f).offsetParent().width()-$(f).position().left}function y(){S.isIndented&&(U.css("left",B()),U.width(C(B())),U.addClass("indented"),V.css("left",0))}function z(){var a=void 0!==h.cusclass?x()-f.parent().position().left:x();U.width(!isNaN(a)&&a>1?a:"")}function A(){return U.hasClass("indented")}function B(){return void 0!==h.cusclass?0:W[S.positionWithPosition?"position":"offset"]().left+(angular.isNumber(S.extraIndent)?S.extraIndent:0)}function C(a){return x()-a}function D(){return A()?x()-B():angular.isNumber(c.scrollByPixels)?x()-$(U.find(".item")[bb]).offset().left:x()}function E(a){var b=0,c=-1,d=0,e=$(U.find(".item")),f=bb;if(e.size()*e.outerWidth(!0)>x())for(;Math.round(b)<D()&&c!==b&&-1!==f;)c=b,b+=$(e[f]).outerWidth(!0),d++,f=a?f-=1:f+=1;return d-1}function F(a){try{}catch(b){}bb=a}function G(){return bb}function H(a){var b,c=U.find(".item");b=a?$(c[G()-E(a)]).index():$(c[E()-1+G()]).index();try{}catch(d){}return b}function I(){return N()&&S.isIndented?-1*(J()-B()):M()+-1*J()}function J(){var a=$(U.find(".item")[H()+1]).offset().left;return S.isIndented||(a-=$(U).offset().left),angular.isNumber(c.scrollByPixels)&&(a=c.scrollByPixels*Math.floor(D()/c.scrollByPixels)),a}function K(){return M()+Math.abs(L())}function L(){var a=$(U.find(".item")[H(!0)]).offset().left;return void 0!==c.isVod&&c.isVod!==!1&&void 0!==$(U.find(".item")[H(!0)-1]).offset()&&(a=$(U.find(".item")[H(!0)-1]).offset().left),S.isIndented||(a-=$(U).offset().left),angular.isNumber(c.scrollByPixels)&&(a=c.scrollByPixels*Math.floor(Math.max(0,D())/c.scrollByPixels)),a}function M(){return $(U).find(".slide")[S.isIndented?"offset":"position"]().left}function N(){return 1===S.currentSet}function O(){return S.currentSet===hb.length}function P(){s("first",function(){S.currentSet=1,F(0)})}function Q(){N()&&S.isIndented?y():S.isIndented?w():z(),m(),a(v,fb)}function R(a){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:a}),reporting.setAttrs({prop10:a}),reporting.sendAttrs(!0))}var S=c;S.isMobile=isMobile();var T=$(f).attr("id"),U=$(f).find(".carousel"),V=$(f).find(".slide");$(f).find(".item");var W=$(f).find(".dots"),X=$(f).find(".carousel-next"),Y=$(f).find(".carousel-prev"),Z=0;S.currentSet=1;var ab,bb=0,cb=0,db=!1,eb=!1,fb=200,gb=60,hb=[],ib=S.showMock?parseInt(S.showMock,10):!1,jb=$(window).width();S.items=[],S.ooluser=d;var kb="Vod_more_info";S.load=function(){};var lb=function(){var a=function(a){var c=$(a.target),d={targetElem:c,clickedItem:c.is("li")?c:c.parents(".item"),clickedBtn:c.is("button")?c:c.closest("button").length>0?c.closest("button"):!1,clickedInfoBlock:c.is(".info-block")?c:c.closest(".info-block")};d.clickedSecondItem=d.clickedInfoBlock.prev().is(".info-block"),b(a,d)},b=function(a,b){if(!b.clickedBtn&&q(b.clickedItem,b.clickedSecondItem)&&angular.isFunction(q))q(b.clickedItem,b.clickedSecondItem)();else if(!$(a.target).is("button")&&!$(a.target).is("a"))if(R(kb),$(a.target).is(".info-block"))$(a.target).unbind("click"),void 0!==$(a.target).attr("asseturl")&&null!==$(a.target).attr("asseturl")&&(window.location.href="/smarthome/#/product/"+$(a.target).attr("asseturl"));else if(1025>jb){$(a.target).parents(".info-block").unbind("click");var d=$(a.target).parents(".info-block").attr("asseturl");void 0!==d&&null!==d&&(window.location.href="/smarthome/#/product/"+d)}else $(a.target).parents(".info-block").unbind("click"),void 0!==$(a.target).parents(".info-block").attr("asseturl")&&null!==$(a.target).parents(".info-block").attr("asseturl")&&(window.location.href="/smarthome/#/product/"+$(a.target).parents(".info-block").attr("asseturl"));c.$emit("carouselEvent",{eventName:"click",eventTarget:a.target})};f.bind("click",function(b){a(b)}),S.isPast=function(a){return angular.isDate(a)&&a.getTime()<(new Date).getTime()},$(window).resize(function(){S.$apply(function(){Q(),l(),r()})}),$(f).mouseover(function(){t()}),$(f).mouseout(function(){u()}),Y.click(function(){s("previous",function(){S.currentSet--,F(H(!0))})}),X.click(function(){s("next",function(){S.currentSet++,F(H()+1)})}),V.swipe({tap:function(b){(3!==b.which||2!==b.button)&&a(b)},swipe:function(a,b){ab&&clearTimeout(ab),isMobile()&&!eb&&("left"!==b||O()?"right"!==b||N()||(eb=!0,s("previous",function(){S.currentSet--,F(H(!0)),eb=!1})):(eb=!0,s("next",function(){S.currentSet++,F(H()+1),eb=!1})))},threshold:75}),S.$watch("localItems",function(a){a&&(cb=c.localItems.length,setTimeout(function(){S.$apply(r)},100),k())}),S.$watch("localItems.length",function(a){a&&k()}),S.$watch("showHide",function(){c.showHide===!0?($(f).removeClass("hidden"),Q()):$(f).addClass("hidden")}),S.$watch("isIndented",function(){Q(),l()}),S.onScroll=function(a,b,d){Q(),c.$emit("carouselEvent",{carouselId:T,eventName:"scroll",eventTarget:U.find(".item")[a],offset:b,offsetDelta:b-Z-d}),Z=b}};S.generateMockElements=function(){var a=[];switch(ib){case 1:for(var b=1;20>=b;b++)a.push({id:"item",action:j,artwork:"/parts/carousels/images/art"+b+".jpg",info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:j},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]});break;case 2:for(;20>=b;b++)a.push({id:"item",action:j,itemWidth:getRandomInt(10,200),info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:j},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]})}return a},S.getLimitedItems=function(){return angular.isNumber(S.maxItems)?b(S.items,S.maxItems):S.items},S.removeFromCart=function(a,b){var c=b?"Vod_remove_cart_hd_bttm":"Vod_remove_cart_sd_bttm";void 0!==h.landingpage&&"true"===h.landingpage&&(c=b?"Vod_remove_cart_hd":"Vod_remove_cart_sd"),e.removeFromCart(a,c,function(c){"SUCCESS"===c.status&&void 0!==S.items&&S.changeState(a,b,!1)})},S.removeFromFavorites=function(a){var b="Vod_remove_cart_hd_bttm",c=!0,d=a.hd_asset;a.inCartHd||(b="Vod_remove_cart_sd_bttm",c=!1,d=a.sd_asset),e.removeFromCart(d,b,function(a){"SUCCESS"===a.status&&S.changeState(d,c,!1)})},S.addToCart=function(){g.location.href="https://www.optimum.net/smarthome/#/product/Google-Home"},S.addToFavorites=function(a){var b="Vod_cart_hd_bttm",c=!0,f=a.hd_asset;a.hd_asset||(b="Vod_cart_sd_bttm",c=!1,f=a.sd_asset),d.hasOOLSession?e.addToCart(f,b,function(a){"SUCCESS"===a.status&&S.changeState(f,c,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:b}),reporting.setAttrs({prop10:b}),reporting.sendAttrs(!0)),g.location.href="/login?referer="+window.location.href)},S.changeState=function(a,b,c){if(b===!0){var d=_.find(S.items,{hd_asset:a});void 0!==d&&(d.inCartHd=c,d.inCart=d.inCartHd===!1&&d.inCartSd===!1?!1:!0)}if(b===!1){var e=_.find(S.items,{sd_asset:a});void 0!==e&&(e.inCartSd=c,e.inCart=e.inCartHd===!1&&e.inCartSd===!1?!1:!0)}},S.getAssetHref=function(a,b){$(b.target).is("button")||$(b.target).is("a")||void 0!==a&&null!==a&&(window.location.href="/tv/asset/#"+a)},i()}}}]),angular.module("spinner",[]).directive("spinner",[function(){var a={lines:17,lineLength:13,width:2,radius:22,corners:0,rotate:24,color:"#000",speed:1.6,trail:10,shadow:!1,hwaccel:!1,zIndex:999};return{restrict:"EA",replace:!0,template:'<div class="spinner-container" style="box-sizing:content-box;position:relative;"></div>',link:function(b,c,d){var e={};_.each(a,function(a,c){c="lineLength"===c?"length":c,e[c]=_.firstDefined(b.$eval(d[c]),a)}),new Spinner(e).spin(c[0]);var f=2*e.length+2*e.radius+2*e.width;c.width(f).height(f).children().css({top:0,left:0,marginTop:"50%",marginLeft:"50%"})}}}]),angular.module("sportsSchedule",[]).directive("sportsSchedule",[function(){return{restrict:"EA",scope:{sportsData:"=sportsdata"},templateUrl:"/parts/sports-schedule/sports-schedule-template.html",link:function(a){a.dropDownOpen=!1,a.selectedTest={value:0},a.amRegex=new RegExp("a.*m.*"),a.setMonth=function(c){a.sportsData.selectedMonth=c,a.sportsData.selectedMonthDays=b(a.sportsData.daysByMonth[a.sportsData.selectedMonth])},a.$watch("selectedTest.value",function(){if(!a.dropDownOpen&&a.sportsData.hasOwnProperty("selectedMonthDays")){var b=a.sportsData.selectedMonth+"-day-"+a.sportsData.selectedMonthDays[a.selectedTest.value];a.scrollToElement(b)}}),a.scrollToElement=function(a){var b="#"+a,c=$(b).offset().top-$("#header-wrapper").height();$("html,body").animate({scrollTop:c},"slow")},a.setDropDownOpen=function(){a.sportsData.dropDownOpen=!0};var b=function(a){return a?Object.keys(a):[]}}}}]),angular.module("stickyStack",[]).directive("stickyStack",["$window",function(a){function b(a,b){c[b].push(a),c[b].sort(function(a,c){var d="top"===b?a:c,e="top"===b?c:a;return d.parent().offset().top-e.parent().offset().top})}var c={top:[],bottom:[]},d={direction:"down",viewport:"top",stickyClassNames:"is-sticky",stopAt:!1};return{scope:!0,link:function(e,f,g){function h(){if(o.stopAt){var a=$(o.stopAt).offset().top,b=m();if("top"===o.viewport&&(a-=f.outerHeight(),a-=n()),b>=a){var c=b-a;"top"===o.viewport&&(c*=-1),f.css(o.cssSide,n()+c)}else j(k())}else j(k())}function i(){var a=f.is(":visible")?f.outerHeight():0;f.parent().height(a)}function j(a){cssRules={},cssRules[o.cssSide]=a?n():"",cssRules.position=a?"fixed":"",f.css(cssRules),f.toggleClass(o.stickyClassNames,a)}function k(){return l()<=m()}function l(){var a=f.parent().offset().top;return"bottom"===o.viewport&&(a+=f.outerHeight()),a-=n()}function m(){var b=$(a).scrollTop();return"bottom"===o.viewport&&(b+=$(a).height()),b}function n(){var a=_(_.initialUntilItem(c[o.viewport],f));return a.filter(function(a){return a.hasClass("is-sticky")}).reduce(function(a,b){return a+b.outerHeight()},0)}var o=_.defaults({},e.$eval(g.stickyStack),d);o.cssSide={top:"top",bottom:"bottom"}[o.viewport],f.wrap('<div class="sticky-wrapper"/>'),b(f,o.viewport),i(),f.on("resize",i),$(a).on("scroll",function(){h()}),$(a).on("resize",function(){h()}),$(a).on("touchmove",function(){h()})}}}]),angular.module("sticky",[]).directive("sticky",["$window",function(){return{scope:!0,link:function(a,b,c){function d(){var a=b.is(":visible")?b.outerHeight():0;b.parent().height(a)}function e(){function d(a){switch(a){case"0%":case 0:return"sticky--top";case"bottom-in-view":return"sticky--bottom";default:return""}}var e={direction:"down",offset:0,handler:function(a){b.toggleClass(g,a===f.direction)}},f=_.defaults({},a.$eval(c.sticky),e),g="is-sticky "+d(f.offset);return f}b.waypoint("sticky",e()),d(),b.on("resize",d)}}}]),angular.module("pbsucmsgs",[]).directive("successmsg",[function(){return{restrict:"E",templateUrl:"/parts/success-msg/success-msg-template.html",scope:{message:"@message",show:"@show"},link:function(){}}}]),angular.module("textCurrency",[]).directive("textCurrency",[function(){return{restrict:"C",require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){return a.replace(/[^$.0-9]*/g,"")}),$(b).live("input",function(){var a=this.value.replace(/[^$.0-9]*/g,"");this.value=a})}}}]).directive("currencyValidate",[function(){return{restrict:"C",require:"?ngModel",link:function(a,b,c,d){function e(a){if(a){var b=0;if(a=String(a),a=a.replace(/\s/g,""),a.split("$").length>0&&(a=a.split("$").join("")),-1===a.indexOf(".")){if(!isNaN(a)&&(b=parseInt(a,10),b>=1&&1e4>b))return!0}else if(a.split(".")&&2===a.split(".").length&&!isNaN(a.split(".")[0])&&!isNaN(a.split(".")[1])&&a.split(".")[1].length<3&&(b=parseFloat(a,2),b>=1&&1e4>b))return!0}return!1}function f(a){return a&&(a=String(a),a=a.replace(/^\s+|\s+$/g,""),a=a.replace("$",""),a=a.replace(/^[0]+/g,""),""!==a&&("."===a&&(a="0"),a="0"===a||isNaN(Math.abs(parseFloat(a)))?0:Math.abs(parseFloat(a)).toFixed(2)),"0.00"===a&&(a=0),a&&a.length>0&&"$"!==a[0])?"$"+a:""}function g(a){$(a).removeClass("error-input"),e(a.value)||$(a).addClass("error-input")}$(b).on("blur",function(){this.value=f(this.value),g(this)}).on("keyup",function(){g(this)}),d.$formatters.push(f)}}}]),angular.module("textNumber",[]).directive("textNumber",[function(){return{restrict:"C",link:function(a,b,c){$(b).live("keydown",function(a){var b=a.ctrlKey||a.metaKey,d=a.which||a.keyCode||a.charCode;switch(console.log(d),d){case 32:if(console.log("space pressed;;;"+c.noSpace),c.noSpace)return!1;return;case 8:case 37:case 39:case 46:case 9:return;case 67:case 86:case 88:if(b)return;break;default:if(d>=48&&57>=d&&!a.shiftKey||d>=96&&105>=d||a.shiftKey&&52===d)return}return!1})}}}]),angular.module("toggle",[]).directive("toggle",["$parse",function(a){return{scope:!0,controller:["$scope","$attrs","$element",function(b,c,d){function e(a){a=Boolean(a),g.render(a),f(a)}function f(a){d.toggleClass(h.TRUE,a).toggleClass(h.FALSE,!a)}var g=this,h={TRUE:"is-toggle",FALSE:"not-toggle"};g.render=_.noop,g.isToggle=function(){return Boolean(a(c.toggle)(b))},g.toggle=function(d){var f=a(c.toggle);d=_.toggle(f(b),d),f.assign?(f.assign(b,d),e(d)):(c.$set("toggle",d),e(d))},b.$watch(c.toggle,e)}]}}]),angular.module("toolTip",[]).directive("toolTip",[function(){return{templateUrl:"/parts/tool-tip/tool-tip-template.html",link:function(){}}}]),$(document).ready(function(){var a=$("#site-wrapper"),b=300;$("#menubutton").toggle(function(){a.css("position","relative"),a.animate({right:"83%"},b)},function(){a.css({position:"none"}),a.animate({right:"0%"},b)})}),angular.module("bottomDefault",["payBillUtils","config","oolCookie"]).controller("BottomDefaultCtrl",["$rootScope","$scope","PayBillService","PayBillUtils","Config","ooluser",function(a,b,c,d,e,f){$(document).ready(function(){var b=$("#contact-list li");b.each(function(){var b=$(this).find("a").attr("href");"/support/livepage/chat"===b&&$(this).find("a").click(function(b){b.preventDefault(),a.chatNow()})})});var g=this,h="",i={LOGIN:"/login/"};g.hasSession=!1,g.showingMobileMenu=!1,g.primary=!1,g.optimumId="",g.helloMessage={text:"",link:""},g.hasService={tv:!1,internet:!1,phone:!1,dvr:!1,eMail:!1,musActive:!1},g.badge={tv:!1,internet:!1,phone:!1},g.toggleshowSignOut=function(){g.showSignOut=!g.showSignOut},g.webmailLink="#",g.phoneLink="#",g.currentAlertIndex=0,g.chatNow=function(){a.chatNow()};var j=function(){return-1===window.location.pathname.indexOf("login")?"?referer="+escape(window.location.href):""},k=function(a){var b=g.hasService;for(var c in a)b[c]=a[c]},l=function(a){g.showingMobileMenu=a},m=function(a){var b=g.helloMessage;b.text=a.text,b.link=a.link,b.link=g.hasSession?"#":"/login/"},n=function(a){var b=g.badge;for(var c in a)b[c]=a[c]},o=function(a){g.webmailLink=a.webmail,g.phoneLink=a.phone,g.outageLink=a.outage,h=a.signout};g.toggleshowSignOut=function(){g.showSignOut=!g.showSignOut},g.handleUserSignout=function(){var a=h+j();window.location=a};var p={MILLI_TO_SECONDS:1e3,SECONDS_IN_HOUR:3600},q=function(a){var b=!1,c=e.getValuesBySelector("cookie.expirationTimeToCheck"),d=(new Date).getTime(),f=d/p.MILLI_TO_SECONDS,g=f-a,h=Math.round(g/p.SECONDS_IN_HOUR);return h>=c&&(b=!0),b};g.forward=function(){var a=q(f.t);if(!g.hasSession||a){var b=i.LOGIN+"?referer="+escape("/pay-bill");console.log("redirecting"+b),window.location=b}else r()};var r=function(){if(b.toAcctType=null,a.acctDetail){var e=d.getObjInArrayByValue(a.acctDetail,"active",!0),f=e.accountType;"2"===f&&(b.toAcctType="0"),"3"===f&&(b.toAcctType="1")}c.toggleAccount(s,u,b.toAcctType)},s=function(a){c.checkSuccess(a)?window.location="/pay-bill/":r()},t=function(a){var b=document.createElement("script");b.type="text/javascript",window.google_conversion_id=a,window.google_custom_params=window.google_tag_params,window.google_remarketing_only=!0,b.src="//www.googleadservices.com/pagead/conversion.js",document.body.appendChild(b),window.google_trackConversion({google_conversion_id:a,google_custom_params:{parameter1:window.google_tag_params},google_remarketing_only:!0}),$("body").append("<noscript><div style='display:inline;'><img height='1' width='1' style='border-style:none;' alt='' src='//googleads.g.doubleclick.net/pagead/viewthroughconversion/"+a+"/?value=0&amp;guid=ON&amp;script=0'/></div></noscript>")};f.hasOOLSession&&(t(970019091),t(1025550508),t(1023380598),t(979385981),t(984947360),t(1040188944),t(1012423419));var u=function(a,b){if(console.log("in error"),a&&401===b){var c="";c=g.hasSession?"/pay-bill":i.LOGIN+"?referer="+escape("/pay-bill"),window.location=c}};return a.$on("mobileMenuDisplayToggle",function(a,b){g.hasSession=b.hasSession,g.optimumId=b.optimumId,g.mobileOutageStatus=b.mobileOutageStatus,g.mobileOutageclassName=b.mobileOutageclassName,g.mobileOutageIcon=b.mobileOutageIcon,g.mobileOutageMessage=b.mobileOutageMessage,k(b.hasService),g.primary=f.primary,g.hasService.eMail=g.hasSession?1===f.p.email?!0:!1:!1,g.hasService.musActive=g.hasSession?"active"===f.p.mus?!0:!1:!1,g.isBiz=g.hasSession&&f.p.biz&&1===f.p.biz?!0:!1,l(b.showingMobileMenu),m(b.helloMessage),n(b.badge),o(b.link)}),b.seleniumMarker="BottomDefaultCtrl in bottom-default.js loaded!",b.BottomDefaultCtrl=g}]),angular.module("transcludeTemplates",[]).factory("transcludeTemplates",[function(){function a(a,c){return c.hasContent()?(a.find("[template-select]").each(function(a,d){b($(d),c)}),void 0):!1}function b(a,b){var d=b.selectFirstFound(c(a));return d?(a.html(d.clone().attr("template-for",null).outerHtml()).attr("ng-bind-html",null).attr("ng-bind",null).attr("template-select",null),void 0):!1}function c(a){return _.map(a.attr("template-select").split("||"),d)}function d(a){return'[template-for="'+$.trim(a)+'"]'}return a}]),angular.module("transferModal",["modal","panel","alertMulti","moveTransferService","textCurrency","radio","dropdowns","isViewportSize"]).directive("transfermodal",["$http","$compile","MoveTransferService","PayBillUtils","PayBillService","$rootScope","isViewportSize",function(a,b,c,d,e,f,g){return{restrict:"E",transclude:!0,scope:{display:"="},link:function(h,i){function j(){t?y():a.get(u).then(function(a){t=b(a.data)(h),i.append(t),y()})}function k(){var a=v.computeDaysRemaining(w,h.disconnectDate,h.systemDate),b=a;a>1?a+=" days":(1===a||0===a)&&(a+=" day"),h.daysLeft=a,h.daysLeftForTransfer=b}function l(){for(var a="",b=0;b<h.noOfPaymentMethods;b++)if(h.transferModel.paymentMethods[b].isAutoPayment){a=h.transferModel.paymentMethods[b].payMethodName;break}return a}function m(a){console.log(a+"In movetransfer success handler");var b,c=a.currMonAutoPayDate,d=a.responseInfo.statusCode;b=v.identifyResponseType(d),h.transferMessage=p(b,c,a),x.updateState(x.states.RESULT),console.log("result called")}function n(a){console.log(a+"In Opt out success handler"),console.log("remind me later success called")}function o(a){console.log(a+"In Opt out fail handler"),console.log("remind me later  error called")}function p(a,b,c){var d=" is ",e="";h.autoPayMethod=h.pmNickNames[0],h.updatedMethod=h.pmNickNames[0],console.log("response"),h.selectedItemsCount>1&&(d=" and "+(h.selectedItemsCount-1)+" other payment method are "),h.selectedItemsCount>2&&(d=" and "+(h.selectedItemsCount-1)+" other payment methods are "),c&&(e=c.responseInfo.ancillaryStatusCode);var f={};return console.log("in response"),"success"===a?(opts={},opts.type="success",opts.title="Your payment info and settings have been transferred to your new account ("+h.transferredAccNO+").",opts.priority=1,h.pageAlerts=[],v.alertObject(opts,h),h.success=!0,"MTSAPSRCSPCS"===e&&(f=h.updatePayMethodFlag?{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}),"MTSAPSRCS"===e&&(f=h.updatePayMethodFlag?{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}),"MTS"===e&&(f={content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "})):"failure"===a?h.showTransferFailure=!0:("MTSAPF"===e&&(h.transferFailed=!0,f=h.updatePayMethodFlag?{content_tab1:"Sorry, we weren't able to transfer your automatic payment settings, but you can enroll anytime you like at optimum.net/pay-bill.Enroll in automatic payments",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:"Sorry, we weren't able to transfer your automatic payment settings, but you can enroll anytime you like at optimum.net/pay-bill.Enroll in automatic payments",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "},opts={},opts.type="major",opts.title="",opts.message="Sorry, your automatic payment settings could not be transferred, but we were able to successfully transfer your saved payment methods.",opts.priority=2,v.alertObject(opts,h)),"MTSAPSRCF"===e&&(h.success=!0,f=h.updatePayMethodFlag?{content_tab1:"Your automatic payment settings have been enabled. Due to some technical difficulties payment for the current month couldn't be scheduled, please make a onetime payment for current month's bill.",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:"Your automatic payment settings have been enabled. Due to some technical difficulties payment for the current month couldn't be scheduled, please make a onetime payment for current month's bill.",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "},opts={},opts.type="success",opts.title="Your payment info and settings have been transferred to your new account ("+h.transferredAccNO+").",opts.priority=1,h.pageAlerts=[],v.alertObject(opts,h)),"MTSAPSRCSPCF"===e&&(h.success=!0,h.prefCommFailed=!0,c.responseInfo.message.mainmsg&&(h.prefCommContent=c.responseInfo.message.mainmsg),f=h.updatePayMethodFlag?{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "},opts={},opts.type="success",opts.title="Your payment info and settings have been transferred to your new account ("+h.transferredAccNO+").",opts.priority=1,h.pageAlerts=[],v.alertObject(opts,h))),f}function q(){h.transferMessage=p("failure",null,null),x.updateState(x.states.RESULT)}function r(a){e.checkSuccess(a)&&(url="/pay-bill/dissuasion/?p=true",window.location=url)}function s(){}var t,u="/parts/transfer-modal/transfer-modal-template.html";h.$watch("display",function(a,b){console.log("newval: "+a+"oldVal: "+b),a&&j()}),h.isViewportSize=g;var v=d;isMobile()&&(v.changeInputType("max-amount-container"),v.changeInputType("other-amount-container"));var w=90;h.moveTransferService=c;var x=function(){function a(a){return f===a}function b(){f=e.INITIAL,console.log("states"+f)}function c(a){f=a}function d(){h.showTransferWizard=!1,h.display=!1}var e={INITIAL:"Initial",EDIT_AUTO_PAY:"EditAutoPay",OPTOUT:"OptOut",RESULT:"Result",ERROR_ALL:"Error",MAYBE_LATER:"MayBeLater",SPINNER:"Spinner",CANCEL:"Cancel"},f={};return{states:e,isCurrent:a,init:b,updateState:c,close:d}}();h.wizardState=x;var y=function(){h.ebillInfo=h.moveTransferService.getEbillResponse();var a=v.getObjInArrayByValue(f.acctDetail,"active",!0);h.activeAcctEbillInfo=v.computeActiveAcctEbillInfo(a.accountNumber,h.ebillInfo),h.fromAcctEbillInfo=v.computeFromAcctEbillInfo(h.ebillInfo),h.toAcctEbillInfo=v.computeToAcctEbillInfo(h.ebillInfo),console.log(h.activeAcctEbillInfo),h.transferModel={},h.transferModel.apOptOut=h.ebillInfo.apOptOut,h.transferModel.pmOptOut=h.ebillInfo.pmOptOut,h.showOptOutLink=0===h.transferModel.apOptOut&&0===h.transferModel.pmOptOut||!f.showOptOut?!1:!0,h.showTransferFailure=!1,h.autoPayPresent=h.fromAcctEbillInfo.hasAutoPay,h.payduedate=h.fromAcctEbillInfo.isDuedate,h.autopaydate=h.fromAcctEbillInfo.scheduledAutoDate,h.paydaysInAdvance=h.fromAcctEbillInfo.payDaysInAdvance,h.paydayofMonth=h.fromAcctEbillInfo.payDayOfMonth,h.topaydayofMonth=h.toAcctEbillInfo.payDayOfMonth,h.topaydaysInAdvance=h.toAcctEbillInfo.payDaysInAdvance,h.systemDate=v.parseDate(f.systemDate),h.sysDate=f.systemDate,h.dueDate=f.dueDate,h.parsedDueDate=v.parseDate(f.dueDate),h.autopaydate&&(h.autopaydate=h.autopaydate.substr(0,6)+h.autopaydate.substr(-2)),h.dayofMonth=h.fromAcctEbillInfo.payDayOfMonth,h.noOfPaymentMethods=h.fromAcctEbillInfo.paymentMethods.length,h.editCloseClicked=!1;for(var b=!1,c=[],d=0;d<h.noOfPaymentMethods;d++)if(h.fromAcctEbillInfo.paymentMethods[d].isAutoPayment===!0){c[0]=h.fromAcctEbillInfo.paymentMethods[d],b=!0;break}for(var e=0,g=0;g<h.noOfPaymentMethods;g++)d>g?c[g+1]=h.fromAcctEbillInfo.paymentMethods[g]:d===g&&0===e?e=1:c[g]=h.fromAcctEbillInfo.paymentMethods[g];if(h.transferModel.paymentMethods=b?c:h.fromAcctEbillInfo.paymentMethods,h.transferModel.maxAmountValue=h.fromAcctEbillInfo.capAmount,h.lastBill=!1,h.lastAmount=f.lastAmount,(""===h.lastAmount||null===h.lastAmount)&&(h.lastBill=!0),h.accountNoShow=v.formatAccountNumber(h.fromAcctEbillInfo.accountNum),h.transferredAccNO=v.formatAccountNumber(h.toAcctEbillInfo.accountNum),h.transferModel.otherAmount=h.fromAcctEbillInfo.fixAmount,h.transferModel.alreadyPaid=!1,h.autoPayNickName=null,h.listActions=!0,h.updatePayMethodFlag=!1,h.pmNickNames=[],h.pageAlerts=[],h.payMethodsStr=null,h.chkPayMethods="",h.initialMethod="",h.updatedMethod="",h.selectedPaymentMethods=[],h.transferModel.autoPayTransferCheck=h.fromAcctEbillInfo.hasAutoPay,h.disconnectDate=v.parseDate(h.ebillInfo.discoDate),h.toAcctEbillInfo.isPaperBill||h.fromAcctEbillInfo.isPaperBill||(h.enrolledInPaperLess=!0),h.parsedSystemDate=v.parseDate(f.systemDate),k(),null!==h.disconnectDate){h.pastAcctAvlDate=v.addDays(h.disconnectDate,w),h.pastAcctAvlDate=v.dateToString(h.pastAcctAvlDate);var i=h.pastAcctAvlDate.split("/").join(""),j=i.substring(0,2),m=i.substring(2,4),n=i.substring(6,8);h.optOutShowDate=j+"/"+m+"/"+n,h.pastAcctAvlDate=h.pastAcctAvlDate.substr(0,6)+h.pastAcctAvlDate.substr(-2)}for(h.transferModel.paymentMethodOptions=[],h.transferModel.dueDateOptions={},h.transferModel.dateOnMonthOptions={},h.transferModel.datePM="advance",h.transferModel.amountPM="due",h.firstLoad=!0,h.doneClicked=!1,h.autoPayTransfer=!1,h.transferModel.amountValid=!0,h.transferModel.emailValid=!0,h.fromAcctEbillInfo.payDayOfMonth&&(h.transferModel.datePM="dom",h.dayOnMonth=h.fromAcctEbillInfo.payDayOfMonth,h.paydayofMonth=h.fromAcctEbillInfo.payDayOfMonth),h.fromAcctEbillInfo.payDaysInAdvance&&(h.transferModel.datePM="advance",h.daysInAdvance=h.fromAcctEbillInfo.payDaysInAdvance,h.paydaysInAdvance=h.fromAcctEbillInfo.payDaysInAdvance),h.fromAcctEbillInfo.capAmount&&(h.transferModel.amountPM="due",h.maxAmt=h.fromAcctEbillInfo.capAmount),h.fromAcctEbillInfo.fixAmount&&(h.transferModel.amountPM="other",h.otherAmount=v.currency(h.fromAcctEbillInfo.fixAmount),h.fixAmt=h.otherAmount),h.transferModel.emailAddress=h.fromAcctEbillInfo.email,f.dueAmount&&(h.initalDueAmount=f.dueAmount),h.wizardState.init(),h.showTransferWizard=!0,h.transferModel.showMaxStatement=!1,h.ackTransferFlag=0,h.transferModel.selectedPayMethods=[],null!==h.fromAcctEbillInfo.capAmount&&h.fromAcctEbillInfo.capAmount>0&&(h.transferModel.showMaxStatement=!0),h.autoPayMethod=l(),h.selectedItemsCount=h.noOfPaymentMethods,angular.forEach(h.transferModel.paymentMethods,function(a){angular.isDefined(a.selected=!0),h.defaultMethods=a.payMethodName}),d=0;d<h.fromAcctEbillInfo.paymentMethods.length;d++)paymentMethod=h.fromAcctEbillInfo.paymentMethods[d],paymentMethod.isAutoPayment&&(h.transferModel.paymentMethod=d,h.cardName=paymentMethod.payMethodName),h.transferModel.paymentMethodOptions[String(d)]=paymentMethod.payMethodName;for(d=1;6>d;d++)h.transferModel.dueDateOptions[String(d)]=1===d?String(d)+" day before":String(d)+" days before";for(function(a){Number.getOrdinalFor=function(b,c){return(c?b:"")+(a[((b=Math.abs(b%100))-20)%10]||a[b]||"th")}}(["","st","nd","rd"]),num1=1;32>num1;num1++)str=Number.getOrdinalFor(num1,!0),h.transferModel.dateOnMonthOptions[String(num1)]=str;null!==h.dayofMonth&&(day=Number.getOrdinalFor(h.dayofMonth,!0),h.paydayofMonth=day),f.$watch("statements",function(){f.$watch("dueAmount",function(){f.dueAmount&&h.autoPayPresent&&f.statements&&(h.showAutoText=!0,h.dueDate&&(h.firstAutoPaydate=v.createAutoPayDate(h)))})})};h.paymentMethodCountHandler=function(a){var b=[];h.chkPayMethods=!0,angular.forEach(a,function(a){angular.isDefined(a.selected)&&a.selected===!0&&b.push(a.payMethodName)}),h.selectedItemsCount=b.length,h.listActions=h.selectedItemsCount>0?!0:!1,h.selectedPaymentMethods=b,h.transferModel.autoPayTransferCheck||h.listActions||!h.autoPayPresent?h.autoPayPresent||h.listActions||(opts={},opts.type="major",opts.title="",opts.message="At least one payment method must be selected.",opts.priority=2,h.pageAlerts=[],v.alertObject(opts,h)):(opts={},opts.type="major",opts.title="",opts.message="At least one payment method or Automatic payments must be selected.",opts.priority=2,h.pageAlerts=[],v.alertObject(opts,h))},h.showMayBeLater=function(){var a=30;h.daysLeftForTransfer>a?(h.mayBeLater(),h.wizardState.init()):h.wizardState.updateState(x.states.MAYBE_LATER)},h.payMethodType=function(a,b){return v.payMethodType(a,b)},h.truncatePaymentName=function(a){return v.truncateName(a)},h.enableRefresh=function(){h.showTransferWizard=!1,h.display=!1,f.refresh=!0},h.enableTransfer=function(){return h.transferModel.authorizeTransfer&&(h.transferModel.autoPayTransferCheck||h.listActions)?(h.ackTransferFlag=1,!1):!0
},h.submitAutoPay=function(){h.doneClicked=!0;var a=[];if(h.emailFromServer=h.transferModel.emailAddress,h.cardName=h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod],h.autoAmount=h.transferModel.amountPM,h.autoDatePM=h.transferModel.datePM,h.updatePayMethodFlag=!0,h.updatePayMethodFlag){if("advance"===h.transferModel.datePM&&(h.flag=0,h.paydaysInAdvance=h.transferModel.dueDateSelected,h.firstAutoPaydate=v.createAutoPayDate(h)),"dom"===h.transferModel.datePM){if(h.flag=1,h.paydayofMonth){h.paydayofMonth=h.paydayofMonth.substring(0,1);var b=parseInt(h.transferModel.dateOnMonthSelected,10);b=b,b=b.toString(),h.domonth=h.transferModel.dateOnMonthSelected,h.paydayofMonth!==b&&(h.paydayofMonth=h.transferModel.dateOnMonthSelected),h.paydayofMonth=Number.getOrdinalFor(h.paydayofMonth,!0)}else h.paydayofMonth=h.transferModel.dateOnMonthSelected,h.domonth=h.transferModel.dateOnMonthSelected,h.paydayofMonth=Number.getOrdinalFor(h.paydayofMonth,!0);h.firstAutoPaydate=v.createAutoPayDate(h)}"due"===h.transferModel.amountPM&&(h.maxAmount=h.transferModel.maxAmountValue,h.setMaxAmount=v.currency(h.maxAmount),h.setMaxCheck=h.transferModel.maxAmount,h.otherAmount=null),"other"===h.transferModel.amountPM&&(h.otherAmount=v.currency(h.transferModel.otherAmount),h.setMaxCheck=!1);for(var c=0;c<h.noOfPaymentMethods;c++)h.transferModel.paymentMethods[c].isAutoPayment&&(h.initialMethod=h.transferModel.paymentMethods[c].payMethodName,h.initialMethod&&(h.transferModel.paymentMethods[c].isAutoPayment=!1)),h.updatedMethod=h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod],h.updatedMethod===h.transferModel.paymentMethods[c].payMethodName&&(h.transferModel.paymentMethods[c].isAutoPayment=!0);for(h.autoPayMethodCheck(),c=0;c<h.noOfPaymentMethods;c++)if(h.transferModel.paymentMethods[c].isAutoPayment===!0){a[0]=h.transferModel.paymentMethods[c];break}for(var d=0,e=0;e<h.noOfPaymentMethods;e++)c>e?a[e+1]=h.transferModel.paymentMethods[e]:c===e&&0===d?d=1:a[e]=h.transferModel.paymentMethods[e];h.transferModel.paymentMethods=a}else l();h.transferModel.showMaxStatement=!1,h.wizardState.init()},h.closeEditModal=function(){h.doneClicked||(h.firstLoad=!0),h.editCloseClicked=!0,h.checkCancel()},h.submitDataTransfer=function(){if(h.transferModel.autoPayTransferCheck?(h.autoPayTransfer=!0,h.autoPayNickName=h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod]):h.autoPayNickName=null,h.updatePayMethodFlag||("advance"===h.transferModel.datePM&&(h.autoPayDaysInAdvance=h.daysInAdvance),"dom"===h.transferModel.datePM&&(h.autoPayDayOfMonth=h.dayOnMonth),"due"===h.transferModel.amountPM&&(h.autoPayCapAmount=h.maxAmt),"other"===h.transferModel.amountPM&&(h.autoPayFixAmount=h.fixAmt)),h.chkPayMethods)h.pmNickNames=h.selectedPaymentMethods,h.payMethodsStr=h.pmNickNames.toString();else{for(var a=0;a<h.noOfPaymentMethods;a++)h.pmNickNames[a]=encodeURIComponent(h.transferModel.paymentMethods[a].payMethodName);h.payMethodsStr=h.pmNickNames.toString()}x.updateState(x.states.SPINNER),e.submitMoveTransfer(m,q,h)},h.autoPayMethodCheck=function(){h.$watch("transferModel.autoPayTransferCheck",function(){h.transferModel.autoPayTransferCheck&&angular.forEach(h.transferModel.paymentMethods,function(a){angular.isDefined(a.selected)&&a.selected===!1&&a.isAutoPayment&&(a.selected=!0,h.paymentMethodCountHandler(h.transferModel.paymentMethods))})})},h.editAutoPay=function(){function a(a){var b=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)}function b(a){$("#"+a).removeClass("error-input"),c($("#"+a).val())?"other"===h.transferModel.amountPM?(h.amountSelected=$("#"+a).val(),h.transferModel.amountValid=!0):h.transferModel.maxAmount&&h.transferModel.maxAmountValue&&(h.transferModel.amountValid=!0):($("#"+a).addClass("error-input"),h.transferModel.amountValid=!1)}function c(a){if(a)if(a=String(a),a=a.replace(/\s/g,""),a.split("$").length>0&&(a=a.split("$").join("")),-1===a.indexOf(".")){if(!isNaN(a)&&(value=parseInt(a,10),value>=1&&1e4>value))return!0}else if(a.split(".")&&2===a.split(".").length&&!isNaN(a.split(".")[0])&&!isNaN(a.split(".")[1])&&a.split(".")[1].length<3&&(value=parseFloat(a,2),value>=1&&1e4>value))return!0;return!1}h.editCloseClicked=!1,h.pageAlerts=[],x.updateState(x.states.EDIT_AUTO_PAY),response=h.fromAcctEbillInfo,h.firstLoad?(response.hasAutoPay&&(h.hasAutoPay=!0,null!==response.payDayOfMonth&&(h.transferModel.datePM="dom",h.transferModel.dateOnMonthSelected=String(response.payDayOfMonth)),response.payDaysInAdvance&&(h.transferModel.datePM="advance",h.transferModel.dueDateSelected=String(response.payDaysInAdvance),h.paydaysInAdvance=String(response.payDaysInAdvance)),null!==response.fixAmount?($("#otherAmountInput").val(v.currency(response.fixAmount)),h.fixAmt=v.currency(response.fixAmount),h.otherAmount=v.currency(response.fixAmount),h.transferModel.amountPM="other"):($("#otherAmountInput").val="",h.fixAmt="",h.otherAmount=null),null!==response.capAmount?(h.calculatedMaxAmount=v.currency(response.capAmount),$("#maxAmountInput").val(v.currency(response.capAmount)),h.transferModel.amountPM="due",b("maxAmountInput"),h.setMaxCheck=h.transferModel.maxAmount,opts={},opts.type="minor",opts.title="",opts.message="You had a max payment amount set on your previous account. <br>Please review your new estimated monthly charges and make any necessary changes.",opts.priority=2,h.pageAlerts=[],v.alertObject(opts,h)):($("#maxAmountInput").val="",h.transferModel.maxAmountValue="",h.transferModel.maxAmount=!1,h.setMaxCheck=!1)),h.transferModel.emailAddress=null!==response.email?response.email:"",h.domonth=h.transferModel.dateOnMonthSelected,h.autoDueDate=h.transferModel.dueDateSelected,h.autoDatePM=h.transferModel.datePM,h.autoAmount=h.transferModel.amountPM,h.emailFromServer=h.transferModel.emailAddress,h.setMaxCheck=h.transferModel.maxAmount,h.maxAmount=h.transferModel.maxAmountValue):(h.transferModel.maxAmountValue=h.maxAmount,h.otherAmount&&(h.fixAmt=h.otherAmount.substring(1,4)),h.transferModel.otherAmount=h.otherAmount,h.transferModel.emailAddress=h.email,h.transferModel.dueDateSelected=h.paydaysInAdvance,h.transferModel.dateOnMonthSelected=h.domonth,h.autoDueDate=h.transferModel.dueDateSelected,h.transferModel.emailAddress=h.emailFromServer,h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod]=h.cardName,h.transferModel.datePM=h.autoDatePM,h.transferModel.amountPM=h.autoAmount,h.transferModel.maxAmount=h.setMaxCheck,null!==h.paydayofMonth&&void 0!==h.paydayofMonth&&(h.transferModel.dateOnMonthSelected=3===h.paydayofMonth.length?h.paydayofMonth.substring(0,1):h.paydayofMonth.substring(0,2)),null!==h.maxAmount?($("#maxAmountInput").val(v.currency(h.maxAmount)),h.transferModel.maxAmount=h.setMaxCheck,b("maxAmountInput")):($("#maxAmountInput").val="",h.transferModel.maxAmountValue="")),h.$watch("transferModel.emailAddress",function(b){$("#emailInput").removeClass("error-input"),$("#emailError").addClass("hidden"),a(b)?h.transferModel.emailValid=!0:($("#emailInput").addClass("error-input"),$("#emailError").removeClass("hidden"),h.transferModel.emailValid=!1),h.hasAutoPay&&(h.transferModel.emailChanged=h.emailAddress!==b?!0:!1)}),h.$watch("transferModel.maxAmount",function(){h.transferModel.maxAmount?(h.transferModel.amountPM="due",b("maxAmountInput")):h.transferModel.amountValid=!0}),h.checkPaymentValid=function(){return h.transferModel.amountValid&&h.transferModel.emailValid?!1:!0},$("#otherAmountInput").live("blur",function(){this.value=this.value.split("$").join(""),this.value=this.value.replace(/\s/g,""),this.value=this.value.replace(/^[0]+/g,""),""!==this.value&&("."===this.value&&(this.value="0"),this.value="0"===this.value||isNaN(Math.abs(parseFloat(this.value)))?0:Math.abs(parseFloat(this.value)).toFixed(2)),"0.00"===this.value&&(this.value=0),this.value&&this.value.length>0&&"$"!==this.value[0]&&(this.value="$"+this.value)}),$("#maxAmountInput").live("blur",function(){this.value=this.value.replace(/^\s+|\s+$/g,""),this.value=this.value.replace("$",""),this.value=this.value.replace(/^[0]+/g,""),""!==this.value&&("."===this.value&&(this.value="0"),this.value="0"===this.value||isNaN(Math.abs(parseFloat(this.value)))?0:Math.abs(parseFloat(this.value)).toFixed(2)),"0.00"===this.value&&(this.value=0),this.value&&this.value.length>0&&"$"!==this.value[0]&&(this.value="$"+this.value)}),h.$watch("transferModel.otherAmount",function(){"other"===h.transferModel.amountPM&&b("otherAmountInput")}),h.$watch("transferModel.maxAmountValue",function(){"due"===h.transferModel.amountPM&&b("maxAmountInput")}),h.$watch("transferModel.amountPM",function(){$("#otherAmountInput").removeClass("error-input"),$("#maxAmountInput").removeClass("error-input"),h.transferModel.amountValid=!1,"other"===h.transferModel.amountPM?(b("otherAmountInput"),h.otherAmountClicked()):(b("maxAmountInput"),h.transferModel.maxAmount||(h.transferModel.amountValid=!0))}),h.otherAmountClicked=function(){h.transferModel.maxAmount=!1,h.transferModel.amountPM="other"},h.firstLoad=!1},h.checkCancel=function(){h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod]!==h.cardName||h.transferModel.dateOnMonthSelected!==h.domonth?x.updateState(x.states.CANCEL):h.transferModel.dueDateSelected!==h.autoDueDate||h.transferModel.datePM!==h.autoDatePM?x.updateState(x.states.CANCEL):$("#otherAmountInput").val()!==h.fixAmt||h.transferModel.amountPM!==h.autoAmount?x.updateState(x.states.CANCEL):h.transferModel.emailAddress!==h.emailFromServer||h.transferModel.maxAmount!==h.setMaxCheck||h.transferModel.maxAmountValue!==h.maxAmount?x.updateState(x.states.CANCEL):x.init()},h.yesCancel=function(){h.editCloseClicked?h.mayBeLater():h.wizardState.init()},h.noThanks=function(){h.editCloseClicked=!1,h.wizardState.updateState(x.states.EDIT_AUTO_PAY)},h.dontRemind=function(){h.transferModel.apOptOut=0,h.transferModel.pmOptOut=0,e.submitOptOut(n,o,h),f.refresh=!0,h.wizardState.close()},h.mayBeLater=function(){document.cookie="remind_later=true;path=/",h.wizardState.close(),f.isGetStartedClicked=!1},h.checkManagePaperLess=function(){if(f.acctDetail){var a=v.getObjInArrayByValue(f.acctDetail,"active",!0),b=a.accountType;h.toAcctType=b,"2"===b&&(h.toAcctType="0"),"3"===b&&(h.toAcctType="1"),e.toggleAccount(r,s,h.toAcctType)}}}}}]),function(a){jQuery.fn.outerHtml=function(b){return b?this.before(b).remove():a("<div>").append(this.eq(0).clone()).html()},jQuery.fn.hasContent=function(){return""!==a.trim(this.html())},jQuery.fn.fixChromeRedrawBug=function(){this[0].style.display="none",this[0].offsetHeight,this[0].style.display="block"},jQuery.fn.selectFirstFound=function(a){for(var b=0;b<a.length;b+=1){var c=this.find(a[b]);if(c.length)return c}return null},jQuery.fn.relativeAnchorPositions=function(){return{top:0,left:0,right:this.outerWidth(),bottom:this.outerHeight()}},jQuery.fn.absoluteAnchorPositions=function(){var a=this.offset();return a.right=a.left+this.outerWidth(),a.bottom=a.top+this.outerHeight(),a},jQuery.fn.scrollPositions=function(){var a={top:this.scrollTop(),left:this.scrollLeft()};return a.bottom=a.top+this.outerHeight(),a.right=a.left+this.outerWidth(),a},jQuery.fn.scrollRight=function(){return this.scrollLeft()+this.outerWidth()},jQuery.fn.scrollBottom=function(){return this.scrollTop()+this.outerHeight()}}(jQuery),angular.module("vodCarousels",["dots","if","dvrRecord","ellipsis","poster","imgAlt","hover","isViewportSize","vod","webdvrResource","onetCookies"]).directive("vodCarousels",["$timeout","limitToFilter","isViewportSize","ooluser","Vod","$location","WebDVR","Cookies",function(a,b,c,d,e,f,g,h){return d.laBoxUser=d.hasOOLSession?d.laBoxUser||d.laboxOrMini:"true"===h.getCookie("labox"),{restrict:"EA",scope:{showHide:"=show",localItems:"=items",showMock:"=mock",isLazy:"=lazy",positionWithPosition:"=positionWithPosition",isIndented:"=indent",extraIndent:"=extraIndent",maxSets:"=maxSets",scrollByPixels:"=scrollByPixels",type:"=type",isVod:"=vod"},transclude:!0,replace:!1,templateUrl:"/parts/vod-carousels/vod-carousels-template.html",link:function(c,f,h){function i(){lb(),ib&&(S.items=S.generateMockElements(),cb=S.items.length),r(),c.$emit("carouselEvent",{eventName:"load",eventTarget:$(f)}),n()?(U.addClass("art"),U.removeClass("block"),S.isArtwork=!0):(U.addClass("block"),U.removeClass("art"),S.isArtwork=!1),Q(),l()}function j(){console.log("mock: test callback action")}function k(){var a=!1;(c.localItems[0]!==c.items[0]||c.localItems.length<c.items.length)&&(a=!0),S.items=S.localItems,Q(),l(),a&&P()}function l(){var a;try{delete S.maxItems}catch(b){}if(null!==(a=o())){var c=0,d=0,e=x();_.each(S.items,function(b,f){return c+=(b.itemWidth||140)+(n()?28:0),c>e&&(d++,c=c-(n()?28:0)<=e?0:(b.itemWidth||140)+(n()?28:0)),d>=a?(S.maxItems=f,!1):void 0})}}function m(){a(function(){var a,b=U.width();if(n()){if(S.isArtwork=!0,U.addClass("art"),U.removeClass("block"),void 0!==c.isVod&&c.isVod!==!1)if(angular.isNumber(b)&&b>100&&S.getLimitedItems().length*U.find(".item").outerWidth(!0)>10){var d=0,e=0;setTimeout(function(){$.each(U.find(".item"),function(){e+=1,d+=parseInt($(this).outerWidth(!0),10)}),e===U.find(".item").length&&(V.width(d+10+"px"),r())},20)}else V.width("");else angular.isNumber(b)&&b>100&&(a=S.getLimitedItems().length*U.find(".item").outerWidth(!0))>10?V.width(a+10+"px"):V.width("");V.height()<U.find(".poster").height()&&(V.css("height",U.find(".poster").height()),X.css("top",0),Y.css("top",0))}else S.isArtwork=!1,U.addClass("block"),U.removeClass("art"),V.width(""),V.css("max-height",gb);r()})}function n(){var a=!1;return"block"===S.type?!1:"art"===S.type?!0:($.each(S.items,function(b,c){return c.artwork?(a=!0,!1):void 0}),a)}function o(){var a=S.maxSets;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)&&a>0?a:null}function p(a){return parseInt(a.toString().match(/-(\d+)$/)[1],10)}function q(a,b){if(a.attr("id")){var c=S.getLimitedItems()[p(a.attr("id"))];return b===!0?c.secondItem.action:c.action}}function r(){if(S.isIndented)hb=0===S.getLimitedItems().length?[]:new Array(1+Math.ceil((V.width()-C(B()))/x()));else{var a=U.width();U.width()<767&&(a=U.width()-4*f.parent().position().left),hb=0===S.getLimitedItems().length?[]:new Array(Math.ceil(V.width()/a))}c.dots=hb}function s(a,b){var d="first"===a?0:"next"===a?I():K(),e=N()&&S.isIndented?B():0;V.animate({left:d},fb,"swing",function(){"function"==typeof b&&setTimeout(function(){var a;b(),angular.isNumber(c.scrollByPixels)&&(a=U.find(".item"),a.each(function(a,b){b=$(b);var c=b.position().left,e=B()-d;return c===e||e>c&&c+b.outerWidth()>e?(F(a),!1):void 0})),S.onScroll(bb,d,e)},fb)})}function t(){isMobile()||(N()?(U.removeClass("show-prev-ui"),O()?U.removeClass("show-next-ui"):U.addClass("show-next-ui")):O()?(U.addClass("show-prev-ui"),U.removeClass("show-next-ui")):(U.addClass("show-prev-ui"),U.addClass("show-next-ui")),db=!0)}function u(){!isMobile()&&db&&(U.removeClass("show-prev-ui"),U.removeClass("show-next-ui"),db=!0)}function v(){db&&t()}function w(){U.css("left",0),U.width(x()),U.removeClass("indented")}function x(){return void 0!==h.cusclass?S.isIndented?$("."+h.cusclass).width():$(f).offsetParent().width()-$(f).position().left:S.isIndented?$(window).width():$(f).offsetParent().width()-$(f).position().left}function y(){S.isIndented&&(U.css("left",B()),U.width(C(B())),U.addClass("indented"),V.css("left",0))}function z(){var a=void 0!==h.cusclass?x()-f.parent().position().left:x();U.width(!isNaN(a)&&a>1?a:"")}function A(){return U.hasClass("indented")}function B(){return void 0!==h.cusclass?0:W[S.positionWithPosition?"position":"offset"]().left+(angular.isNumber(S.extraIndent)?S.extraIndent:0)}function C(a){return x()-a}function D(){return A()?x()-B():angular.isNumber(c.scrollByPixels)?x()-$(U.find(".item")[bb]).offset().left:x()}function E(a){var b=0,c=-1,d=0,e=$(U.find(".item")),f=bb;if(e.size()*e.outerWidth(!0)>x())for(;Math.round(b)<D()&&c!==b&&-1!==f;)c=b,b+=$(e[f]).outerWidth(!0),d++,f=a?f-=1:f+=1;return d-1}function F(a){try{}catch(b){}bb=a}function G(){return bb}function H(a){var b,c=U.find(".item");b=a?$(c[G()-E(a)]).index():$(c[E()-1+G()]).index();try{}catch(d){}return b}function I(){return N()&&S.isIndented?-1*(J()-B()):M()+-1*J()}function J(){var a=$(U.find(".item")[H()+1]).offset().left;return S.isIndented||(a-=$(U).offset().left),angular.isNumber(c.scrollByPixels)&&(a=c.scrollByPixels*Math.floor(D()/c.scrollByPixels)),a}function K(){return M()+Math.abs(L())}function L(){var a=$(U.find(".item")[H(!0)]).offset().left;return void 0!==c.isVod&&c.isVod!==!1&&void 0!==$(U.find(".item")[H(!0)-1]).offset()&&(a=$(U.find(".item")[H(!0)-1]).offset().left),S.isIndented||(a-=$(U).offset().left),angular.isNumber(c.scrollByPixels)&&(a=c.scrollByPixels*Math.floor(Math.max(0,D())/c.scrollByPixels)),a}function M(){return $(U).find(".slide")[S.isIndented?"offset":"position"]().left}function N(){return 1===S.currentSet}function O(){return S.currentSet===hb.length}function P(){s("first",function(){S.currentSet=1,F(0)})}function Q(){N()&&S.isIndented?y():S.isIndented?w():z(),m(),a(v,fb)}function R(a){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:a}),reporting.setAttrs({prop10:a}),reporting.sendAttrs(!0))}var S=c;S.isMobile=isMobile();var T=$(f).attr("id"),U=$(f).find(".carousel"),V=$(f).find(".slide");$(f).find(".item");var W=$(f).find(".dots"),X=$(f).find(".carousel-next"),Y=$(f).find(".carousel-prev"),Z=0;S.currentSet=1;var ab,bb=0,cb=0,db=!1,eb=!1,fb=200,gb=60,hb=[],ib=S.showMock?parseInt(S.showMock,10):!1,jb=$(window).width();S.items=[],S.ooluser=d,S.noDVRs=!0;var kb="Vod_more_info";g.query(function(a){S.noDVRs=0===a.length?!1:!0}),S.load=function(){};var lb=function(){var a=function(a){var c=$(a.target),d={targetElem:c,clickedItem:c.is("li")?c:c.parents(".item"),clickedBtn:c.is("button")?c:c.closest("button").length>0?c.closest("button"):!1,clickedDVRRecord:c.is("dvr-record, [dvr-record]")||c.closest("dvr-record, [dvr-record]").length>0?c:!1,clickedInfoBlock:c.is(".info-block")?c:c.closest(".info-block")};d.clickedSecondItem=d.clickedInfoBlock.prev().is(".info-block"),b(a,d)},b=function(a,b){if(b.clickedDVRRecord);else if(!b.clickedBtn&&q(b.clickedItem,b.clickedSecondItem)&&angular.isFunction(q))q(b.clickedItem,b.clickedSecondItem)();else if(!$(a.target).is("button")&&!$(a.target).is("a"))if(R(kb),$(a.target).is(".info-block"))$(a.target).unbind("click"),void 0!==$(a.target).attr("asseturl")&&null!==$(a.target).attr("asseturl")&&(window.location.href="/tv/asset/#"+$(a.target).attr("asseturl"));else if(1025>jb){$(a.target).parents(".info-block").unbind("click");var d=$(a.target).parents(".info-block").attr("asseturl");void 0!==d&&null!==d&&(window.location.href="/tv/asset/#"+d)}else $(a.target).parents(".info-block").unbind("click"),void 0!==$(a.target).parents(".info-block").attr("asseturl")&&null!==$(a.target).parents(".info-block").attr("asseturl")&&(window.location.href="/tv/asset/#"+$(a.target).parents(".info-block").attr("asseturl"));c.$emit("carouselEvent",{eventName:"click",eventTarget:a.target})};f.bind("click",function(b){a(b)}),S.isPast=function(a){return angular.isDate(a)&&a.getTime()<(new Date).getTime()},$(window).resize(function(){S.$apply(function(){Q(),l(),r()})}),$(f).mouseover(function(){t()}),$(f).mouseout(function(){u()}),Y.click(function(){s("previous",function(){S.currentSet--,F(H(!0))})}),X.click(function(){s("next",function(){S.currentSet++,F(H()+1)})}),V.swipe({tap:function(b){(3!==b.which||2!==b.button)&&a(b)},swipe:function(a,b){ab&&clearTimeout(ab),isMobile()&&!eb&&("left"!==b||O()?"right"!==b||N()||(eb=!0,s("previous",function(){S.currentSet--,F(H(!0)),eb=!1})):(eb=!0,s("next",function(){S.currentSet++,F(H()+1),eb=!1})))},threshold:75}),S.$watch("localItems",function(a){a&&(cb=c.localItems.length,setTimeout(function(){S.$apply(r)},100),k())}),S.$watch("localItems.length",function(a){a&&k()}),S.$watch("showHide",function(){c.showHide===!0?($(f).removeClass("hidden"),Q()):$(f).addClass("hidden")}),S.$watch("isIndented",function(){Q(),l()}),S.onScroll=function(a,b,d){Q(),c.$emit("carouselEvent",{carouselId:T,eventName:"scroll",eventTarget:U.find(".item")[a],offset:b,offsetDelta:b-Z-d}),Z=b}};S.generateMockElements=function(){var a=[];switch(ib){case 1:for(var b=1;20>=b;b++)a.push({id:"item",action:j,artwork:"/parts/carousels/images/art"+b+".jpg",info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:j},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]});break;case 2:for(;20>=b;b++)a.push({id:"item",action:j,itemWidth:getRandomInt(10,200),info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:j},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]})}return a},S.getLimitedItems=function(){return angular.isNumber(S.maxItems)?b(S.items,S.maxItems):S.items},S.removeFromCart=function(a,b){var c=b?"Vod_remove_cart_hd_bttm":"Vod_remove_cart_sd_bttm";void 0!==h.landingpage&&"true"===h.landingpage&&(c=b?"Vod_remove_cart_hd":"Vod_remove_cart_sd"),e.removeFromCart(a,c,function(c){"SUCCESS"===c.status&&void 0!==S.items&&S.changeState(a,b,!1)})},S.removeFromFavorites=function(a){var b="Vod_remove_cart_hd_bttm",c=!0,d=a.hd_asset;a.inCartHd||(b="Vod_remove_cart_sd_bttm",c=!1,d=a.sd_asset),e.removeFromCart(d,b,function(a){"SUCCESS"===a.status&&S.changeState(d,c,!1)})},S.addToCart=function(a,b){var c=b?"Vod_cart_hd_bttm":"Vod_cart_sd_bttm";void 0!==h.landingpage&&"true"===h.landingpage&&(c=b?"Vod_cart_hd":"Vod_cart_sd"),d.hasOOLSession?e.addToCart(a,c,function(c){"SUCCESS"===c.status&&void 0!==S.items&&S.changeState(a,b,!0)}):(R(c),$window.location.href="/login?referer="+window.location.href)},S.addToFavorites=function(a){var b="Vod_cart_hd_bttm",c=!0,f=a.hd_asset;a.hd_asset||(b="Vod_cart_sd_bttm",c=!1,f=a.sd_asset),d.hasOOLSession?e.addToCart(f,b,function(a){"SUCCESS"===a.status&&S.changeState(f,c,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:b}),reporting.setAttrs({prop10:b}),reporting.sendAttrs(!0)),$window.location.href="/login?referer="+window.location.href)},S.changeState=function(a,b,c){if(b===!0){var d=_.find(S.items,{hd_asset:a});void 0!==d&&(d.inCartHd=c,d.inCart=d.inCartHd===!1&&d.inCartSd===!1?!1:!0)}if(b===!1){var e=_.find(S.items,{sd_asset:a});void 0!==e&&(e.inCartSd=c,e.inCart=e.inCartHd===!1&&e.inCartSd===!1?!1:!0)}},S.getAssetHref=function(a,b){$(b.target).is("button")||$(b.target).is("a")||void 0!==a&&null!==a&&(window.location.href="/tv/asset/#"+a)},i()}}}]),angular.module("vodMenu",["vod","if"]).directive("vodMenu",[function(){return{templateUrl:"/parts/vod-menu/vod-menu-template.html",restrict:"EA",scope:{caption:"@caption",megamenu:"@megamenu"},controller:["$scope","ooluser","movieCart","OnDemand","$notice","Vod","$compile","$window","$location","$rootScope",function(a,b,c,d,e,f,g,h,i,j){function k(b,c){a.mobileMenuList=a.menuData.slice(parseInt(b.next_level_index,10),parseInt(b.next_level_index,10)+parseInt(c.this_menu_count,10));var d=parseInt(b.parent_level_index,10);if(-1===d)a.prevMenuLinkCaptionInfo={menu_id:null,caption:"TV shows, movies, and more"};else{var e=a.menuData.slice(d,d+1);a.prevMenuLinkCaptionInfo=e[0]}a.mobileMenuList.unshift({menu_id:b.menu_id,caption:b.caption})}a.showMenu=!1;var l=!1;a.showSeriesPage=!1,a.numberOfItems=12;var m="Movies A-Z",n="Adult",o={caption:"On Demand home"};a.$watch("caption",function(b){a.btnCaption=void 0!==b?"Browse "+b:"TV shows, movies, and more"}),f.getVodMenu(),a.showMobileMenu=!1,a.prevMenuLinkCaptionInfo=o,a.showLeftArrow=!1,a.displayMenu=function(b){if(a.showMenu=!0,l===!1&&void 0===a.caption)f.getVodMenu(function(b){"SUCCESS"===b.status&&(a.menuData=b.data.result.menu,a.parentItems=_.where(a.menuData,{parent_level_index:-1}),a.mobileMenuList=_.where(a.menuData,{parent_level_index:-1}),a.mobileMenuList.unshift({menu_id:null,caption:"TV shows, movies, and more"}),l=!0)});else if(l===!1&&void 0!==a.caption)f.getVodMenu(function(b){if("SUCCESS"===b.status){a.menuData=b.data.result.menu,l=!0,"Events and Specials"===a.caption&&(a.caption="Events & Specials");var c=_.where(a.menuData,{caption:a.caption})[0];0===c.children_count&&(c=_.where(a.menuData,{caption:a.caption})[1]);var d=a.menuData[parseInt(c.next_level_index,10)];a.parentItems=a.menuData.slice(parseInt(c.next_level_index,10),parseInt(c.next_level_index,10)+parseInt(d.this_menu_count,10)),k(c,d)}});else if(l===!0&&void 0!==b){var c=$(b.target).parents(".vod-menu");if(c.parents(".captionItems").length>0){var d=c.parents(".captionItems"),e=c.find(".desktop-menu").offset().left,g=d.find(".caption-text").offset().left;if(Math.abs(e-g)>10){var h=d.next("div").find(".carousel").width()-d.find(".caption-text").outerWidth(!0),i=h<d.find(".menu-width").width()?d.find(".menu-width").width()-h:0;c.find(".more-channels-menu").animate({left:-i},500)}else c.find(".more-channels-menu").animate({left:0},500)}}},a.backOverView=function(){var b=angular.element(event.target).parents(".menu-content");b.find(".menu-list").removeClass("menu-width"),b.find(".parentItems").children("li").find("a.active").removeClass("active"),b.find(".parentItems").children("li").find("ul").hide(),b.find(".parentItems").css("left",0),b.removeClass("parent-sub-menu"),b.find(".prevList").hide(),b.parents(".more-channels-menu").removeClass("menu-carousel-width"),void 0!==a.caption&&b.parents(".more-channels-menu").css({left:0})},a.getPreviousMenuItems=function(b){var c=angular.element(b.target).parents(".menu-content"),d=parseInt(Math.abs(parseInt(c.find(".parentItems").css("left"),10))/c.find(".parentItems").width(),10),e=c.find(".menu-list").find("ul:visible").length,f=Math.abs(parseInt(c.find(".parentItems").css("left"),10))>c.find(".parentItems").width()?e-d:void 0,h=parseInt(c.find(".parentItems").css("left"),10)+c.find(".parentItems").outerWidth(!0);if(c.find(".parentItems").css("left",h),i=c.find(".items-list").find("ul:visible").length>3){void 0!==f&&f>=3&&c.find(".items-list").find("ul:visible").last().hide();var i=c.find(".items-list").find("ul:visible").length;c.find(".items-list").find("ul:visible").last().find("li").last().hasClass("moreChannels")&&c.find(".items-list").find("ul:visible").last().find("li").last().replaceWith(g("<li seemore class='seeMore' ><a>More <i class='onet-icons-arrow-right'></i></a></li>")(a)),(-h<c.find(".parentItems").outerWidth(!0)||0===h)&&(c.find(".prevList").hide(),c.parents(".more-channels-menu").removeClass("menu-carousel-width"),c.find(".parentItems").css("left",0))}else c.find(".prevList").hide(),c.parents(".more-channels-menu").removeClass("menu-carousel-width"),c.find(".parentItems").css("left",0)},a.getDetails=function(b){return j.selectedMenuItem=void 0!==b.caption?b.caption:"",void 0!==b.caption&&b.caption===m?(a.showMenu=a.showMobileMenu=!1,h.location.href="/tv/on-demand/#/summary/"+b.menu_id+"/"+b.caption,void 0):void 0!==b.caption&&b.caption===n?(a.showMenu=a.showMobileMenu=!1,h.location.href="/tv/asset/#/adult/"+b.menu_id,void 0):1===b.series_ind&&4===b.action_type?(a.showMenu=a.showMobileMenu=!1,h.location.href="/tv/asset/#/series/"+b.menu_id,void 0):0===b.series_ind&&4===b.action_type?(a.showMenu=a.showMobileMenu=!1,h.location.href="/tv/on-demand/#/summary/"+b.menu_id,void 0):void 0},a.closeMenu=function(){if(a.showMobileMenu=!1,void 0!==a.caption){var b=_.where(a.menuData,{caption:a.caption})[0],c=a.menuData[parseInt(b.next_level_index,10)];k(b,c)}else a.mobileMenuList=_.where(a.menuData,{parent_level_index:-1}),a.mobileMenuList.unshift({menu_id:null,caption:"TV shows, movies, and more"}),a.prevMenuLinkCaptionInfo=o;a.showLeftArrow=!1},a.getMobileMenuDetails=function(b){if(a.showLeftArrow=!0,null===b.menu_id)a.showLeftArrow=!1;else{a.getDetails(b),a.prevLinkInfo=b,a.prevMenuLinkCaptionInfo=a.mobileMenuList[0];var c=parseInt(b.next_level_index,10);a.mobileMenuList=a.menuData.slice(c,c+parseInt(b.children_count,10)),a.mobileMenuList.unshift(b)}},a.textSearch=function(){document.location="/search/#/tvOnDemand/"+encodeURIComponent(a.searchText?a.searchText:"")},a.goToPrviousMenu=function(b){if(a.showLeftArrow=!0,void 0!==b)if(null===b.menu_id)a.mobileMenuList=_.where(a.menuData,{parent_level_index:-1}),a.mobileMenuList.unshift({menu_id:null,caption:"TV shows, movies, and more"}),a.prevMenuLinkCaptionInfo=o,a.showLeftArrow=!1;else{var c=parseInt(b.parent_level_index,10);if(a.mobileMenuList=_.where(a.menuData,{parent_level_index:c}),void 0!==a.mobileMenuList&&a.mobileMenuList.length>0){var d=parseInt(a.mobileMenuList[0].parent_level_index,10);if(-1===c)a.mobileMenuList.unshift({menu_id:null,caption:"TV shows, movies, and more"}),a.prevMenuLinkCaptionInfo=o,a.showLeftArrow=!1;else{a.mobileMenuList.unshift(a.prevMenuLinkCaptionInfo);var e=a.menuData.slice(d,d+1);if(void 0!==a.caption&&a.caption===e[0].caption&&(a.showLeftArrow=!1),void 0!==e&&e.length>0&&-1!==e[0].parent_level_index){var f=parseInt(e[0].parent_level_index,10),g=a.menuData.slice(f,f+1);a.prevLinkInfo=void 0!==e?e[0]:a.mobileMenuList[0],a.prevMenuLinkCaptionInfo=void 0!==g?g[0]:a.prevLinkInfo}else a.prevLinkInfo={menu_id:null,caption:"TV shows, movies, and more"},a.prevMenuLinkCaptionInfo={menu_id:null,caption:"TV shows, movies, and more"}}}}},a.gotoOndemand=function(){"#/"===h.location.hash?a.closeMenu():(a.closeMenu(),h.location.href="/tv/on-demand/#/")},a.getMenus=function(){a.displayMenu(),a.showMobileMenu=!0}}]}}]).directive("vodSubMenu",["$compile",function(a){return{restrict:"AE",template:"",link:function(b,c,d){angular.element(".parentItems").css("left",0);var e=!1,f="Movies A-Z",g="Adult";c.bind("click",function(){var h=c.parents(".menu-content");if(h.addClass("parent-sub-menu"),c.parent().parent().find(".active").removeClass("active"),c.addClass("active"),void 0!==d.nextlevelindex&&null!==d.nextlevelindex&&""!==d.nextlevelindex&&c.html()!==f&&c.html()!==g){if(h.find(".menu-list").addClass("menu-width"),c.parent().parent().children("li.items").last("li").find("ul").hide(),h.parents(".captionItems").length>0){var i=h.parents(".captionItems"),j=h.parents(".vod-menu").find(".desktop-menu").offset().left,k=i.find(".caption-text").offset().left;if(Math.abs(j-k)>10){var l=i.next("div").find(".carousel").width()-i.find(".caption-text").outerWidth(!0),m=l<i.find(".menu-width").width()?i.find(".menu-width").width()-l:0;c.parents(".more-channels-menu").animate({left:-m},500)}else c.parents(".more-channels-menu").animate({left:0},500)}var n=3,o=1,p=4,q=(parseInt($(window).width()/c.parent().parents("ul").outerWidth(),10),b.menuData[parseInt(d.nextlevelindex,10)]),r=b.menuData.slice(parseInt(d.nextlevelindex,10),parseInt(d.nextlevelindex,10)+parseInt(q.this_menu_count,10)),s=r.length,t="<ul>",u=0;if(setLeft=!1,$.each(r,function(a,c){c.caption=c.caption.replace(/["']/g,""),"Uncensored TV"!==c.caption&&u<b.numberOfItems&&(u+=1,t+=c.series_ind!==o||c.action_type!==n&&c.action_type!==p?void 0!==c.next_level_index?"<li class='items'><a  vod-sub-menu index="+u+" totalItems="+s+" nextlevelindex="+c.next_level_index+" ng-click='getDetails("+JSON.stringify(c)+")'>"+c.caption+"</a></li>":"<li class='items'><a  vod-sub-menu index="+u+" totalItems="+s+"  ng-click='getDetails("+JSON.stringify(c)+")'>"+c.caption+"</a></li>":void 0!==c.next_level_index?"<li class='items'><a  vod-sub-menu index="+u+" totalItems="+s+" nextlevelindex="+c.next_level_index+" ng-click='getDetails("+JSON.stringify(c)+")'>"+c.caption+"</a></li>":"<li class='items'><a  vod-sub-menu index="+u+" totalItems="+s+"  ng-click='getDetails("+JSON.stringify(c)+")'>"+c.caption+"</a></li>",e=!0)}),noOfHiddenItem=parseInt(Math.abs(parseInt(h.find(".parentItems").css("left"),10))/h.find(".parentItems").width(),10),allVisibleItems=h.find(".menu-list").find("ul:visible").length,itemsToShow=Math.abs(parseInt(h.find(".parentItems").css("left"),10))>h.find(".parentItems").width()?allVisibleItems-noOfHiddenItem:void 0,r.length>b.numberOfItems&&(t+='<li seemore class="seeMore" ng-show='+u+"<"+s+' ><a>More <i class="onet-icons-arrow-right"></i></a></li><div style="display:none">'+JSON.stringify(r)+"</div> "),$(c).next().children("li.moreChannels").length>0&&$(c).next().children("li.moreChannels").replaceWith(a("<li seemore class='seeMore' ><a>More <i class='onet-icons-arrow-right'></i></a></li>")(b)),t+="</ul>",setLeft=0===c.parent().siblings().find("ul:visible").length&&c.parent().parent().find("li").hasClass("moreChannels")!==!0?!0:!1,c.parent().siblings().find("ul").remove(),c.parent().find("ul").remove(),0===c.parent().find("ul").length&&0===c.next("ul").length&&e===!0){var v=h.find(".parentItems").css("left");
template=a(t)(b),c.parent().append(template),h.find(".parentItems").css("left",v)}var w=c.parent().parent().children("li.items").last("li"),x=parseInt(w.find("a:first").attr("index"),10),y=parseInt(w.find("a:first").attr("totalitems"),10);y>x&&c.parent().parent().children("li.moreChannels").replaceWith(a("<li seemore class='seeMore' ><a>More <i class='onet-icons-arrow-right'></i></a></li>")(b)),c.parent().parent().parent().siblings().find("a").removeClass("active"),c.parent().parents("ul").find("li.moreChannels").find("a").addClass("active"),c.parent().siblings().find("a").removeClass("active"),c.next().find("ul").hide()}else c.parent().parent().children("li.items").find("ul").hide();if(h.find(".menu-list").find("ul:visible").length>3&&(h.find(".prevList").show(),h.parents(".more-channels-menu").addClass("menu-carousel-width")),h.find(".menu-list").find("ul:visible").length>3&&setLeft===!0&&e===!0&&(void 0===itemsToShow||itemsToShow>=3==!0)){var z=0===parseInt(h.find(".parentItems").css("left"),10)?c.parents("ul").outerWidth(!0):c.parents("ul").outerWidth(!0)+-parseInt(h.find(".parentItems").css("left"),10);h.find(".parentItems").css("left",-z+1)}c.parent().parent().find("li").last().hasClass("moreChannels")&&c.parent().parent().find("li").last().replaceWith(a("<li seemore class='seeMore' ><a>More <i class='onet-icons-arrow-right'></i></a></li>")(b))})}}}]).directive("seemore",["$compile",function(a){return{restrict:"A",template:"",link:function(b,c){var d=!1;c.bind("click",function(){var e=!1,f=c.parents(".menu-content"),g=parseInt(Math.abs(parseInt(f.find(".parentItems").css("left"),10))/f.find(".parentItems").width(),10),h=f.find(".menu-list").find("ul:visible").length,i=Math.abs(parseInt(f.find(".parentItems").css("left"),10))>f.find(".parentItems").width()?h-g:void 0;e=0===c.parent().find("ul:visible").length?!0:!1,c.parent().find("ul").remove();var j=JSON.parse(c.next().html());c.siblings().find("a").removeClass("active");var k=j.length,l=parseInt(c.prev("li").find("a:first").attr("index"),10),m=j.slice(l,j.length),n="<ul >";if(f.find(".menu-list").addClass("menu-width"),f.parents(".captionItems").length>0){var o=f.parents(".captionItems"),p=f.parents(".vod-menu").find(".desktop-menu").offset().left,q=o.find(".caption-text").offset().left;if(Math.abs(p-q)>10){var r=o.next("div").find(".carousel").width()-o.find(".caption-text").outerWidth(!0),s=r<o.find(".menu-width").width()?o.find(".menu-width").width()-r:0;c.parents(".more-channels-menu").animate({left:-s},500)}else c.parents(".more-channels-menu").animate({left:0},500)}f.addClass("parent-sub-menu"),$.each(m,function(a,c){a<b.numberOfItems&&(l+=1,n+=void 0!==c.next_level_index?"<li class='items'><a  vod-sub-menu index="+l+" nextlevelindex="+c.next_level_index+" totalitems="+k+"  ng-click='getDetails("+JSON.stringify(c)+")'>"+c.caption+"</a></li>":"<li class='items'><a  vod-sub-menu index="+l+" totalitems="+k+" ng-click='getDetails("+JSON.stringify(c)+")'>"+c.caption+"</a></li>",d=!0)}),n+='<li  seemore class="seeMore"  ng-show='+l+"<"+k+'  ><a>More <i class="onet-icons-arrow-right"></i></a></li><div style="display:none">'+JSON.stringify(j)+"</div>",n+="</ul>",f.find(".menu-list").find("ul:visible").length>=3?(f.find(".prevList").show(),f.parents(".more-channels-menu").addClass("menu-carousel-width")):(f.find(".prevList").hide(),f.parents(".more-channels-menu").removeClass("menu-carousel-width"));var t=0===parseInt(f.find(".parentItems").css("left"),10)?c.parents("ul").outerWidth(!0):c.parents("ul").outerWidth(!0)+-parseInt(f.find(".parentItems").css("left"),10);(e===!1||f.find(".menu-list").find("ul:visible").length>=3&&void 0!==i&&i>=3!=!0)&&(t=-(parseInt(f.find(".parentItems").css("left"),10)-1)),template=a(n)(b),f.find(".menu-list").find("ul:visible").length>=3&&f.find(".parentItems").css("left",-t+1),c.prev("li").append(template),c.replaceWith("<li class='moreChannels'><a class='active'>more</a></li>")})}}}]),angular.module("vodAdult",["vod","pagination","if","ellipsis","spinner"]).controller("vodAdultCtrl",["$scope","$routeParams","Vod","ooluser","$location","$window",function(a,b,c,d,e,f){var g=b.menuId;a.showgriddata=!0,a.ooluser=d,a.accountHasDvr=!1,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1),(void 0!==g||null!==g)&&c.getVodMenuParentMenuId(g).success(function(b){"SUCCESS"===b.status?(console.log("Response:",b),void 0!==b.data.result.path&&("Adult"===b.data.result.path[1].caption?(a.breadcrumbs=b.data.result.path,a.adultMenus=b.data.result.menu,console.log("Adult menus:",a.adultMenus),a.adultMenus[1].csslogo="vlogoPlayboyTV_OD",a.adultMenus[2].csslogo="vlogo"+a.adultMenus[2].portal_callsign):f.location="/tv/asset/")):f.location="/tv/asset/"})}]),angular.module("vodEpisode",["dots","config","dvrRecord","linksDvrCart","movieCart","webdvrResource","poster","alertBanner","ctaArrowLink","tvListings","vod","spinner","moreContributors","vodWhereToWatch","if","onetCookies"]).controller("vodEpisodeCtrl",["$scope","Config","MiniGuide","OnDemand","movieCart","ooluser","WebDVR","TVListings","$log","Support","Vod","$routeParams","$window","$http","$location","Cookies",function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q){function r(){a.showErrorMsg=!0,a.error_msg=l.getErrorMsg(500),a.loading=!1}var s=m.episodeNo,t="Series",u=null,v=m.searchtype;f.laBoxUser=f.hasOOLSession?f.laBoxUser||f.laboxOrMini:"true"===q.getCookie("labox");var w=f.laBoxUser;null!==v&&void 0!==v&&"undefined"!==v&&""!==v&&w&&(u=v);var x=l.getEventLinearData(s,u,null,null,null,null);a.showErrorMsg=!1,a.moreLikeThisCount=0,a.loading=!0,a.ooluser=f,a.accountHasDvr=!1,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1),a.maxAirings=3;var y,z=b.getValuesBySelector("endpoint.api.vodlogos"),A="/vod/api/getImage.jpg?name=";a.windowHref=window.location.href,a.moreContributorsMax=2,a.withHD=!1,a.renderMovie=!1,a.showPosterArt=!0,a.showMobilePosterArt=!0,a.ooluser.hasOOLSession&&k.getUserEquipments({},function(b){var c=b._embedded.devices;transforming=_.reduce(c,function(b,c){c.is_hd&&(a.withHD=!0)},{})}),x.success(function(b){if("SUCCESS"!==b.status)return console.log("No response"),r(),a.loading=!1,void 0;var c=b.data.vodtitle.tms_id,d=b.data.vodtitle.series_ind;void 0!==c&&null!==c.match("^EP")||b.data.vodtitle.show_type===t?a.getEpisodeMetaData(b):void 0!==d&&1===d?a.getEpisodeMetaData(b):(a.renderMovie=!0,a.getEpisodeMetaData(b))}).error(r),a.getEpisodeMetaData=function(b){a.assetDetail=angular.extend({},b.data,b.data.vodtitle);var c=a.assetDetail.offer_end_date.replace(/[^\w\s]/gi,"/"),d=new Date(new Date(c).setDate(new Date(c).getDate()+1));if(new Date>d)return n.location.href="/tv/asset/",void 0;if(reporting_pageName=a.renderMovie?"On-Demand-Movie":"On-Demand-Episode",reporting.pageLoadAjax(reporting_pageName),a.loading=!1,void 0!==a.assetDetail.imageAvailability&&(void 0!==a.assetDetail.imageAvailability.desktopImage&&""!==a.assetDetail.imageAvailability.desktopImage?(a.showPosterArt=!0,a.imgURL=A+a.assetDetail.imageAvailability.desktopImage,void 0!==a.assetDetail.imageAvailability.mobileImage&&""!==a.assetDetail.imageAvailability.mobileImage?(a.showMobilePosterArt=!0,a.mobileImgURL=A+a.assetDetail.imageAvailability.mobileImage):(a.showMobilePosterArt=!1,a.mobileImgURL=""),a.renderMovie===!0&&(a.mobileImgURL=A+a.assetDetail.imageAvailability.desktopImage)):void 0!==a.assetDetail.imageAvailability.linearImage&&""!==a.assetDetail.imageAvailability.linearImage?(a.showPosterArt=!0,a.showMobilePosterArt=!0,a.imgURL=a.mobileImgURL=a.assetDetail.imageAvailability.linearImage):(a.showPosterArt=!1,a.showMobilePosterArt=!1,a.imgURL="",a.mobileImgURL="")),l.VodMovieCart.contains(parseInt(s,10),function(b){a.assetDetail.inCart=b.inCart,a.assetDetail.inCartHd=b.hd_asset,a.assetDetail.inCartSd=b.sd_asset}),l.getTvShowings(s).success(function(b){if("SUCCESS"===b.status){var c=new Date;a.airings=_.map(b.data.result.tvshow_data,function(a){return a.title=a.episodeTitle=a.title,a.channel_number=a.num=a.channel_number,a.cs=a.callsign,a.displayStartTime=a.starttime=a.startTime=a.start_time=new Date(l.getTime(a.from_date)),a.displayEndTime=a.endTime=a.end_time=new Date(l.getTime(a.to_date)),a.showButton=a.endTime>c?!0:!1,""!==a.csslogo&&(a.logo=z+a.csslogo.slice(5)+".png"),o.get(a.logo).error(function(){a.logo=""}),a})}}),void 0!==a.assetDetail.path&&a.assetDetail.path.length>1){a.breadcrumbs=a.assetDetail.path;var e=a.assetDetail.path.length-1,f=e-1;a.assetDetail.menu_id=a.assetDetail.path[e].menu_id,void 0!==a.assetDetail.path[f].caption&&null!==a.assetDetail.path[f].caption&&(a.assetDetail.seriescallSign=a.assetDetail.path[f].caption),"FOD"===a.assetDetail.callsign&&(a.assetDetail.callsign=a.assetDetail.seriescallSign)}var g=l.getrating(a.assetDetail.rating);a.assetDetail.tprating=g.content_rating,a.assetDetail.tpstarRating=g.critics_rating,a.assetDetail.at=g._at,a.assetDetail.s=g._s,a.assetDetail.bn=g._bn;var h=l.getindicators(a.assetDetail.indicators);if(a.assetDetail._new=h._new,a.assetDetail.dd=h._dd,a.assetDetail.sap=h._sap,a.assetDetail.cc=h._cc,a.badgesWrap=a.assetDetail.s===!1&&a.assetDetail.bn===!1&&a.assetDetail.at===!1&&a.assetDetail.dd===!1&&a.assetDetail.sap===!1?!1:!0,a.assetDetail.logo=""!==a.assetDetail.csslogo?z+a.assetDetail.csslogo.slice(5)+".png":"",o.get(a.assetDetail.logo).error(function(){a.assetDetail.logo=""}),null===a.assetDetail.duration||void 0===a.assetDetail.duration)a.assetDetail.show_duration=!1;else{a.assetDetail.show_duration=!0;var j=Math.floor(a.assetDetail.duration/60);a.assetDetail.stream_length_hours=j;var k=Math.floor(a.assetDetail.duration%60);a.assetDetail.stream_length_mins=k}void 0!==a.assetDetail.rental_period&&""!==a.assetDetail.rental_period&&null!==a.assetDetail.rental_period&&(a.assetDetail.rental_period=Math.floor(a.assetDetail.rental_period/3600));var m=l.getSeriesDetails(a.assetDetail.menu_id);m.success(function(b){a.assetDetail.seriesInfo="SUCCESS"===b.status?!0:!1}).error(function(a){console.log("Error",a)});var p=l.getflags(a.assetDetail.flags);a.assetDetail.hd=p._hd,a.assetDetail.isSD=null!==a.assetDetail.sd_asset&&void 0!==a.assetDetail.sd_asset?!0:!1,a.assetDetail.isHD=null!==a.assetDetail.hd_asset&&void 0!==a.assetDetail.hd_asset?!0:!1,a.assetDetail.isSeasonAvailable=0===a.assetDetail.season_number||void 0===a.assetDetail.season_number?!1:!0,void 0!==a.assetDetail.genres&&""!==a.assetDetail.genres&&null!==a.assetDetail.genres&&(a.assetDetail.genresList=a.assetDetail.genres.split("|").join(", ")),void 0!==a.assetDetail.directors&&""!==a.assetDetail.directors&&null!==a.assetDetail.directors&&(a.assetDetail.directors=a.assetDetail.directors.split(",")),void 0!==a.assetDetail.menu_id&&l.getMoreEpisodes(a.assetDetail.menu_id,a.assetDetail.tms_id,a.assetDetail.series_ind,a.assetDetail.show_type,"VOD",function(b){a.moreEpisodes=b.result.carouselItems}),null!==a.assetDetail.tms_id&&void 0!==a.assetDetail.tms_id&&l.getTitles(a.assetDetail.tms_id).success(function(b){if("SUCCESS"===b.status){if(b.data.result.titles.length>0){if(a.assetDetail.haveMoreTitles=!0,void 0!==b.data.result.titles)for(i=0;i<b.data.result.titles.length;i++)a.titles=0===b.data.result.titles[0].price?b.data.result.titles:b.data.result.titles.reverse();if(void 0!==a.titles)for(i=0;i<a.titles.length;i++)s=a.titles[i].hd_asset||a.titles[i].sd_asset,a.getCartDetails(s)}}else a.assetDetail.haveMoreTitles=!1}),null!==a.assetDetail.tms_id&&void 0!==a.assetDetail.tms_id?(y=l.getSeriesDetailswEp(a.assetDetail.tms_id),y.success(function(b){"SUCCESS"===b.status?(a.assetDetail.series_image=b.data.result.image_name,(void 0===a.assetDetail.tms_title||""===a.assetDetail.tms_title||null===a.assetDetail.tms_title)&&(a.assetDetail.tms_title=b.data.result.title),(void 0===a.assetDetail.episode_title||""===a.assetDetail.episode_title||null===a.assetDetail.episode_title)&&(a.assetDetail.episode_title=a.assetDetail.title),(void 0===a.assetDetail.actors||""===a.assetDetail.actors||null===a.assetDetail.actors)&&(a.assetDetail.actors=b.data.result.actors),(void 0===a.assetDetail.genres||""===a.assetDetail.genres||null===a.assetDetail.genres)&&(a.assetDetail.genresList=b.data.result.genres.split("|").join(", "))):"ERROR"===b.status}).error(function(a){console.log("Error",a)})):(y=l.getSeriesDetails(a.assetDetail.menu_id),y.success(function(b){"SUCCESS"===b.status?(a.assetDetail.series_image=b.data.result.image_name,a.assetDetail.tms_title=b.data.result.title,a.assetDetail.episode_title=a.assetDetail.title,a.assetDetail.actors=b.data.result.actors,a.assetDetail.genresList=b.data.result.genres.split("|").join(", ")):"ERROR"===b.status}).error(function(a){console.log("Error",a)}))},a.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/"},a.directorSearch=function(b){return"undefined"!==reporting&&(reporting.setEvents(["event17"]),reporting.sendAttrs(!0)),null===b||void 0===b?!1:(b='"'+b.replace(/"/g,"")+'"',window.location=a.searchCategory.ondemand+b+"/false",void 0)},a.getCartDetails=function(b){l.VodMovieCart.contains(b,function(b){a.titles[i].inCart=b.inCart,a.titles[i].inCartHd=b.hd_asset,a.titles[i].inCartSd=b.sd_asset})},a.removeFromCart=function(b,c){var d=c?"Vod_remove_cart_hd":"Vod_remove_cart_sd";l.removeFromCart(b,d,function(d){"SUCCESS"===d.status&&a.changeState(b,c,!1)})},a.removeFromFavorites=function(b){var c="Vod_remove_cart_hd",d=!0,e=b.hd_asset;b.inCartHd||(c="Vod_remove_cart_sd",d=!1,e=b.sd_asset),l.removeFromCart(e,c,function(b){"SUCCESS"===b.status&&a.changeState(e,d,!1)})},a.addToCart=function(b,c){var d=c?"Vod_cart_hd":"Vod_cart_sd";f.hasOOLSession?l.addToCart(b,d,function(d){"SUCCESS"===d.status&&a.changeState(b,c,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:d}),reporting.setAttrs({prop10:d}),reporting.sendAttrs(!0)),n.location.href="/login?referer="+window.location.href)},a.addToFavorites=function(b){var c="Vod_cart_hd",d=!0,e=b.hd_asset;b.hd_asset||(c="Vod_cart_sd",d=!1,e=b.sd_asset),f.hasOOLSession?l.addToCart(e,c,function(b){"SUCCESS"===b.status&&a.changeState(e,d,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:c}),reporting.setAttrs({prop10:c}),reporting.sendAttrs(!0)),n.location.href="/login?referer="+window.location.href)},a.changeState=function(b,c,d){if(c===!0){if(void 0!==a.assetDetail&&a.assetDetail.hd_asset===b&&(a.assetDetail.inCartHd=d,a.assetDetail.inCart=d),void 0!==a.titles){var e=_.find(a.titles,{hd_asset:b});void 0!==e&&(e.inCartHd=d,e.inCart=d)}if(void 0!==a.moreEpisodes){var f=_.find(a.moreEpisodes,{hd_asset:b});void 0!==f&&(f.inCartHd=d,f.inCart=d)}}if(c===!1){if(void 0!==a.assetDetail&&a.assetDetail.sd_asset===b&&(a.assetDetail.inCartSd=d,a.assetDetail.inCart=d),void 0!==a.titles){var g=_.find(a.titles,{sd_asset:b});void 0!==g&&(g.inCartSd=d,g.inCart=d)}if(void 0!==a.moreEpisodes){var h=_.find(a.moreEpisodes,{sd_asset:b});void 0!==h&&(h.inCartSd=d,h.inCart=d)}}}}]),angular.module("landingPage",["dropdowns","config","spinner","if","onyxVodTopPicks","vodCarousels","config","onetCookies"]).controller("landingPageCtrl",["$scope","Vod","Config","$window","ooluser","$rootScope","Cookies",function(a,b,c,d,e,f,g){function h(){var b=a.ribbonsList;a.ribbons=$.isEmptyObject(a.ribbons)?b:a.ribbons.concat(b),a.loading=!1,a.showMore=m<a.resCount?!0:!1,m+=o,0===n?n=n+1+o:n+=o}function i(){var b=a.ribbonsList.slice(n,m);a.ribbons=$.isEmptyObject(a.ribbons)?b:a.ribbons.concat(b),a.loading=!1,a.showMore=m<a.resCount?!0:!1,n=m,m+=o}function j(){a.showErrorMsg=!0,a.error_msg=b.getErrorMsg(500),a.loading=!1}var k=c.getValuesBySelector("endpoint.api.vodonyximage"),l=20;a.loading=!0,a.loadingRibbons=!1,e.laBoxUser=e.hasOOLSession?e.laBoxUser||e.laboxOrMini:"true"===g.getCookie("labox"),a.ooluser=e,a.accountHasDvr=!1,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1);var m=5,n=0,o=5;a.ribbons={},a.showMore=!1;var p=$(window).width();768>p?b.getLandingPage().success(function(b){if("SUCCESS"===b.status){void 0!==reporting&&(reporting_pageName="on-demand",reporting.pageLoadAjax(reporting_pageName)),a.results=b.data.result.ribbons,a.resCount=b.data.result.total;var c=_.filter(a.results,function(a){return"Top Picks"===a.caption?a.titles:void 0});a.topPicks=void 0!==c?c[0].titles:{},a.ribbonItems=_.filter(a.results,function(a){return"Top Picks"!==a.caption?a.titles:void 0}),a.ribbonsList=_.map(a.ribbonItems,function(b){if(void 0!==b.titles){var c=b.titles.titles;return l>0&&(c=c.slice(0,l)),b.titles.carouselItems=_.map(c,function(b){return a.getCarouselItem(b)}),b}}),i()}else a.loading=!1}).error(j):p>=768&&(a.loading=!0,b.getLandingPagewithRequestCount(m,n).success(function(b){if("SUCCESS"===b.status){a.loading=!1,void 0!==reporting&&(reporting_pageName="on-demand",reporting.pageLoadAjax(reporting_pageName)),a.results=b.data.result.ribbons,a.resCount=b.data.result.total;var c=_.filter(a.results,function(a){return"Top Picks"===a.caption?a.titles:void 0});a.topPicks=void 0!==c?c[0].titles:{},a.ribbonItems=_.filter(a.results,function(a){return"Top Picks"!==a.caption?a.titles:void 0}),a.ribbonsList=_.map(a.ribbonItems,function(b){if(void 0!==b.titles){var c=b.titles.titles;return l>0&&(c=c.slice(0,l)),b.titles.carouselItems=_.map(c,function(b){return a.getCarouselItem(b)}),b}}),h()}else a.loading=!1}).error(j)),a.getRibbons=function(){a.loadingRibbons=!0,b.getLandingPagewithRequestCount(m,n).success(function(b){"SUCCESS"===b.status?(void 0!==reporting&&(reporting_pageName="on-demand",reporting.pageLoadAjax(reporting_pageName)),a.loadingRibbons=!1,a.results=b.data.result.ribbons,a.resCount=b.data.result.total,a.ribbonItems=_.filter(a.results,function(a){return"Top Picks"!==a.caption?a.titles:void 0}),a.ribbonsList=_.map(a.ribbonItems,function(b){if(void 0!==b.titles){var c=b.titles.titles;return l>0&&(c=c.slice(0,l)),b.titles.carouselItems=_.map(c,function(b){return a.getCarouselItem(b)}),b}}),h()):a.loading=!1}).error(j)},a.getCarouselItem=function(a){var c,d=a.callsign,e=a.offer_end_date;("MOD"===a.callsign||"VOD"===a.callsign)&&(d="On Demand"),"FOD"===a.callsign&&(d="Free On Demand"),c={id:a.title_id.toString(),title:a.isEpisode?a.episode_title||a.title:a.tms_title||a.title,callsign:d,isEpisode:a.isEpisode,artwork:k+(void 0!==a.imageAvailable?a.imageAvailable:""),epSeasonNumber:a.season_number,network:d,epEepisodeNumber:a.episode_number,vodAvailableThrough:new Date(e.split("-")[0],parseInt(e.split("-")[1],10)-1,e.split("-")[2]).getTime(),_new:a.indicators>>2&!0?!0:!1,href:a.isEpisode?"/episode/"+(a.hd_asset||a.sd_asset):"/movie/"+(a.hd_asset||a.sd_asset),release_year:a.release_year,price:a.price},void 0!==a.hd_asset&&(c.hd_asset=a.hd_asset),void 0!==a.sd_asset&&(c.sd_asset=a.sd_asset);var f=a.hd_asset||a.sd_asset;return b.VodMovieCart.contains(f,function(a){c.inCart=a.inCart,c.inCartHd=a.hd_asset,c.inCartSd=a.sd_asset}),c},a.removeFromCart=function(c,d){var e=d?"Vod_remove_cart_hd":"Vod_remove_cart_sd",f=d===!0?c.hd_asset:c.sd_asset;b.removeFromCart(f,e,function(b){"SUCCESS"===b.status&&void 0!==c&&a.changeState(c,d,!1)})},a.removeFromFavorites=function(c){var d="Vod_remove_cart_hd",e=!0,f=c.hd_asset;c.inCartHd||(d="Vod_remove_cart_sd",e=!1,f=c.sd_asset),b.removeFromCart(f,d,function(b){"SUCCESS"===b.status&&a.changeState(c,e,!1)})},a.addToCart=function(c,f){var g=f?"Vod_cart_hd":"Vod_cart_sd";if(e.hasOOLSession){var h=f===!0?c.hd_asset:c.sd_asset;b.addToCart(h,g,function(b){"SUCCESS"===b.status&&void 0!==c&&a.changeState(c,f,!0)})}else"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:g}),reporting.setAttrs({prop10:g}),reporting.sendAttrs(!0)),d.location.href="/login?referer="+window.location.href},a.addToFavorites=function(c){var f="Vod_cart_hd",g=!0,h=c.hd_asset;c.hd_asset||(f="Vod_cart_sd",g=!1,h=c.sd_asset),e.hasOOLSession?b.addToCart(h,f,function(b){"SUCCESS"===b.status&&a.changeState(c,g,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:f}),reporting.setAttrs({prop10:f}),reporting.sendAttrs(!0)),d.location.href="/login?referer="+window.location.href)},a.changeState=function(a,b,c){b===!0&&(a.inCartHd=c,a.inCart=a.inCartHd===!1&&a.inCartSd===!1?!1:!0),b===!1&&(a.inCartSd=c,a.inCart=a.inCartHd===!1&&a.inCartSd===!1?!1:!0)},a.getDetail=function(a,b){var c=b?"/episode/"+a:"/movie/"+a;window.location.href="/tv/asset/#"+c},a.getAssetInfo=function(a){var b=$(a.target).parents(".accordion-heading"),c=$(a.target).parents(".accordion-group").siblings().find(".accordion-heading"),d=$(a.target).parents(".accordion-group");b.find(".icon-sort-down").length>=1?b.find(".icon-sort-down").removeClass("icon-sort-down").addClass("icon-sort-up"):b.find(".icon-sort-up").removeClass("icon-sort-up").addClass("icon-sort-down"),d.siblings().removeClass("accordion-expand"),c.find(".icon-sort-up").removeClass("icon-sort-up").addClass("icon-sort-down"),d.hasClass("accordion-expand")?d.removeClass("accordion-expand"):d.addClass("accordion-expand");var e=($(a.target).parents(".accordion-group").prevAll(".accordion-group").length+1)*$(a.target).parents(".accordion-heading").outerHeight();$(window).scrollTop(e)},a.getMenus=function(){f.show_mobile_menu=!f.show_mobile_menu}}]),angular.module("linearEpisode",["config","dvrRecord","miniGuideResource","movieCart","webdvrResource","poster","vod","vodWhereToWatch","spinner"]).controller("linearEpisodeCtrl",["$scope","Config","$routeParams","Vod","$rootScope","Support","ooluser","$window","WebDVR","$http",function(a,b,c,d,e,f,g,h,j,k){function l(){a.showErrorMsg=!0,a.error_msg=d.getErrorMsg(500),a.loading=!1}var m,n="&",o="mId:",p="tId:",q=$(window).width(),r=new Date,s="/vod/api/getImage.jpg?name=",t=b.getValuesBySelector("endpoint.api.vodlogos");a.showPosterArt=!0,a.showMobilePosterArt=!0,a.showErrorMsg=!1,a.ooluser=g,a.accountHasDvr=!1,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1),a.noDVRs=!0,j.query(function(b){a.noDVRs=0===b.length?!1:!0}),a.ctrlhaveDVR=!1,a.ctrlisRecorded=!1;var u=c.ids.split(n);void 0!==u[1]&&(a.menu_id=u[1].substr(0+parseInt(o.length,10),u[1].length)),void 0!==u[0]&&(a.tmsId=m=u[0].substr(0+parseInt(p.length,10),u[0].length)),a.withHD=!1,a.ooluser.hasOOLSession&&f.getUserEquipments({},function(b){var c=b._embedded.devices;transforming=_.reduce(c,function(b,c){c.is_hd&&(a.withHD=!0)},{})}),a.loading=!0;var v;d.getEventLinearData(m,"episode",null,null,null,null).success(function(b){if(a.loading=!1,"SUCCESS"===b.status){if(a.linearEpisodeDetail=angular.extend({},b.data,b.data.vodlinear),void 0!==reporting&&(reporting_pageName="Linear-Episode",reporting.pageLoadAjax(reporting_pageName)),void 0!==a.linearEpisodeDetail.imageAvailability&&(void 0!==a.linearEpisodeDetail.imageAvailability.desktopImage&&""!==a.linearEpisodeDetail.imageAvailability.desktopImage?(a.showPosterArt=!0,a.imgURL=s+a.linearEpisodeDetail.imageAvailability.desktopImage,void 0!==a.linearEpisodeDetail.imageAvailability.mobileImage&&""!==a.linearEpisodeDetail.imageAvailability.mobileImage?(a.showMobilePosterArt=!0,a.mobileImgURL=s+a.linearEpisodeDetail.imageAvailability.mobileImage):(a.showMobilePosterArt=!1,a.mobileImgURL="")):void 0!==a.linearEpisodeDetail.imageAvailability.linearImage&&""!==a.linearEpisodeDetail.imageAvailability.linearImage?(a.showPosterArt=!0,a.showMobilePosterArt=!1,a.imgURL=a.mobileImgURL=a.linearEpisodeDetail.imageAvailability.linearImage):(a.showPosterArt=!1,a.showMobilePosterArt=!1,a.imgURL="",a.mobileImgURL="")),a.linearEpisodeDetail.critic_rating=Math.floor(a.linearEpisodeDetail.critic_rating/1),(void 0===a.linearEpisodeDetail.directors||null===a.linearEpisodeDetail.directors||""===a.linearEpisodeDetail.directors)&&(a.directors=!1),(void 0===a.linearEpisodeDetail.episode_title||""===a.linearEpisodeDetail.episode_title)&&(a.linearEpisodeDetail.episode_title=a.linearEpisodeDetail.title),(null===a.linearEpisodeDetail.title||void 0===a.linearEpisodeDetail.title)&&(a.linearEpisodeDetail.title=a.linearEpisodeDetail.episodeTitle=a.linearEpisodeDetail.episode_title),(null!==a.linearEpisodeDetail.more_airings||void 0!==a.linearEpisodeDetail.more_airings||""!==a.linearEpisodeDetail.more_airings)&&(a.linearEpisodeDetail.airings=_.map(a.linearEpisodeDetail.more_airings,function(a){return a.episodeTitle=a.title,a.cs=a.callsign,a.displayStartTime=a.starttime=a.StartTime=a.start_time=new Date(d.getTime(a.from_date)),a.displayEndTime=a.end_time=a.endTime=new Date(d.getTime(a.to_date)),a.num=a.channel_number,a.showButton=a.end_time>r?!0:!1,console.log("airing.csslogo: "+a.csslogo),""!==a.csslogo&&(a.logo=t+a.csslogo.slice(5)+".png"),k.get(a.logo).error(function(){a.logo=""}),a}),e.linear_callsign=a.linearEpisodeDetail.airings[0].callsign,a.linear_callsign=a.linearEpisodeDetail.airings[0].callsign),(null!==m||void 0!==m)&&(d.getMoreLinearEpisodes(m,"episode","LINEAR",function(b){a.moreLinearEpisodes=b.result.carouselItems}),d.getTitles(m).success(function(b){if("SUCCESS"===b.status)if(b.data.result.titles.length>0){if(a.linearEpisodeDetail.offer_end_date=!1,a.linearEpisodeDetail.haveMoreTitles=!0,void 0!==b.data.result.titles)for(i=0;i<b.data.result.titles.length;i++)a.titles=0===b.data.result.titles[0].price?b.data.result.titles:b.data.result.titles.reverse();if(void 0!==a.titles)for(i=0;i<a.titles.length;i++)assetId=a.titles[i].hd_asset||a.titles[i].sd_asset,a.getCartDetails(assetId)}else a.linearEpisodeDetail.haveMoreTitles=!1}),e.vod_header_title="TV",a.linearEpisodeDetail.series_title=null!==a.linearEpisodeDetail.title||void 0!==a.linearEpisodeDetail.title?a.linearEpisodeDetail.title:a.linearEpisodeDetail.episode_title),null!==a.linearEpisodeDetail.series_tms_id||void 0!==a.linearEpisodeDetail.series_tms_id||""!==a.linearEpisodeDetail.series_tms_id?(a.seriesInfoAvailable=!0,v=d.getSeriesDetailsBySeriestmsid(a.linearEpisodeDetail.series_tms_id),v.success(function(b){if("SUCCESS"===b.status){if(void 0!==b.data.result.title&&(a.linearEpisodeDetail.series_title=b.data.result.title),e.seriesInfoAvailable=!1,a.seriesInfoAvailable=!0,e.menu_id=void 0===a.menu_id?a.linearEpisodeDetail.series_tms_id:a.menu_id,(""===a.linearEpisodeDetail.actors||void 0===a.linearEpisodeDetail.actors||null===a.linearEpisodeDetail.actors)&&(a.linearEpisodeDetail.actors=b.data.result.actors),void 0!==b.episodeList.result.path){a.linearEpisodeDetail.path=b.episodeList.result.path;var c=a.linearEpisodeDetail.path.length-1,d=c-1;a.linearEpisodeDetail.menu_id=a.linearEpisodeDetail.path[c].menu_id,linearEpisodeDetail.seriescallSign=a.linearEpisodeDetail.path[d].caption}(null===a.linearEpisodeDetail.callsign||void 0===a.linearEpisodeDetail.callsign)&&(a.linearEpisodeDetail.callsign=a.linearEpisodeDetail.seriescallSign)}else"ERROR"===b.status&&(a.linearEpisodeDetail.seriesInfo=!1,e.seriesInfoAvailable=!1,a.seriesInfoAvailable=!1)}).error(function(a){console.log("Error",a)})):null!==a.menu_id||void 0!==a.menu_id||""!==a.menu_id?(a.seriesInfoAvailable=!0,v=d.getSeriesDetails(a.menu_id),v.success(function(b){if("SUCCESS"===b.status){a.linearEpisodeDetail.series_title=b.data.result.title,e.seriesInfoAvailable=!0,a.seriesInfoAvailable=!0,e.menu_id=a.menu_id,(""===a.linearEpisodeDetail.actors||void 0===a.linearEpisodeDetail.actors||null===a.linearEpisodeDetail.actors)&&(a.linearEpisodeDetail.actors=b.data.result.actors),a.linearEpisodeDetail.path=b.episodeList.result.path;var c=a.linearEpisodeDetail.path.length-1,d=c-1;a.linearEpisodeDetail.menu_id=a.linearEpisodeDetail.path[c].menu_id,linearEpisodeDetail.seriescallSign=a.linearEpisodeDetail.path[d].caption,(null===a.linearEpisodeDetail.callsign||void 0===a.linearEpisodeDetail.callsign)&&(a.linearEpisodeDetail.callsign=a.linearEpisodeDetail.seriescallSign)}else"ERROR"===b.status&&(a.linearEpisodeDetail.seriesInfo=!1,e.seriesInfoAvailable=!1,a.seriesInfoAvailable=!1)}).error(function(a){console.log("Error",a)})):(a.seriesInfoAvailable=!1,a.linearEpisodeDetail.series_title=null!==a.linearEpisodeDetail.title||void 0!==a.linearEpisodeDetail.title?a.linearEpisodeDetail.title:a.linearEpisodeDetail.episode_title,e.seriesInfoAvailable=!1,a.seriesInfoAvailable=!1),void 0!==a.linearEpisodeDetail){a.linearEpisodeDetail.release_date=a.linearEpisodeDetail.release_date.split("-")[0];var c=a.linearEpisodeDetail.qualifiers.split(",");a.linearEpisodeDetail.isHD=-1!==$.inArray("HDTV",c)?!0:!1,a.linearEpisodeDetail.cc=-1!==$.inArray("CC",c)?!0:!1,a.linearEpisodeDetail.stereo=-1!==$.inArray("Stereo",c)?!0:!1,a.linearEpisodeDetail.dd=-1!==$.inArray("DD 5.1",c)?!0:!1,a.linearEpisodeDetail._new=-1!==$.inArray("New",c)?!0:!1,a.linearEpisodeDetail.bn=-1!==$.inArray("BN",c)?!0:!1,a.linearEpisodeDetail.at=-1!==$.inArray("AT",c)?!0:!1,a.linearEpisodeDetail.sap=-1!==$.inArray("SAP",c)?!0:!1,a.linearEpisodeDetail.rerun=-1!==$.inArray("Rerun",c)?!0:!1,a.linearEpisodeDetail.isSeasonAvailable=0!==a.linearEpisodeDetail.season_number||""!==a.linearEpisodeDetail.season_number||void 0!==a.linearEpisodeDetail.season_number?!0:!1,void 0!==a.linearEpisodeDetail.genres&&""!==a.linearEpisodeDetail.genres&&null!==a.linearEpisodeDetail.genres&&(a.linearEpisodeDetail.genres=a.linearEpisodeDetail.genres.split(",").join(", ")),a.badgesWrap=a.linearEpisodeDetail.stereo===!1&&a.linearEpisodeDetail.bn===!1&&a.linearEpisodeDetail.at===!1&&a.linearEpisodeDetail.dd===!1&&a.linearEpisodeDetail.sap===!1?!1:!0}}else h.location="/tv"}).error(l),a.onDemandDetails=function(){q>767?($("html, body").animate({scrollTop:$("#showonDemandData").offset().top-150},1e3),a.onDemandAvailable=!0):($("html, body").animate({scrollTop:$("#showOnDemandMobile").offset().top-150},1e3),a.onDemandAvailable=!0)},a.getCartDetails=function(b){d.VodMovieCart.contains(b,function(b){a.titles[i].inCart=b.inCart,a.titles[i].inCartHd=b.hd_asset,a.titles[i].inCartSd=b.sd_asset})},a.goToLogin=function(){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:"Record"}),reporting.setAttrs({prop10:"Record"}),reporting.sendAttrs(!0)),h.location.href="/login?referer="+window.location.href}}]),angular.module("vodLinearMovie",["vod","moreContributors","dvrRecord","spinner","vodWhereToWatch","webdvrResource","config"]).controller("vodLinearMovieCtrl",["$scope","Vod","$routeParams","$rootScope","Support","ooluser","$window","WebDVR","Config","$http",function(a,b,c,d,e,f,g,h,j,k){function l(){a.showErrorMsg=!0,a.error_msg=b.getErrorMsg(500),a.loading=!1}var m=c.programId,n=c.channel,o=c.callsign,p=c.startTime,q=c.hubId,r=c.isHd,s=c.eventId;a.loading=!0,a.accountHasDvr=!1,a.ooluser=f,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1),a.noDVRs=!0,a.dvrBlocked=!1;var t=j.getValuesBySelector("endpoint.api.vodlogos");h.query(function(b){a.noDVRs=0===b.length?!1:!0,a.dvrBlocked=b.hasDvrBlocked===!0?!0:!1});var u=$(window).width(),v="/vod/api/getImage.jpg?name=",w=j.getValuesBySelector("endpoint.api.wpg")+"image?eventId=",x=j.getValuesBySelector("endpoint.api.wpg")+"upgImage?programId=";a.showPosterArt=!0,a.showErrorMsg=!1;var y=new Date;a.ctrlhaveDVR=!1,a.ctrlisRecorded=!1,a.withHD=!0,a.ooluser.hasOOLSession&&(a.withHD=!1,e.getUserEquipments({},function(b){var c=b._embedded.devices;transforming=_.reduce(c,function(b,c){c.is_hd&&(a.withHD=!0)},{})})),n=void 0===n?null:n,void 0!==s&&null!==s&&""!==s?b.getLinearEventDetail(s,q,r).success(function(b){a.getLinearMovieDetails(b)}).error(l):b.getLinearProgramDetail("movie",m,q,a.withHD,p,o).success(function(b){a.getLinearMovieDetails(b)}).error(l),a.getLinearMovieDetails=function(c){if(a.loading=!1,"SUCCESS"===c.status){a.linearMovieDetail=angular.extend({},c.data,c.data.linear),void 0!==reporting&&(reporting_pageName="Linear-Movie",reporting.pageLoadAjax(reporting_pageName)),d.vod_header_title="TV",d.seriesInfoAvailable=!1,a.linearMovieDetail.episodeTitle=a.linearMovieDetail.title=a.linearMovieDetail.title,a.linearMovieDetail.callSign=a.linearMovieDetail.cs=a.linearMovieDetail.callsign,a.linearMovieDetail.channel_number=a.linearMovieDetail.num=a.linearMovieDetail.channelNum,a.linearMovieDetail.displayStartTime=b.getestTime(a.linearMovieDetail.startTime),a.linearMovieDetail.displayEndTime=b.getestTime(a.linearMovieDetail.endTime),a.linearMovieDetail.starttime=a.linearMovieDetail.startTime=a.linearMovieDetail.start_time=new Date(a.linearMovieDetail.startTime),a.linearMovieDetail.stream_length=a.linearMovieDetail.duration,a.linearMovieDetail.endTime=a.linearMovieDetail.end_time=new Date(a.linearMovieDetail.endTime),a.linearMovieDetail.programtype=a.linearMovieDetail.showType,a.linearMovieDetail.tvRating=a.linearMovieDetail.tvRating?a.linearMovieDetail.tvRating:a.linearMovieDetail.criticRating,void 0!==a.linearMovieDetail.callsign&&""!==a.linearMovieDetail.callsign&&(a.linearMovieDetail.logo=t+a.linearMovieDetail.callsign+".png"),k.get(a.linearMovieDetail.logo).error(function(){a.linearMovieDetail.logo=""
}),a.sportsEvent="SPORTS_EVENT"===a.linearMovieDetail.show_type?!0:!1,void 0!==a.linearMovieDetail.endTime&&(a.linearMovieDetail.showButton=a.linearMovieDetail.endTime>y?!0:!1);var e=Math.floor(a.linearMovieDetail.stream_length/60);a.linearMovieDetail.stream_length_hours=e;var f=Math.floor(a.linearMovieDetail.stream_length%60);a.linearMovieDetail.stream_length_mins=f;var h=a.linearMovieDetail.starRating.split(".");a.linearMovieDetail.starRating=h[0];var j=a.linearMovieDetail.imageAvailability;if(void 0!==j&&(void 0!==j.desktopImageVOD&&null!=j.desktopImageVOD&&""!==j.desktopImageVOD?(a.showPosterArt=!0,a.imgURL=v+j.desktopImageVOD,void 0!==j.mobileImageVOD&&null!==j.mobileImageVOD&&""!==j.mobileImageVOD?(a.showMobilePosterArt=!0,a.mobileImgURL=v+j.mobileImageVOD):(a.showMobilePosterArt=!1,a.mobileImgURL="")):void 0!==j.desktopImageWPG&&null!==j.desktopImageWPG&&""!==j.desktopImageWPG?(a.showPosterArt=!0,a.imgURL=w+j.desktopImageWPG,void 0!==j.mobileImageWPG&&null!==j.mobileImageWPG&&""!==j.mobileImageWPG?(a.showMobilePosterArt=!0,a.mobileImgURL=w+j.mobileImageWPG):(a.showMobilePosterArt=!1,a.mobileImgURL="")):void 0!==j.desktopImageUPG&&null!==j.desktopImageUPG&&""!==j.desktopImageUPG?(a.showPosterArt=!0,a.imgURL=x+j.desktopImageUPG,void 0!==j.mobileImageUPG&&null!==j.mobileImageUPG&&""!==j.mobileImageUPG?(a.showMobilePosterArt=!0,a.mobileImgURL=x+j.mobileImageUPG):(a.showMobilePosterArt=!1,a.mobileImgURL="")):(a.showPosterArt=!1,a.showMobilePosterArt=!1,a.imgURL="",a.mobileImgURL="")),(null!==a.linearMovieDetail.moreAiringDates||void 0!==a.linearMovieDetail.moreAiringDates)&&(a.airings=_.map(a.linearMovieDetail.moreAiringDates,function(c){var d=c.startTime;c.displayStartTime=b.getestTime(d),c.title=c.episodeTitle=a.linearMovieDetail.episodeTitle,c.channel_number=c.channelNumber,c.cs=c.callsign,c.starttime=c.startTime=c.start_time=new Date(c.startTime),c.duration=c.duration;var e=Math.floor(6e4*c.duration);return c.displayEndTime=b.getestTime(e+d),c.endTime=c.end_time=new Date(e+d),c.num=c.channelNumber,c.programtype=a.linearMovieDetail.showType,null!==c.qualities&&void 0!==c.qualities&&(c.qualifiers=c.qualities.toString()),c.showButton=c.endTime>y?!0:!1,void 0!==c.callsign&&""!==c.callsign&&(c.logo=t+c.callsign+".png"),k.get(c.logo).error(function(){c.logo=""}),c})),a.linearMovieDetail.offer_end_date=!1,a.linearMovieDetail.vodIds.length>0&&(a.titles=a.linearMovieDetail.vodIdTitles.titles,void 0!==a.titles))for(i=0;i<a.titles.length;i++)assetId=a.titles[i].hd_asset||a.titles[i].sd_asset,a.getCartDetails(assetId);var l=a.linearMovieDetail.qualities;null!==a.linearMovieDetail.qualities&&void 0!==a.linearMovieDetail.qualities&&(a.linearMovieDetail.qualifiers=a.linearMovieDetail.qualities.toString()),a.ooluser.hasOOLSession&&(a.linearMovieDetail.isHDEpisode=-1!==$.inArray("HDTV",l)?!0:!1),a.linearMovieDetail.isHD=-1!==$.inArray("HDTV",l)?!0:!1,a.linearMovieDetail.cc=-1!==$.inArray("CC",l)?!0:!1,a.linearMovieDetail.stereo=-1!==$.inArray("Stereo",l)?!0:!1,a.linearMovieDetail.dd=-1!==$.inArray("DD 5.1",l)?!0:!1,a.linearMovieDetail._new=-1!==$.inArray("New",l)?!0:!1,a.linearMovieDetail.bn=-1!==$.inArray("BN",l)?!0:!1,a.linearMovieDetail.at=-1!==$.inArray("AT",l)?!0:!1,a.linearMovieDetail.sap=-1!==$.inArray("SAP",l)?!0:!1,a.linearMovieDetail.rerun=-1!==$.inArray("Rerun",l)?!0:!1,a.badgesWrap=a.linearMovieDetail.stereo===!1&&a.linearMovieDetail.bn===!1&&a.linearMovieDetail.at===!1&&a.linearMovieDetail.dd===!1&&a.linearMovieDetail.sap===!1?!1:!0,void 0!==a.linearMovieDetail.genres&&null!==a.linearMovieDetail.genres&&""!==a.linearMovieDetail.genres&&(a.genres=a.linearMovieDetail.genres.split("|").join(", ")),a.actors=a.linearMovieDetail.actors,a.directors=a.linearMovieDetail.directors}else g.location="/tv"},a.getCartDetails=function(c){b.VodMovieCart.contains(c,function(b){a.titles[i].inCart=b.inCart,a.titles[i].inCartHd=b.hd_asset,a.titles[i].inCartSd=b.sd_asset})},a.onDemandDetails=function(){u>767?($("html, body").animate({scrollTop:$("#showonDemandData").offset().top-150},1e3),a.onDemandAvailable=!0):($("html, body").animate({scrollTop:$("#showOnDemandMobile").offset().top-150},1e3),a.onDemandAvailable=!0)},a.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/"},a.directorSearch=function(b){return"undefined"!==reporting&&(reporting.setEvents(["event17"]),reporting.sendAttrs(!0)),null===b||void 0===b?!1:(b='"'+b.replace(/"/g,"")+'"',window.location=a.searchCategory.ondemand+b+"/false",void 0)},a.goToLogin=function(){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:"Record"}),reporting.setAttrs({prop10:"Record"}),reporting.sendAttrs(!0)),g.location.href="/login?referer="+window.location.href}}]),angular.module("vodMovie",["vod","moreContributors","spinner","config","onetCookies"]).controller("vodMovieCtrl",["$scope","$routeParams","Vod","ooluser","$window","Support","$location","Config","$http","Cookies",function(a,b,c,d,e,f,g,h,j,k){function l(){a.showErrorMsg=!0,a.error_msg=c.getErrorMsg(500),a.loading=!1}var m=b.movieId,n=b.searchtype;if(void 0===m||""===m||null===m)return l(),a.loading=!1,void 0;d.laBoxUser=d.hasOOLSession?d.laBoxUser||d.laboxOrMini:"true"===k.getCookie("labox");var o,p=d.laBoxUser;o=null!==n&&void 0!==n&&"undefined"!==n&&""!==n&&p?c.getMovieDetailSearch(m):c.getMovieDetail(m),a.ooluser=d,a.accountHasDvr=!1,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1),a.loading=!0;var q="/vod/api/getImage.jpg?name=",r=h.getValuesBySelector("endpoint.api.vodlogos");a.showPosterArt=!0,a.showErrorMsg=!1,a.withHD=!1,a.windowHref=window.location.href,a.ooluser.hasOOLSession&&f.getUserEquipments({},function(b){var c=b._embedded.devices;transforming=_.reduce(c,function(b,c){c.is_hd&&(a.withHD=!0)},{})}),o.success(function(b){if(a.loading=!1,"SUCCESS"!==b.status)return l(),void 0;a.assetDetail=angular.extend({},b.data,b.data.vod);var d=a.assetDetail.tms_id,e=a.assetDetail.series_ind;if(void 0!==d&&null!==d.match("^EP")||void 0!==e&&1===e)return g.path("/episode/"+m),void 0;var f=a.assetDetail.offer_end_date.replace(/[^\w\s]/gi,"/"),h=new Date(new Date(f).setDate(new Date(f).getDate()+1));if(new Date>h)return g.path("/tv/asset/"),void 0;void 0!==reporting&&(reporting_pageName="On-Demand-Movie",reporting.pageLoadAjax(reporting_pageName)),c.VodMovieCart.contains(parseInt(m,10),function(b){a.assetDetail.inCart=b.inCart,a.assetDetail.inCartHd=b.hd_asset,a.assetDetail.inCartSd=b.sd_asset}),void 0!==a.assetDetail.imageAvailability&&(void 0!==a.assetDetail.imageAvailability.desktopImage&&""!==a.assetDetail.imageAvailability.desktopImage?(a.showPosterArt=!0,a.imgURL=q+a.assetDetail.imageAvailability.desktopImage,a.mobileImgURL=void 0!==a.assetDetail.imageAvailability.desktopImage&&""!==a.assetDetail.imageAvailability.desktopImage?q+a.assetDetail.imageAvailability.mobileImage:q+a.assetDetail.imageAvailability.desktopImage):void 0!==a.assetDetail.imageAvailability.linearImage&&""!==a.assetDetail.imageAvailability.linearImage?(a.showPosterArt=!0,a.imgURL=a.assetDetail.imageAvailability.linearImage,a.mobileImgURL=a.assetDetail.imageAvailability.linearImage):(a.showPosterArt=!1,a.imgURL="",a.mobileImgURL="")),c.getTvShowings(m).success(function(b){if("SUCCESS"===b.status){var d=new Date;a.airings=_.map(b.data.result.tvshow_data,function(a){return a.title=a.episodeTitle=a.title,a.channel_number=a.num=a.channel_number,a.cs=a.callsign,a.displayStartTime=a.starttime=a.startTime=a.start_time=new Date(c.getTime(a.from_date)),a.displayEndTime=a.endTime=a.end_time=new Date(c.getTime(a.to_date)),a.showButton=a.endTime>d?!0:!1,""!==a.csslogo&&(a.logo=r+a.csslogo.slice(5)+".png"),j.get(a.logo).error(function(){a.logo=""}),a})}}),(void 0!==a.assetDetail.tms_id||null!==a.assetDetail.tms_id)&&c.getTitles(a.assetDetail.tms_id).success(function(b){if("SUCCESS"===b.status){if(1===b.data.result.titles.length&&(a.assetDetail.network=b.data.result.titles[0].network),b.data.result.titles.length>1){if(a.assetDetail.haveMoreTitles=!0,void 0!==b.data.result.titles)for(i=0;i<b.data.result.titles.length;i++)a.titles=0===b.data.result.titles[0].price?b.data.result.titles:b.data.result.titles.reverse();if(void 0!==a.titles)for(i=0;i<a.titles.length;i++)assetId=a.titles[i].hd_asset||a.titles[i].sd_asset,a.getCartDetails(assetId)}}else a.assetDetail.haveMoreTitles=!1});var k=c.getrating(a.assetDetail.rating);a.assetDetail.tprating=k.content_rating,a.assetDetail.tpstarRating=k.critics_rating,a.assetDetail.at=k._at,a.assetDetail.s=k._s,a.assetDetail.bn=k._bn;var n=c.getindicators(a.assetDetail.indicators);if(a.assetDetail._new=n._new,a.assetDetail.dd=n._dd,a.assetDetail.sap=n._sap,a.assetDetail.cc=n._cc,""!==a.assetDetail.csslogo&&(a.assetDetail.logo=r+a.assetDetail.csslogo.slice(5)+".png"),j.get(a.assetDetail.logo).error(function(){a.assetDetail.logo=""}),c.getflags(a.assetDetail.flags),null===a.assetDetail.stream_length||void 0===a.assetDetail.stream_length)a.assetDetail.duration=!1;else{a.assetDetail.duration=!0;var o=Math.floor(a.assetDetail.stream_length/60);a.assetDetail.stream_length_hours=o;var p=Math.floor(a.assetDetail.stream_length%60);a.assetDetail.stream_length_mins=p}a.assetDetail.isSD=null!==a.assetDetail.sd_asset&&void 0!==a.assetDetail.sd_asset&&""!==a.assetDetail.sd_asset?!0:!1,a.assetDetail.isHD=null!==a.assetDetail.hd_asset&&void 0!==a.assetDetail.hd_asset&&""!==a.assetDetail.hd_asset?!0:!1,void 0!==a.assetDetail.genres&&null!==a.assetDetail.genres&&""!==a.assetDetail.genres&&(a.assetDetail.genresList=a.assetDetail.genres.split("|").join(", ")),void 0!==a.assetDetail.directors&&""!==a.assetDetail.directors&&null!==a.assetDetail.directors&&(a.assetDetail.directors=a.assetDetail.directors.split(",")),void 0!==a.assetDetail.rental_period&&""!==a.assetDetail.rental_period&&null!==a.assetDetail.rental_period&&(a.assetDetail.rental_period=Math.floor(a.assetDetail.rental_period/3600)),a.badgesWrap=a.assetDetail.s===!1&&a.assetDetail.bn===!1&&a.assetDetail.at===!1&&a.assetDetail.dd===!1&&a.assetDetail.sap===!1?!1:!0}).error(l),a.getCartDetails=function(b){c.VodMovieCart.contains(b,function(b){a.titles[i].inCart=b.inCart,a.titles[i].inCartHd=b.hd_asset,a.titles[i].inCartSd=b.sd_asset})},a.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/"},a.directorSearch=function(b){return"undefined"!==reporting&&(reporting.setEvents(["event17"]),reporting.sendAttrs(!0)),null===b||void 0===b?!1:(b='"'+b.replace(/"/g,"")+'"',window.location=a.searchCategory.ondemand+b+"/false",void 0)},a.addToCart=function(b,f){var g=f?"Vod_cart_hd":"Vod_cart_sd";d.hasOOLSession?c.addToCart(b,g,function(c){"SUCCESS"===c.status&&a.changeState(b,f,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:g}),reporting.setAttrs({prop10:g}),reporting.sendAttrs(!0)),e.location.href="/login?referer="+window.location.href)},a.addToFavorites=function(b){var f="Vod_cart_hd",g=!0,h=b.hd_asset;b.hd_asset||(f="Vod_cart_sd",g=!1,h=b.sd_asset),d.hasOOLSession?c.addToCart(h,f,function(b){"SUCCESS"===b.status&&a.changeState(h,g,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:f}),reporting.setAttrs({prop10:f}),reporting.sendAttrs(!0)),e.location.href="/login?referer="+window.location.href)},a.removeFromCart=function(b,d){var e=d?"Vod_remove_cart_hd":"Vod_remove_cart_sd";c.removeFromCart(b,e,function(c){"SUCCESS"===c.status&&a.changeState(b,d,!1)})},a.removeFromFavorites=function(b){var d="Vod_remove_cart_hd",e=!0,f=b.hd_asset;b.inCartHd||(d="Vod_remove_cart_sd",e=!1,f=b.sd_asset),c.removeFromCart(f,d,function(b){"SUCCESS"===b.status&&a.changeState(f,e,!1)})},a.changeState=function(b,c,d){if(c===!0&&(void 0!==a.assetDetail&&a.assetDetail.hd_asset===b&&(a.assetDetail.inCartHd=d,a.assetDetail.inCart=d),void 0!==a.titles)){var e=_.find(a.titles,{hd_asset:b});void 0!==e&&(e.inCartHd=d,e.inCart=d)}if(c===!1&&(void 0!==a.assetDetail&&a.assetDetail.sd_asset===b&&(a.assetDetail.inCartSd=d,a.assetDetail.inCart=d),void 0!==a.titles)){var f=_.find(a.titles,{sd_asset:b});void 0!==f&&(f.inCartSd=d,f.inCart=d)}}}]),angular.module("tvProgram",["vod","moreContributors","dvrRecord","if","webdvrResource","config","onetCookies"]).controller("tvProgramCtrl",["$scope","Vod","$routeParams","$rootScope","Support","ooluser","$window","WebDVR","Config","$http","Cookies",function(a,b,c,d,e,f,g,h,j,k,l){function m(){return null===q||""===q||void 0===q?g.location="/tv":(b.getChannelEventDetail(a.lineupId,q,a.hubId,a.withHD,r,w).success(function(b){return a.getLinearProgramDetails(b)}).error(n),void 0)}function n(){a.showErrorMsg=!0,a.error_msg=b.getErrorMsg(500),a.loading=!1}f.laBoxUser=f.hasOOLSession?f.laBoxUser||f.laboxOrMini:"true"===l.getCookie("labox");var o=c.programId,p=c.channel,q=c.callsign,r=c.startTime,s=c.hubId,t=c.eventId,u=c.tribid,v=c.isHd,w=c.endTime,x=c.record,y=j.getValuesBySelector("endpoint.api.wpg")+"image?eventId=",z=j.getValuesBySelector("endpoint.api.wpg")+"upgImage?programId=";a.loading=!0,a.showErrorMsg=!1,a.ooluser=f,a.noDVRs=!0,a.dvrBlocked=!1,a.trackClick="Record_bttm",a.labox=a.ooluser.laBoxUser;var A=j.getValuesBySelector("endpoint.api.vodlogos");h.query(function(b){a.noDVRs=0===b.length?!1:!0,a.dvrBlocked=b.hasDvrBlocked===!0?!0:!1});var B=new Date,C=$(window).width(),D="/vod/api/getImage.jpg?name=";a.showPosterArt=!0,a.showMobilePosterArt=!0,a.showLinearEpisode=!0;var E="SERIES";a.ctrlhaveDVR=!1,a.ctrlisRecorded=!1,a.withHD=!0,a.ooluser.hasOOLSession&&(a.withHD=!1,"record"===x&&("true"!==v?(a.withHD=!1,a.hubId=f.hubId,a.lineupId=f.lineupId):(a.withHD=!0,a.hubId=f.ehubId,a.lineupId=f.elineupId),m()),e.getUserEquipments({},function(b){var c=b._embedded.devices;transforming=_.reduce(c,function(b,c){c.is_hd&&(a.withHD=!0)},{})})),p=void 0===p?null:p,void 0!==t&&null!==t&&""!==t?b.getLinearEventDetail(t,s,v).success(function(b){a.getLinearProgramDetails(b)}).error(n):void 0!==u&&null!==u&&""!==u?b.getDvrVideos(u,r,q).success(function(b){"SUCCESS"===b.status?(a.showLinearEpisode=b.data.linear.show_type===E?!0:void 0!==b.data.linear.episodeInfo.showCardId&&null!==b.data.linear.episodeInfo.showCardId&&""!==b.data.linear.episodeInfo.showCardId?!0:!1,a.getLinearProgramDetails(b)):g.location="/tv"}).error(n):"record"!==x&&b.getLinearProgramDetail("tvProgram",o,s,a.withHD,r,q).success(function(b){a.getLinearProgramDetails(b)}).error(n),a.getLinearProgramDetails=function(c){if(a.loading=!1,"SUCCESS"===c.status){a.linearProgramDetail=angular.extend({},c.data,c.data.linear),void 0!==reporting&&(reporting_pageName="Linear-Episode",reporting.pageLoadAjax(reporting_pageName)),d.vod_header_title="TV",void 0!==a.linearProgramDetail.callsign&&""!==a.linearProgramDetail.callsign&&(a.linearProgramDetail.logo=A+a.linearProgramDetail.callsign+".png"),k.get(a.linearProgramDetail.logo).error(function(){a.linearProgramDetail.logo=""}),d.linear_callsign=a.linearProgramDetail.callsign;var e=a.linearProgramDetail.imageAvailability;void 0!==e&&(void 0!==e.desktopImageVOD&&null!=e.desktopImageVOD&&""!==e.desktopImageVOD?(a.showPosterArt=!0,a.imgURL=D+e.desktopImageVOD,void 0!==e.mobileImageVOD&&null!==e.mobileImageVOD&&""!==e.mobileImageVOD?(a.showMobilePosterArt=!0,a.mobileImgURL=D+e.mobileImageVOD):(a.showMobilePosterArt=!1,a.mobileImgURL="")):void 0!==e.desktopImageWPG&&null!==e.desktopImageWPG&&""!==e.desktopImageWPG?(a.showPosterArt=!0,a.imgURL=y+e.desktopImageWPG,void 0!==e.mobileImageWPG&&null!==e.mobileImageWPG&&""!==e.mobileImageWPG?(a.showMobilePosterArt=!0,a.mobileImgURL=y+e.mobileImageWPG):(a.showMobilePosterArt=!1,a.mobileImgURL="")):void 0!==e.desktopImageUPG&&null!==e.desktopImageUPG&&""!==e.desktopImageUPG?(a.showPosterArt=!0,a.imgURL=z+e.desktopImageUPG,void 0!==e.mobileImageUPG&&null!==e.mobileImageUPG&&""!==e.mobileImageUPG?(a.showMobilePosterArt=!0,a.mobileImgURL=z+e.mobileImageUPG):(a.showMobilePosterArt=!1,a.mobileImgURL="")):(a.showPosterArt=!1,a.showMobilePosterArt=!1,a.imgURL="",a.mobileImgURL="")),a.linearProgramDetail.startTime,a.linearProgramDetail.displayStartTime=b.getestTime(a.linearProgramDetail.startTime),a.linearProgramDetail.displayEndTime=b.getestTime(a.linearProgramDetail.endTime),a.linearProgramDetail.episodeTitle=a.linearProgramDetail.episode_title||a.linearProgramDetail.title,a.linearProgramDetail.cs=a.linearProgramDetail.callsign,a.linearProgramDetail.channel_number=a.linearProgramDetail.num=a.linearProgramDetail.channelNum,a.linearProgramDetail.starttime=a.linearProgramDetail.startTime=a.linearProgramDetail.start_time=new Date(a.linearProgramDetail.startTime),a.linearProgramDetail.endTime=a.linearProgramDetail.end_time=new Date(a.linearProgramDetail.endTime),a.linearProgramDetail.programtype=a.linearProgramDetail.showType,a.linearProgramDetail.isSeasonAvailable=0===a.linearProgramDetail.season_number||""===a.linearProgramDetail.season_number||void 0===a.linearProgramDetail.season_number||null===a.linearProgramDetail.season_number?!1:!0,void 0!==a.linearProgramDetail.endTime&&(a.linearProgramDetail.showButton=a.linearProgramDetail.endTime>B?!0:!1);var h=Math.floor(a.linearProgramDetail.duration/60);a.linearProgramDetail.stream_length_hours=h;var j=Math.floor(a.linearProgramDetail.duration%60);if(a.linearProgramDetail.stream_length_mins=j,null!==a.linearProgramDetail.starRating&&void 0!==a.linearProgramDetail.starRating){var l=a.linearProgramDetail.starRating.split(".");a.linearProgramDetail.starRating=Math.floor(l[0]/1)}null!==a.linearProgramDetail.moreAiringDates&&void 0!==a.linearProgramDetail.moreAiringDates&&(a.airings=_.map(_.uniq(a.linearProgramDetail.moreAiringDates),function(c){var d=c.startTime;c.displayStartTime=b.getestTime(d),c.title=c.episodeTitle=a.linearProgramDetail.episodeTitle,c.channel_number=c.channelNumber,c.cs=c.callsign,c.starttime=c.startTime=c.start_time=new Date(c.startTime),c.duration=c.duration;var e=Math.floor(6e4*c.duration);return c.displayEndTime=b.getestTime(e+d),c.endTime=c.end_time=new Date(e+d),c.num=c.channelNumber,c.programtype=a.linearProgramDetail.showType,null!==c.qualities&&void 0!==c.qualities&&(c.qualifiers=c.qualities.toString()),c.showButton=c.endTime>B?!0:!1,void 0!==c.callsign&&""!==c.callsign&&(c.logo=A+c.callsign+".png"),c.tribuneid=c.tribuneId,k.get(c.logo).error(function(){c.logo=""}),c}));var m;if(m=void 0!==a.linearProgramDetail.tmsSeriesId&&null!==a.linearProgramDetail.tmsSeriesId?a.linearProgramDetail.tmsSeriesId:a.linearProgramDetail.tms_id,m&&null!==a.linearProgramDetail.episodes&&void 0!==a.linearProgramDetail.episodes&&(a.linearProgramDetail.episodes.length>0&&(d.seriesInfoAvailable=!1,a.seriesInfoAvailable=!0),a.moreLinearEpisodes=_.map(_.uniq(a.linearProgramDetail.episodes),function(b){var c=b.qualifiers;b.title=b.episodeTitle||b.title,b._new=-1!==$.inArray("New",c)?!0:!1,b.href="/tvprogram/"+b.eventId+"/"+b.callsign;var d=Math.floor(6e4*b.duration);b.network=b.callsign,b.epStartTime=new Date(moment(b.startTime));var g=b.epStartTime.getTime();return b.epEndTime=new Date(d+g),b.epSeasonNumber=b.seasonNumber?b.seasonNumber:void 0,b.epEepisodeNumber=b.episodeNumber?b.episodeNumber:void 0,void 0!==e.moreEpisodes&&null!==e.moreEpisodes&&""!==e.moreEpisodes?(b.artwork=y+e.moreEpisodes,a.labox&&(b.artwork=z+e.moreEpisodes)):b.artwork=D+"seriesTmsId:"+m+"&size=280x210",b.program={episodeTitle:b.title,title:b.title,cs:b.callsign,starttime:new Date(b.epStartTime),StartTime:new Date(b.epStartTime),start_time:new Date(b.epStartTime),end_time:new Date(b.epEndTime),endTime:new Date(b.epEndTime),num:b.channel_number,itemRecorde:!1,tribuneId:b.tribuneId,trackClick:trackClick},f.hasOOLSession&&(b.recbutton=!0),b})),a.linearProgramDetail.offer_end_date=!1,a.linearProgramDetail.vodIds.length>0&&(a.titles=a.linearProgramDetail.vodIdTitles.titles,void 0!==a.titles))for(i=0;i<a.titles.length;i++)assetId=a.titles[i].hd_asset||a.titles[i].sd_asset,a.getCartDetails(assetId);var n=a.linearProgramDetail.qualities;a.ooluser.hasOOLSession&&(a.linearProgramDetail.isHDEpisode=-1!==$.inArray("HDTV",n)?!0:!1),a.linearProgramDetail.isHD=-1!==$.inArray("HDTV",n)?!0:!1,a.linearProgramDetail.cc=-1!==$.inArray("CC",n)?!0:!1,a.linearProgramDetail.stereo=-1!==$.inArray("Stereo",n)?!0:!1,a.linearProgramDetail.dd=-1!==$.inArray("DD 5.1",n)?!0:!1,a.linearProgramDetail._new=-1!==$.inArray("New",n)?!0:!1,a.linearProgramDetail.bn=-1!==$.inArray("BN",n)?!0:!1,a.linearProgramDetail.at=-1!==$.inArray("AT",n)?!0:!1,a.linearProgramDetail.sap=-1!==$.inArray("SAP",n)?!0:!1,a.linearProgramDetail.rerun=-1!==$.inArray("Rerun",n)?!0:!1,a.badgesWrap=a.linearProgramDetail.stereo===!1&&a.linearProgramDetail.bn===!1&&a.linearProgramDetail.at===!1&&a.linearProgramDetail.dd===!1&&a.linearProgramDetail.sap===!1?!1:!0,void 0!==a.linearProgramDetail.genres&&null!==a.linearProgramDetail.genres&&(a.linearProgramDetail.genreList=a.linearProgramDetail.genres.split("|").join(", ")),a.actors=a.linearProgramDetail.actors,a.directors=a.linearProgramDetail.directors,a.showLinearEpisode||(a.linearMovieDetail=a.linearProgramDetail)}else g.location="/tv"},a.onDemandDetails=function(){C>767?($("html, body").animate({scrollTop:$("#showonDemandData").offset().top-150},1e3),angular.element(".primary-episode-info").scope().onDemandAvailable=!0):($("html, body").animate({scrollTop:$("#showOnDemandMobile").offset().top-150},1e3),angular.element(".primary-episode-info").scope().onDemandAvailable=!0)},a.getCartDetails=function(c){b.VodMovieCart.contains(c,function(b){a.titles[i].inCart=b.inCart,a.titles[i].inCartHd=b.hd_asset,a.titles[i].inCartSd=b.sd_asset})},a.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/"},a.directorSearch=function(b){return"undefined"!==reporting&&reporting.setEvents(["event17"]),null===b||void 0===b?!1:(b='"'+b.replace(/"/g,"")+'"',window.location=a.searchCategory.ondemand+b+"/false",void 0)},a.goToLogin=function(){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:"Record"}),reporting.setAttrs({prop10:"Record"}),reporting.sendAttrs(!0)),g.location.href="/login?referer="+window.location.href}}]),angular.module("vodSeries",["config","vod","spinner","webdvrResource","onetCookies"]).controller("vodSeriesCtrl",["$scope","ooluser","movieCart","OnDemand","$notice","$routeParams","$rootScope","Vod","$http","$location","$window","Support","WebDVR","Config","Cookies",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){_ASSET_CLASSIFICATION_LINEAR="EPG",_ASSET_CLASSIFICATION_VOD="On Demand",_EVENT_DETAILS_PREFIX_LINEAR="/program/",_EVENT_DETAIL_LINEAR_ASSET_PREFIX="/tvprogram/",_EVENT_DETAILS_PREFIX_ONDEMAND="/episode/",_SERIES_PREFIX="^SH",_SERIES_SPORTS_PREFIX="^SP",_EXTRA_DELIMITER="&",a.episodes=[],a.seriesLoading=!0,a.classification={classificationvalue:""},a.windowHref=window.location.href,b.laBoxUser=b.hasOOLSession?b.laBoxUser||b.laboxOrMini:"true"===o.getCookie("labox"),a.ooluser=b,a.accountHasDvr=!1,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1),a.noDVRs=!0;var p=n.getValuesBySelector("endpoint.api.vodlogos"),q=$(window).width();m.query(function(b){a.noDVRs=0===b.length?!1:!0}),a.whereToWatchItems={},a.limitAirings=5,a.showPosterArt=!0,a.showErrorMsg=!1,a.isBreadcrumbs=!1,a.noSeasonEpisodeLinear=!1,a.noSeasonEpisodeOnDemand=!1;var r="Record_bttm",s="",t="",u=!1,v="/vod/api/getImage.jpg?name=";void 0!==f.callsign&&(t=f.callsign),f.menuId.match(_SERIES_PREFIX)||f.menuId.match(_SERIES_SPORTS_PREFIX)?(u=!0,s=h.getSeriesDetailsBySeriestmsidNew(f.menuId,t)):(a.menu_id=f.menuId,s=h.getSeriesDetailsNew(a.menu_id,t));var w={textAnchorsOptions:{},preSelected:null,mainTilte:null},x=[{title:"On Demand"},{title:"On TV"},{title:"Show all"}];a.model=w;for(var y=0;y<x.length;y++)w.preSelected=x[2].title,w.textAnchorsOptions[x[y].title]=x[y].title;u?(g.vod_header_title="TV",w.preSelected=x[2].title):(g.vod_header_title="On Demand",w.preSelected=x[0].title),a.$watch("model.preSelected",function(b){a.classification.classificationvalue="On TV"===b?_ASSET_CLASSIFICATION_LINEAR:"On Demand"===b?_ASSET_CLASSIFICATION_VOD:""}),a.withHD=!1,a.ooluser.hasOOLSession?(a.hubId=b.hubId,l.getUserEquipments({},function(c){var d=c._embedded.devices;transforming=_.reduce(d,function(c,d){d.is_hd&&(a.withHD=!0,a.hubId=b.ehubId)},{})})):h.getLineUp().success(function(b){a.hubId=b.hubId,a.withHD=b.isHD}).error(function(){a.hubId=105,a.withHD=!0}),s.success(function(b){if("SUCCESS"===b.status){if(void 0!==reporting&&(reporting_pageName="On-Demand-Series",reporting.pageLoadAjax(reporting_pageName)),a.seriesLoading=!1,a.seriesDetails=b.data.result,a.linearEpisodes=b.linearEpisodeList,a.vodEpisodes=b.episodeList,a.getWhereToWatchItems(b),void 0!==a.seriesDetails.imageAvailability.desktopImage&&""!==a.seriesDetails.imageAvailability.desktopImage?(a.showPosterArt=!0,a.imgURL=v+a.seriesDetails.imageAvailability.desktopImage,a.mobileImgURL=void 0!==a.seriesDetails.imageAvailability.mobileImage&&""!==a.seriesDetails.imageAvailability.mobileImage?v+a.seriesDetails.imageAvailability.mobileImage:v+a.seriesDetails.imageAvailability.desktopImage):(a.showPosterArt=!1,a.imgURL="",a.mobileImgURL=""),""!==a.seriesDetails.csslogo&&(a.seriesDetails.logo=p+a.seriesDetails.csslogo.slice(5)+".png"),i.get(a.seriesDetails.logo).error(function(){a.seriesDetails.logo=""}),void 0!==b.episodeList){a.episodeDetail=b.episodeList.result;var c=a.episodeDetail.path;void 0!==c&&(a.isBreadcrumbs=!0,a.breadcrumbs=c);var d=a.episodeDetail.titles[0],e=a.episodeDetail.titles[1];(null===a.seriesDetails.title||void 0===a.seriesDetails.title)&&(void 0!==d&&null!==d.tms_id&&void 0!==d.tms_id?null!==d.tms_title&&void 0!==d.tms_title&&null!==d.tms_id.match("^EP")&&(a.seriesDetails.title=d.tms_title):void 0!==e&&null!==e.tms_id&&void 0!==e.tms_id&&null!==e.tms_title&&void 0!==e.tms_title&&null!==e.tms_id.match("^EP")&&(a.seriesDetails.title=e.tms_title)),(null===a.seriesDetails.actors||void 0===a.seriesDetails.actors)&&(void 0!==d&&null!==d.tms_id&&void 0!==d.tms_id?null===d.tms_id.match("^MV")&&(a.seriesDetails.actors=d.actors):void 0!==e&&null!==e.tms_id&&void 0!==e.tms_id&&null===e.tms_id.match("^MV")&&(a.seriesDetails.actors=e.actors)),(null===a.seriesDetails.genres||void 0===a.seriesDetails.genres||"N/A"===a.seriesDetails.genres)&&(void 0!==d&&null!==d.genres&&void 0!==d.genres&&""!==d.genres&&null!==d.tms_id&&void 0!==d.tms_id&&null===d.tms_id.match("^MV")&&"N/A"!==d.genres&&(a.seriesDetails.genres=d.genres.split("|").join(",")),void 0!==e&&null!==e.genres&&void 0!==e.genres&&""!==e.genres&&null!==e.tms_id&&void 0!==e.tms_id&&null===e.tms_id.match("^MV")&&"N/A"!==e.genres&&(a.seriesDetails.genres=e.genres.split("|").join(",")))}void 0!==b.linearEpisodeList&&0!==b.linearEpisodeList.result.linear_data.length&&((null===a.seriesDetails.title||void 0===a.seriesDetails.title)&&(a.seriesDetails.title=b.linearEpisodeList.result.linear_data[0].title),(void 0===a.seriesDetails.genres||""===a.seriesDetails.genres||null===a.seriesDetails.genres||"N/A"===a.seriesDetails.genres)&&(a.seriesDetails.genres=b.linearEpisodeList.result.linear_data[0].genres),(void 0===a.seriesDetails.directors||""===a.seriesDetails.directors||null===a.seriesDetails.directors)&&void 0!==b.linearEpisodeList.result.linear_data[0].directors&&(a.seriesDetails.directors=b.linearEpisodeList.result.linear_data[0].directors),(void 0===a.seriesDetails.actors||""===a.seriesDetails.actors||null===a.seriesDetails.actors)&&void 0!==b.linearEpisodeList.result.linear_data[0].actors&&(a.seriesDetails.actors=b.linearEpisodeList.result.linear_data[0].actors)),void 0!==a.seriesDetails.actors&&""!==a.seriesDetails.actors&&null!==a.seriesDetails.actors&&(a.seriesDetails.actors=a.seriesDetails.actors.split(",").slice(0,5)),void 0!==a.seriesDetails.genres&&""!==a.seriesDetails.genres&&null!==a.seriesDetails.genres&&(a.seriesDetails.genres=a.seriesDetails.genres.split(",")),void 0!==a.seriesDetails.qualifiers&&""!==a.seriesDetails.qualifiers&&null!==a.seriesDetails.qualifiers&&(a.seriesDetails.qualifiers=a.seriesDetails.qualifiers.split(",")),void 0!==a.seriesDetails.directors&&""!==a.seriesDetails.directors&&null!==a.seriesDetails.directors&&(a.seriesDetails.directors=a.seriesDetails.directors.split(",").slice(0,5))}else k.location.href="/tv/on-demand/#/summary/"+f.menuId,a.seriesLoading=!1}).error(function(){a.showErrorMsg=!0,a.error_msg=h.getErrorMsg(500),a.seriesLoading=!1}),a.getWhereToWatchItems=function(b){var c={},d={},e={};void 0!==b.linearEpisodeList&&(e=_.filter(b.linearEpisodeList.result.linear_data,function(a){return void 0!==a.season_number&&void 0!==a.episode_number&&null!==a.season_number&&null!==a.episode_number&&0!==a.season_number&&0!==a.episode_number?!0:void 0})),0===e.length&&void 0!==b.linearEpisodeList&&(a.nullLinearEpisodes=b.linearEpisodeList.result.linear_data,_.map(a.nullLinearEpisodes,function(b){b.classification=_ASSET_CLASSIFICATION_LINEAR,h.getTvShowings(b.tms_id).success(function(c){if("SUCCESS"===c.status){var d=new Date;b.airings=_.map(c.data.result.tvshow_data,function(b){b.title=b.episodeTitle=b.title,b.channel_number=b.num=b.channel_number,b.cs=b.callsign,b.starttime=b.startTime=b.start_time=new Date(h.getTime(b.from_date)),b.endTime=b.end_time=new Date(h.getTime(b.to_date));var c=b.qualifiers.split(",");return a.ooluser.hasOOLSession&&(b.isHDEpisode=-1!==$.inArray("HDTV",c)?!0:!1),b.showButton=b.endTime>d?!0:!1,""!==b.csslogo&&(b.logo=p+b.csslogo.slice(5)+".png"),i.get(b.logo).error(function(){b.logo=""}),b}),b.airings.length>0&&(b.airingStartTime=b.airings[0].starttime)}})})),0!==e.length&&void 0!==b.linearEpisodeList&&(c=_.filter(b.linearEpisodeList.result.linear_data,function(a){return a.classification=_ASSET_CLASSIFICATION_LINEAR,a})),void 0!==b.episodeList&&(d=_.sortBy(_.filter(b.episodeList.result.titles,function(a){return a.classification=_ASSET_CLASSIFICATION_VOD,""!==a.csslogo&&(a.logo=p+a.csslogo.slice(5)+".png"),i.get(a.logo).error(function(){a.logo=""}),void 0!==a.hd_asset||void 0!==a.sd_asset?a:void 0}),"hd_asset")),0===e.length&&c.length>0&&d.length>0?a.whereToWatchItems=d:c.length>0&&d.length>0?a.whereToWatchItems=d.concat(c):c.length>0?a.whereToWatchItems=c:d.length>0&&(a.whereToWatchItems=d),a.emptyondemandList=!1,a.emptylinearList=!1,null!==c.length&&void 0!==c.length||null!==a.nullLinearEpisodes&&void 0!==a.nullLinearEpisodes||(a.emptylinearList=!0),(null===d.length||void 0===d.length)&&(a.emptyondemandList=!0),a.groupsnotNull=_.groupBy(_.filter(_.sortBy(a.whereToWatchItems,"season_number"),function(a){return void 0!==a.season_number&&void 0!==a.episode_number&&null!==a.season_number&&null!==a.episode_number&&0!==a.season_number&&0!==a.episode_number?!0:void 0}),function(a){return a.season_number}),a.groupsNull=_.filter(a.whereToWatchItems,function(a){return void 0===a.season_number&&void 0===a.episode_number||null===a.season_number&&null===a.episode_number||0===a.season_number&&0===a.episode_number?a:void 0}),$.each(_.sortBy(a.groupsnotNull,"season_number").reverse(),function(b,c){var d=_.groupBy(c,"episode_number"),e=[];$.each(d,function(a,b){e.push({eno:b[0].episode_number,item:b})});var f=_.sortBy(e,function(a){return-1*a.eno});$.each(f,function(b,c){var d={};d[c.eno]=c.item,a.episodes.push(d)})}),a.sortedDetails={episodes:a.episodes},a.nullEpisodes=[];var f=1,g=_.filter(a.groupsNull,function(a){return void 0!==a.tms_id?!0:void 0}),j=_.filter(a.groupsNull,function(a){return void 0===a.tms_id||null===a.tms_id?!0:void 0});$.each(_.groupBy(g,"tms_id"),function(b,c){var d={};c.href_id="emptyEpisodes"+f,f+=1,d[b]=c,a.nullEpisodes.push(d)}),$.each(_.groupBy(j,"title"),function(b,c){var d={};c.href_id="emptyEpisodes"+f,f+=1,d[b]=c,a.nullEpisodes.push(d)}),a.seasonCombo=_.uniq(_.map(_.sortBy(a.whereToWatchItems,"season_number"),function(a){return a.season_number
})),null!==a.vodEpisodes&&void 0!==a.vodEpisodes&&(a.seasonComboVod=_.uniq(_.map(_.sortBy(a.vodEpisodes.result.titles,"season_number"),function(a){return a.season_number}))),null!==a.linearEpisodes&&void 0!==a.linearEpisodes&&(a.seasonComboLinear=_.uniq(_.map(_.sortBy(a.linearEpisodes.result.linear_data,"season_number"),function(a){return a.season_number})));var k={totalSeasons:{},currentSeason:null,mainTilte:null};k.totalSeasons[0]="Show all";for(var l=0;l<a.seasonCombo.length;l++)0!==a.seasonCombo[l]&&void 0!==a.seasonCombo[l]&&(k.totalSeasons[a.seasonCombo[l]]=a.seasonCombo[l]);a.sortedSeason=k,setTimeout(function(){$(".option-dropdown").bind("click",function(){if(!angular.element(".season-dropdown").find(".dropdown__shelf").hasClass("scroll-pane")){angular.element(".season-dropdown").find(".dropdown__shelf").addClass("scroll-pane");var a=angular.element(".season-dropdown").find(".scroll-pane");x.mouseScroll=!0,new JScrollPaneVertical(a,x)}})},50)},a.getMoreEpisodes=function(a,b){var c=$(b.target),d=$(b.target).parents(".accordion-heading"),e=c.parents(".accordion-group").prevAll(".accordion-group").find(".accordion-heading:visible").length*d.outerHeight(!0)+$(".series-header").outerHeight(!0);q>767?$("html, body").animate({scrollTop:e+200},1e3):$("html, body").animate({scrollTop:e+300},1e3),$(b.target).parents(".accordion-heading").find(".icon-sort-down").length>=1?$(b.target).parents(".accordion-heading").find(".icon-sort-down").removeClass("icon-sort-down").addClass("icon-sort-up"):$(b.target).parents(".accordion-heading").find(".icon-sort-up").removeClass("icon-sort-up").addClass("icon-sort-down"),$(b.target).parents(".accordion-group").siblings().find(".accordion-heading").removeClass("accordion-expand"),$(b.target).parents(".accordion-group").siblings().find(".accordion-heading").find(".icon-sort-up").removeClass("icon-sort-up").addClass("icon-sort-down"),$(b.target).parents(".accordion-heading").hasClass("accordion-expand")?$(b.target).parents(".accordion-heading").removeClass("accordion-expand"):$(b.target).parents(".accordion-heading").addClass("accordion-expand")},a.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/"},a.actorSearch=function(b){return null===b||void 0===b?!1:(b='"'+b.replace(/"/g,"")+'"',window.location=a.searchCategory.ondemand+b+"/false",void 0)},a.getAssetHref=function(b){var c={};c=a.classification.classificationvalue===_ASSET_CLASSIFICATION_LINEAR?_.filter(b,{classification:_ASSET_CLASSIFICATION_LINEAR})[0]:a.classification.classificationvalue===_ASSET_CLASSIFICATION_VOD?_.filter(b,{classification:_ASSET_CLASSIFICATION_VOD})[0]:b[0],c.classification===_ASSET_CLASSIFICATION_VOD?(id=c.hd_asset||c.sd_asset,j.path(_EVENT_DETAILS_PREFIX_ONDEMAND+id)):c.classification===_ASSET_CLASSIFICATION_LINEAR&&(u?j.path(_EVENT_DETAIL_LINEAR_ASSET_PREFIX+c.event_id+"/"+a.hubId+"/"+a.withHD):j.path(_EVENT_DETAIL_LINEAR_ASSET_PREFIX+c.event_id+"/"+a.hubId+"/"+a.withHD))},a.getlinearAssetHref=function(b){u?j.path(_EVENT_DETAIL_LINEAR_ASSET_PREFIX+b.event_id+"/"+a.hubId+"/"+a.withHD):j.path(_EVENT_DETAIL_LINEAR_ASSET_PREFIX+b.event_id+"/"+a.hubId+"/"+a.withHD)},a.removeFromCart=function(b,c,d){var e=d?"On-Demand-Series | Vod_remove_cart_hd_bttm":"On-Demand-Series | Vod_remove_cart_sd_bttm";h.removeFromCart(c,e,function(c){"SUCCESS"===c.status&&a.changeState(b,d,!1)})},a.removeFromFavorites=function(b){var c="On-Demand-Series | Vod_remove_cart_hd_bttm",d=!0,e=b.hd_asset;b.inCartHd||(c="On-Demand-Series | Vod_remove_cart_sd_bttm",d=!1,e=b.sd_asset),h.removeFromCart(e,c,function(c){"SUCCESS"===c.status&&a.changeState(b,d,!1)})},a.addToCart=function(c,d,e){var f=e?"Vod_cart_hd_bttm":"Vod_cart_sd_bttm";b.hasOOLSession?h.addToCart(d,f,function(b){"SUCCESS"===b.status&&a.changeState(c,e,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:f}),reporting.setAttrs({prop10:f}),reporting.sendAttrs(!0)),k.location.href="/login?referer="+window.location.href)},a.addToFavorites=function(c){var d="Vod_cart_hd_bttm",e=!0,f=c.hd_asset;c.hd_asset||(d="Vod_cart_sd_bttm",e=!1,f=c.sd_asset),b.hasOOLSession?h.addToCart(f,d,function(b){"SUCCESS"===b.status&&a.changeState(c,e,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:d}),reporting.setAttrs({prop10:d}),reporting.sendAttrs(!0)),k.location.href="/login?referer="+window.location.href)},a.changeState=function(a,b,c){b===!0&&(a.inCartHd=c),b===!1&&(a.inCartSd=c),a.inCart=a.inCartHd||a.inCartSd?!0:!1},a.goToLogin=function(){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:r}),reporting.setAttrs({prop10:r}),reporting.sendAttrs(!0)),k.location.href="/login?referer="+window.location.href},a.$watch("sortedSeason.currentSeason",function(b){var c=0,d=0;if("0"===b&&null===b&&void 0===b)a.noSeasonEpisodeOnDemand=!1,a.noSeasonEpisodeLinear=!1;else if("0"!==b&&null!==b){for(var e in a.seasonComboVod)if(a.seasonComboVod[e].toString()===b){c+=1;break}a.noSeasonEpisodeOnDemand=0===c?!0:!1;for(var f in a.seasonComboLinear)if(a.seasonComboLinear[f].toString()===b){d+=1;break}a.noSeasonEpisodeLinear=0===d?!0:!1}else a.noSeasonEpisodeOnDemand=!1,a.noSeasonEpisodeLinear=!1}),a.filterSeason=function(b){return"0"===a.sortedSeason.currentSeason?!0:void 0===b.season_number||null===b.season_number?!1:"0"===b.season_number.toString()?!1:b.season_number.toString()===a.sortedSeason.currentSeason?!0:void 0}}]).directive("accordianSelect",["$compile",function(){return{restrict:"A",link:function(a,b){b.click(function(){b.hasClass("active-accordion-toggle")?b.removeClass("active-accordion-toggle"):($("div.accordion-heading a").removeClass("active-accordion-toggle"),b.addClass("active-accordion-toggle"))})}}}]).filter("getEndDate",function(){return function(a){return null!==a&&void 0!==a?new Date(a.startTime).getTime()+6e4*a.duration:" "}}),angular.module("vodSummary",["vod","pagination","if","ellipsis","spinner","isViewportSize","onetCookies"]).controller("vodSummaryCtrl",["$scope","$routeParams","Vod","ooluser","$location","$window","$rootScope","Cookies",function(a,b,c,d,e,f,g,h){function i(b,d,e,f){c.getSummaryList(b,d,e,a.model.preSelected,a.filter_preSelected).success(function(b){a.loder=!1,a.mobile_loader=!1,"SUCCESS"===b.status?(void 0!==reporting&&(reporting_pageName="VOD_categories",reporting.pageLoadAjax(reporting_pageName)),a.startCount=e,0===a.startCount&&(a.startCount=1),a.isMusic=b.data.result.isMusicPage,a.isMusic===!0&&(a.showgriddata=!1,g.isMusicPage=!0),a.endCount=b.data.result.next,("0"===a.endCount||void 0===a.endCount||null===a.endCount)&&(a.endCount=b.data.result.total),a.startCount=Math.floor(parseInt(e,10)+1),a.next=b.data.result.next,a.titles=b.data.result.titles,a.titlesMobile=void 0===a.titlesMobile?b.data.result.titles:$.isEmptyObject(a.titlesMobile)?b.data.result.titles:a.titlesMobile.concat(b.data.result.titles),a.noData=void 0!==a.titles&&a.titles.length>0?!1:!0,a.moviesCount=a.pagination.titleCount=b.data.result.total,void 0!==b.data.result.path&&(a.breadcrumbs=b.data.result.path),_.map(b.data.result.titles,function(b){var d=c.getrating(b.rating);b.tprating=d.content_rating,b.tpstarRating=d.critics_rating;var e=c.getindicators(b.indicators);if(b.cc=e._cc,null===b.stream_length||void 0===b.stream_length)b.show_duration=!1;else{b.show_duration=!0;var f=Math.floor(b.stream_length/60);b.stream_length_hours=f;var g=Math.floor(b.stream_length%60);b.stream_length_mins=g}void 0!==b.rental_period&&""!==b.rental_period&&null!==b.rental_period&&(b.rental_period=Math.floor(b.rental_period/3600)),b.showPosterArt=!1,b.showloader=!0,a.getCartDetails(b)}),setTimeout(function(){j()},200),a.scroll=!0):(a.titles={},a.menuCaption=g.selectedMenuItem,f&&(a.breadcrumbs[3]=f),a.noData=!0,a.moviesCount=0)})}function j(){$(".info-block, .genre-list").swipe({tap:function(a){return 3===a.which&&2===a.button||$(a.target).is("button")?void 0:(k(v),$(a.target).hasClass("info-block")?1025>u?void 0!==$(a.target).attr("assetid")&&(window.location.href="/tv/asset/#/movie/"+$(a.target).attr("assetid")):void 0!==$(a.target).attr("assetid")&&(window.location.href=r+$(a.target).attr("assetid")):1025>u?void 0!==$(a.target).parents(".info-block").attr("assetid")&&(window.location.href="/tv/asset/#/movie/"+$(a.target).parents(".info-block").attr("assetid")):void 0!==$(a.target).parents(".info-block").attr("assetid")&&(window.location.href=r+$(a.target).parents(".info-block").attr("assetid")),void 0)}}),angular.element(".table-view").find(".genre-list-items").each(function(){$(this).swipe({tap:function(b){$(this).unbind("click"),3===b.which&&2===b.button||$(b.target).is("button")||a.getTitleDetail(b,$.parseJSON($(this).attr("item")))}})}),angular.element(".collapse-table").each(function(){$(this).swipe({tap:function(b){$(this).unbind("click"),3===b.which&&2===b.button||$(b.target).is("button")||a.closePanel(b)}})})}function k(a){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:a}),reporting.setAttrs({prop10:a}),reporting.sendAttrs(!0))}function l(){"0"!==a.next&&void 0!==a.next&&(a.mobile_loader=!0,i(n,20,a.next))}function m(){$(window).scrollTop()+$(window).height()>$(document).height()-($(".common-footer-help").outerHeight()+$(".common-footer-links").outerHeight()+150)&&a.scroll===!0&&a.isViewportSize.phone===!0&&(a.scroll=!1,l())}var n=b.menuId;a.showgriddata=!0,g.summary_layout=!0,g.isMusicPage=!1;var o=20,p=50,q=100,r="/tv/asset/#/movie/",s="/vod/api/getImage.jpg?name=",t="Movies A-Z";a.sortSheetDetails=!1,d.laBoxUser=d.hasOOLSession?d.laBoxUser||d.laboxOrMini:"true"===h.getCookie("labox"),a.ooluser=d,a.accountHasDvr=!1,a.ooluser.hasOOLSession&&(a.accountHasDvr=a.ooluser.p?a.ooluser.p.dvr&&1===a.ooluser.p.dvr?!0:!1:!1),a.scroll=!1,a.mobile_loader=!1,a.isViewportSize=isViewportSize,a.dispalyMblTblInfo=!1,a.mblTableInfo={},a.isMusic=!1;var u=$(window).width(),v="Vod_more_info";a.pagination={currentPage:0,rpr:o,displayCount:"0",rprOptions:[{value:o,label:"20 per page"},{value:p,label:"50 per page"},{value:q,label:"100 per page"}]},a.filters={_no_filter:0,_hd:1,_free:2,_just_added:3,_last_chance:4},a.filter_preSelected=a.filters._no_filter;var w={preSelected:"1",preMobileSelected:"1",sort:[{value:"1",label:"Alphabetical"},{value:"2",label:"Release year"},{value:"3",label:"Popularity"}]};a.model=w,a.sorted_title="1"===a.model.preSelected?"Alphabetically":a.model.sort[a.model.preSelected-1].label,void 0!==b.type&&b.type===t?(a.loder=!0,c.getVodMenuParentMenuId(n).success(function(b){"SUCCESS"===b.status?(a.movieSubcategory=_.map(b.data.result.menu,function(b){return b.dispayCaption=a.getMappedCaption(b.caption),b}),n=a.movieSubcategory[0].menu_id,setTimeout(function(){$($(".sortingAlphabatical").find("li")[0]).addClass("active"),$($(".mobile-sub-cat").find("li")[0]).addClass("active")},200),void 0!==a.movieSubcategory&&i(n,a.pagination.rpr,0)):(a.loder=!1,a.noData=!0)})):(a.loder=!0,i(n,a.pagination.rpr,0)),a.changePage=function(b){a.loder=!0,$(window).scrollTop(0),a.pageNumber=b.pageNum;var c=a.pagination.rpr*a.pageNumber;i(n,a.pagination.rpr,c)},a.$watch("pagination.rpr",function(b,c){c!==b&&($(window).scrollTop(0),a.loder=!0,a.pagination.currentPage=0,a.pageNumber=0,i(n,a.pagination.rpr,0))}),a.getCartDetails=function(a){var b=a.hd_asset||a.sd_asset;c.VodMovieCart.contains(b,function(b){a.inCart=b.inCart,a.inCartHd=b.hd_asset,a.inCartSd=b.sd_asset})},a.removeFromCart=function(b,d,e){var f=e?"Vod_remove_cart_hd":"Vod_remove_cart_sd";c.removeFromCart(d,f,function(c){"SUCCESS"===c.status&&a.changeState(b,e,!1)})},a.removeFromFavorites=function(b){var d="Vod_remove_cart_hd",e=!0,f=b.hd_asset;b.inCartHd||(d="Vod_remove_cart_sd",e=!1,f=b.sd_asset),c.removeFromCart(f,d,function(c){"SUCCESS"===c.status&&a.changeState(b,e,!1)})},a.addToCart=function(b,e,g){var h=g?"Vod_cart_hd":"Vod_cart_sd";d.hasOOLSession?c.addToCart(e,h,function(c){"SUCCESS"===c.status&&a.changeState(b,g,!0)}):(k(h),f.location.href="/login?referer="+window.location.href)},a.addToFavorites=function(b){var e="Vod_cart_hd",g=!0,h=b.hd_asset;b.hd_asset||(e="Vod_cart_sd",g=!1,h=b.sd_asset),d.hasOOLSession?c.addToCart(h,e,function(c){"SUCCESS"===c.status&&a.changeState(b,g,!0)}):(k(e),f.location.href="/login?referer="+window.location.href)},a.signinRedirect=function(){f.location.href="/login?referer="+window.location.href},a.changeState=function(a,b,c){b===!0&&(a.inCartHd=c),b===!1&&(a.inCartSd=c),a.inCart=a.inCartHd||a.inCartSd?!0:!1},a.getAssetHref=function(a,b){$(b.target).is("button")||void 0!==a&&(window.location.href=r+a)},a.getMoreInfo=function(a){k(v),void 0!==a&&(window.location.href=r+a)},a.getTitleDetail=function(b,c){var d=_.filter(a.titles,{title_id:c.title_id});if(g.isMusicPage===!0){if(void 0===d[0].imgeCheck){d[0].showloader=!0;var e=new Image;e.src=s+c.image_name+"&size=200x150",e.onload=function(){d[0].imgeCheck=!0,d[0].showPosterArt=!0,d[0].showloader=!1,a.$apply()},e.onerror=function(){d[0].imgeCheck=!0,d[0].showPosterArt=!1,d[0].showloader=!1,a.$apply()}}}else if(void 0===d[0].imgeCheck){d[0].showloader=!0;var f=new Image;f.src=s+c.image_name+"&size=140x210&alt_size=240x360",d[0].showPosterArt=!1,f.onload=function(){d[0].imgeCheck=!0,d[0].showPosterArt=!0,d[0].showloader=!1,a.$apply()},f.onerror=function(){d[0].imgeCheck=!0,d[0].showPosterArt=!1,d[0].showloader=!1,a.$apply()}}var h=$(b.target);$(b.target).is(".genre-list-items")||(h=$(b.target).parents(".genre-list-items")),h.next(".panel-popup").is(":visible")?(h.find(".name").removeClass("active"),$(".genre-list-items").find(".title").addClass("active"),h.next(".panel-popup").slideUp("slow",function(){h.removeClass("remove-border")})):(h.addClass("remove-border"),$(".genre-list-items").find(".title").removeClass("active active-row"),h.find(".name").addClass("active"),$(".genre-list-items").not("#"+h.attr("id")).find(".name.active").removeClass("active"),h.next(".panel-popup").slideDown("slow")),$(".genre-list-items").not("#"+h.attr("id")).next(".panel-popup").slideUp("slow"),$(".genre-list-items").not("#"+h.attr("id")).removeClass("remove-border")},a.changeLayout=function(b){a.showgriddata=b,setTimeout(function(){j()},200)},a.closePanel=function(a){$(a.target).parents(".panel-popup").slideUp("slow",function(){$(".genre-list-items").find(".name.active").removeClass("active"),$(".genre-list-items").find(".title").addClass("active"),$(a.target).parents(".panel-popup").prev(".genre-list-items").removeClass("remove-border")})},a.$watch("showgriddata",function(a,b){a!==b&&(g.summary_layout=a)}),g.$watch("summary_layout",function(b,c){b!==c&&(a.showgriddata=b)}),a.setArrow=function(a){var b=$(a.target);b.parents(".accordion-heading").find(".icon-sort-down").length>=1?b.parents(".accordion-heading").find(".icon-sort-down").removeClass("icon-sort-down").addClass("icon-sort-up"):b.parents(".accordion-heading").find(".icon-sort-up").removeClass("icon-sort-up").addClass("icon-sort-down"),b.parents(".accordion-group").siblings().find(".accordion-heading").removeClass("accordion-expand"),b.parents(".accordion-group").siblings().find(".accordion-heading").find(".icon-sort-up").removeClass("icon-sort-up").addClass("icon-sort-down"),b.parents(".accordion-heading").hasClass("accordion-expand")?b.parents(".accordion-heading").removeClass("accordion-expand"):b.parents(".accordion-heading").addClass("accordion-expand")},a.getFilteredData=function(b){a.loder=!0,a.titlesMobile={},a.filter_preSelected=b,a.filtered_title=a.getMappedfilters(b);var c=void 0===a.pageNumber?0:a.pagination.rpr*a.pageNumber;i(n,a.pagination.rpr,c)},a.applysortFilter=function(b){a.loder=!0,a.no_filter_sort=!1,a.filter_preSelected=b,a.titlesMobile={},a.filtered_title=a.getMappedfilters(b),a.model.preSelected=a.model.preMobileSelected,a.sorted_title="1"===a.model.preMobileSelected?"Alphabetically":a.model.sort[a.model.preSelected-1].label,a.sortSheetDetails=!1,i(n,a.pagination.rpr,0)},a.sortData=function(){a.sortSheetDetails=!0,a.init_filter=!0,a.prevSort=a.model.preMobileSelected,a.prevFilter=a.filter_preSelected},a.getFilterValue=function(b){a.filter_preSelected=b,a.init_filter=a.prevFilter===b?!0:!1},a.$watch("model.preMobileSelected",function(b,c){b!==c&&(a.init_filter=a.prevSort===b?!0:!1)}),a.$watch("model.preSelected",function(b,c){if(b!==c){a.loder=!0,a.titlesMobile={},a.model.preMobileSelected=a.model.preSelected,a.sorted_title="1"===a.model.preSelected?"Alphabetically":a.model.sort[a.model.preSelected-1].label;var d=void 0===a.pageNumber?0:a.pagination.rpr*a.pageNumber;i(n,a.pagination.rpr,d)}}),a.subcategoryDetail=function(b,c,d){a.loder=!0,a.titlesMobile={},n=b.menu_id,g.selectedMenuItem=b.caption;var e=$(c.target);$(c.target).is(".li")||(e=$(c.target).parent("li")),$(".sub_cat_"+d).addClass("active"),$(".sub_cat_"+d).siblings().removeClass("active"),a.pagination.currentPage=0,a.pageNumber=0,i(n,a.pagination.rpr,0,b)},a.closeFilter=function(){a.sortSheetDetails=!1,a.filter_preSelected=a.prevFilter,a.model.preMobileSelected=a.prevSort},a.getTableInfo=function(b){var c=_.filter(a.titlesMobile,{title_id:b.title_id});if(g.isMusicPage===!0){if(void 0===c[0].imgeCheck){c[0].showloader=!0;var d=new Image;d.src=s+b.image_name+"&size=200x150",d.onload=function(){c[0].imgeCheck=!0,c[0].showPosterArt=!0,c[0].showloader=!1,a.$apply()},d.onerror=function(){c[0].imgeCheck=!0,c[0].showPosterArt=!1,c[0].showloader=!1,a.$apply()}}}else if(void 0===c[0].imgeCheck){c[0].showloader=!0;var e=new Image;e.src=s+b.image_name+"&size=140x210&alt_size=240x360",e.onload=function(){c[0].imgeCheck=!0,c[0].showPosterArt=!0,c[0].showloader=!1,a.$apply()},e.onerror=function(){c[0].imgeCheck=!0,c[0].showPosterArt=!1,c[0].showloader=!1,a.$apply()}}a.dispalyMblTblInfo=!0,setTimeout(function(){$(".mobileTablePoster").swipe({tap:function(a){return 3===a.which&&2===a.button||$(a.target).is("button")?void 0:(void 0!==$(this).attr("assetid")&&(window.location.href=r+$(this).attr("assetid")),void 0)}})},200),a.mblTableInfo=b},a.closeTableInfo=function(){a.dispalyMblTblInfo=!1,a.mblTableInfo={}},a.getMappedCaption=function(a){switch(a){case"ABCDE":return"A-E";case"FGHIJ":return"F-J";case"KLMNO":return"K-O";case"PQRST":return"P-T";case"UVWXYZ":return"U-Z";default:return a}},a.getMappedfilters=function(a){switch(a){case 1:return"HD";case 2:return"Free";case 3:return"Just added";case 4:return"Last chance"}},$(window).scroll(m)}]),angular.module("vodtoppicks",["vod","movieCart","oolCookie","poster"]).directive("vodTopPicks",function(){return{restrict:"EA",templateUrl:"/parts/vod-top-picks/vod-top-picks.html",controller:["$scope","Vod","$http","movieCart","$notice","OnDemand","ooluser","$timeout","Config",function(a,b,c,d,e,f,g,h,i){function j(){a.showCarousel=!1,a.topPicks="",$(".ondemand-toppicks").hide("fast")}var k=$(window).width();a.windowHref=window.location.href,a.ooluser=g;var l=1e4,m=i.getValuesBySelector("vodTopPicks");b.getTopPicks().success(function(b){$(".ondemand-toppicks").show("fast"),a.showCarousel=b.showCarouselFlag===!0?!0:!1,a.topPicks=b.assets,l=b.carouselAutoCycle?b.carouselAutoCycle:m.autoCycleTime,a.getTapDetail=function(a){window.location.href="/tv/asset/#/movie/"+a};var c=0;if(angular.forEach(a.topPicks,function(b){d.getItems(function(){a.noCart=!1,b.noCart=a.noCart,angular.isObject(b)&&(b.onDemandAsset=f.addAssetMethodsToAsset(b),a.topPicks[c]=b,c+=1)},function(){b.noCart=a.noCart,a.topPicks[c]=b,c+=1})}),isViewportSize.phone&&isDeviceWidth.phone){if(767>k&&$(".carousel").carousel({interval:1e8}),769>k){var e=$(".description-text").height();setTimeout(function(){var a=$(".carousel-indicators li.active").first().attr("data-slide-to");"0"===a&&(100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."}))},250),$(".carousel-inner").swipe({swipeLeft:function(){$(this).parent().carousel("next"),100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},swipeRight:function(){$(this).parent().carousel("prev"),100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},tap:function(b){($(b.target).hasClass("img-alt")===!0||$(b.target).hasClass("carouselImg")===!0||$(b.target).hasClass("img-alt__graphic")===!0)&&h(function(){var b=$(".carousel-indicators li.active").first().attr("data-slide-to"),c=a.topPicks[b].id;window.location.href="/tv/asset/#/movie/"+c},5)},threshold:50})}}else $(".carousel").carousel({interval:l,pause:"none"}),setTimeout(function(){var a=$(".description-text").height();100>a?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},250),$(document).on("mouseenter","[id=carouselItemId]",function(){$(".carousel").carousel("pause")}),$(document).on("mouseleave","[id=carouselItemId]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),$(document).on("click","[data-slide=next]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),$(document).on("click","[data-slide=prev]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),a.getDetail=function(a){window.location.href="/tv/asset/#/movie/"+a},$(".carousel").on("slid.bs.carousel",function(){setTimeout(function(){$(".carousel-indicators li").size();var a=$(".carousel-indicators li.active").first().attr("data-slide-to"),b=$(".description-text").height();"0"===a?100>b?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."}):100>b?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},80)})}).error(j),a.notifyNoCart=function(){e.add("Sorry, we could not access your cart. Please try again later.","error")},a.removeFromCart=function(b){void 0!==b.onDemandAsset&&b.onDemandAsset.removeFromCart(angular.noop,a.notifyNoCart)},a.addToCart=function(b){void 0!==b.onDemandAsset&&b.onDemandAsset.addToCart(angular.noop,a.notifyNoCart)}}]}}).filter("dateformat",function(){return function(a){return a.split(" ")[0]}}).filter("getRatingClass",function(){return function(a){return null!==a?a.replace(".","-"):"0-0"}}),angular.module("vodWhereToWatch",["dvrRecord","vod","vodCarousels","if","dropdowns","webdvrResource","onetCookies"]).directive("vodWhereToWatch",[function(){return{restrict:"EA",templateUrl:"/parts/vod-where-to-watch/vod-where-to-watch-template.html",scope:{airings:"=airings",titles:"=titles",episodeDetail:"=episodedetail",limitto:"@limitto",assetType:"@assetType",withHD:"=withhd",onDemandAvailable:"=onDemandAvailable",moreEpisodes:"=moreEpisodes",moreLinearEpisodes:"=moreLinearEpisodes"},controller:["$scope","ooluser","Vod","$window","Support","$rootScope","WebDVR","Cookies",function(a,b,c,d,e,f,g,h){a.onDemand=a.onTV=!0,a.toggleButtonClass="icon-sort-up",b.laBoxUser=b.hasOOLSession?b.laBoxUser||b.laboxOrMini:"true"===h.getCookie("labox"),a.ooluser=b,a.dvrBlocked=!1,a.noDVRs=!0,g.query(function(b){a.noDVRs=0===b.length?!1:!0,a.dvrBlocked=b.hasDvrBlocked===!0?!0:!1}),a.urlOne="",a.urlTwo="";var i="Record_bttm",j={textAnchorsOptions:{},preSelected:null,mainTilte:null},k=[{title:"Show all"},{title:"On Demand"},{title:"On TV"}];j.preSelected=k[0].title,a.model=j;for(var l=0;l<k.length;l++)j.preSelected=k[0].title,j.textAnchorsOptions[k[l].title]=k[l].title;a.$watch("onDemandAvailable",function(b){void 0!==b&&b!==!1&&(a.onTV=!1,a.onDemand=!0,j.preSelected=k[1].title)}),a.$watch("model.preSelected",function(b){a.onDemandAvailable=!1,"On TV"===b?(a.onTV=!0,a.onDemand=!1,$("#accHeading2").removeClass("collapsed"),$("#collapseMobile").addClass("in"),$("#collapseMobile").css("height","auto")):"On Demand"===b?(a.onDemand=!0,a.onTV=!1,$("#accHeading2").removeClass("collapsed"),$("#collapseMobile").addClass("in"),$("#collapseMobile").css("height","auto")):(a.onTV=!0,a.onDemand=!0,$("#accHeading2").removeClass("collapsed"),$("#collapseMobile").addClass("in"),$("#collapseMobile").css("height","auto"))}),a.$watch("airings",function(b,c){b!==c&&(a.airings=_.map(b,function(a){if(null!==a.qualifiers&&void 0!==a.qualifiers){var b=a.qualifiers.split(",");a.isHDEpisode=-1!==$.inArray("HDTV",b)?!0:!1,a._new=-1!==$.inArray("New",b)?!0:!1}return a.trackClick=i,a}),$(".on-tv").find(".channel-info:visible").last().addClass("remove-border"))},!0),a.$watch("episodeDetail",function(b,c){b!==c&&(a.episodeDetail=b)},!0),a.$watch("assetType",function(b){void 0!==b&&null!==b&&""!==b&&("VOD"===a.assetType&&(a.urlOne="mobileOnDemandTitle.html",a.urlTwo="mobileOnTv.html"),"LINEAR"===a.assetType&&(a.urlOne="mobileOnTv.html",a.urlTwo="mobileOnDemandTitle.html"))}),a.$watch("moreEpisodes",function(b){void 0!==b&&null!==b&&""!==b&&(a.moreEpisodes=b)}),a.$watch("moreLinearEpisodes",function(b){void 0!==b&&null!==b&&""!==b&&(a.moreLinearEpisodes=b)}),a.setArrow=function(){a.toggleButtonClass="icon-sort-up"===a.toggleButtonClass?"icon-sort-down":"icon-sort-up"},a.removeFromCart=function(b,d){var e=d?"Vod_remove_cart_hd_bttm":"Vod_remove_cart_sd_bttm";c.removeFromCart(b,e,function(c){"SUCCESS"===c.status&&a.changeState(b,d,!1)})},a.removeFromFavorites=function(b){var d="Vod_remove_cart_hd_bttm",e=!0,f=b.hd_asset;b.inCartHd||(d="Vod_remove_cart_sd_bttm",e=!1,f=b.sd_asset),c.removeFromCart(f,d,function(b){"SUCCESS"===b.status&&a.changeState(f,e,!1)})},a.addToCart=function(e,f){var g=f?"Vod_cart_hd_bttm":"Vod_cart_sd_bttm";b.hasOOLSession?c.addToCart(e,g,function(b){"SUCCESS"===b.status&&a.changeState(e,f,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:g}),reporting.setAttrs({prop10:g}),reporting.sendAttrs(!0)),d.location.href="/login?referer="+window.location.href)},a.addToFavorites=function(e){var f="Vod_cart_hd_bttm",g=!0,h=e.hd_asset;e.hd_asset||(f="Vod_cart_sd_bttm",g=!1,h=e.sd_asset),b.hasOOLSession?c.addToCart(h,f,function(b){"SUCCESS"===b.status&&a.changeState(h,g,!0)}):("undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:f}),reporting.setAttrs({prop10:f}),reporting.sendAttrs(!0)),d.location.href="/login?referer="+window.location.href)},a.signinRedirect=function(){d.location.href="/login?referer="+window.location.href},a.getVODDetail=function(a){window.location.href="/tv/asset/#/episode/"+a},a.getLinearDetail=function(a){window.location.href="/tv/asset/#/program/tId:"+a},a.changeState=function(b,c,d){if(c===!0){if(void 0!==a.episodeDetail&&a.episodeDetail.hd_asset===b&&(a.episodeDetail.inCartHd=d,a.episodeDetail.inCart=d),void 0!==a.titles){var e=_.find(a.titles,{hd_asset:b});void 0!==e&&(e.inCartHd=d,e.inCart=d)}if(void 0!==a.moreEpisodes){var f=_.find(a.moreEpisodes,{hd_asset:b});void 0!==f&&(f.inCartHd=d,f.inCart=d)}}if(c===!1){if(void 0!==a.episodeDetail&&a.episodeDetail.sd_asset===b&&(a.episodeDetail.inCartSd=d,a.episodeDetail.inCart=d),void 0!==a.titles){var g=_.find(a.titles,{sd_asset:b});void 0!==g&&(g.inCartSd=d,g.inCart=d)}if(void 0!==a.moreEpisodes){var h=_.find(a.moreEpisodes,{sd_asset:b});void 0!==h&&(h.inCartSd=d,h.inCart=d)}}},a.goToLogin=function(){"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:"Record_bttm"}),reporting.setAttrs({prop10:"Record_bttm"}),reporting.sendAttrs(!0)),d.location.href="/login?referer="+window.location.href}}]}}]),angular.module("yextSearch",["YextAnswers"]).directive("yextSearch",["Yext",function(a){return{restrict:"C",template:"",link:function(b,c){var d=_.uniqueId("yext-search-");c.prop("id",d),a.addSearchBar({container:"#"+d,name:d,redirectUrl:"/search/",placeholderText:"Search support"})}}}]),angular.module("acctChecksum",[]).service("AcctChecksum",[function(){this.make14=function(a){for(var b=a.replace(/-/g,""),c=0,d=0;13>d;d+=2)c+=parseInt(b[d],10);for(var e=2*(c%10),f=e%10,g=0,h=1;13>h;h+=2)g+=parseInt(b[h],10);var i=g%10+f,j=i%10,k=10-j,l=Math.abs(k)%10,m=b+l;return m.substring(0,5)+"-"+m.substring(5,11)+"-"+m.substring(11,13)+"-"+m[13]}}]).filter("make14",["AcctChecksum",function(a){return function(b){return b?13!==b.replace(/-/g,"").length?(console.log("make14 given something other than a 13-digit acct. number"),b):a.make14(b):b}}]),angular.module("alertsService",["config","oolCookie","outageService","payBillResource","payBillUtils","codService"]).factory("Alerts",["$http","Config","ooluser","Outage","PayBillService","PayBillUtils","Cod","$q","$rootScope","$window","$location",function(a,b,c,d,e,f,g,h,i,j,k){var l=b.getValuesBySelector("endpoint.api.alert"),m=angular.fromJson,n={GET_ALERT:"alert",GET_PREVIEW_ALERT:"alert?cms_mode=preview"},o={SIMPLE:"simpleResponse"},p=c.eoid?c.eoid:"",q=!1,r=k.host(),s="preview";q=r.indexOf(s)>-1?!0:!1;var t=!1;r.indexOf("espanol.optimum")>-1&&(t=!0);var u=function(){function b(a,b,c){a.push({extLink:c,link:b.id,corpIds:b.corpIds,id:b.id,primaryMessage:b.title,type:alertType,regions:b.regions,secondaryMessage:b.summary,description:b.description,date:b.date})}var f=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=m(a);c.isValid=!0,c.parsedResponse=d}catch(e){console.error("ERROR parsing => "+b),console.error(e)}return c},j=function(a){var c=f(a,o.SIMPLE),d=null;if(c.isValid){var e=c.parsedResponse._embedded,g=e&&e.alerts?e.alerts:[];g=angular.isArray(g)?g:[g];for(var h=[],i=0,j=g.length;j>i;i++){var k=g[i];k.label&&!k.title&&(k.title=k.label);var l=k.id&&k.title&&k.summary;alertType="Service Outage"===k.title?"major":"minor";var m="";m=""!==k.extLink&&"null"!==k.extLink&&void 0!==k.extLink&&null!==k.extLink?k.extLink:"";var n=0,p=0,r=!1,s=!0,u=!0;void 0!==k.expiryDate&&null!==k.expiryDate&&""!==k.expiryDate&&"null"!==k.expiryDate&&0!==k.expiryDate&&"0"!==k.expiryDate&&(n=k.expiryDate,(new Date).getTime()>n&&(r=!0)),void 0!==k.publishDate&&null!==k.publishDate&&""!==k.publishDate&&"null"!==k.publishDate&&0!==k.publishDate&&"0"!==k.publishDate&&(p=k.publishDate,(new Date).getTime()<p&&(s=!1)),("es"===k.language&&t===!1||"en"===k.language&&t===!0)&&(u=!1),q&&(s=!0,r=!1,u=!0),s===!0&&r===!1&&u===!0&&(n="",p="",l&&b(h,k,m))}d={alerts:_.cloneDeep(h)}}return d},r=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})},s=_.once(function(){if(c.primary===!0||null!=c.p&&1===c.p.bp){var a=h.defer();return e.getSummary({},a.resolve,a.reject),a.promise}return null});return this.getAlert=function(a){var b=l+n.GET_ALERT+"?eoid="+p;return q&&(b=l+n.GET_PREVIEW_ALERT+"&eoid="+p),a&&a.page&&(b=b+"&displayPage="+a.page),r(b,null,null,j,null)},this.getCombinedAlerts=function(a){var b=function(a){return function(){return a}},e=this.getAlert(a).then(_.identity,b({data:{alerts:[]}})),f=d.getProcessedOutagePromise(),j=g.getCODDetails(),l=h.all([e,f,s(),j]).then(function(a){var b=a[0],d=b.data.alerts.slice(0),e=a[1],f=a[2],g=a[3];_.each(d,function(a){a.source="cms-detailed",a.link=""!==a.extLink?a.extLink:"/support/notification/#?type=cms-detailed&id="+a.id});var h="/support/outage/#/",j="Service alert",l="Your account is past due",m="minor";if("User not logged in"!==e.outageStatus&&null!=e.accountSummary?e.accountSummary.nodeInDistress||e.accountSummary.devicesOffline||!e.accountSummary.plannedMaintenance?e.accountSummary.nodeInDistress||e.accountSummary.devicesOffline||e.accountSummary.plannedMaintenance?e.accountSummary.plannedMaintenance&&e.accountSummary.nodeInDistress&&e.accountSummary.devicesOffline?h+="PmNodeInDistress":e.accountSummary.plannedMaintenance&&!e.accountSummary.nodeInDistress&&e.accountSummary.devicesOffline?h+="PmNodeInDistress":!e.accountSummary.plannedMaintenance&&e.accountSummary.nodeInDistress&&e.accountSummary.devicesOffline?h+="UndeclaredOutage":e.accountSummary.plannedMaintenance||e.accountSummary.nodeInDistress||!e.accountSummary.devicesOffline?e.accountSummary.plannedMaintenance&&e.accountSummary.nodeInDistress&&!e.accountSummary.devicesOffline?h+="PmNodeInDistress":e.accountSummary.plannedMaintenance||!e.accountSummary.nodeInDistress||e.accountSummary.devicesOffline||(h+="NodeInDistress"):h+="UndeclaredOutage":h+="PmModemsOnline":h+="PmNodeInDistress":"User not logged in"===e.outageStatus?h+="UnauthenticatedUserOutage":("error"===e.outageStatus||"ERROR"===e.outageStatus)&&(h+="NoServiceStatus"),null!=e.accountSummary&&"VOD_HOLD"===e.accountSummary.accountPaymentStatus&&(h="/support/outage/#/PendingVOD",d.unshift({primaryMessage:j,secondaryMessage:l,type:m,outageType:"OUTAGE_ON_ACCOUNT",source:"vod hold",link:h})),null!=e.accountSummary&&e.accountSummary.serviceOutageReported&&("RECENTLY_CLEARED"===e.outageStatus&&"/support/outage/#/"!==h||("RECENTLY_CLEARED"===e.outageStatus&&"/support/outage/#/"===h?h="/support/outage/#/PmModemsOnline":(h="/support/outage/#/PmKnownOutage",l="Outage detected",e.outageStatus="OUTAGE_ON_ACCOUNT",d.unshift({primaryMessage:j,secondaryMessage:l,type:"major",outageType:e.outageStatus,source:"outage",link:h,outageMessage:e.outageMessage})))),c.primary===!0||null!=c.p&&1===c.p.bp){var n=20;
null!=g&&null!=g.data&&g.data.balance>n&&null!=f&&(null==f.getBillSummaryReturn||null!=f.getBillSummaryReturn&&null!=f.getBillSummaryReturn.billStatements&&0===f.getBillSummaryReturn.billStatements.length)&&(m="major",h="/pay-bill/payment-options",l="$"+g.data.balance+" is due at this time.",d.unshift({primaryMessage:l,secondaryMessage:"Please make your payment to avoid any interruption of services.",type:m,outageType:"OUTAGE_ON_ACCOUNT",source:"non pay",link:h}))}null!=e.accountSummary&&"NON_PAY"===e.accountSummary.accountPaymentStatus&&(m="major",h="/pay-bill/payment-options",l="Your account is past due",d.unshift({primaryMessage:l,secondaryMessage:"Your service has been interrupted and is scheduled to be disconnected because your account is past due. To restore your service and avoid disconnection, you need to pay your account balance. To make a payment now, please go to https://www.optimum.net/pay-bill/ or you can make payment through the Optimum Support App**.",type:m,outageType:"OUTAGE_ON_ACCOUNT",source:"non pay",link:h}));var o=$(location).attr("href"),p=document.referrer,q=o.indexOf("/support"),r=o.substring(q);if(i.currentOutageLink=h,-1===p.indexOf("/outage")&&r!==h);else if(-1!==o.indexOf("/outage")&&-1===o.indexOf("/login/?referer")&&-1===p.indexOf("alerts-and-notifications")){var s=h.split("#");k.path(s[1])}return{alerts:d}});return l},this};return new u}]),angular.module("authenticationHandler",[]).config(["$httpProvider",function(a){var b=["$rootScope","$q",function(a,b){function c(a){return 401===a.status}return function(d){return d.then(function(a){return a},function(d){return c(d)&&a.$broadcast("authenticationHandler:unauthenticated",d),b.reject(d)})}}];a.responseInterceptors.push(b)}]),angular.module("bestBets",["config","oolCookie"]).factory("BestBets",["$http","Config","ooluser",function(a,b,c){var d=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=angular.fromJson(a);c.isValid=!0,c.parsedResponse=d}catch(e){console.error("ERROR parsing => "+b),console.error(e)}return c},e=function(){var a=this,d=b.getValuesBySelector("endpoint.api.bestBets");a.getOnTonight=function(){var b={deviceType:"web",hubId:c.hubId};return a.makeRequest(d,"GET",b,a.formatOnTonightResponse.bind(this),null)}};return e.prototype={makeRequest:function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(a){return a})},formatOnTonightResponse:function(a){var b=d(a,"BEST BETS"),c=[];if(b.isValid){var e=b.parsedResponse,f=e.body&&e.body.bodyContent?e.body.bodyContent:!1;_.each(f,function(a){_.has(a,"block")&&_.each(a.block,function(a){if(_.has(a,"classifier")&&a.classifier.length){var b={};_.each(a.classifier,function(a){_.has(a,"type")&&"AirDateTime"===a.type&&(b.time=a.content),_.has(a,"type")&&"ProgramTitle"===a.type&&(b.title=a.content)}),c.push({time:b.time,title:b.title})}})})}return c}},new e}]),angular.module("boxHitService",["config","ngResource"]).factory("BoxHit",["$resource","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.user");return a(c+"boxhit",{},{ping:{method:"GET",isArray:!1}})}]),angular.module("cmsJsonParser",[]).service("CmsParser",["$http","$q",function(a,b){var c=b.defer(),d={getSportsData:function(b){return a({method:"GET",url:"/tv/sports/sports-templates/sports-data.html",responseType:"json"}).then(function(a){var d={};return d.monthsDisplay=[],d.daysByMonth=[],d.rowData={},a.data.message&&a.data.message[b]&&""!==a.data.message[b]?(a.data.message=a.data.message[b],c.resolve(a.data),c.promise):(a.data.message=void 0,d.rowData="mlb"===b?a.data.mlb?a.data.mlb:void 0:"nba"===b?a.data.nba?a.data.nba:void 0:"nhl"===b?a.data.nhl?a.data.nhl:void 0:(b="mls")?a.data.mls?a.data.mls:void 0:a.data,d.monthsDisplay=e(d.rowData),d.daysByMonth=f(d.rowData,d.monthsDisplay),d.selectedMonth=d.monthsDisplay[0]?d.monthsDisplay[0]:"",d.selectedMonthDays=e(d.daysByMonth[d.selectedMonth]),c.resolve(d),c.promise)},function(a){return a.message="Sorry, Schedule Unavailable",c.reject(a),c.promise})},getNestProductCatalog:function(){return a({method:"GET",url:"/nest/product-detail/templates/data.json",responseType:"json"}).then(function(a){var b=a.data.ecomm_catalog.NEST;return b},function(a){return data=a})}},e=function(a){return a?Object.keys(a):[]},f=function(a,b){if(!b&&!a)return[];for(var c={},d=0;d<b.length;d++){var e=a[b[d]];c[b[d]]=g(e)}return c},g=function(a){for(var b={},c="day",d=0;d<a.length;d++)b.hasOwnProperty(a[d][c])||(b[a[d][c]]=[]),b[a[d][c]].push(a[d]);return b};return d}]),angular.module("codService",["config","oolCookie"]).factory("Cod",["$http","Config","ooluser",function(a,b,c){function d(){var d=b.getValuesBySelector("endpoint.api.cod");this.getCODDetails=_.once(function(){return c.primary===!0||null!=c.p&&1===c.p.bp?a.get(d).then(function(a){var b=a.data;return b},function(){var a={};return a}):null})}return d.prototype={},new d}]),angular.module("config",["authenticationHandler","commonHeader","commonFooter","bottomDefault","serviceAppointment"]).factory("Config",[function(){var a="/api/",b=window.location.host,c="https://webmail.optimum.net/wm3-beta";/stage/.test(b)&&(c="http://stage.webmail.optimum.net");var d=function(){var a="https://voice.optimum.net/";return/dev/.test(b)&&(a="https://voice.dev-optimum.net/"),/stage/.test(b)&&(a="https://stage4.voice.optimum.net"),a},e=function(){var a="https://router.optimum.net";return/dev/.test(b)&&(a="https://router.optimum.net"),/stage/.test(b)&&(a="https://stage.router.optimum.net"),a},f=function(){var a="https://mymail.optimum.net/appsuite/#!!&app=io.ox/mail/detail&folder=default0/INBOX&id=";return/stage/.test(b)&&(a="https://mymail-staging.optimum.net/appsuite/#!!&app=io.ox/mail/detail&folder=default0/INBOX&id="),a},g=function(){var a="https://myemail.optimum.net/";return/stage/.test(b)&&(a="https://myemail-staging.optimum.net/"),a},h=function(){return b.indexOf("dev-optimum.net")>-1?"6LehcN8SAAAAABGio3EhxsCI4NvfPMhqPq1JdmbR":"6LdXtuISAAAAAL2b633FAvwjKFoUAucvq0Fkoeql"},i={captcha_key:h(),cookie:{expirationTimeToCheck:1},deprecatedBrowserCheckTime:6048e5,endpoint:{api:{alert:a+"alert/services/v1/",appointment:a+"user/services/v1/appointment/",bestBets:a+"ipadproxy/_public/bestbets.jsp",billpay:a+"billpay/services/v1/billpay/",cablesupport:a+"support/services/v1/",cablesupport_public:a+"support/_public/services/v1/",dvr:a+"onet-webdvr/",dvrwebapp:a+"dvr/services/v1/",epg:a+"epg/services/v1/epg/",epgModified:a+"epg/services/v1/",epgImages:"/iptv-proxy/stage.imageproxy.iptv.optimum.net/images/",epgImagesAlt:"/iptv-proxy/epg.images.iptv.optimum.net/images/",email_metadata:a+"user/services/v1/emailmetadata/getEmailMetaData",faqSearch:"/FAQ#/list/kw/",hulu:a+"user/services/v1/hulu/url",ipad:a+"ipadproxy/",login:a+"login/services/v1/",map:a+"map/services/v1/",map_public:a+"map/_public/services/v1/",mcafee:a+"login/services/v1/mcafee/",multiAuth:a+"login/services/v1/challenge/",nestProducts:a+"cms/_public/rest/json/google_nest_products",nestSubscriptions:a+"cms/_public/rest/json/google_nest_subscriptions",smarthomeCarousel:a+"cms/_public/rest/json/smarthome_carousel",nestflags:a+"cms/_public/rest/json/nest_config_service",animationConfig:a+"cms/_public/rest/json/animation_config",netflix_generate:a+"user/services/v1/user/netflix/generateToken",netflix_promos:a+"user/services/v1/user/netflix/promotions",networkLogo:"/iptv-proxy/epg.iptv.optimum.net/logos/optimum.net/",newOnDemand:"/iptv-proxy/vodimages.iptv.optimum.net/",outage:a+"outage/",outage_proxy:a+"outage-proxy/",ox_webmail:a+"user/services/v1/emailmetadata/getMetaDataOX",phone:a+"phone/services/v1/phone/voicemail/",photos:a+"user/services/v1/photos/",preferences:a+"preferencesmanager/services/v1/preferences/",search:a+"search/search/",suggest:a+"search/suggest/",support:a+"support/services/v1/support/",support_faq:a+"support/services/v1/faq/",support_public:a+"support/_public/services/v1/support/",supportedDevices:"//andauth.iptv.optimum.net/android/getSupportedDevices.jsp?cb=JSON_CALLBACK",support_consent:a+"support/services/v1/consent/retail/",tvListingsDVR:a+"tvlistings-webdvr/",user:a+"user/services/v1/user/",useragent:a+"onet/useragent/",vodimage:"/iptv-proxy/vodimages.iptv.optimum.net/mobile/image/asset/",vodlogos:"/iptv-proxy/epg.iptv.optimum.net/logos/optimum.net/cropped/",weather:"/services/weather/today/weather.json",webmail:a+"webmail/",webDVR:a+"tvlistings-webdvr/json/webdvrservicejson.do",wifi:a+"wifi/services/v1/",wpg:a+"epg/services/v1/wpg/",genesys_onet:a+"onet/genesys/",genesys_endpoint:a+"../cvContactUs/rest/",pricing:a+"user/services/v1/pricing/",vod:a+"vod-webapp/services/v1/vod/",vodwebapp:a+"vod-webapp/services/v1/onyx/",vodonyx:"/vod"+a,vodonyximage:"/vod/api/getImage.jpg?name=",vendor_flag:a+"support/services/v1/vendorStatus/getvendorStatus?type=",ecommerce:a+"user/services/v1/ecommerce/",ddi:a+"mdr/services/v1/ddi/",wifipass:a+"wifi/services/v1/daypass/",oolSession:a+"support/services/v1/support/oolsession",cmssectionurl:a+"/cms/_public/rest/json/section?nid=",cod:a+"user/services/v1/cod/accountBalance",getRouterFeaturesByModel:a+"cms/_public/rest/json/getRouterFeaturesByModel?model="}},serviceAppointment:{bronxId:"07837",bronxOrderType:"TC",timeOutMilliSeconds:"600000"},formValidation:{firstNameInput:{hint:"Enter a first name",errors:{invalidChars:"Contains invalid characters",tooShort:"Input is too short"},success:"Valid first name"},lastNameInput:{hint:"Enter a last name",errors:{invalidChars:"Contains invalid characters",tooShort:"Input is too short"},success:"Valid last name"},zipCodeInput:{hint:"Enter a zip code",errors:{invalidChars:"Numbers only",tooLong:"5 number limit"},success:"Valid zip code"},optimumIdInput:{hint:"Enter an optimumId",errors:{tooShort:"Optimum ID is too short",tooLong:"Optimum ID is too long",beginChars:'Optimum ID cannot begin with "." or "-" or "_"',endChars:'Optimum ID cannot end with "." or "-" or "_"',unavailable:"Optimum ID is not unavailable"},success:"Optimum ID is available"}},imageSize:{net_poster_67x89:"net_poster_67x89",net_poster_109x145:"net_poster_109x145",net_poster_140x187:"net_poster_140x187",net_poster_218x290:"net_poster_218x290",net_poster_222x297:"net_poster_222x297"},link:{twitterURL:"https://twitter.com/messages/compose?recipient_id=705534415",mailOxDeepLink:f(),mailSncrInboxLink:g(),contactUs:"http://www.optimum.com/support/contact_us.jsp",supportEmail:"/support/livepage/email",supportLiveChat:"/support/livepage/chat",basePhoneMenuUrl:d(),routerHostUrl:e(),managedRouterSettings:"/internet/manage-router",mapDefault:"http://maps.google.com/",processLogin:"/api/login/services/v1/login/processLogin",processSignout:"/api/login/services/v1/signout",cdn:{images:"/cdn/static.tvlistings.optimum.net/ool/static/prod/images"},software:{desktop:{osx:{optimumApp:"http://www.optimum.net/laptop"},windows:{optimumApp:"http://www.optimum.net/laptop"}},mobile:{android:{optimumApp:"https://play.google.com/store/apps/details?id=com.optimum.unity.mobile",wifiDownload:"https://play.google.com/store/apps/details?id=com.cv.autosignin&hl=en",wifiFinder:"https://play.google.com/store/apps/details?id=com.cablevision.optimum.hsf",optimumDVR:"https://play.google.com/store/apps/details?id=com.optimum.rdvr.mobile",mapsURL:"geo:"},ios:{optimumApp:"https://itunes.apple.com/en/app/optimum/id387231038?mt=8&uo=4",wifiDownload:"https://itunes.apple.com/us/app/optimum-wifi-register/id490698227?mt=8&uo=4",wifiFinder:"https://itunes.apple.com/us/app/optimum-wifi-hotspot-finder/id529899484?mt=8&uo=4",mapsURL:"http://maps.apple.com/"},iosIpad:{optimumApp:"https://itunes.apple.com/us/app/optimum-for-ipad/id424612367?mt=8&uo=4"},kindle:{optimumApp:"http://www.amazon.com/Cablevisions-Systems-Corporation-Optimum-Edition/dp/B0079Q963K/ref=sr_1_1?s=mobile-apps&ie=UTF8&qid=1368543095&sr=1-1"}}},siteControl:"/api/login/services/v1/sso/hostways/transferService?ref=DDNS",speedtest:"http://speedcheck.optimum.net/",webHosting:{manage:"/api/login/services/v1/sso/hostways/transferService",upgrade:"http://www.optimum.com/home-internet-service/internet-speed/"},webmail:c},message:{api:{deviceExists:"This device has already been registered for automatic sign-in.",error:"Service not available at this time",noWifiUsage:"No usage in the last thirty days."}},paths:{assets:{fonts:"/assets/fonts",images:"/assets/images"}},thePlatform:{guid:{internet:{aboutHotspots:"29364291514",autoSignin:"29363779604",security:"29358659940"},support:{landingPage:"xwlOU9acAgKO1VpGTqx7cJkR0trSAxlA"}}},timer:{webmail:3e5},webDVR:{allowMultipleDVRLookup:!0},vodTopPicks:{maxItems:5,autoCycleTime:7e3},states:["NY","NJ","CT","PA","AL","AK","AZ","AR","CA","CO","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","ME","MA","MI","MN","MS","MO","MT","NE","NV","NH","NM","NC","ND","OH","OK","OR","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"]},j={getValuesBySelector:function(a){var b={};if("*"===a)b=_.cloneDeep(i);else{var c=_.cloneDeep(i),d=_.cloneDeep(i);_.each(a.split("."),function(a){if(!d.hasOwnProperty(a))throw new Error("unsupported property => "+a);var b=d[a];c=b,d=b}),b=c}return b},select:function(){return this.getValuesBySelector.apply(this,_.toArray(arguments))}};return j}]),angular.module("cookieLoggerService",[]).factory("CookieLogger",["$http",function(a){function b(a){return a&&a.length?a.length:0}function c(){if(Modernizr.localstorage){var c=localStorage.sitetransition,d=null,f={};c&&(f=JSON.parse(c),d=f.status);var g=b(document.cookie.match(/(^|;) *site=?(;|$)/));if(g){if(g&&"normal"===d){var h={lastNormal:f.timestamp,current:(new Date).toJSON()};localStorage.sitetransition=JSON.stringify({status:"abnormal"}),a.post(e,h)}}else localStorage.sitetransition=JSON.stringify({status:"normal",timestamp:(new Date).toJSON()})}}var d="/api/support/services/v1/log/cookie",e="/api/support/services/v1/log/transition",f=function(a,b){var c;c=a.http?["http://www.optimum.net","http://optimum.net","https://www.optimum.net","http://espanol.optimum.net","https://espanol.optimum.net"]:a.nowww?["https://optimum.net","https://www.optimum.net","https://espanol.optimum.net"]:["https://www.optimum.net","https://espanol.optimum.net"];for(var e=function(a){return function(){a.remove()}},f=0;f<c.length;f++){var g=$("<img>"),h=e(g);g.error(h),g.on("load",h),b.host=c[f],g.attr("src",c[f]+d+"?"+$.param(b))}},g=function(a){var b="http:"===window.location.protocol,c="optimum.net"===window.location.hostname,d=_.random(1e6),e={nonce:d,cause:a};f({http:b,nowww:c},e)},h=function(){var a=b(document.cookie.match(/(^|;) *site=/g)),d=b(document.cookie.match(/(^|;) *site=[^n]/g)),e="http:"===window.location.protocol,f="optimum.net"===window.location.hostname;a>1||d>0?g("weird site cookie"):(e||f)&&g("weird URL"),c()};return{logCookies:g,checkSanity:_.once(h)}}]),angular.module("cpcMobileHandler",[]).factory("CpcMobileHandler",[function(){var a=!1,b="",c={isCpcCheck:function(){for(var b=window.location.search.substr(1).split("&"),c={},d=0,e="";e=b[d];d++){var f=b[d].split("=");c[f[0]]=f[1]}var g=decodeURIComponent(c.referer);return a=!1,g.indexOf("cpcmobile")>-1&&(a=!0),a},getCpcMobile:function(){return b=c.getUrlParams("cpcmobile")},getUrlParams:function(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}return""}};return c}]),angular.module("creditCardTextResource",["payBillUtils","payBillResource"]).factory("CreditCardText",["PayBillService","PayBillUtils",function(a,b){function c(a){if(a=a.replace(/[^0-9]/g,""),0===a.length||a.length<5)return a;var b=0,c="";for(b=0;b<a.length;b+=4)endLength=b+3>=a.length?a.length:b+4,b>0&&(c+=" "),c+=a.substring(b,endLength);return c}function d(a){var b={luhn_valid:!1,length_valid:!1};if(a=String(a),a.split(" ")&&a.split(" ").length>0&&(a=a.split(" ").join("")),0===a.length)return b;if(parseInt(a,10)<=10)return b;for(_i=0,_len=e.length;_len>_i;_i++)card=e[_i],a.match(card.pattern)&&(b.card_type=card);return b.card_type&&(is_valid_luhn(a)&&(b.luhn_valid=!0),is_valid_length(a,b.card_type)&&(b.length_valid=!0)),b}var e=[{name:"amex",pattern:/^3[47]/,valid_length:[15]},{name:"visa",pattern:/^4/,valid_length:[16]},{name:"mastercard",pattern:/^5[1-5]/,valid_length:[16]},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,valid_length:[16]}];is_valid_luhn=function(a){var b,c,d,e,f,g;for(d=0,g=a.split("").reverse(),c=e=0,f=g.length;f>e;c=++e)b=g[c],b=+b,c%2?(b*=2,d+=10>b?b:b-9):d+=b;return 0===d%10},is_valid_length=function(a,b){for(i=0;i<b.valid_length.length;i++)if(a.length===b.valid_length[i])return!0;return!1};var f={setup:function(a,b,e){$("#"+b).live("blur",function(){a.cardValidated||($("#"+b).removeClass("cards--visa").removeClass("cards--mastercard").removeClass("cards--discover").removeClass("cards--amex").removeClass("cards--invalid"),""!==$("#"+b).val()&&$("#"+b).addClass("cards--invalid")),this.value=c(this.value)}),$("#"+b).live("input propertychange",function(){this.value=c(this.value),a.addPayModel.paymentAccountNumber=this.value,f.assessCreditCard(d(this.value),a,b,e)}).live("keyup",function(){formattedVal=c($(this).val()),scrollPos=this.selectionStart,setScrollPos=!0,scrollPos>=this.value.length&&(setScrollPos=!1),this.value!==formattedVal&&(this.value=formattedVal,setScrollPos&&(this.selectionStart=scrollPos,this.selectionEnd=scrollPos))});var g=$.browser.msie&&parseInt($.browser.version,10)<9;g&&$("#"+b).live("keyup paste",function(){a.addPayModel.paymentAccountNumber=this.value,f.assessCreditCard(d(this.value),a,b,e)}),$("#"+b).live("focusout",function(){d(this.value).luhn_valid&&d(this.value).length_valid&&""!==this.value?$("#creditCardError").addClass("hidden"):$("#creditCardError").removeClass("hidden")}),$("#"+e).live("focusout",function(){0===this.value.length&&a.cardValidated&&(this.value=a.model.payNickName_CC_bk,a.$apply(function(){this.value=a.model.payNickName_CC_bk}))})},assessCreditCard:function(a,c,d,e){if(a){if(c.cardValidated=!1,$("#"+d).removeClass("cards--visa").removeClass("cards--mastercard").removeClass("cards--discover").removeClass("cards--amex").removeClass("cards--invalid"),c.addPayModel.cardType="",nickNameText="",a.card_type)switch(a.card_type.name.toLowerCase()){case"visa":c.addPayModel.cardType="V",nickNameText="Visa",$("#"+d).addClass("cards--visa");break;case"mastercard":c.addPayModel.cardType="M",nickNameText="Mastercard",$("#"+d).addClass("cards--mastercard");break;case"discover":c.addPayModel.cardType="D",nickNameText="Discover",$("#"+d).addClass("cards--discover");break;case"amex":c.addPayModel.cardType="A",nickNameText="Amex",$("#"+d).addClass("cards--amex")}a.length_valid&&a.luhn_valid?c.$apply(function(){c.addPayModel.paymentAccountNumber_CC=nickNameText,c.cardValidated=!0,unformattedText=$("#"+d).val().split(" ").join(""),c.model.payNickname_CC=nickNameText.substring(0,8)+"-"+unformattedText.substring(unformattedText.length-4,unformattedText.length),c.model.payNickName_CC_bk=c.model.payNickname_CC,c.pmSelected=c.model.payNickname_CC,cardNumber=$("#"+d).val().split(" ").join(""),c.isDebitCardType=!1,c.model.addDebit=!1,c.service.getCreditCardInfo({cardnumber:cardNumber,cardType:c.addPayModel.cardType},function(a){b.handleSuccessfullResponse(a,c,{noClear:!0})&&a.cardType&&"D"===a.cardType&&(c.model.addDebit=!0,c.isDebitCardType=!0,c.showDebitCheck=!1)},function(){})}):c.$apply(function(){c.cardValidated=!1,c.pmSelected="card",c.model.payNickname_CC="",c.model.payNickName_CC_bk=""})}else $("#"+e).val(""),c.$apply(function(){c.model.payNickName_CC_bk="",c.model.payNickname_CC=""})}};return f}]),angular.module("ddi",["config"]).service("DDIService",["$http","$q","Config",function(a,b,c){var d=c.getValuesBySelector("endpoint.api.user");c.getValuesBySelector("endpoint.api.billpay");var e="ddi/offer",f="ddi/redeemed",g="ddi/redeemclicked",h=function(b,c,d,e,f,g){var h={method:c||"GET",url:b,responseType:e||null,data:d||null,headers:g||null,transformResponse:f||null};return a(h).success(function(a){return a}).error(function(a){return a})};this.getOfferStatus=function(){return offerState},this.getOfferDetails=function(){var a=b.defer(),c=a.promise;return h(d+e,"GET",null,"json").then(function(b){a.resolve(b)},function(b){a.reject(b)}),c.success=function(a){return c.then(a),c},c.error=function(a){return c.then(null,a),c},c},this.DDIredeem=function(a,b){var c={redeemed:"Y"};return h(d+f,"POST",c,"json").then(function(b){a(b)},function(a){b(a)})},this.DDIRedeemClicked=function(a,b){return h(d+g,"POST",null,"json").then(function(b){a(b)},function(a){b(a)})}}]),angular.module("dmcaNoticesService",["config"]).factory("dmcaNoticesService",["$http","Config",function(a,b){function c(a){this.infringementTime=moment(a.acnsSourceInfringementTime,"YYYY-MM-DD HH:mm:ss").toDate(),this.arbitrationFiledDate=a.arbitrationFiledDate?Date.fromISO(a.arbitrationFiledDate):null,this.arbitrationStatus=a.arbitrationStatus,this.abuseIp=a.abuseIp,this.sourceHostname=a.acnsSourceHostname,this.sourceUsername=a.acnsSourceUsername,this.materialTitle=a.acnsMaterialTitle,this.materialFileName=a.acnsMaterialFileName,this.materialURL=a.acnsMaterialURL,this.sourcePort=a.acnsSourcePort,this.sourceApplication=a.acnsSourceApplication,this.sourceNumberOfFiles=a.acnsSourceNumberOfFiles,this.complainantEntity=a.acnsComplainantEntity,this.acnsComplainantId=a.acnsComplainantId,this.complainantId=a.acnsComplainantId,this.ticketId=a.ticketId,this.mouFlag="YES"===a.mouFlag.toUpperCase(),this.incidentLevel=a.incidentLevel,this.receivedDate=Date.fromISO(a.receivedDate),this.noticeId=a.noticeId,this.fileSize=a.acnsMaterialFilesize,this.complainantAddress=a.acnsComplainantAddress,this.complainantContact=a.acnsComplainantContact,this.complainantEmail=a.acnsComplainantEmail,this.complainantPhone=a.acnsComplainantPhone,this.sourceInfringementTime=a.acnsSourceInfringementTime}var d="dmca/account_notices",e="dmca/ticket/notice",f="dmca/arbitration";return Date.fromISO=function(a){return moment(a).toDate()},{getTickets:function(e,f){var g=b.getValuesBySelector("endpoint.api.user")+d;a.get(g).success(function(a){var b=a.notices;e.call(this,_.map(b,function(a){return new c(a)}))}).error(function(a){console.log("[dmcaNoticesService] Failed to retrieve tickets from end point: "+g),f instanceof Function&&f.call(this,a)})},getTicketsAndTopData:function(e,f){var g=b.getValuesBySelector("endpoint.api.user")+d;a.get(g).success(function(a){console.log("DMCA Response is "+JSON.stringify(a));var b=a.notices,d=_.map(b,function(a){return new c(a)}),f=_.reduce(_.pluck(d,"arbitrationFiledDate"),function(a,b){return!a||b&&b>a?b:a},null);e.call(this,{notices:d,alertToFile:a.alertToFile,canFileChallenge:a.canFileChallenge,id:a.id,daysToFile:a.daysToFile,lastArbitrationDate:f})}).error(function(a){console.log("[dmcaNoticesService] Failed to retrieve tickets from end point: "+g),f instanceof Function&&f.call(this,a)})},getNotice:function(c,d,f){var g=b.getValuesBySelector("endpoint.api.user")+e+"/"+c;a.get(g).success(function(a){d.call(this,a)}).error(function(a){console.log("[dmcaNoticesService] Failed to retrieve ticket detail from end point: "+g),f instanceof Function&&f.call(this,a)})},sendArbitration:function(c,d){var e=b.getValuesBySelector("endpoint.api.user")+f;a.post(e).success(c).error(function(a){console.log("[dmcaNoticesService] Failed to submit an arbitration request from endpoint: "+e),d instanceof Function&&d.call(this,a)})}}}]),angular.module("downloadAssistant",["config"]).factory("navigator",function(){return window.navigator}).factory("DownloadAssistant",["Config","navigator",function(a,b){function c(a){this.name="IllegalStateException",this.message=a,this.toString=function(){return a}}var d=a.getValuesBySelector("*").link.software,e=_.extend(d.desktop,d.mobile),f=[{key:"osx",name:"Mac OS X",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("mac")}},{key:"windows",name:"Windows",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("win")}},{key:"android",name:"Android",predicate:function(){return(-1!==b.platform.toLowerCase().indexOf("android")||-1!==b.userAgent.toLowerCase().indexOf("android"))&&-1===b.userAgent.toLowerCase().indexOf("silk")}},{key:"iosIpad",name:"iOS (iPad)",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("ipad")}},{key:"ios",name:"iOS (iPhone)",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("iphone")||-1!==b.platform.toLowerCase().indexOf("ipod")}},{key:"kindle",name:"Kindle",predicate:function(){return-1!==b.userAgent.toLowerCase().indexOf("silk")}},{key:"linux",name:"Linux",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("linux")&&-1===b.userAgent.toLowerCase().indexOf("android")}}],g=_.head(_.filter(f,function(a){return a.predicate()})),h=function(){if(!g)throw new c("[DownloadAssistant] no platform set (platform detection has failed).")};return{getPlatformURL:function(a,b){h();var c=b?b:g.key;return c in e?e[c][a]:e.windows[a]},getAllPlatformURLs:function(a,b){return _.foldr(f,function(c,d){return d.key in e&&a in e[d.key]&&(g!==d||!b)&&c.unshift({key:d.key,name:d.name,url:e[d.key][a]}),c},[])},getPlatformName:function(){return h(),g.name},detectionFailed:function(){return"undefined"==typeof g},detectionSucceeded:function(){return"undefined"!=typeof g}}}]),angular.module("dvrRecordingModel",["config","onetCookies"]).factory("recordingModel",["Config","ooluser","Cookies",function(a,b,c){return b.laBoxUser=b.hasOOLSession?b.laBoxUser||b.laboxOrMini:"true"===c.getCookie("labox"),function(a){function c(a){return moment(a.Program.StartTime).format("M/D")}function d(a){var b="";return a.Program.SeasonNumber&&(b+="S"+a.Program.SeasonNumber),a.Program.EpisodeNumber&&(b+=" E"+a.Program.EpisodeNumber),b}function e(a){function b(a){var b=_(a).keys().groupBy(function(a){return _.contains(h.accepted,a)?"accepted":"fallback"}).valueOf();return b.accepted=_.sortBy(b.accepted,function(a){return _.indexOf(h.accepted,a)}),b.fallback=_.sortBy(b.fallback,function(a){return _.indexOf(h.fallback,a)}),b}function c(a){var b=_.first(a.h),c=_.first(a.v);return c?g.preferred=c.ImgUrl:b&&!g.fallback&&(g.fallback=b.ImgUrl),g.preferred?!1:!0}function d(a){var b=_.first(a.h);return g.fallback=g.fallback||(b?b.ImgUrl:""),g.fallback?!1:!0}function e(a){var b=_(a).groupBy(function(a){return a.Width<a.Height?"v":"h"}).defaults({h:[],v:[]}).valueOf();return _.each(b,function(a,c){b[c]=_.sortBy(a,function(a){return-1*a.Width})}),b}var f=_.groupBy(a.ImageList,"Category");if(_.isEmpty(f))return a.thumbIsPreferred=!1,a.thumbUrl=null,void 0;var g={preferred:"",fallback:""},h={accepted:["Poster Art","Banner"],fallback:["Program Logo","Cast Ensemble","Cast in Character"]},i=b(f);_.each(i.accepted,function(a){return c(e(f[a]))}),g.preferred||g.fallback||_.each(i.fallback,function(a){return d(e(f[a]))}),a.thumbIsPreferred=Boolean(g.preferred),a.thumbUrl=g.preferred||g.fallback||null}function f(a){function b(a){return!Boolean(Number(a.format("m")))}var c,d;return c=moment(a.Program.StartTime),d=_.template('<span class="air-date"><%= date %></span> <span class="air-time"><%= time %></span>'),d({date:c.format("M/D"),time:c.format(b(c)?"h A":"h:mm A")})}function g(a){var b=[],c=moment(a.Program.duration),d=moment.duration(c.valueOf()).hours(),e=moment.duration(c.subtract(d,"hour").valueOf()).minutes();return d>0&&b.push(d+"h"),e>0&&b.push(e+"m"),b.join(" ")}function h(a){var b,c,d,e;return b=moment(),c=moment(a.Program.StartTime),d=a.Program.isRecorded,e=c.isBefore(moment().add("days",6))&&c.isAfter(b),d||e}if(_.isUndefined(a.Program))throw"Program attribute is undefined for recording";var i=moment(a.Program.StartTime,"MM-DD-YY HHmmss"),j=moment(a.Program.EndTime,"MM-DD-YY HHmmss");a.Program.StartTime=i.valueOf(),a.Program.EndTime=j.valueOf(),a.Program.ReleaseDate=moment(a.Program.ReleaseDate).valueOf();var k=moment();return a.Program.duration=j.valueOf()-i.valueOf(),a.Program.isRecorded=a.isRecorded,a.Program.isRecording=k.isAfter(i)&&k.isBefore(j),a.Program.isRecordingScheduled=!a.isRecorded,a.isDependable=h(a),a.displayShowTime=f(a),a.displayShowDate=c(a),a.displayDuration=g(a),a.displaySeasonEpisode=d(a),(a.isDependable||b.laBoxUser)&&e(a),a.Program.EpisodeTitle=a.Program.EpisodeTitle||a.Title,a}}]),angular.module("ecomm",["config","onetCookies"]).service("NestService",["$http","$q","User","Config","Cookies",function(a,b,c,d,e){var f=!1,g={data:{accountNumber:"0780173941201",csrId:null,recentOTPAmount:0,recentOTPDate:null,currentBalance:-450.27,amountDue:-450.27,dueDate:null,systemDate:"10/26/2017",dueDays:0,currentStatementDate:null,nextStatementDate:null,customerType:"R",defaultPmNickname:"Atlas6",pastDue:"",pastDueAmount:0,hasScheduledPayment:null,scheduledPayDate:null,scheduledPayAmount:0,scheduledPayNickname:null,scheduledPayCapFailure:"N",hasRecentPayment:"N",recentPayAmount:0,recentPayDate:null,recentPayFailure:"N",recentPayFailureReason:null,creditCardExpiring:null,creditCardExpired:null,hasAutoPay:"N",billCycleStartDate:null,billCycleEndDate:null,payByMailAddress:"P.O. Box 371378",payByMailCity:" Pittsburgh",payByMailState:" PA",payByMailZip:" 15250-7378",hasPaymentMethod:"Y",hasAutoPmtMethod:"N",wipDiscoReason:null,nonPayDisconnect:"N",statementBalance:422.08,wrt:0,memoCredit:-450.27,otpList:[],disco:!1,ledgerDate:"03/15/2017",loadDate:"03/13/2017",preDeAuth:!1,deAuth:!1,ppvInhibit:!1,deAuthStartDate:null,deAuthEndDate:null,ppvFirstInhibitedDate:null,ppvInhibitBalance:null,deAuthBalanceDue:null,ppvInhibitPastDueBalance:null,pastDueAmountWithPpv:0,achAccepted:!1,status:{statusCode:"0000",statusDesc:"description",canAccessBillPay:"Y"}}},h={data:{services:[{packageLevels:[{desc:"iOESP",type:"iOESP"}],desc:"iOESP",type:"iOESP"},{packageLevels:[{desc:"IO",type:"IO"}],desc:"IO",type:"IO"},{packageLevels:[{desc:"BO",type:"BO"}],desc:"VIDEO",type:"VIDEO"},{packageLevels:[{desc:"ONDEMAND",type:"ONDEMAND"}],desc:"ONDEMAND",type:"ONDEMAND"},{packageLevels:[{desc:"OL",type:"OL"}],desc:"OOL",type:"OOL"},{packageLevels:[{desc:"ETHNIC",type:"ETHNIC"}],desc:"ETHNIC",type:"ETHNIC"}],FirstName:"WOODBURY",LastName:"WEBDVR3",AccountNo:"0780173941201",CustomerType:"Test Account",IsSeasonal:!1,ServiceAddress:{StreetName:"CROSSWAYS PK DR",StreetNo:"420",City:"Woodbury",State:"NY",ZIP:"11797"},HomePhoneNo:"5168039694",_embedded:{services:[{packageLevels:[{desc:"iOESP",type:"iOESP"}],desc:"iOESP",type:"iOESP",_embedded:{packageLevels:[{desc:"iOESP",type:"iOESP",_links:{self:{href:"/user/accountinfo/services/iOESP/packageLevel"}}}]},_links:{self:{href:"/user/accountinfo/services/iOESP"}}},{packageLevels:[{desc:"IO",type:"IO"}],desc:"IO",type:"IO",_embedded:{packageLevels:[{desc:"IO",type:"IO",_links:{self:{href:"/user/accountinfo/services/IO/packageLevel"}}}]},_links:{self:{href:"/user/accountinfo/services/IO"}}},{packageLevels:[{desc:"BO",type:"BO"}],desc:"VIDEO",type:"VIDEO",_embedded:{packageLevels:[{desc:"BO",type:"BO",_links:{self:{href:"/user/accountinfo/services/VIDEO/packageLevel"}}}]},_links:{self:{href:"/user/accountinfo/services/VIDEO"}}},{packageLevels:[{desc:"ONDEMAND",type:"ONDEMAND"}],desc:"ONDEMAND",type:"ONDEMAND",_embedded:{packageLevels:[{desc:"ONDEMAND",type:"ONDEMAND",_links:{self:{href:"/user/accountinfo/services/ONDEMAND/packageLevel"}}}]},_links:{self:{href:"/user/accountinfo/services/ONDEMAND"}}},{packageLevels:[{desc:"OL",type:"OL"}],desc:"OOL",type:"OOL",_embedded:{packageLevels:[{desc:"OL",type:"OL",_links:{self:{href:"/user/accountinfo/services/OOL/packageLevel"}}}]},_links:{self:{href:"/user/accountinfo/services/OOL"}}},{packageLevels:[{desc:"ETHNIC",type:"ETHNIC"}],desc:"ETHNIC",type:"ETHNIC",_embedded:{packageLevels:[{desc:"ETHNIC",type:"ETHNIC",_links:{self:{href:"/user/accountinfo/services/ETHNIC/packageLevel"}}}]},_links:{self:{href:"/user/accountinfo/services/ETHNIC"}}}]},_links:{self:{href:"/user/accountinfo"}}}},i={data:{contact_info:[{contactInfoId:"1",sendTo:"5168039562",description:"Preferred Phone #",methodEnabled:!0},{contactInfoId:"2",sendTo:"5169741222",description:"Additional Phone #",methodEnabled:!0},{contactInfoId:"3",sendTo:"hsgggg@gmail.com",description:"Preferred Email",methodEnabled:!1},{contactInfoId:"4",sendTo:"",description:"Additional Email 1",methodEnabled:!1},{contactInfoId:"5",sendTo:"5168039562",description:"Preferred Text",methodEnabled:!0},{contactInfoId:"6",sendTo:"5165909790",description:"Additional Text",methodEnabled:!0},{contactInfoId:"7",sendTo:"",description:"Additional Email 2",methodEnabled:!1}],preferences:[{name:"Proactively inform customers of one-time charges and past due balance prior to popular PPV events.",optIn:!0,prefContactId:"0",backupContactId:"5",categoryId:"1001"},{name:"Order Confirmation Email",optIn:!0,prefContactId:"0",backupContactId:"0",categoryId:"6"},{name:"WIC Email Receipt",optIn:!1,prefContactId:"0",backupContactId:"0",categoryId:"8"},{name:"Appointment reminders for all pending truck rolls (other than tech call before)",optIn:!0,prefContactId:"1",backupContactId:"2",categoryId:"1"},{name:"'All Services Out\" communications",optIn:!0,prefContactId:"6",backupContactId:"6",categoryId:"2"}],_links:{self:{href:"/user/optimumid/webdvr3ad/cpc"}}}},j={count:0,icon:"icon-cart",products:[]},k="nest_cart";
d.getValuesBySelector("endpoint.api.billpay");var l=d.getValuesBySelector("endpoint.api.billpay"),m=d.getValuesBySelector("endpoint.api.user"),n="ecommerce/nest/placeOrder",o="ecommerce/retail/submitOrder",p="retail/createRMA",q="retail/createPackingSlip",r="retail/createOnlineReturn",s="retail/createOnlineReturnLabel",t="nest/getOrdersByStatus?status=",u="nest/updateReviewStatus",v="bpGlobal",w="ebillinfo",x=d.getValuesBySelector("endpoint.api.ecommerce"),y=d.getValuesBySelector("endpoint.api.nestProducts"),z=d.getValuesBySelector("endpoint.api.nestSubscriptions"),A=d.getValuesBySelector("endpoint.api.smarthomeCarousel"),B=d.getValuesBySelector("endpoint.api.nestflags"),C=d.getValuesBySelector("endpoint.api.animationConfig"),D=d.getValuesBySelector("endpoint.api.cmssectionurl"),E=!1,F=!1,G=!1,H=[],I=[],J={name:"",max_discount:"",price:0,discount_percent:"",skus:[]},K=this;this.getCatalogproducts=function(){return E},this.getUserInfoData=function(){return F};var L=function(b,c,d,e,f,g){var h={method:c||"GET",url:b,responseType:e||null,data:d||null,headers:g||null,transformResponse:f||null};return a(h).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})},M=function(){var b=l+v;return a.get(b)},N=function(){var b=l+w+"?accountType=0&system=Portal";return a.get(b)},O=function(a){var b=new Date;b.setTime(b.getTime()+36e5),e.setCookieObject(k,a,{expires:b.toGMTString(),domain:e.BASE_DOMAIN,path:"/"})};this.getProductList=function(a){var c=[];return c.push(L(y,"GET",null,"json")),c.push(L(z,"GET",null,"json")),b.all(c).then(function(b){productCatalog=[];var c=[],d=[];return angular.forEach(b[0].data.products,function(b){if(b.productId=b.name.replace(/\s+/g,"-"),b.type="product",b.price=b.options.models[0].price,a?P(b.options.models,a,b.discount_percent_when_offered_with_other_items):P(b.options.models,"",b.discount_percent_when_offered_with_other_items),b.priceType=b.options.models[0].priceType,b.max_quantity=parseInt(b.max_quantity,10)||50,productCatalog.push(b),b.skus_with_which_this_item_is_offered_as_discounted){J={},subsDetail={},J.name=b.name,J.max_discount=parseInt(b.max_discounted_items_per_order,10),J.discount_percent=b.discount_percent_when_offered_with_other_items,J.price=b.price,J.skus=[];var d=b.skus_with_which_this_item_is_offered_as_discounted.split(",");_.each(d,function(a){-1===J.skus.indexOf(a)&&J.skus.push(a)}),c.push(J)}}),angular.forEach(b[1].data.subscriptions,function(b){b.productId=b.name.replace(/\s+/g,"-"),b.type="subscription",b.price=b.options.models[0].price,a&&P(b.options.models,a,!1),b.max_quantity=parseInt(b.max_quantity,10)||50,subsDetail.name=b.name,subsDetail.max_quantity=b.max_quantity,productCatalog.push(b),d.push(subsDetail)}),H=c,I=d,E=productCatalog,productCatalog},function(a){return a})};var P=function(a,b,c){_.each(a,function(a){for(var d,e="fullprice",f=!1,g=!1,h=0;h<a.opt_pricing.length;h++)null!==a.opt_pricing[h].type?(a.opt_pricing[h].type!==b||f||(d=a.opt_pricing[h],g=!0),"employee"!==b&&"promo"===a.opt_pricing[h].type.toLowerCase()&&null!==a.opt_pricing[h].discount&&(d=a.opt_pricing[h],f=!0)):!f&!g&&(d=a.opt_pricing[h]);var i=a.price,j=a.price;if("percentage"===d.discount_type?j=a.price*(100-d.discount)/100:"price"===d.discount_type&&(j=a.price-d.discount),j<a.price&&(i=j,e=d.type,a.onSale=!0),c){var k=a.price*((100-c)/100);a.promoPrice=k}a.salePrice=i,a.priceType=e,a.discount=d.discount,a.ratecode=d.ratecode})};this.getUserInfo=function(){var a=[];return a.push(M()),a.push(c.getAccountInfo()),a.push(N()),b.all(a).then(function(a){return f?(F=[],F.push(g),F.push(h)):F=a,Q(F[1].data),F},function(a){return f?(F=[],F.push(g),F.push(h),F):a})};var Q=function(a){var b={};a&&a.ServiceAddress&&(b.city=a.ServiceAddress.City,b.state=a.ServiceAddress.State,b.zip=a.ServiceAddress.ZIP,b.address1=a.ServiceAddress.StreetNo+" "+a.ServiceAddress.StreetName,b.address2=a.ServiceAddress.Address2),b.customerName=a.FirstName+" "+a.LastName,a.ServiceAddress=b};this.getCart=function(){if(0===j.products.length){var a=[];e.getCookie(k)&&(a=e.getCookieObject(k)),j.products=a,j.count=0;for(var b=0;b<a.length;b++)j.count=j.count+a[b].quantity}return j},this.resetCart=function(){j={count:0,products:[]}},this.getSubsDetails=function(a){var b=_.find(I,function(b){return b.name===a.name?b:void 0});return b},this.getPromoDetails=function(a){var b=_.filter(H,function(b){return-1!==b.skus.indexOf(a.sku)});return b};var R=function(a,b){for(var c in a){var d=a[c];if(d.name===b.name&&d.option===b.option)return c}return-1},S=function(a,b){var c,d=0;if(b)for(c in a){var e=a[c];"employee"!==e.priceType&&"fullprice"!==e.priceType||-1===b.skus.indexOf(e.sku)||(d+=a[c].quantity)}else for(c in a)d+=a[c].quantity;return d};this.isSubscriptionOnlyOrder=function(){var a=_.find(j.products,function(a){return"subscription"!==a.type});return a?!1:!0},this.addToCart=function(a){var b=0,c=0,d=0,e=function(a){var d=R(j.products,a);if(d>=0)if("promo"===a.type)j.products[d].quantity=j.products[d].quantity+a.quantity<=j.products[d].promo_max_discounted_items_order?j.products[d].quantity+a.quantity:j.products[d].promo_max_discounted_items_order,j.count=S(j.products,"");else{if("subscription"===j.products[d].type){var e=K.getSubsDetails(j.products[d]);j.products[d].quantity+a.quantity<=e.max_quantity?j.products[d].quantity=j.products[d].quantity+a.quantity:c=j.products[d].quantity}else j.products[d].quantity+a.quantity<=j.products[d].max_quantity?j.products[d].quantity=j.products[d].quantity+a.quantity:b=j.products[d].quantity;j.count=S(j.products,"")}else"promo"===a.type?(a.quantity>a.promo_max_discounted_items_order&&(a.quantity=a.promo_max_discounted_items_order),j.count=j.count+a.quantity,j.products.push(a)):(j.count=j.count+a.quantity,j.products.push(a))},f=R(j.products,a);return f>=0&&"subscription"===j.products[f].type&&(d=1),e(a),d||!a.subscription||b||e(a.subscription),d&&!b&&c&&(b=c),O(j.products),b},this.cartTotalCount=function(a){var b=0,c={},d=_.reduce(a,function(a,b){return a+parseFloat(b.salePrice)*parseInt(b.quantity,10)},0);if(c.cartTotal=d,c.totalSavings=X(a),0!==a.length)for(var e=0;e<a.length;e++)b+=a[e].quantity;return c.cartCount=b,c},this.getProductCartDetails=function(a){for(var b="",c=[],d=[],e={},f="",g=0;g<a.length;g++)"product"!==a[g].type?(b=a[g],c.push(b)):(f=a[g],d.push(f));return e.hardwareCart=d,e.subscriptions=c,e.totalSavings=X(d),e},this.updateCartProducts=function(a,b,c){var d,e=0;if(j.count=0,"employee"===a.priceType||"fullprice"===a.priceType){var f=this.getPromoDetails(a);_.each(f,function(f){d=R(b,f),d>=0&&(0!==a.quantity?(e=S(b,f),b[d].quantity=e<=b[d].promo_max_discounted_items_order?e:b[d].promo_max_discounted_items_order):b.splice(d,1),T(b,c))})}d=R(b,a),d>=0&&(0===a.quantity&&b.splice(d,1),T(b,c))};var T=function(a,b){j.count=0;for(var c=[],d=0;d<a.length;d++)j.count=j.count+a[d].quantity,c.push(a[d]);for(var e=0;e<b.length;e++)c.push(b[e]);O(c)};this.removeProductsFromCart=function(a,b,c){var d,e,f=[];if("employee"===a.priceType||"fullprice"===a.priceType){var g=this.getPromoDetails(a);_.each(g,function(g){if(d=R(b,g),d>=0){e=R(b,a),e>=0&&(b.splice(e,1),d=R(b,g));var h=S(b,g);h>0?b[d].quantity=h>b[d].promo_max_discounted_items_order?b[d].promo_max_discounted_items_order:h:b.splice(d,1),j.count=S(b,"");for(var i=0;i<b.length;i++)f.push(b[i]);for(var k=0;k<c.length;k++)f.push(c[k]);j.products=0===b.length?[]:f,O(f)}})}if(e=R(b,a),e>=0){b.splice(e,1),j.count=S(b,"");for(var h=0;h<b.length;h++)f.push(b[h]);for(var i=0;i<c.length;i++)f.push(c[i]);j.products=0===f.length?[]:f,O(f)}return b},this.deleteAll=function(a,b){var c=[];if(productLength=a.length,a.splice(0,productLength),0!==a.length)for(var d=0;d<a.length;d++)c.push(a[d]);if(0!==b.length)for(var e=0;e<b.length;e++)c.push(b[e]);j.count=S(b,""),j.products=0===b.length?[]:c,O(c)},this.setCartStyle=function(a){j.icon="checkout"===a||"order-summary"===a?"icon-cart-lock":"order-success"===a?"icon-cart-check":"icon-cart"},this.getSmarthomeBannerDetails=function(){return L(A,"GET",null,"json")},this.getNestSecurityFlags=function(){var a=B+"?sdfd";return L(a,"GET",null,"json")},this.getCmsSection=function(a){var b=D+a;return L(b,"GET",null,"json")},this.getCmsSection=function(a){var b=D+a;return L(b,"GET",null,"json")},this.getAnimationConfig=function(){return L(C,"GET",null,"json")},this.getAnimationConfig=function(){return L(C,"GET",null,"json")},this.getCartProductDetails=function(a,b){var c=_.map(a.products,function(a){var c=_.find(b,function(b){return b.name===a.name}),d=0,e=c.options.models[0];c.options.models[0].opt_pricing,c.options.models.length>1&&(e=_.find(c.options.models,function(b){return b.name===a.option}));var f=c.options.models[0].price;"promo"===a.type&&(f=c.options.models[0].price*((100-c.discount_percent_when_offered_with_other_items)/100));var g={name:c.name,type:a.type,option:e.name,sku:e.SKU,price:e.price,salePrice:e.salePrice,promoPrice:e.promoPrice,quantity:a.quantity,ratecode:e.ratecode,special_offer_price_desc:e.special_offer_price_desc,special_offer_cart_desc:e.special_offer_cart_desc,size_mini:c.images.detail_images.desktop[0].size_mini,max_quantity:c.max_quantity,priceType:c.options.models[0].priceType,discount:d};return g});return c},this.getSalesTaxRates=function(a,b){var c={sourceApp:"ECOMMERCE",footprint:"OPT",zipCode:b,rateCodes:a};return L(x+"salesTaxByProducts","POST",c,"json").then(function(a){return a.data},function(a){return a})};var U=function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)};this.getOrders=function(){var b=x+"retail/getOrderDetail";return a.get(b)},this.calculateOrderTotal=function(a,b){var c={totalBeforeDiscountAndTax:0,totalDiscountAmount:0,totalSalesTax:0,totalAfterDiscountAndTax:0},d=0,e=10,f=0,g=0,h=0;return _.each(b,function(b){"product"===b.type?(f=b.price*b.quantity,c.totalBeforeDiscountAndTax=c.totalBeforeDiscountAndTax+f,rateCodeTax=_.find(a,function(a){return a.rateCode===b.ratecode}),d=rateCodeTax.taxRate,g=0,h=0,b.quantity>e?(c.totalDiscountAmount=c.totalDiscountAmount+(b.price-b.salePrice)*e,h=b.price*(b.quantity-e)+b.salePrice*e,g=h*d,c.totalSalesTax=c.totalSalesTax+g):(c.totalDiscountAmount=c.totalDiscountAmount+(b.price-b.salePrice)*b.quantity,h=b.salePrice*b.quantity,g=h*d,c.totalSalesTax=c.totalSalesTax+g),b.tax=g,b.cost=h):"promo"===b.type&&(f=b.price*b.quantity,c.totalBeforeDiscountAndTax=c.totalBeforeDiscountAndTax+f,rateCodeTax=_.find(a,function(a){return a.rateCode===b.ratecode}),d=rateCodeTax.taxRate,g=0,h=0,c.totalDiscountAmount=c.totalDiscountAmount+(b.price-b.promoPrice)*b.quantity,h=b.promoPrice*b.quantity,g=h*d,c.totalSalesTax=c.totalSalesTax+g,b.tax=g,b.cost=h)}),c.totalAfterDiscountAndTax=U(c.totalBeforeDiscountAndTax,2)+U(c.totalSalesTax,2)-U(c.totalDiscountAmount,2),c},this.getCheckOutDetails=function(){return G},this.setCheckOutDetails=function(a){G=a},this.getAddressDetails=function(a){var c=[];return c.push(V(a)),b.all(c).then(function(a){if(f){var b=[];return b.push(i),W(b)}return W(a)},function(a){if(f){var b=[];return b.push(i),W(b)}return a})};var V=function(b){return a.get(m+"optimumid/"+b+"/cpc")},W=function(a){var b={},c=a[0]?a[0].data:!1;if(c&&c.contact_info&&c.contact_info.length)for(var d=0,e=c.contact_info.length;e>d;d++)"1"===c.contact_info[d].contactInfoId&&(b.phoneNumber=c.contact_info[d].sendTo),"3"===c.contact_info[d].contactInfoId&&(b.emailAddress=c.contact_info[d].sendTo);return b},X=function(a){var b={totalDiscountAmount:0},c=10,d=0;return _.each(a,function(a){"product"===a.type?(d=0,b.totalDiscountAmount=a.quantity>c?b.totalDiscountAmount+(a.price-a.salePrice)*c:b.totalDiscountAmount+(a.price-a.salePrice)*a.quantity):"promo"===a.type&&(b.totalDiscountAmount=b.totalDiscountAmount+(a.price-a.promoPrice)*a.quantity)}),b};this.submitOrder=function(a,b,c){return a.order.equipments?Y(a,l+n,b,c):(a.order.equipments=[],L(l+n,"POST",a,"json").then(function(a){b(a)},function(a){c(a)}))},this.submitRetailOrder=function(a,b,c){return a.isCreatePayMethod?Y(a,l+o,b,c):L(l+o,"POST",a,"json").then(function(a){b(a)},function(a){c(a)})},this.submitRmaRequest=function(b,c,d){var e=x+p,f={method:"POST",url:e,responseType:"json",data:b};return a(f).then(function(a){c(a)},function(a){d(a)})},this.submitPackingSlipRequest=function(b){var c=x+q,d={method:"POST",url:c,headers:{Accept:"application/pdf"},responseType:"blob",data:b};return a(d)},this.submitOnlRetnRequest=function(b,c,d){var e=x+r,f={method:"POST",url:e,responseType:"json",data:b};return a(f).then(function(a){c(a)},function(a){d(a)})},this.submitRTNLabelRequest=function(b){var c=x+s,d={method:"POST",url:c,headers:{Accept:"application/pdf"},responseType:"blob",data:b};return a(d)},this.getOrdersByStatus=function(a){var b=x+t+a;return L(b,"GET",null,"json",null,{"Cache-Control":"no-cache"})},this.updateReviewStatus=function(a){var b=x+u;return L(b,"POST",a,"json")};var Y=function(a,b,c,d){if("C"===a.methodType||"D"===a.methodType){key="-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: BCPG v1.52\n\nmQENBFZGTI8DCACfFYZmVrkiKzQjR0zBtz42OL6Hr4I+0/iHvujxw+vOxA/G7Cy0\n+28E7/5RgGG1CYJXYEceQEsHyvpEa8ezEzU// aNh6S3FJVM8C7WyWHcmyh4m8IKO\nUGYV0SCyVrz0rGQu+xQu3cvtjBvQ4IL4DIzjR9SoQw0zT+Vp9Gg4yFHSXeCVhqI/\nNIqOtmcNWK/kVBT71k/aQ/NVKtrRKAJIIw22WvGfnNQaLdSWEeTo7NzcsZZd7aDU\ns6zvf5rS2YQvIr9XOq709VM8RbfC14lpAAF1leANGuHnxV9p8EcskmGAH4pslSbs\n4FVNgex88OnC1IA9LqsDjER4lJx3/qNI3T0pABEBAAG0FWViaWxsQGNhYmxldmlz\naW9uLmNvbYkBKAQTAwIAEgUCVkZMnAIbAwKLCQKVCAIeAQAKCRBp0tizpepmNDCJ\nCACBQATvN7NKhc9MomFreNGcbQuCfSEnE0U2v7yFbVaIMEI6RtHThxbt8A2+E5bw\nsqUZ9f/FvOs+4Ivqk79K5MuVIQ+NKqBsi3brz2u2BxyR3SaXVpUlfn1Mt3K2Krga\nvLRH9jz1OK0arwRrQkZMPB0N55Cb0kJlrl20jPjrPKVkXnNdomg/WP7+VaWsXUlt\ntS/3IGsbqnoSpGRgqTg508y+l2bT8myYoaqjk9yEgpkzLMebNKcxfFa4kDdrjf1I\nnHtBcr1CeMzhcvI7Ag+cNkowmIluRyWvcOM/twZaITt2QY6RggIixpR52zPp572X\noq7Nkhxh4AKYwzt9BK7mV8b5uQENBFZGTJwCCACl7z7R1rbiGQ0rA5aRinmSwR8C\nboUoYtwwyTF9fvofoQfQyaiU0Z4LkTU+RJ0XLXFjyfQ/weEuLp+sDiDkzhbKxIha\n6ZnBgaCUCXRsvPq/nb1fqJuxtLyZ8gmYxcCGQkuNNN0LNC5GChV+bhp/Zlra4WzW\nEkjxXbKtKGBU1Vq0v14cMnd1JUXQTVn2brE3SuPkT7WUtTgCpfgoPdJKyep83vnc\nFIKrJXw486haGU6T8xaZSA8rv/7fYK/+958CvqUsOrKqMhZMQhp8wQwUHGDLrvp7\n2/1pGh6bmElCMnEtrWc1HQ6nMEykhed823W4LW9/j5cTMY8x80cOtSV422VXABEB\nAAGJAR8EGAMCAAkFAlZGTJwCGwwACgkQadLYs6XqZjSCfQf/XYhTbLICW84LMFVe\n6L/3FvW0jln8NVguP0jre8X/4lZVW6WfGx0AJKGwN0bmm+YxbJa0V8QK3TJrykuD\nThTD4bWQiEsDBllvXPuF30X8RAhGlb/AgSkksSMBri8ZOpRfD+FrJWMvnI30KFfY\njhWWTgu6Dc2irQtaTG1cmxaAIaFwiS/iQJYFWchHPhxPXZC4Oh4Xk/u2KphR8x0K\nd70L8ibWpEOyocKd4+m+tCJiTs7wkmgvRgm8Ozw8qBV+PVlX/FbWTtHpMyTrZYLb\n6xGsbnaOHtN8dpGYC0LARjXriUZ/g38OX6vL20Ko8QZgn/gHr4EGSa1K0+WJcCGa\n1mSasg==\n=Y9xj\n-----END PGP PUBLIC KEY BLOCK-----\n";var e=openpgp.key.readArmored(key),f=a.paymentAccountNumber.replace(/\s/g,"");openpgp.encryptMessage(e.keys,f).then(function(e){return a.paymentAccountNumber=e,L(b,"POST",a,"json").then(function(a){c(a)},function(a){d(a)})},function(a){return console.log("Encryption of credit card number failed"),d(a)})}};this.getOrderDetails=function(){var c=b.defer(),d=c.promise;return a.get(x+"nest/orders",{params:{sourceApp:"ECOMMERCE",footprint:"OPT",subscription:"ALL"}}).then(function(a){c.resolve(a)},function(a){c.reject(a)}),d.success=function(a){return d.then(a),d},d.error=function(a){return d.then(null,a),d},d}}]),angular.module("epgRating",["config","oolCookie"]).factory("EPGRating",["$http","Config","ooluser",function(a,b,c){var d=b.getValuesBySelector("endpoint.api.ipad")+"userratings/",e=b.getValuesBySelector("endpoint.api.ipad")+"setuserratings/",f={se:"E",deviceId:c.deviceId},g={error:[{StatusCode:-1,StatusDescription:"eventId is required"}]},h={error:[{StatusCode:-2,StatusDescription:"starRating (0 <= starRating <= 4) is required"}]};return{get:function(b,c,e){var h,i={};return c=c||angular.noop,e=e||angular.noop,angular.isString(b)&&(b=parseInt(b,10)),!angular.isNumber(b)||isNaN(b)?(h=angular.copy(g),e(h,400,function(){},{}),h):(a.get(d,{params:angular.extend(f,{eventId:b})}).success(function(a,b,d,e){angular.extend(i,a),c(a,b,d,e)}).error(function(a,b,c,d){e(a,b,c,d)}),i)},set:function(b,c,d,i){var j,k={};return d=d||angular.noop,i=i||angular.noop,angular.isString(b)&&(b=parseInt(b,10)),angular.isString(c)&&(c=parseInt(c,10)),!angular.isNumber(b)||isNaN(b)?(j=angular.copy(g),i(j,400,function(){},{}),j):!angular.isNumber(c)||isNaN(c)||Math.floor(c)!==c||0>c||c>4?(j=angular.copy(h),i(j,400,function(){},{}),j):(a.get(e,{params:angular.extend(f,{eventId:b,userRating:c})}).success(function(a,b,c,e){angular.extend(k,a),d(a,b,c,e)}).error(function(a,b,c,d){i(a,b,c,d)}),k)}}}]),angular.module("errorHandler",[]).provider("errorHandler",[function(){var a;return a=!0,severityMap={ServiceError:"major"},{setShouldLog:function(b){return a=b,this},$get:["$rootScope","$injector",function(b,c){function d(a,c){var d=c?c+" "+a:a;e.error(d),b.error={message:d,type:severityMap[c]}}var e=a?c.get("$log"):{error:angular.noop};return d}]}}]),angular.module("faqService",["config","onetCookies"]).service("FaqService",["$http","$q","Config",function(a,b,c){var d=c.getValuesBySelector("endpoint.api.support_faq"),e="listEnhanced",f="answerDetail",g="products";this.getFaqResults=function(b){var c=d+e+"?site="+b.site;return b.kw&&(c=c+"&kw="+b.kw.toString()),b.product&&b.product.id&&(c=c+"&pid="+b.product.id.toString(),b.product.subId&&(c=c+"&subpid="+b.product.subId.toString())),a.get(c)},this.getAnswerDetails=function(b,c){var e=d+f+"?site="+b+"&aid="+c;return a.get(e)},this.getProducts=function(b){var c=d+g+"?site="+b;return a.get(c)}}]),angular.module("huluService",["config"]).factory("Hulu",["Config","$http",function(a,b){var c={},d=a.getValuesBySelector("endpoint.api.hulu");return c.getHuluURLPromise=function(a){var c={params:{progID:a}};return b.get(d,c).then(function(a){return a.data})},c}]),angular.module("makeSentenceCase",[]).service("MakeSentenceCase",[function(){var a=function(a){var b=a.toLowerCase().replace(/(^\s*\w|[\.\!\?]\s*\w)/g,function(a){return a.toUpperCase()});return b};this.makeSentenceCase=function(b){var c=a(b);return c}}]).filter("makesentencecase",["MakeSentenceCase",function(a){return function(b){return b?"TV"===b?b:"ON DEMAND"===b?"On Demand":a.makeSentenceCase(b):b}}]),angular.module("miniGuideResource",["config","ngCookies","oolCookie","onetCookies","vod"]).factory("MiniGuide",["$http","dateFilter","Config","$cookies","ooluser","$rootScope","$q","Cookies","Vod",function(a,b,c,d,e,f,g,h){var i=c.getValuesBySelector("endpoint.api.epg")+"miniguide";e.laBoxUser=e.hasOOLSession?e.laBoxUser||e.laboxOrMini:"true"===h.getCookie("labox");var j={getHubId:function(a){return e.hasOOLSession?(a.hubId=a.isHD?e.ehubId:e.hubId,a.lineupId=a.isHD?e.elineupId:e.lineupId,a.laBox=e.laBoxUser):(a.laBox="true"===h.getCookie("labox"),epgCookie=h.getCookie("epg"),epgCookie&&epgCookie.length>0&&(epgJson=JSON.parse(epgCookie),a.hubId=epgJson.hubId,a.lineupId=a.laBox?epgJson.laboxLineupId:epgJson.lineupId)),a},getItems:function(c,d,f){function g(a){var b;return angular.isString(a)&&(b=a.match(/^(\d{2})(\d{2})(\d{4})T(\d{2})(\d{2})$/))?new Date(b[3],b[1]-1,b[2],b[4],b[5]):a}function h(a){var b,d,e;if(angular.isObject(a)&&angular.isObject(a.content)&&angular.isArray(a.content.programs))for(b=a.content.programs,d=b.length-1;d>=0;d--)e=b[d],angular.isNumber(e.startTime)&&(e.startTime=new Date(e.startTime),e.endTime=new Date(e.endTime),angular.isNumber(e.eventId)&&(e.href=e.movies||e.sports?"/tv/asset/#/movie/"+e.eventId+"/"+a.content.hubId+"/"+c.isHD:"/tv/asset/#/tvprogram/"+e.eventId+"/"+a.content.hubId+"/"+c.isHD)),angular.isUndefined(e.episodeinfo)&&(e.episodeinfo={title:e.episodeTitle})}function k(){var a;if(angular.isObject(c)){if(angular.isDefined(c.isHD)||(c.isHD=!0),e&&(c=j.getHubId(c)),c.hasOwnProperty("hubId")&&(!angular.isString(c.hubId)&&!angular.isNumber(c.hubId)||""===c.hubId))try{delete c.hubId}catch(d){}if(c.hasOwnProperty("lineupId")&&(!angular.isString(c.lineupId)&&!angular.isNumber(c.lineupId)||""===c.lineupId))try{delete c.lineupId}catch(d){}angular.isString(c.duration)&&c.duration.match(/^\d+$/)&&(c.duration=parseInt(c.duration,10)),angular.isNumber(c.duration)&&angular.isDate(a=g(c.starttime))&&(c.endtime=new Date(a.getTime()),c.endtime.setMinutes(a.getMinutes()+c.duration)),angular.isDate(c.starttime)&&(c.starttime=b(c.starttime,"yyyy-MM-ddTHH:mm")),angular.isDate(c.endtime)&&(c.endtime=b(c.endtime,"yyyy-MM-ddTHH:mm")),angular.isArray(c.callsigns)&&(c.callsigns=c.callsigns.join(","));try{delete c.duration}catch(d){}}return c}function l(){a.get(i,{params:k()}).then(function(a){var b=a.data;h(b),angular.isObject(b.status)&&"501"===b.status.code&&angular.isObject(b.content)&&angular.isArray(b.content.programs)&&b.content.programs.length>0?(angular.extend(m,b),d(b)):f(b)},function(a){f(a.data)})}var m={};return angular.isFunction(c)&&(angular.isFunction(d)&&(f=d),d=c,c={}),d=d||angular.noop,f=f||angular.noop,l(),m}};return j}]),angular.module("moreLikeThisResource",["config","ngCookies","oolCookie"]).factory("MoreLikeThis",["$http","dateFilter","Config","$cookies","ooluser","$rootScope","$q",function(a,b,c,d,e,f,g){var h=c.getValuesBySelector("endpoint.api.ipad")+"morelikethis/",i={get:function(b,c,d){function i(a){return moment(a,"MM-DD-YY HHmm")}function j(a){return angular.isString(a)?a.replace(/[^a-z\d\-]/gi,"-"):a}function k(a){var b,c,d,e,f;if(angular.isObject(a)&&angular.isArray(a.result))for(b=a.result,c=b.length-1;c>=0;c--)d=b[c],angular.isString(d.EndTime)&&moment.isMoment(f=i(d.EndTime))&&(d.endTime=f),angular.isString(d.StartTime)&&moment.isMoment(e=i(d.StartTime))&&(d.startTime=e),d.isMovie=angular.isString(d.ProgramType)&&("TV Movie"===d.ProgramType||"Feature Film"===d.ProgramType||"Short Film"===d.ProgramType),angular.isNumber(d.Id)&&"EVENT"===d.Type&&(d.href="/tv/program/"+d.Id+"/"+d.CallSign+"/"+(d.isMovie?"movie":"episode")+"/"+j(d.Title))}var l={};return c=c||angular.noop,d=d||angular.noop,angular.isNumber(b)||angular.isString(b)&&b.match(/^\d+$/)?e.hasOOLSession?(a.get(h,{params:{eventId:b}}).then(function(a){var b;return angular.isObject(a)&&angular.isString(b=a.data)&&-1!==b.indexOf('<?xml version="1.0" encoding="UTF-8"?><LoginStatus><Status><Code>6</Code><Message>We have performed a scheduled maintenance, please relaunch and log back into the application.</Message></Status></LoginStatus>')||angular.isObject(a)&&angular.isObject(a.data)&&angular.isArray(a.data.error)&&a.data.error.length>0&&1010===a.data.error[0].StatusCode?(f.$broadcast("authenticationHandler:unauthenticated",a),g.reject(a)):a}).then(function(a){var b=a.data;k(b),angular.isArray(b.error)&&b.error.length>0&&angular.isObject(b.error[0])&&"SUCCESS"===b.error[0].StatusDescription&&angular.isArray(b.result)&&b.result.length>0?(angular.extend(l,b),c(b)):d(b)},function(a){d(a.data)}),l):(d({Message:"No session.  Login required.",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),null):(d({Message:"eventId parameter is required",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),null)}};return i}]),angular.module("mostWatchedResource",["config"]).factory("MostWatched",["$http","dateFilter","Config",function(a,b,c){var d=c.getValuesBySelector("endpoint.api.ipad")+"mostwatched/",e={format:"json",hubId:"105"},f=100*Math.floor((new Date).getFullYear()/100),g={getItems:function(b,c,g){function h(a){var b;return angular.isString(a)&&(b=a.match(/^(\d{2})-(\d{2})-(\d{2}) (\d{2})(\d{2})$/))?new Date(f+b[3],b[1]-1,b[2],b[4],b[5]):a}function i(a){var b,c,d,e;if(angular.isObject(a)&&angular.isObject(a.result)&&angular.isArray(a.result.MostWatched))for(b=a.result.MostWatched,console.log("programs in most watched:",b),c=b.length-1;c>=0;c--)d=b[c],angular.isString(d.StartTime)&&angular.isDate(e=h(d.StartTime))&&(d.StartTime=e),angular.isString(d.EndTime)&&angular.isDate(e=h(d.EndTime))&&(d.EndTime=e),angular.isString(d.quals)&&(d.qualifiers=d.quals.split(/,/)),d.isMovie=angular.isString(d.ProgramType)&&("TV Movie"===d.ProgramType||"Feature Film"===d.ProgramType||"Short Film"===d.ProgramType),d.isSeries=angular.isString(d.ProgramType)&&"Series"===d.ProgramType,angular.isNumber(d.EventId)&&(d.href=d.isMovie||"Sports event"===d.ProgramType?"/tv/asset/#/movie/"+d.EventId+"/"+d.CallSign+"/"+d.ChannelNumber:"/tv/asset/#/tvprogram/"+d.EventId+"/"+d.CallSign+"/"+d.ChannelNumber)}var j={};return angular.isFunction(b)&&(angular.isFunction(c)&&(g=c),c=b,b={}),c=c||angular.noop,g=g||angular.noop,a.get(d,{params:angular.extend(b,e)}).success(function(a){i(a),angular.extend(j,a),c(a)}).error(function(a){g(a)}),j}};return g}]),angular.module("moveTransferService",["ngResource"]).factory("MoveTransferService",["$resource","$http",function(){var a={ebillResponse:{},selectedAccountNum:""},b=function(b){a.ebillResponse=b},c=function(b){a.selectedAccountNum=b},d=function(b){a.sysDate=b},e=function(){return a},f=function(){return a.ebillResponse},g=function(){return a.selectedAccountNum};return{setEBillResponse:b,setSystemDate:d,getModel:e,getEbillResponse:f,setSelectedAccountNum:c,getSelectedAccountNum:g}}]),angular.module("movieCart",["onDemandResource"]).factory("movieCart",["OnDemand",function(a){return a.MovieCart}]),angular.module("netflixService",["config"]).factory("Netflix",["Config","$http",function(a,b){var c={},d=a.getValuesBySelector("endpoint.api.netflix_promos"),e=a.getValuesBySelector("endpoint.api.netflix_generate");return c.getPromos=function(){return b.get(d).then(function(a){return a.data})},c.generateURL=function(a){return b.post(e,{promoID:a}).then(function(a){return a.data})},c}]),angular.module("networkSettings",["ngResource","config"]).factory("networkSettings",["$resource","Config","$http","$q",function(a,b,c,d){function e(a,b,d,e){return b=b||angular.noop,d=d||angular.noop,e=e||angular.noop,c.post(i,a,{params:{contentType:"json",deviceId:a.deviceId,deviceType:"STB"}}).then(function(a){var c;angular.isObject(a)&&200===a.status&&angular.isObject(c=a.data)&&angular.isObject(c=c.status)&&angular.isString(c=c.message)?"VALID"===c?b(a):"INVALID"===c?d(a):e(a):e(a)})}var f=b.getValuesBySelector("endpoint.api.ipad")+"getNetworkSettings.jsp",g=b.getValuesBySelector("endpoint.api.ipad")+"setNetworkSettings.jsp",h=b.getValuesBySelector("endpoint.api.ipad")+"copyNetworkSettings.jsp",i=b.getValuesBySelector("endpoint.api.ipad")+"validatePIN.jsp",j={contentType:"json",deviceType:"STB"},k=function(){},l=a(g,j);return k.get=function(a,b,e){var g=new k;return angular.isFunction(a)&&(e=b,b=a,a={}),b=b||angular.noop,e=e||angular.noop,c.get(f,{params:angular.extend({},j,a||{})}).then(function(a){return angular.isString(a.data)&&(a.data={message:a.data}),a.status>=200&&a.status<300&&angular.isObject(a.data)&&angular.isObject(a.data.status)&&("0"===a.data.status.code||0===a.data.status.code)?a:d.reject(a)},function(a){return angular.isString(a.data)&&(a.data={message:a.data}),a.status>=200&&a.status<300&&angular.isObject(a.data)&&angular.isObject(a.data.status)&&("0"===a.data.status.code||0===a.data.status.code)?a:d.reject(a)}).then(function(a){angular.extend(g,a.data),b(g,a.headers)},e),g},k.prototype.$save=function(a,b){var c=this;return a=a||angular.noop,b=b||angular.noop,l.prototype.$save.apply(this.content,[function(d){angular.isObject(d.status)&&"SUCCESS"===d.status.message?(angular.extend(c,d),a.apply(this,Array.prototype.slice.apply(arguments))):b.apply(this,Array.prototype.slice.apply(arguments))},b])},k.save=l.save,k.copy=function(a,b,d,e,f){return e=e||angular.noop,f=f||angular.noop,angular.isString(a)&&""!==a?angular.isString(b)&&""!==b?angular.isObject(d)?c.post(h,d,{params:{contentType:"json",sourceDeviceId:a,targetDeviceId:b,deviceType:"STB"}}).success(e).error(f):(f("settings is required"),void 0):(f("to device id is required"),void 0):(f("from device id is required"),void 0)},k.validatePCPIN=function(a,b,c,d,f){return angular.isString(a)&&""!==a?angular.isString(b)&&""!==b?(e({deviceId:a,settings:[{setting:[{value:[b],group:"device",name:"parental_control_pin"}],type:"Parental Controls"}]},c,d,f),void 0):(f("pin is required"),void 0):(f("device id is required"),void 0)},k.validatePurchasePIN=function(a,b,c,d,f){return angular.isString(a)&&""!==a?angular.isString(b)&&""!==b?(e({deviceId:a,settings:[{setting:[{value:[b],group:"device",name:"purchase_pin"}],type:"Purchasing"}]},c,d,f),void 0):(f("pin is required"),void 0):(f("device id is required"),void 0)},k}]),angular.module("onDemandResource",["config","oolCookie","alertModal","l","onetCookies"]).factory("OnDemand",["$http","$q","Config","$log","ooluser","alertModal","l","Cookies",function(a,b,c,d,e,f,g,h){function i(){"undefined"!=typeof reporting&&(s.events="event9",reporting.click())}function j(){}function k(a){return angular.isArray(a)?_.map(a,l):(angular.isObject(a)&&(angular.isObject(a.filteredAssetList)&&angular.isArray(a.filteredAssetList.assets)&&a.filteredAssetList.assets.length>0&&(a.filteredAssetList.assets=k(a.filteredAssetList.assets)),angular.isArray(a.assets)&&(a.assets=k(a.assets)),angular.isObject(a.ribbonList)&&angular.isArray(a.ribbonList.ribbons)&&_.each(a.ribbonList.ribbons,function(a){angular.isArray(a.assets)&&(a.carouselItems=_.map(a.assets,function(a){return l(a).toCarouselItem()}))})),void 0)}function l(a){var b;if(angular.isString(a.endDt))try{a.endDate=moment(a.endDt,"MM/DD/YYYY HH:mm:ss").toDate()}catch(c){}return(angular.isNumber(b=a.price)||angular.isString(a.price)&&a.price.match(/^\d+(?:\.\d*)?$/)&&angular.isNumber(b=parseFloat(a.price)))&&(a.priceBadge=0===b?0:"$"+b),_.extend(new j,a)}e.laBoxUser=e.hasOOLSession?e.laBoxUser||e.laboxOrMini:"true"===h.getCookie("labox");var m,n,o=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getFilters",p=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getNewlyOnDemand",q=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getRibbons",r=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getTopCategories",t=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getCategoryDetail",u=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getAssetsByFilter",v=(c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getAssetsById",c.getValuesBySelector("endpoint.api.vodwebapp")+"getCartDetailsByIds"),w=c.getValuesBySelector("endpoint.api.vodonyximage"),x=c.getValuesBySelector("endpoint.api.vodimage"),y="?"+(new Date).getTime(),z=!1,A={},B={},C=[],D=[],E={ids:[],assets:[],carouselItems:[],stale:(new Date).getTime()},F={},G={},H=function(a){var b,c,d=["MPAA-NC-17"];if(angular.isArray(a))for(b=0;b<a.length;b++)c=a[b],angular.isObject(c)&&(angular.isString(c.rating)&&_.contains(d,c.rating)?(a.splice(b,1),b--):251409===c.id&&(a.splice(b,1),b--));else angular.isObject(a)&&(a.hasOwnProperty("filteredAssetList")?H(a.filteredAssetList):a.hasOwnProperty("assets")?H(a.assets):angular.isObject(a.ribbonList)&&angular.isArray(a.ribbonList.ribbons)&&_.each(a.ribbonList.ribbons,function(a){angular.isArray(a.assets)&&H(a.assets)}))};return n=function(){var f={method:"GET",cache:!1,headers:{"Content-Type":"application/json; charset=utf-8"}},g=angular.extend({},f,{cache:!0}),h=function(b,e,g){var h=c.getValuesBySelector("endpoint.api.vodwebapp")+"moviecartremove/",i={};e=e||angular.noop,g=g||angular.noop,b?(i.assetId=b,a.get(h,_.extend(f,{params:i})).success(function(a,b,c,f){angular.isObject(a)&&angular.isArray(a.error)&&a.error.length>0&&angular.isObject(a.error[0])&&angular.isString(a.error[0].StatusDescription)&&"SUCCESS"===a.error[0].StatusDescription?(d.log("Removed to movie cart"),e(a,b,c,f)):g(a,b,c,f)}).error(function(a,b,c,e){d.error(a,b,c,e),g(a,b,c,e)})):g("Error: No assetId provided")},j={contains:function(a,b,c){angular.isObject(E)&&null!==E&&!E.stale?b(_.where(E.ids,{AssetId:a}).length>0||_.where(E.assets,{id:a}).length>0):j.getItems(function(c){angular.isObject(c)&&angular.isArray(c.ids)&&b(_.where(c.ids,{AssetId:a}).length>0||_.where(c.assets,{id:a}).length>0)},c)},getItems:function(f,h,i,j){function k(a){return _.isObject(a)
}var l=c.getValuesBySelector("endpoint.api.vodwebapp")+"getCartItemsCount",n=(new Date).getTime();return f=f||angular.noop,h=h||angular.noop,e.hasOOLSession?(angular.isNumber(E.stale)&&(y="?"+E.stale),a.get(l+y,g).then(function(a){return k(a.data)?a:b.reject(a.data)}).then(function(a){function b(){function b(){E.assets.length>E.ids.length&&(E.assets.length=E.ids.length),E.carouselItems.length>E.ids.length&&(E.carouselItems.length=E.ids.length),_.each(a.data.result.cartElements,function(a,b){if(F.hasOwnProperty(a.AssetId)){if(j&&b>=j)return!1;E.assets[b]=F[a.AssetId],E.carouselItems[b]=F[a.AssetId].toCarouselItem()}})}var c=[];if(z)return d.log("Already hydrating"),void 0;if(z=!0,angular.isObject(a)&&angular.isObject(a.data)&&angular.isObject(a.data.result)&&angular.isArray(a.data.result.cartElements))if(_.each(a.data.result.cartElements,function(a,b){if(!F.hasOwnProperty(a.AssetId)){if(j&&b>=j)return!1;c.push(a.AssetId)}}),c.length>0)m.getByIds(c,function(c){if(angular.isObject(c)&&angular.isArray(c.assets)){for(_.each(a.data.result.cartElements,function(a){var b=_.filter(c.assets,{id:a.AssetId});0===b.length?d.warn("No asset data for asset id",a.AssetId):(F[a.AssetId]=b[0],b.length>1&&d.warn("Found more than one asset for asset id",a.AssetId,b))}),b();C.length>0;)C.pop()(E);D.length=0}else{for(;D.length>0;)D.pop()(c);C.length=0}z=!1},function(){for(z=!1;D.length>0;)D.pop().apply(this,Array.prototype.slice.apply(arguments));C.length=0});else{for(b(),z=!1;C.length>0;)C.pop()(E);D.length=0}}E.stale=E.stale&&(E.stale<n?!1:E.stale),angular.isObject(a)&&angular.isObject(a.data)&&angular.isObject(a.data.result)&&angular.isArray(a.data.result.cartElements)?(E.ids.length=0,_.each(a.data.result.cartElements,function(a){E.ids.push(a)})):(E.ids.length=0,E.assets.length=0,E.carouselItems.length=0),i?(C.push(f),D.push(h)):f(E),b()},function(a){h(a)}),void 0):(h({Message:"No session.  Login required.",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),void 0)},addItem:function(b,e,g){var h=c.getValuesBySelector("endpoint.api.vodwebapp")+"moviecartadd/",k={};e=e||angular.noop,g=g||angular.noop,b?(k.assetId=b,a.get(h,_.extend(f,{params:k})).success(function(a,b,c,f){var h;angular.isObject(a)&&angular.isArray(a.error)&&a.error.length>0&&angular.isObject(a.error[0])?h=a.error[0]:angular.isObject(a)&&angular.isObject(a.error)&&angular.isObject(a.error.MobileResponse)&&(h=a.error.MobileResponse),angular.isObject(h)&&angular.isString(h.StatusDescription)&&"SUCCESS"===h.StatusDescription?(d.log("Added to movie cart"),i(),E.stale=(new Date).getTime(),j.getItems(),e(a)):g(a,b,c,f)}).error(function(a,b,c,e){d.error(a,b,c,e),g(a,b,c,e)})):g("Error: no assetId provided")},removeMultipleItems:function(a,b,c,d){function e(){var b=null;a.length>0?(b=a.shift(),angular.isObject(b)&&b.hasOwnProperty("id")&&(b=b.id),angular.isString(b)&&b.match(/^\d+$/)&&(b=parseInt(b,10)),angular.isNumber(b)?h(b,function(a,c,f,g){i.removed.push(b),d(i,a,c,f,g),e()},function(a,c,e,g){i.failed.push(b),d(i,a,c,e,g),f(a,c,e,g)}):(i.failed.push(b),d(i,data,status,headers,config),f("Expected asset id to be a Number, numeric String, or Object with 'id' property"))):g()}function f(a,b,d,e){E.stale=(new Date).getTime(),j.getItems(),c(i,a,b,d,e)}function g(){E.stale=(new Date).getTime(),j.getItems(),b(i)}var i={removed:[],failed:[],remaining:[]};b=b||angular.noop,c=c||angular.noop,d=d||angular.noop,angular.isNumber(a)&&(a=[a]),angular.isArray(a)&&a.length>0?(a=angular.copy(a),i.remaining=a,e()):c(i,"Error: No assetId provided")},removeItem:function(a,b,c){b=b||angular.noop,h(a,function(a,c,d,e){E.stale=(new Date).getTime(),j.getItems(),b(a,c,d,e)},c)}};return j}(),j.prototype.getArtwork=function(){return x+this.id+"?deviceName=iPad&artName=VOD%20-%20POSTERS"},j.prototype.getNewArtwork=function(){return w+this.logo+"&size=242x363&alt_size=272x363"},j.prototype.cart=function(){var a=this;return angular.isUndefined(this._inCartObject)&&(this._inCartObject={}),n.contains(this.id,function(b){a._inCartObject.inCart=b,a._inCartObject.notInCart=!b}),this._inCartObject},j.prototype.addToCart=function(a,b){var c=this;n.addItem(this.id,function(){c.cart(),angular.isFunction(a)&&a.apply(this,Array.prototype.slice.apply(arguments))},b)},j.prototype.removeFromCart=function(a,b){var c=this;n.removeItem(this.id,function(){c.cart(),angular.isFunction(a)&&a.apply(this,Array.prototype.slice.apply(arguments))},b)},j.prototype.toCarouselItem=function(){var a,b,c=this,d={label:e.laBoxUser?"Add to Favs":"Add to Cart",icon:e.laBoxUser?"icon-heart":"icon-shopping-cart",action:function(){var a=function(){n.addItem(c.id,function(){b.buttons=[h]},function(){f.create({message:g.cart.errorInitiallyAddingItem,ctas:[{label:g.cart.buttonTryAgainSimple,result:"retry"}]}).then(function(b){"retry"===b&&a()})})};a()}},h={label:"Remove",icon:"onet-icons-remove",action:function(){var a=function(){n.removeItem(c.id,function(){b.buttons=[d]},function(){f.create({message:g.cart.errorRemovingItem,ctas:[{label:g.cart.buttonTryAgainSimple,result:"retry"}]}).then(function(b){"retry"===b&&a()})})};a()}};return angular.isObject(this._carouselItem)?b=this._carouselItem:G.hasOwnProperty(this.id)?b=this._carouselItem=G[this.id]:(b={title:this.title,callsign:this.pcl,artwork:this.getArtwork()},void 0===b.callsign||""===b.callsign||null===b.callsign?(b.href="/tv/asset/#/movie/"+this.id,b.action=function(){document.location=b.href}):(b.href="/tv/asset/#/episode/"+this.id,b.action=function(){document.location=b.href}),this._carouselItem=G[this.id]=b,(angular.isNumber(a=this.price)||angular.isString(this.price)&&this.price.match(/^\d+(?:\.\d*)?$/)&&angular.isNumber(a=parseFloat(this.price)))&&(b.priceBadge=0===a?0:"$"+a),n.contains(this.id,function(a){b.buttons=[a?h:d]}),b)},m={MovieCart:n,getByIds:function(b,c,d){var e={};return c=c||angular.noop,d=d||angular.noop,angular.isNumber(b)&&(b=[b]),angular.isArray(b)&&0!==b.length?(a.post(v,{assetIdList:b,pageNum:1,pageSize:b.length,sortField:"A-Z"}).success(function(a,b,d,f){k(a),angular.extend(e,a),c(a,b,d,f)}).error(function(a,b,c,e){d(a,b,c,e)}),e):(d("Error: no ids provided"),null)},getFilters:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(o).success(function(a,e,f,g){"OK"===a.message&&angular.isObject(a.filterList)&&angular.isArray(a.filterList.filters)?(angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d},addAssetMethodsToAsset:l,getRibbons:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(q).success(function(a,e,f,g){"OK"===a.message?(H(a),k(a),angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d},getTopCategories:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(r).success(function(a,e,f,g){"OK"===a.message?(angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d},getCategoryDetail:function(b,c,d){var e={};return c=c||angular.noop,d=d||angular.noop,angular.isObject(b)?(a.post(t,b).success(function(a,b,f,g){"OK"===a.message?(angular.extend(e,a),c(a,b,f,g)):d(a,b,f,g)}).error(function(a,b,c,e){d(a,b,c,e)}),e):(d("Request object is required."),{})},getByFilters:function(b,c,d){var e,f,g,h={};if(c=c||angular.noop,d=d||angular.noop,angular.isObject(b)&&angular.isDefined(b.categoryId)&&!angular.isNumber(b.categoryId)&&(!angular.isString(b.categoryId)||!b.categoryId.match(/^\d+$/)))try{delete b.categoryId}catch(i){}return!angular.isObject(b)||(!angular.isArray(b.filterIds)||b.filterIds.length<1||!(angular.isNumber(b.filterIds[0])||angular.isString(b.filterIds[0])&&b.filterIds[0].match(/^\d+$/)))&&angular.isUndefined(b.categoryId)?(d("Error: no filterIds nor categoryId provided"),null):(e=_.extend({},{pageSize:"100",pageNum:"1",includeIndex:"true"},b),A.hasOwnProperty(f=angular.toJson(e))?(g=A[f],angular.extend(h,g.data),c(g.data,g.status,g.headers,g.config)):B.hasOwnProperty(f)?(B[f].successes.push(c),B[f].errors.push(d),h=B[f].result):(B[f]={successes:[c],errors:[d],result:h},a.post(u,e).success(function(a,b,c,d){for(H(a),k(a),angular.extend(h,a),A[f]={data:a,status:b,headers:c,config:d};B[f].successes.length>0;)B[f].successes.pop()(a,b,c,d);try{delete B[f]}catch(e){}}).error(function(a,b,c,d){for(;B[f].errors.length>0;)B[f].errors.pop()(a,b,c,d);try{delete B[f]}catch(e){}})),h)},getForNetwork:function(b,c,d){var e={};return c=c||angular.noop,d=d||angular.noop,angular.isString(b)?(b=b.toUpperCase(),a.get(o).success(function(f){var g,h,i;if(angular.isObject(f)&&"OK"===f.message&&angular.isObject(f.filterList)&&angular.isArray(h=f.filterList.filters)){for(g=h.length-1;g>=0;g--)angular.isObject(h[g])&&angular.isString(h[g].filterValue)&&h[g].filterValue.toUpperCase()===b&&(i=h[g].filterId);angular.isUndefined(i)?d("No filter found for callsign "+b,f):a.post(u,{filterIds:[i],pageSize:"100",pageNum:"1"}).success(function(a,b,d,f){H(a),k(a),angular.extend(e,a),c(a,b,d,f)}).error(function(a,b,c,e){d(a,b,c,e)})}else d("Malformed response from filter call",f)}).error(function(a,b,c,e){d(a,b,c,e)}),e):(d("Error: no callsign provided"),null)},getNewlyOnDemand:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(p).success(function(a,e,f,g){"OK"===a.message&&angular.isArray(a.assets)?(H(a),k(a),angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d}}}]),angular.module("onetCookies",[]).factory("Cookies",[function(){var a={},b=window.location.hostname.split(".");return a.BASE_DOMAIN=b.length<2?"."+window.location.hostname:"."+b[b.length-2]+"."+b[b.length-1],a.getCookie=function(a){for(var b=escape(a),c=document.cookie.split(";"),d=c.length,e=0;d>e;e++){var f=$.trim(c[e]);if(0===f.lastIndexOf(b+"=",0))return unescape(f.split("=")[1])}return null},a.getCookieObject=function(b){var c=a.getCookie(b);return null!=c?$.parseJSON(c):null},a.setCookie=function(a,b,c){if(!_.isObject(c))throw"Cookies.setCookie options must be provided";var d="",e=c.path;if(_.isUndefined(e))throw"Cookies.setCookie path must be provided. Use null if current path desired";_.isUndefined(c.expires)||(d+="; expires="+c.expires),_.isNull(e)||(d+="; path="+e),_.isUndefined(c.domain)||(d+="; domain="+c.domain),document.cookie=escape(a)+"="+escape(b)+d},a.setCookieObject=function(b,c,d){var e=JSON.stringify(c);a.setCookie(b,e,d)},a.deleteCookie=function(b,c){c.expires=new Date(0).toGMTString(),a.setCookie(b,"",c)},a}]),angular.module("oolCookie",["ngCookies","config","userLogin"]).factory("ooluser",["$cookies","Config","userLogin","$log",function(a,b,c,d){var e="x-ooluser",f={MILLI_TO_SECONDS:1e3,SECONDS_IN_HOUR:3600,SESSION_IN_MILLIS:3888e6},g={},h={},i={},j={},k=function(a){var c=!1,d=b.getValuesBySelector("cookie.expirationTimeToCheck"),e=(new Date).getTime(),g=e/f.MILLI_TO_SECONDS,h=g-a,i=Math.round(h/f.SECONDS_IN_HOUR);return i>=d&&(c=!0),c},l=function(a){var b=new Date(a).toUTCString();return b},m=function(a){var b=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1"),c=angular.toJson(a),d=(new Date).getTime()+f.SESSION_IN_MILLIS,e=l(d),g=escape("oolp_")+"="+escape(c)+";path=/;domain="+b+";expires="+e;return g},n=function(a){return angular.fromJson(a)},o=function(){return{hasOOLSession:!1}};try{if(a.oolp_&&!a.ools_)g=o(),window.location.replace(b.getValuesBySelector("link.processSignout")+"?referer="+encodeURIComponent(window.location));else if(a.oolp_){g=angular.fromJson(a.oolp_);try{h=angular.fromJson(a.oolpe_),g.laboxOrMini=!1,g.io&&(g.tv={},g.tv.serviceLevel=h.tv.sl.split("+").join(" "),g.tv.box=h.tv.bx,g.tv.eq=h.tv.eq,g.laboxOrMini=g.laboxUser||"mini"===g.tv.eq),g.ool&&(g.internet={},g.internet.serviceLevel=h.internet.sl.split("+").join(" "),g.internet.upSpeed=h.internet.up.split("+").join(" "),g.internet.downSpeed=h.internet.dwn.split("+").join(" "),g.internet.devices=h.internet.dv,g.internet.entitlement=h.internet.updwnEntlmt,g.internet.equip=[],g.internet.equip=h.internet.eq,g.internet.equip.forEach(function(a){null===a.type||void 0===a.type||"gateway"!==a.type.toLowerCase()&&"router"!==a.type.toLowerCase()?a.type&&"stream"===a.type.toLowerCase()&&(g.internet.stream=!0):(g.internet.equipModel=a.model,g.internet.equipType=a.modType,g.internet.equipSvc=a.service,g.internet.smartWifi=a.smartWifi)}))}catch(p){g.tv={},g.internet={}}try{i=angular.fromJson(a.ox),g.ox=i.ox}catch(p){}try{j=angular.fromJson(a.sncr),g.sncr=j.sncr}catch(p){}g.t&&k(g.t)&&c.refreshOoluserCookie().then(function(a){var b=decodeURIComponent(a.headers()[e]);g=n(b),g.hasOOLSession=!0,document.cookie=m(g),g.p&&g.p.bp&&1===g.p.bp&&(g.hasBPAccess=!0),g.p&&g.p.disco&&1===g.p.disco&&(g.isDisco=!0)},function(){d.warn("cookie NOT refreshed successfully")}),g.hasOOLSession=!0,g.p&&g.p.bp&&1===g.p.bp&&(g.hasBPAccess=!0),g.p&&g.p.disco&&1===g.p.disco&&(g.isDisco=!0)}else g=o()}catch(q){d.error(q),g=o()}return g.isDisconnected=function(a){this.hasOwnProperty("status")&&g.status!==!0?a(this.status):this._userService.isDisconnected().then(function(b){angular.isObject(b)&&b.hasOwnProperty("data")&&b.data.hasOwnProperty("disconnected")&&(g.status=b.data.disconnected,document.cookie=m(g),a(b.data.disconnected))},function(){})},g}]),angular.module("outageService",["config","oolCookie","userService","predictableJSONP"]).factory("Outage",["$http","Config","ooluser","User","$q","PredictableJSONP",function(a,b,c){var d=function(){var d=b.getValuesBySelector("endpoint.api.cablesupport");b.getValuesBySelector("endpoint.api.outage_proxy"),angular.fromJson;var e=c.eoid?c.eoid:"",f={GET_OUTAGES:"outage/notification"},g=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return null})};this.logNotificationData=function(a,c,d){var e=b.getValuesBySelector("endpoint.api.cablesupport"),f=e+"/log/servicestatus",i={symptom:a,services:c,confirmOutage:d};return g(f,"POST",i,h,{"Content-Type":"application/json"})};var h=function(a){return a};this.getOutagesPromise=function(){var a=d+f.GET_OUTAGES+"?eoid="+e+"&callback=JSON_CALLBACK"+"&_="+(new Date).getTime();return g(a,"JSONP",null,null,null)},this.getProcessedOutagePromise=_.once(function(){return a.get(d+f.GET_OUTAGES+"?eoid="+e).then(function(a){var b=a.data;return b},function(){var a={outageStatus:"error",accountSummary:null,plannedMaintenance:null,outageMessage:null};return a})});var i={NO_OUTAGE:"No outage",OUTAGE_ON_ACCOUNT:"Service outage",OFFLINE:"Equipment offline",NON_PAY:"Your account is past due",VOD_HOLD:"Your account is past due",PLANNED_MAINTENANCE:"Network maintenance",NODE_DISTRESS:"Brief service interruption detected",RECENTLY_CLEARED:"Service restored","USER NOT LOGGED IN":"Check your service status here",ERROR:""},j={menu:{},alert:{},banner:{"USER NOT LOGGED IN":"Sign in to check your service status.",RECENTLY_CLEARED:"Service restored",NO_OUTAGE:"No outage",OFFLINE:"Equipment offline",OUTAGE_ON_ACCOUNT:"Service outage",NODE_DISTRESS:"Brief service interruptions detected",PLANNED_MAINTENANCE:"Network maintenance",NON_PAY:"Your account is past due",VOD_HOLD:"Your account is past due",ERROR:"Your service status is not available at this time. Please try again later."}},k=b.getValuesBySelector("link.cdn.images")+"/",l={ERROR:"Customer_not_authenticated_question_mark.png",OUTAGE_ON_ACCOUNT:"Outage_exclamation_point.png",RECENTLY_CLEARED:"icon_thumbsup_accent.png",NO_OUTAGE:"icon_check.png",OFFLINE:"Device_offline_tools.png","USER NOT LOGGED IN":"Customer_not_authenticated_question_mark.png",PLANNED_MAINTENANCE:"icon_cone.png",NODE_DISTRESS:"icon_node.png",NON_PAY:"Outage_exclamation_point.png",VOD_HOLD:"Outage_exclamation_point.png"};this.outageCopy=function(a,b){return j[a][b]||i[b]},this.outageIcon=function(a){var b=l[a];return b?k+b:null}};return new d}]),angular.module("payBillUtils",["payBillResource"]).factory("PayBillUtils",["$rootScope","PayBillService",function(a,b){var c={success:{general:"Completed successfully.",addPaymentMethod:"Added Payment Method successfully.",updatePaymentMethod:" updated successfully.",deletePaymentMethod:" has been successfully deleted."},error:{general:"This information is not currently available. Please try again later"}},e={normal:{scheduled:{single:{msg:"This payment method is used for a scheduled payment.",option1:"Use another payment method for the scheduled payment.",option2:"Delete the scheduled payment."},multiple:{msg:"This payment method is used for scheduled payments.",option1:"Use another payment method for the scheduled payments.",option2:"Delete the scheduled payments."}},auto:{msg:"This payment method is used for your monthly automatic payments.",option1:"Use another payment method for my automatic payments.",option2:"Cancel my automatic payments."},both:{single:{msg:"This payment method is used for a scheduled payment and your monthly automatic payments.",option1:"Use another payment method for the scheduled payment and monthly automatic payments.",option2:"Delete the scheduled payment and cancel monthly automatic payments."},multiple:{msg:"This payment method is used for scheduled payments and your monthly automatic payments.",option1:"Use another payment method for the scheduled payments and monthly automatic payments.",option2:"Delete the scheduled payments too and cancel monthly automatic payments."}}},lastPayment:{scheduled:{single:{msg:"Deleting this payment method will also delete your scheduled payment."},multiple:{msg:"Deleting this payment method will also delete your scheduled payments."}},auto:{msg:"Deleting this payment method will also delete your future monthly automatic payments."},both:{single:{msg:"Deleting this payment method will also delete your scheduled payment and your future monthly automatic payments."},multiple:{msg:"Deleting this payment method will also delete your scheduled payments and your future monthly automatic payments."}}}},f={computeDaysRemaining:function(a,b,c){var d=a-this.calculateDayDiff(b,c);return d},parseDate:function(a){if(a&&a.indexOf(" ")>0&&(a=a.substring(0,a.indexOf(" "))),a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null},addMonths:function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate());return c.setMonth(a.getMonth()+b),c},addDays:function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate());return c.setDate(c.getDate()+b),c},dateToString:function(a){return this.checkAppendZero(a.getMonth()+1)+"/"+this.checkAppendZero(a.getDate())+"/"+a.getFullYear()},sortDate:function(a,b){var c=a.payDate,d=b.payDate;return a.date&&b.date&&(c=a.date,d=b.date),f.parseDate(c)>f.parseDate(d)?-1:c===d?a.ledgerSeq&&b.ledgerSeq&&parseInt(a.ledgerSeq,10)>parseInt(a.ledgerSeq,10)?1:-1:1},payMethodType:function(a,b){switch(a.toLowerCase()){case"cc":if(b)switch(b.toLowerCase()){case"v":return"Visa";case"m":return"Master Card";case"a":return"Amex";case"d":return"Discover"}return"Credit Card";case"ba":return"Checking account"}},recordOmniture:function(){s.linkTrackVars="eVar41, events",s.linkTrackEvents="event 2",s.eVar41="Movers",s.events="event 2",reporting.click()},calculateDayDiff:function(a,b){var c=864e5,d=Math.round((b-a)/c);return d},calculateLastDay:function(a,b){var c=new Date(b,a+1,0);return c=c.getDate()},checkAppendZero:function(a){return isNaN(a)||(a=parseInt(a,10)),10>a?"0"+a:String(a)},isEqual:function(a,b){return a&&b||a===b?(a=$.trim(String(a).toUpperCase()),b=$.trim(String(b).toUpperCase()),a!==b?!1:!0):!1},checkValidString:function(a){return a&&""!==a?!0:!1},getURLParameter:function(a){var b=window.location.search.substring(1);if("ppi"===a&&b.substr(0,3)===a)return this.decryptParams(decodeURI(b.substr(4)));for(var c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}return""},clearAllMessages:function(a,b,c){a.mainSuccess=!1,a.successMsg="",a.mainError=!1,a.mainErrorMsg="string"!=typeof a.mainErrorMsg?[]:"",a.popupError=!1,a.popupErrorMsg="",a.popupSuccess=!1,a.popupSuccessMsg="",b&&(a.addError=!1,a.addErrorMsg=""),c&&(a.editError=!1,a.editErrorMsg="",a.deleteError=!1,a.deleteErrorMsg="")},dataStatus:{NOT_STARTED:0,IN_PROGRESS:1,ERROR:2,SUCCESS:3},getDeletePopupMessage:function(){return e},createAutoPayDate:function(a){if(a.dueDate){var b=a.dueDate.split("/").join("").substr(2,2),c=a.sysDate,d=c.split("/").join("").substr(2,2),e=c.split("/").join("").substr(0,2),f=a.paydaysInAdvance,g=a.paydayofMonth;isNaN(g)&&g.length>=3&&(g=g.slice(0,-2),g=Number(g));var h=a.dueDate.split("/").join(""),i=h.substr(2,2);i=Number(i);var j=h.substr(0,2),k=h.substr(6,2);return d=Number(d),f&&"advance"===a.transferModel.datePM?(i-=f,d>i&&(12===j?(j=1,k+=1):j=j>e?j:Number(e)+1),d===i&&(i=Number(i)+1),i>d&&(i>b?i=b:j=j>e?j:e),10>j&&(j="0"+String(Number(j))),10>i&&i>0&&(i="0"+String(i))):g&&(g>i?g>d?(i=g,j=j>e?j:e):(j=Number(e)+1,i=b):i>g&&(i=g,10>i&&(i="0"+String(i)),d>i&&(12===j?(j=1,k+=1):(j=Number(e)+1,10>j&&(j="0"+String(j)))),h=j+"/"+i+"/"+k),i===g&&(e>j&&(j=e),h=j+"/"+i+"/"+k)),h=j+"/"+i+"/"+k}},decryptParams:function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);b[c]=d>=33&&126>=d?String.fromCharCode(33+(d+14)%94):String.fromCharCode(d)}return b.join("")},getMessageConfig:function(a,b,c,d){return data={message:b,type:a},c&&(data.ctas=[],data.ctas.push(c)),d&&(data.actionAlert=!0),data},alert:function(a,b,c,d){(!d.pageAlerts||d.pageAlerts.length>0)&&(d.pageAlerts=[]),d.pageAlerts.push(this.getMessageConfig(a,b,c,!0)),d.alertFlag=String(d.pageAlerts.length)===d.alertFlag?"_c"+String(d.pageAlerts.length):String(d.pageAlerts.length)},alertObject:function(a,b){for(var c=!1,d=0;d<b.pageAlerts.length;d++)if("success"===b.pageAlerts[d].type){c=!0;break}c&&b.pageAlerts.splice(d,1),b.pageAlerts.push(a),b.alertFlag=String(b.pageAlerts.length)===b.alertFlag?"_c"+String(b.pageAlerts.length):String(b.pageAlerts.length)},addToAlerts:function(a,b,c,d,e){e&&d.pageAlerts&&d.pageAlerts.length>0&&d.pageAlerts[0].actionAlert?(d.pageAlerts[0].type=a,d.pageAlerts[0].message=b,c&&(d.pageAlerts[0].ctas=[],d.pageAlerts[0].ctas.push(c))):d.pageAlerts.push(this.getMessageConfig(a,b,c,e)),d.alertFlag=d.alertFlag===String(d.pageAlerts.length)?"_c"+String(d.pageAlerts.length):String(d.pageAlerts.length)},addErrorToAlerts:function(a,b){b||(b=c.error.general),this.addToAlerts("major",b,null,a,!0),a.pageAlerts.reverse()},addSuccessToAlerts:function(a,b){this.addToAlerts("success",b,null,a,!0),a.pageAlerts.reverse()},addSuccessLeafToAlerts:function(a,b){this.addToAlerts("successLeaf",b,null,a,!0),a.pageAlerts.reverse()},formatDate:function(a){return a.indexOf(" ")>0&&(a=a.substring(0,a.indexOf(" "))),3===a.split("/").length&&4===a.split("/")[2].length?this.checkAppendZero(a.split("/")[0])+"/"+this.checkAppendZero(a.split("/")[1])+"/"+a.split("/")[2].substring(2,4):a},unFormatDate:function(a){return 3===a.split("/").length&&2===a.split("/")[2].length?this.checkAppendZero(a.split("/")[0])+"/"+this.checkAppendZero(a.split("/")[1])+"/"+"20"+a.split("/")[2]:a},checkUnAuthorized:function(){var a=!0,b=document.cookie;null!==b&&(b=unescape(b));for(var c=b.split(";"),d=0;d<c.length;d++){var e=c[d].split("="),f=e[0];f=f.replace(" ","");var g=e[1];if("oolp_"===f&&g&&""!==g&&(g=JSON.parse(g),g.p&&1===g.p.bp))return!1}return a},pageScope:0,currency:function(a,b){var c=b?"$0.00":"$0";return null===a||""===a||void 0===a?a:(a=a.toString(),a.split("$").length>0&&(a=a.split("$").join("")),a=parseFloat(a),0===a?c:0>a?"-$"+Math.abs(a).toFixed(2):a>0?"$"+a.toFixed(2):c)},removeChars:function(a,b){return String(a).split(b).join("")},initModel:function(a,b,c){if(model={},this.checkUnAuthorized()&&(window.location="/pay-bill/unauthorized/"),this.pageScope=a,model.mainError=!1,model.mainErrorMsg="",model.addError=!1,model.addErrorMsg="",model.editError=!1,model.editErrorMsg="",model.successMsg="",model.mainSuccess=!1,model.apiError=!1,model.mandatoryAPIData=this.dataStatus.NOT_STARTED,a.currency=this.currency,a.hidePageError=!1,a.pageAlerts=[],a.alertFlag="0",a.model=model,a.stubMode=!1,model.popupError=!1,model.popupErrorMsg="",model.popupSuccess=!1,model.popupSuccessMsg="",b||c){for(a.addNewPayment=!1,model.addDebit=!1,model.monthOptions={0:"MM"},a.isDebitCardType=!1,a.customerName="",model.bankName="",i=1;13>i;i++)model.monthOptions[String(i)]=10>i?"0"+String(i):String(i);for(model.yearOptions={0:"YY"},d=parseInt(String((new Date).getFullYear()).substr(2,2),10),i=d;d+20>i;i++)model.yearOptions[String(i)]=String(i);for(model.stateOption={},stateName=["---","NY","NJ","CT","PA","AL","AK","AZ","AR","CA","CO","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","ME","MA","MI","MN","MS","MO","MT","NE","NV","NH","NM","NC","ND","OH","OK","OR","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],i=0;i<stateName.length;i++)model.stateOption[String(stateName[i])]=String(stateName[i]);b&&(a.addPayModel={},a.addPayModel.showPayType=!0,a.addPayModel.paymentOption=!1,model.payNickname_BA="",model.paymentTypeOptions={NA:"Select a payment method",BA:"Checking Account",CC:"Credit/Debit Card"}),c&&(a.editPayModel={},a.editPayment=!1,model.deleteError=!1,model.deleteErrorMsg="",a.deletePayment=!1,a.currentPaymentMethod={})}return model},handleErrorResponse:function(b,d){var e=c.error.general;d||(d={}),d.mandatory&&(b.apiError=!0,b.mandatoryAPIData=this.dataStatus.ERROR),d.message&&(e=d.message),d.add?(b.addErrorMsg=e,b.addError=!0):d.edit?(b.editErrorMsg=e,b.editError=!0):d.popup?(b.popupErrorMsg=e,b.popupError=!0):d.deletePopup?(b.deleteErrorMsg=e,b.deleteError=!0):d.mandatory||(b.mainError=!0,d.errorArr||b.mainErrorMsg&&"string"!=typeof b.mainErrorMsg?b.mainErrorMsg.push(e):b.mainErrorMsg=e,a&&a.$$childHead&&(this.addErrorToAlerts(a.$$childHead,e),a.$$childHead.Pagesubmit=!1,a.$$childHead.showSpinner=!1)),d.scroll&&this.scrollToError(d.scroll)},handleSuccessfullResponse:function(a,b,c){model=b.model;var d=function(a){if(c.osc&&c.osc.length&&c.osc.length>0){for(var b=0;b<c.osc.length;b++)if(a===c.osc[b])return!0;return!1}};c||(c={}),c.noClear||this.clearAllMessages(model,!0,!0);var e=0;return a&&(a.responseInfo?e=a.responseInfo:a.status&&(e=a.status)),e&&e.statusCode&&(0===parseInt(e.statusCode,10)||d(parseInt(e.statusCode,10)))?(c.update&&b.updatePayments(),c.popup?model.popupSuccess=!0:c.noClear||(model.mainSuccess=!0),c.scroll&&this.scrollToError(c.scroll),!0):c.summary?!0:(e&&e.message&&e.message.mainmsg?c.message=e.message.mainmsg:e&&e.statusDesc&&(c.message=e.statusDesc),this.handleErrorResponse(model,c),!1)},checkDefaultSuccess:function(a){return a&&(responseObj=null,a.responseInfo?responseObj=a.responseInfo:a.status&&(responseObj=a.status),responseObj.statusDesc&&"the operation completed successfully"!==responseObj.statusDesc)?responseObj.statusDesc:null},handleSuccessMessage:function(a,c){if(c&&a.responseInfo.message){var d=new Date;d.setTime(d.getTime()+12e4);var e="; expires="+d.toGMTString()+"; path=/",f=a.responseInfo.message;document.cookie="confResponse="+escape(JSON.stringify(f))+e,""===f&&b.clear_cookie("confResponse")}},identifyResponseType:function(a){var b=null;return b="00000"===a?"success":"000017"===a?"failure":"partial"},identifyPayMethodType:function(a,b,c){var d={payMethodName:"",hasAutoPay:!1,hasOTP:!1,hasMultipleOTP:!1,hasScheduledAutoPay:!1,noOfOTP:0,isLast:!1,deleteMessageType:""};if(a&&b&&c&&b.paymentMethods){if(d.payMethodName=a,1===b.paymentMethods.length&&(d.isLast=!0),b.hasAutoPay)for(var e=0;e<b.paymentMethods.length;e++)if(b.paymentMethods[e].payMethodName===a&&b.paymentMethods[e].isAutoPayment){d.hasAutoPay=!0;break}c.scheduledAutoPayment&&c.scheduledAutoPayment.payNickname===a&&(d.hasScheduledAutoPay=!0);var f=c.scheduledOTPayments;d.noOfOTP=$.grep(f,function(b){return b.payNickname===a}).length,d.noOfOTP>0&&(d.hasOTP=!0,d.noOfOTP>1&&(d.hasMultipleOTP=!0))}return d},computeActiveAcctEbillInfo:function(a,b){var c;if(b&&b.ebillInformationOutputs)for(var d=0;d<b.ebillInformationOutputs.length;d++)if(b.ebillInformationOutputs[d].accountNum===a){c=b.ebillInformationOutputs[d];break}return c},computeFromAcctEbillInfo:function(b){var c;if(a.acctDetail){var d=this.getObjInArrayByValue(a.acctDetail,"active",!0),e=d.accountType;if(b&&b.ebillInformationOutputs&&d){if(2===e||3===e)return activeAcctEbillInfo;for(var f=0;f<b.ebillInformationOutputs.length;f++)if(b.ebillInformationOutputs[f].isFrom!==!0);else{c=b.ebillInformationOutputs[f];var g=this.getObjInArrayByValue(a.acctDetail,"accountNumber",c.accountNumber);if(0===e&&2===g.accountType||1===e&&3===g.accountType)return c}}}return c},computeToAcctEbillInfo:function(a){var b;if(a&&a.ebillInformationOutputs)for(var c=0;c<a.ebillInformationOutputs.length;c++)if(a.ebillInformationOutputs[c].isFrom===!1){b=a.ebillInformationOutputs[c];break}return b},getObjInArrayByValue:function(a,b,c){var d;if(a)for(var e=0;e<a.length;e++)if(a[e][b]===c){d=a[e];break}return d},getPayMethodClassifier:function(a){return a.deleteMessageType=a.isLast?"lastPayment":"normal",a.hasAutoPay&&a.hasOTP?(a.deleteMessageType+="_both",a.deleteMessageType+=a.noOfOTP>1?"_multiple":"_single"):!a.hasAutoPay&&a.hasOTP?(a.deleteMessageType+="_scheduled",a.deleteMessageType+=a.noOfOTP>1?"_multiple":"_single"):a.hasAutoPay&&!a.hasOTP&&(a.deleteMessageType+="_auto"),a},getDeleteMessages:function(a){var b={msg:null,option1:null,option2:null};if(a.deleteMessageType)switch(a.deleteMessageType){case"normal_scheduled_single":b=e.normal.scheduled.single;break;case"normal_scheduled_multiple":b=e.normal.scheduled.multiple;break;case"normal_auto":b=e.normal.auto;break;case"normal_both_single":b=e.normal.both.single;break;case"normal_both_multiple":b=e.normal.both.multiple;break;case"lastPayment_scheduled_single":b=e.lastPayment.scheduled.single;break;case"lastPayment_scheduled_multiple":b=e.lastPayment.scheduled.multiple;break;case"lastPayment_auto":b=e.lastPayment.auto;break;case"lastPayment_both_single":b=e.lastPayment.both.single;break;case"lastPayment_both_multiple":b=e.lastPayment.both.multiple}return b},isEmail:function(a){var b=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)},checkForCancel:function(){window.location.href="/pay-bill"},truncateName:function(a){var b=25;return isMobile()&&(b=20),a&&a.length>b?(nameArr=a.split("-"),nameArr&&nameArr.length>0&&!isNaN(nameArr[nameArr.length-1])&&nameArr[nameArr.length-1].length<=4?a.substring(0,b-8)+"...-"+nameArr[nameArr.length-1]:a.substring(0,b-3)+"..."):a},truncateBPLandingName:function(a){var b=20;isMobile()&&(b=20);var c=$("#checkTablet").is(":visible");return c||(b=8),a&&a.length>b?(nameArr=a.split("-"),nameArr&&nameArr.length>0&&!isNaN(nameArr[nameArr.length-1])&&nameArr[nameArr.length-1].length<=4?a.substring(0,b-8)+"...-"+nameArr[nameArr.length-1]:a.substring(0,b-3)+"..."):a},scrollToError:function(a){var b=($("div"),$("#"+a));b&&$("html, body").animate({scrollTop:40},"slow")},formatAccountNumber:function(a){var b=13;if(null==a||a.toString().length!==b)return a;var c=/^(\d{5})(\d{6})(\d{2}$)/.exec(a);return a=c[1]+"-"+c[2]+"-"+c[3]},unFormatAccountNumber:function(a){return a&&a.split(" ")&&a.split(" ").length>0&&(a=a.split(" ").join("").split("-").join("")),a},getReferrerDomain:function(){var a="";return document.referrer&&(a=document.referrer.split("/").slice(2,3).join("/")),a},isPrevDomainSame:function(){var a=this.getReferrerDomain(),b=!1;return document.domain&&a?document.domain.toUpperCase()===a.toUpperCase()&&(b=!0):(-1!==navigator.appVersion.indexOf("MSIE 7")||-1!==navigator.appVersion.indexOf("MSIE 8"))&&(b=!0),b},get_cookie:function(a){var b=a+"=",c="";return document.cookie.length>0&&(offset=document.cookie.indexOf(b),-1!==offset&&(offset+=b.length,end=document.cookie.indexOf(";",offset),-1===end&&(end=document.cookie.length),c=unescape(document.cookie.substring(offset,end)))),c},clear_cookie:function(a){document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"
},changeInputType:function(a,b){var c={from:"text",to:"tel"},d=$("#"+a),e=d.html();b=b?$.extend({},c,b):c,"number"===b.to&&b.min&&b.max&&(b.to+='" min="0" max="10000'),d&&e&&e.split('type="'+b.from+'"').join('type="'+b.to+'"')},clearAddPayForm:function(a){a.addPayModel.routNum="",a.addPayModel.paymentAccountNumber_BA="",a.model.nameOnAccount_BA=a.customerName,a.model.saveAddtoProfile_BA=!1,a.model.payNickname_BA="",a.model.nameOnAccount_CC=a.customerName,$("#cardInputField").val(""),$("#cardInputField").removeClass("cards--visa").removeClass("cards--mastercard").removeClass("cards--discover").removeClass("cards--amex").removeClass("cards--invalid"),a.model.addMonth="0",a.model.addYear="0",a.cardValidated=!1,a.model.saveAddtoProfile_CC=!1,a.model.addDebit=!1,a.isDebitCardType=!1,a.showDebitCheck=!1,a.model.payNickname_CC="",$("#addCCPayName").val(""),a.model.isDiffBilling=!1,a.addPayModel.addrLine1="",a.addPayModel.addrLine2="",a.addPayModel.city="",a.addPayModel.state="---",a.addPayModel.zip="",a.model.addError=!1},reloadPersistedPage:function(){window.onpageshow=function(a){a.persisted&&window.location.reload()}},roundOff:function(a){return"-"===a.substring(0,1)?(a=a.substring(2),a=Number(a).toFixed(2),a="$"+a+" "+"cr"):"$"===a.substring(0,1)&&(a=a.substring(1),a=Number(a).toFixed(2),a="$"+a),a}};return f}]),angular.module("payBillResource",["config"]).factory("PayBillService",["$http","Config","$rootScope",function(a,b,c){function e(a,b){return a&&a.length>b?!0:!1}function f(a){return a&&a.length<=13?!0:!1}function g(a){return isNaN(a)&&(a=parseInt(a,10)),10>a?"0"+a:String(a)}function h(a){if(a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null}window.sjcl&&window.sjcl.random&&0===window.location.pathname.toLowerCase().indexOf("/pay-bill")&&window.sjcl.random.startCollectors();var j=b.getValuesBySelector("endpoint.api.billpay"),k={system:"Portal"},l=function(){},m={responseInfo:{statusCode:"00055",currMonAutoPayDate:"11-11-2013"}},n={responseInfo:{statusCode:"00000",statusDesc:"This could be the result of your credit limit being exceeded, or the credit card is no longer valid.\n If you feel your Payment Method is correct, please try your payment again later.",statusType:"Consolidated AMSS",message:{mainmsg:"This could be the result of your credit limit being exceeded, or the credit card is no longer valid. If you feel your Payment Method is correct, please try your payment again later.",intro:"Oops.  We are unable to process your request.",outro:"If you are still experiencing difficulty, contact us at Customer Support.",additionalInfo:null,linkText:"Contact Us",linkURL:"/support/contact-us/"}},confirmNumber:null},o={getBillSummaryReturn:{responseInfo:null,billStatements:[{billAmount:"$162.94",billCloseDate:"03/15/2014",billDueDate:"03/30/2014",documentKey:"07862201403C241405016R",inserts:[],payments:[]}]},payments:[]},p={nameOnAccount:"Please enter your full name",creditCard:"Please enter a valid credit card number",payNickname:"Please enter a nickname",addrLine1:"Please enter an address",city:"Please enter a city",zip:"Please enter a valid zip code",routNum:"Incorrect format:<br>Please enter a valid routing number",accountNumber:"Please enter a valid account number",nameForAccount:"Please enter valid name for account",emailId:"Please enter a valid email id",dueAmount:"Please enter more than amount due",otherAmount:"Minimum payment of $1 is required",morethanotherAmount:"The payment amount entered is greater than the maximum allowed"},q={latestBill:"This is your latest billing statement, but may not reflect recent account activity after this bill was issued.",billingPeriod:"Lorem ipsum dolor sit amet",paymentReceived:"Lorem ipsum dolor sit amet",paymentsThankYou:"Lorem ipsum dolor sit amet",remainingBalance:"Lorem ipsum dolor sit amet",totalMonthlySavings:"Lorem ipsum dolor sit amet",remainingBalanceSubtotal:"Lorem ipsum dolor sit amet",payments:"Lists payments that you've made.  Recent payments may not be reflected here ",additionalOutlet:"This is for receiving premium channels on additional outlets in your home.",onDemand:"Shows On Demand and Pay Per View Purchase",tax_fees:"This section lists any applicable taxes and fees for services provided.",sports:"A monthly sports programming surcharge that is a direct result of continually rising sports programming costs.",mutltiPdtDsct:"A monthly discount given to customers who maintain the required levels of TV, Phone, and Internet service.",otherActivity:"Any credits and/or debits to your account.",partialMnthActvty:"Charges and/or credits for any change, addition or removal of service that occurred during your billing cycle."},r={success:{general:"Completed successfully.",addPaymentMethod:"Added payment method successfully.",updatePaymentMethod:" updated successfully.",deletePaymentMethod:" has been successfully deleted.",deleteOther:{changeScheduled:"Your scheduled payment will now use ",changeScheduledMulti:"Your scheduled payments will now use ",changeAuto:"All future monthly automatic payments will now use ",deleteScheduled:"Your scheduled payment has been deleted.",deleteScheduledMulti:"Your scheduled payments have been deleted.",deleteAuto:"All future monthly automatic payments have been cancelled",changeBoth:"All future monthly automatic payments and scheduled payment will now use ",changeBothMulti:"All future monthly automatic payments and scheduled payments will now use ",deleteBoth:"All future monthly automatic payments and scheduled payment have been cancelled",deleteBothMulti:"All future monthly automatic payments and scheduled payments have been cancelled"},deletePayment:"Your payment has been successfully deleted.",acctActivityMsg:"Visit the <a href = '/pay-bill/account-activity' class = 'color-secondary'>Account activity</a> page to manage scheduled payments.",optout:{autoPayDefault:"You have successfully cancelled automatic payments.",paperlessBilling:"You have successfully cancelled paperless billing.  Your next available statement will be mailed to your billing address."},emailUpdate:"Your email preferences have been successfully updated."},error:{general:"This information is not currently available. Please try again later",optout:{automaticPayments:"Cannot opt out of autopay because this option is not set for this account. Click on cancel to continue.",paperlessBilling:"Cannot opt out of paperless billing because this option is not set for this account. Click on cancel to continue.",noOption:"No opt out of service selected. Click on cancel to continue."},paymentOptions:{invalidPayment:"Sorry, this payment is invalid. Please click on cancel to continue.",autopayUpdate:"Incorrect values cannot update the scheduled auto pay payment. Please click on cancel to continue."},defaultPayFailure:{responseInfo:{statusCode:"<<errorCode>>",statusDesc:"We are unable to process your request at this time.",statusType:"Consolidated AMSS",message:{mainmsg:"We seem to be experiencing technical difficulties. Please try again later.",intro:"We are unable to process your request at this time.",outro:"If you continue to experience difficulty, please contact us at customer support.",additionalInfo:null,linkText:"Contact Us",linkURL:"/support/contact-us/"}}}}};validateZip=function(a){return a&&5===a.length&&!isNaN(a)?!0:!1};var s={stubMode:!1,requestInProgress:!1,currentServiceEnd:"",get_cookie:function(a){var b=a+"=",c="";return document.cookie.length>0&&(offset=document.cookie.indexOf(b),-1!==offset&&(offset+=b.length,end=document.cookie.indexOf(";",offset),-1===end&&(end=document.cookie.length),c=unescape(document.cookie.substring(offset,end)))),c},clear_cookie:function(a){document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},services:{EBILL_INFO:"ebillinfo",BP_GLOBAL:"bpGlobal",SUMMARY:"summary",BILL_FILE:"billfile",CARD_INFO:"cardinfo",BANK_INFO:"bankinfo",CREATE_PM:"createpaymethod",UPDATE_PM:"updatepaymethod",REMOVE_PM:"removepaymethod",OT_PAYMENT:"submitotpayment",UPDATE_OT_PAYMENT:"updateotpayment",REMOVE_OT_PAYMENT:"removeotimepayment",CREATE_AUTO_PAYMENT:"createautopayment",UPDATE_AUTO_PAYMENT:"updateautopayment",UPDATE_SCH_AUTO:"updateScheduledAutoPayment",REMOVE_AUTO_PAYMENT:"removeautopayment",SCHEDULED_PAYMENTS:"scheduledpayments",SERVICE_ADDRESS:"serviceAddress",UPDATE_COMM:"updateprefcom",UPDATE_COMM_NEW:"updateprefcomNew",CREATE_AUTO_NEW:"createautopaymethodNew",UPDATE_AUTO_NEW:"updateAutoPayNew",OT_PAYMENT_NEW:"submitotpaymentNew",UPDATE_OT_PAYMENT_NEW:"updateotpaymentNew",UPDATE_SCH_AUTO_NEW:"updateScheduledAutoPaymentNew",MOVE_TRANSFER:"moveTransferPaymentSettings",TOGGLE_ACCOUNT:"toggleAccount",GET_XML:"xmlbillfile",GET_XMLSUM:"xmlsummary",GET_PAYMENT_HISTORY:"getPaymentHistory"},accountNumber:function(a){l(a)},getTodayDate:function(){return d=new Date,d.getMonth()+1+"/"+d.getDate()+"/"+d.getFullYear()},getFirstDate:function(){return d=new Date,d.getMonth()+1+"/01/"+d.getFullYear()},dateToString:function(a){return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()},checkTrailingZero:function(a){return g(a)},getTotalDaysInMonth:function(a,b){return a=parseInt(a,10),b=parseInt(b,10),new Date(b,a,0).getDate()},initModel:function(){for(model={},model.monthOptions={0:"MM"},model.yearOptions={0:"YY"},model.stateOption={},model.personal={},model.mainError=!1,model.mainErrorMsg="",model.addError=!1,model.addErrorMsg="",model.editError=!1,model.editErrorMsg="",model.paymentTypeOptions={BA:"Checking Account",CC:"Credit/Debit Card"},i=1;13>i;i++)model.monthOptions[String(i)]=String(i);for(d=parseInt(String((new Date).getFullYear()).substr(2,2),10),i=d;d+20>i;i++)model.yearOptions[String(i)]=String(i);for(stateName=["---","NY","NJ","CT","PA","AL","AK","AZ","AR","CA","CO","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","ME","MA","MI","MN","MS","MO","MT","NE","NV","NH","NM","NC","ND","OH","OK","OR","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],i=0;i<stateName.length;i++)model.stateOption[String(stateName[i])]=String(stateName[i]);for(personalType=["Personal","Business"],i=0;i<personalType.length;i++)model.personal[personalType[i][0]]=String(personalType[i]);return model},getPaymentMethod:function(a,b){model=b.model,b.model.editError=!1,b.model.editErrorMsg="",model.isEditDiffBilling=!1;for(var c=0;c<b.activeAcctEbillInfo.paymentMethods.length;c++)if(paymentMethod=b.activeAcctEbillInfo.paymentMethods[c],paymentMethod.payMethodName.toLowerCase()===a.toLowerCase())return b.editPayModel.payType=paymentMethod.accountType,b.editPayModel.nameOnAccount=paymentMethod.nameOnAccount,b.editPayModel.oldPayNickname=a,b.editPayModel.newPayNickname=a,b.editPayModel.cardAccountNumber=paymentMethod.paymentAccountNumber.substring(paymentMethod.paymentAccountNumber.length-4,paymentMethod.paymentAccountNumber.length),b.editPayModel.displayCardNumber="Ending in "+b.editPayModel.cardAccountNumber,b.editPayModel.isDefault=paymentMethod.isDefault,"CC"===b.editPayModel.payType?(paymentMethod.expDate&&4===paymentMethod.expDate.length&&(month=parseInt(paymentMethod.expDate.substring(0,2),10),model.editMonth=String(month),model.editYear=String(paymentMethod.expDate.substring(2,4)),b.editPayModel.addrLine1=paymentMethod.addrLine1,b.editPayModel.addrLine2=paymentMethod.addrLine2),b.editPayModel.city=paymentMethod.city,b.editPayModel.state=paymentMethod.state,b.editPayModel.zip=paymentMethod.zip,b.editPayModel.debitCapable=paymentMethod.debitCapable,b.editPayModel.methodType=paymentMethod.methodType):b.editPayModel.newPayNickname=a,paymentMethod},get_addData:function(a){var b={};return model=a.model,b.system="Portal",this.get_cookie("wg")&&(b.isWalledGarden=!0),b.payType=a.addPayModel.payType,"BA"===b.payType?(b.paymentAccountNumber=a.addPayModel.paymentAccountNumber_BA,b.accountType=a.model.personalType,b.nameOnAccount=a.model.nameOnAccount_BA,b.routNum=a.addPayModel.routNum,b.payNickname=a.model.payNickname_BA):(b.paymentAccountNumber=$("#cardInputField").val().split(" ").join(""),b.nameOnAccount=a.model.nameOnAccount_CC,b.payNickname=$("#addCCPayName").val(),b.expDate=g(a.model.addMonth)+"/"+a.model.addYear,b.methodType="C",a.model.addDebit&&(b.methodType="D"),b.isDebitCapable=a.isDebitCardType?!0:!1,b.cardType=a.addPayModel.cardType,model.isDiffBilling&&(b.addrLine1=a.addPayModel.addrLine1,b.addrLine2=a.addPayModel.addrLine2,b.city=a.addPayModel.city,b.state=a.addPayModel.state,b.zip=a.addPayModel.zip)),0===a.numPaymentMethods&&(b.defaultInd=1),b},get_autopayData:function(a,b){var c={};return c.payNickname=a.pmSelected,c.isTCAccepted=a.model.tcAcceptanceStatus,c.isAchAccepted=a.achAccepted,"due"!==a.model.amountPM?c.fixAmount=String(a.otherAmount).split("$").join(""):a.model.maxAmount&&(c.capAmount=String(a.maxAmount).split("$").join("")),"advance"===a.model.datePM?c.payDaysInAdvance=a.model.dueDateSelected:"dom"===a.model.datePM&&(b?c.payDayOfMonth=a.model.dateOnMonthSelected:c.payDay=a.model.dateOnMonthSelected),c},get_editData:function(a){var b={system:"Portal",defaultInd:1};return b.payNickname=a.editPayModel.oldPayNickname,b.nameOnAccount=a.editPayModel.nameOnAccount,b.payType=a.editPayModel.payType,b.payNickname!==a.editPayModel.newPayNickname&&(b.newPayNickname=a.editPayModel.newPayNickname),b.defaultInd=a.editPayModel.isDefault?1:0,"CC"===b.payType&&(b.expDate=g(model.editMonth)+"/"+a.model.editYear,model.isEditDiffBilling&&(b.addrLine1=a.editPayModel.addrLine1,b.addrLine2=a.editPayModel.addrLine2,b.city=a.editPayModel.city,b.state=a.editPayModel.state,b.zip=a.editPayModel.zip),a.editPayModel.debitCapable&&(b.methodType=a.editPayModel.methodTypeStatus?"D":"C")),b},get_deleteData:function(a){var b={};return angular.extend(b,k),b.payNickname=a,b},get_otData:function(a,b,c){var d={};return angular.extend(d,k),c||b||(d.isTCAccepted=a.model.tcAcceptanceStatus),this.get_cookie("wg")&&(d.isWalledGarden=!0),a.showAddPM?(currentPM=a.model.paymentMethodOptions[a.model.paymentMethod],angular.extend(d,this.get_addData(a)),delete d.payNickname,"Add account"===currentPM&&a.model.bankName&&(d.companyName=a.model.bankName)):d.payNickname=a.pmSelected,c||(d.isImmediate=0),"now"===a.dateSelected?(c||(d.isImmediate=1),d.payDate=a.systemDate):(d.payDate=a.dateSelected,d.payDate!==a.systemDate||c?h(d.payDate)<h(a.systemDate)&&(d.payDate=a.systemDate,c||(d.isImmediate=1)):d.isImmediate=1),b&&(d.paymentID=a.paymentID),a.amountSelected&&(d.payAmount=String(a.amountSelected).split("$").join("")),a.isIntlPostPaid&&(d.isIntlPostPaid=a.isIntlPostPaid),d},getValidationError:function(a){return p[a]},resetEditBtn:function(a){a.showDebitCheck=!0,a.model.addDebit=!0},getServerResponses:function(){return r},getToolTipsValues:function(){return q},validate_addForm:function(a){switch(a.model.addError=!1,a.model.addErrorMsg="",a.addPayModel.payType){case"CC":if(!e(a.model.nameOnAccount_CC,0))return a.model.addErrorMsg=p.nameOnAccount,a.model.addError=!0,!1;if(!a.cardValidated)return a.model.addErrorMsg=p.creditCard,a.model.addError=!0,!1;if(!e($("#addCCPayName").val(),0))return a.model.addErrorMsg=p.payNickname,a.model.addError=!0,!1;if(a.model.isDiffBilling){if(!e(a.addPayModel.addrLine1,0))return a.model.addErrorMsg=p.addrLine1,a.model.addError=!0,!1;if(!e(a.addPayModel.city,0))return a.model.addErrorMsg=p.city,a.model.addError=!0,!1;if(!validateZip(a.addPayModel.zip))return a.model.addErrorMsg=p.zip,a.model.addError=!0,!1}break;case"BA":if(!e(a.addPayModel.routNum,0)||isNaN(a.addPayModel.routNum)||9!==a.addPayModel.routNum.length)return a.model.addErrorMsg=p.routNum,a.model.addError=!0,!1;if(!e(a.addPayModel.paymentAccountNumber_BA,3)||isNaN(a.addPayModel.paymentAccountNumber_BA))return a.model.addErrorMsg=p.accountNumber,a.model.addError=!0,!1;if(!e(a.model.nameOnAccount_BA,0))return a.model.addErrorMsg=p.nameOnAccount,a.model.addError=!0,!1;if(!e(a.model.payNickname_BA,0))return a.model.addErrorMsg=p.payNickname,a.model.addError=!0,!1}return!0},validate_editForm:function(a){if(a.model.editError=!1,a.model.editErrorMsg="",!e(a.editPayModel.nameOnAccount,0))return a.model.editErrorMsg=p.nameOnAccount,a.model.editError=!0,!1;if(!e(a.editPayModel.newPayNickname,0))return a.model.editErrorMsg=p.payNickname,a.model.editError=!0,!1;switch(a.editPayModel.payType){case"CC":if(a.model.isDiffBilling){if(!e(a.editPayModel.addrLine1,0))return a.model.editErrorMsg=p.addrLine1,a.model.editError=!0,!1;if(!e(a.editPayModel.city,0))return a.model.editErrorMsg=p.city,a.model.editError=!0,!1;if(!validateZip(a.editPayModel.zip))return a.model.editErrorMsg=p.zip,a.model.editError=!0,!1}break;case"BA":}return!0},checkAddForm:function(a){switch(model=a.model,a.addPayModel.payType){case"CC":if(a.addPaymentBtnClicked)return!0;if(e(a.model.nameOnAccount_CC,0)&&a.cardValidated&&"0"!==model.addMonth&&"0"!==model.addYear){if(!a.model.isDiffBilling)return!1;if(e(a.addPayModel.addrLine1,0)&&e(a.addPayModel.city,0)&&e(a.addPayModel.zip,4)&&"---"!==a.addPayModel.state)return!1}break;case"BA":if(a.addPaymentBtnClicked)return!0;if(a.validRoutingNo&&e(a.addPayModel.routNum,0)&&e(a.addPayModel.paymentAccountNumber_BA,0)&&e(a.model.nameOnAccount_BA,0)&&e(a.model.payNickname_BA,0))return!1}return!0},checkEditForm:function(a){return editPayModel=a.editPayModel,model=a.model,a.editPaymentBtnClicked?!0:(valid=!1,changed=!1,"CC"===editPayModel.payType?(e(editPayModel.newPayNickname,0)&&f(editPayModel.newPayNickname)&&e(editPayModel.nameOnAccount,0)&&"0"!==model.editMonth&&"0"!==model.editYear&&(model.isEditDiffBilling?e(editPayModel.addrLine1,0)&&e(editPayModel.city,0)&&"---"!==editPayModel.state&&e(editPayModel.zip,4)&&(valid=!0):valid=!0),editPayModel.newPayNickname!==a.currentPaymentMethod.payMethodName||editPayModel.nameOnAccount!==a.currentPaymentMethod.nameOnAccount||a.currentPaymentMethod.expDate!==g(model.editMonth)+""+model.editYear?changed=!0:model.isEditDiffBilling&&(editPayModel.addrLine1!==a.currentPaymentMethod.addrLine1||editPayModel.addrLine2!==a.currentPaymentMethod.addrLine2&&""!==editPayModel.addrLine2||editPayModel.city!==a.currentPaymentMethod.city||editPayModel.state!==a.currentPaymentMethod.state||editPayModel.zip!==a.currentPaymentMethod.zip)&&(changed=!0),editPayModel.methodTypeStatus!==a.currentPaymentMethod.originalCardType&&(changed=!0)):e(editPayModel.newPayNickname,0)&&f(editPayModel.newPayNickname)&&e(editPayModel.nameOnAccount,0)&&(valid=!0,(editPayModel.newPayNickname!==a.currentPaymentMethod.payMethodName||editPayModel.nameOnAccount!==a.currentPaymentMethod.nameOnAccount)&&(changed=!0)),valid&&changed?!1:!0)},getPaymentMethods:function(a,b,c,d){return this.stubMode?void 0:this.handleGetService(a,b,c,this.services.EBILL_INFO,d)},getSummary:function(a,b,c){return this.stubMode?void 0:this.handleGetService(a,b,c,this.services.SUMMARY)},getBPGlobal:function(a,b,c,d){return this.stubMode?void 0:this.handleGetService(a,b,c,this.services.BP_GLOBAL,d)},getBillFileURL:function(a,b,c){return b?c?"/pay-bill/bill-insert/index.html?bi="+b:j+this.services.BILL_FILE+"?system=Portal&insertID="+b:a?j+this.services.BILL_FILE+"?system=Portal&billID="+a:"/pay-bill/bill-insert"},getBillFile:function(a,b,c){return this.handleGetService(a,b,c,this.services.BILL_FILE)},getCreditCardInfo:function(a,b,c){return this.stubMode?void 0:this.encryptAndPost(a,b,c,this.services.CARD_INFO)},getBankInfo:function(a,b,c){return params={routingnumber:a},this.handleGetService(params,b,c,this.services.BANK_INFO)},createPaymentMethod:function(a,b,c){return this.validate_addForm(c)?(data=this.get_addData(c),this.stubMode?(data.payMethodName=data.payNickname,data.accountType=data.payType,data.paymentAccountNumber=data.paymentAccountNumber.substring(data.paymentAccountNumber.length-4,data.paymentAccountNumber.length),void 0):this.encryptAndPost(data,a,b,this.services.CREATE_PM)):!1},updatePaymentMethod:function(a,b,c){return this.validate_editForm(c)?(data=this.get_editData(c),this.stubMode?void 0:this.handlePostService(data,a,b,this.services.UPDATE_PM)):!1},makeDefaultPM:function(a,b,c,d){if(paymentMethod=this.getPaymentMethod(a,d),d.editPayModel.isDefault=!0,data=this.get_editData(d),!this.stubMode)return this.handlePostService(data,b,c,this.services.UPDATE_PM);for(paymentMethod.isDefault=!0,loop=0;loop<d.ebillInfo.ebillInformationOutputs.length;loop++)if(d.ebillInfo.ebillInformationOutputs[loop].isFrom)for(var e=0;e<d.ebillInfo.ebillInformationOutputs[loop].paymentMethods.length;e++)paymentMethod1=d.ebillInfo.ebillInformationOutputs[loop].paymentMethods[e],paymentMethod1.payMethodName.toLowerCase()!==a.toLowerCase()&&(paymentMethod1.isDefault=!1)},removePaymentMethod:function(a,b,c){return data=this.get_deleteData(c),this.stubMode?void 0:this.handlePostService(data,a,b,this.services.REMOVE_PM)},submitOTPayment:function(a,b,c){return data=this.get_otData(c),this.stubMode?(a(n),void 0):this.handlePostService(data,a,b,this.services.OT_PAYMENT)},get_modalTransferData:function(a){var b={};return b.system="Portal",b.pmNickNames=a.payMethodsStr,b.isAutoPayTransfer=a.autoPayTransfer,a.autoPayTransfer&&(b.autoPayNickname=a.autoPayNickName),a.updatePayMethodFlag?("advance"===a.transferModel.datePM&&(b.autoPayDaysInAdvance=a.transferModel.dueDateSelected),"dom"===a.transferModel.datePM&&(b.autoPayDayOfMonth=a.transferModel.dateOnMonthSelected),"due"===a.transferModel.amountPM&&(b.autoPayCapAmount=String(a.transferModel.maxAmountValue).split("$").join("")),"other"===a.transferModel.amountPM&&(b.autoPayFixAmount=String(a.transferModel.otherAmount).split("$").join(""))):("advance"===a.transferModel.datePM&&(b.autoPayDaysInAdvance=a.autoPayDaysInAdvance),"dom"===a.transferModel.datePM&&(b.autoPayDayOfMonth=a.autoPayDayOfMonth),"other"===a.transferModel.amountPM&&(b.autoPayFixAmount=String(a.fixAmt).split("$").join(""))),b.isUpdatePrefComm=!1,null===a.transferModel.emailAddress||""===a.transferModel.emailAddress?b.isUpdatePrefComm=!1:a.transferModel.emailAddress===a.fromAcctEbillInfo.email&&a.fromAcctEbillInfo.mailNotifyInd||(b.isUpdatePrefComm=!0),b.isUpdatePrefComm&&(b.email=a.transferModel.emailAddress,b.mailNotifyInd=!0,b.origMailNotifyInd=a.toAcctEbillInfo.mailNotifyInd,b.origPaperBillInd=a.toAcctEbillInfo.isPaperBill,b.origEmail=a.toAcctEbillInfo.email,b.paperBillInd=a.toAcctEbillInfo.isPaperBill),this.get_cookie("wg")&&(b.isWalledGarden=!0),b.mtAknowInd=a.ackTransferFlag,c.dueAmount>0?(b.isCreateRecPay=!0,b.initialPayAmount=String(c.dueAmount).split("$").join("")):b.isCreateRecPay=!1,b},toggleAccount:function(a,b,c){var d={};return this.stubMode?void 0:(c&&(d.accountType=c),this.handlePostService(d,a,b,this.services.TOGGLE_ACCOUNT))},xmlbillFile:function(a,b,c){return this.stubMode?void 0:this.handleGetService(a,b,c,this.services.GET_XML)},xmlSummary:function(a,b){var c={};return c.csrid=123456,c.system="Portal",this.stubMode?(a(o),void 0):this.handleGetService(c,a,b,this.services.GET_XMLSUM)},getPaymentHistoryDetails:function(a,b,c){return this.stubMode?void 0:this.handleGetService(a,b,c,this.services.GET_PAYMENT_HISTORY)},submitMoveTransfer:function(a,b,c){return data=this.get_modalTransferData(c),this.stubMode?(a(m),void 0):this.handlePostService(data,a,b,this.services.MOVE_TRANSFER)},submitOptOut:function(a,b,c){var d={};return d.system="Portal",d.apOptOut=c.transferModel.apOptOut,d.pmOptOut=c.transferModel.pmOptOut,this.stubMode?(a(m),void 0):this.handlePostService(d,a,b,this.services.MOVE_TRANSFER)},submitMayBeLater:function(a,b,c){return this.stubMode?(a(m),void 0):this.handlePostService(c,a,b,this.services.MOVE_TRANSFER)},submitOTPaymentNew:function(a,b,c){return data=this.get_otData(c),model=c.model,addPayModel=c.addPayModel,c.showAddPM&&(model.saveAddtoProfile_CC&&"CC"===addPayModel.payType||model.saveAddtoProfile_BA&&"BA"===addPayModel.payType)?(data.isCreatePayMethod=!0,angular.extend(data,this.get_addData(c))):data.isCreatePayMethod=!1,this.stubMode?void 0:this.encryptAndPost(data,a,b,this.services.OT_PAYMENT_NEW)},updateOTPayment:function(a,b,c){return data=this.get_otData(c,!0),this.stubMode?(a(n),void 0):this.handlePostService(data,a,b,this.services.UPDATE_OT_PAYMENT)},updateOTPaymentNew:function(a,b,c){return data=this.get_otData(c,!0),model=c.model,addPayModel=c.addPayModel,c.showAddPM&&(model.saveAddtoProfile_CC&&"CC"===addPayModel.payType||model.saveAddtoProfile_BA&&"BA"===addPayModel.payType)?(data.isCreatePayMethod=!0,angular.extend(data,this.get_addData(c))):data.isCreatePayMethod=!1,this.stubMode?void 0:this.encryptAndPost(data,a,b,this.services.UPDATE_OT_PAYMENT_NEW)},removeOTPayment:function(a,b,c){return this.stubMode?void 0:(data={paymentID:c},this.handlePostService(data,a,b,this.services.REMOVE_OT_PAYMENT))},scheduleAutoPay:function(a,b,c){return data=this.get_autopayData(c),this.stubMode?(a(n),void 0):this.handlePostService(data,a,b,this.services.CREATE_AUTO_PAYMENT)},scheduleAutoPayNew:function(a,b,c){return data=this.get_autopayData(c),data.isCreatePayMethod=c.showAddPM,c.showAddPM&&angular.extend(data,this.get_addData(c)),data.isCreateRecPay=c.createRecPay,c.amountSelected&&(data.initialPayAmount=String(c.amountSelected).split("$").join("")),angular.extend(data,this.get_otData(c)),data.isUpdatePrefComm=!1,c.emailAddress===c.activeAcctEbillInfo.email&&c.activeAcctEbillInfo.mailNotifyInd||(data.isUpdatePrefComm=!0),c.activeAcctEbillInfo.isPaperBill&&c.goPaperless.paperlessEnabled&&(data.isUpdatePrefComm=!0),data.isUpdatePrefComm&&(data.email=c.emailAddress,data.origMailNotifyInd=c.activeAcctEbillInfo.mailNotifyInd,data.origPaperBillInd=c.activeAcctEbillInfo.isPaperBill,data.origEmail=c.activeAcctEbillInfo.email,data.mailNotifyInd=!0,data.paperBillInd=c.activeAcctEbillInfo.isPaperBill&&c.goPaperless.paperlessEnabled?!1:c.activeAcctEbillInfo.isPaperBill),this.stubMode?void 0:this.encryptAndPost(data,a,b,this.services.CREATE_AUTO_NEW)},updateAutoPay:function(a,b,c){return data=this.get_autopayData(c,!0),this.stubMode?(a(n),void 0):this.handlePostService(data,a,b,this.services.UPDATE_AUTO_PAYMENT)},updateAutoPayNew:function(a,b,c){return data=this.get_autopayData(c,!0),data.isCreatePayMethod=c.showAddPM,c.hasOwnProperty("hasCapChanged")&&(data.hasCapChanged=c.hasCapChanged),c.showAddPM&&angular.extend(data,this.get_addData(c)),data.isUpdatePrefComm=!1,c.emailAddress===c.activeAcctEbillInfo.email&&c.activeAcctEbillInfo.mailNotifyInd||(data.isUpdatePrefComm=!0),data.isUpdatePrefComm&&(data.email=c.emailAddress,data.origMailNotifyInd=c.activeAcctEbillInfo.mailNotifyInd,data.origPaperBillInd=c.activeAcctEbillInfo.isPaperBill,data.origEmail=c.activeAcctEbillInfo.email,data.mailNotifyInd=!0,data.paperBillInd=c.activeAcctEbillInfo.isPaperBill),this.stubMode?void 0:this.encryptAndPost(data,a,b,this.services.UPDATE_AUTO_NEW)},swapDateFormat:function(a){if("string"==typeof a&&""!==a){var b=a.split("/");return 3===b.length?b[1]+"/"+b[0]+"/"+b[2]:2===b.length?b[1]+"/"+b[0]:a}return a instanceof Date?a.getDate()+"/"+a.getMonth()+"/"+a.getFullYear():a},updateScheduledAutoPay:function(a,b,c){return scope=0,c&&(scope=c.scope),data=this.get_otData(scope,!1,!0),this.stubMode?(a(n),void 0):this.handlePostService(data,a,b,this.services.UPDATE_SCH_AUTO)},updateScheduledAutoPayNew:function(a,b,c){return scope=0,c&&(scope=c.scope),data=this.get_otData(scope,!1,!0),model=scope.model,addPayModel=scope.addPayModel,scope.showAddPM&&(model.saveAddtoProfile_CC&&"CC"===addPayModel.payType||model.saveAddtoProfile_BA&&"BA"===addPayModel.payType)?(data.isCreatePayMethod=!0,angular.extend(data,this.get_addData(scope))):data.isCreatePayMethod=!1,this.stubMode?(a(n),void 0):this.encryptAndPost(data,a,b,this.services.UPDATE_SCH_AUTO_NEW)},removeAutoPay:function(a,b,c,d){return data={},c&&(data.removeScheduledInd=!0),d&&(data.unregisterAutoPayInd=!0),this.stubMode?void 0:this.handlePostService(data,a,b,this.services.REMOVE_AUTO_PAYMENT)},scheduledPayments:function(a,b){return this.stubMode?void 0:this.handleGetService(k,a,b,this.services.SCHEDULED_PAYMENTS)},serviceAddress:function(a,b){return this.stubMode?void 0:this.handleGetService(k,a,b,this.services.SERVICE_ADDRESS)},updateCommunication:function(a,b,c){return this.handlePostService(a,b,c,this.services.UPDATE_COMM)},updateCommunicationNew:function(a,b,c){return this.handlePostService(a,b,c,this.services.UPDATE_COMM_NEW)},checkSuccess:function(a){return a.responseInfo&&a.responseInfo.statusCode&&0===parseInt(a.responseInfo.statusCode,10)?!0:!1},getErrorMessage:function(a){return a&&a.responseInfo&&a.responseInfo.statusDesc?a.responseInfo.statusDesc:r.error.general},handlePostService:function(b,c,d,e){var f={};return this.requestInProgress=!0,this.currentServiceEnd=e,a({method:"POST",url:j+e,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){angular.extend(a,k);var b=[];for(var c in a)(void 0!==a[c]||"defaultInd"===c||"isImmediate"===c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:b,timeout:12e4}).success(function(a){this.currentServiceEnd="",this.requestInProgress=!1,angular.extend(f,a),c(a)}).error(function(a,b,c,e){this.currentServiceEnd="",this.requestInProgress=!1,d(a,b,c,e)}),f},handleGetService:function(b,c,d,e,f){var g={};return this.requestInProgress=!0,this.currentServiceEnd=e,a.get(j+e,{params:angular.extend(b,k),cache:(e===s.services.BP_GLOBAL||e===s.services.EBILL_INFO)&&"UNCACHED"!==f}).success(function(a){this.requestInProgress=!1,angular.extend(g,a);try{e===s.services.BP_GLOBAL&&a&&a.csrId&&angular.extend(k,{csrid:a.csrId})}catch(b){}c(a)}).error(function(a,b,c,e){this.requestInProgress=!1,d(a,b,c,e)}),g},encryptAndPost:function(a,b,c,d){if("cardinfo"!==d&&"C"!==a.methodType&&"D"!==a.methodType)return this.handlePostService(a,b,c,d);key="-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: BCPG v1.52\n\nmQENBFZGTI8DCACfFYZmVrkiKzQjR0zBtz42OL6Hr4I+0/iHvujxw+vOxA/G7Cy0\n+28E7/5RgGG1CYJXYEceQEsHyvpEa8ezEzU// aNh6S3FJVM8C7WyWHcmyh4m8IKO\nUGYV0SCyVrz0rGQu+xQu3cvtjBvQ4IL4DIzjR9SoQw0zT+Vp9Gg4yFHSXeCVhqI/\nNIqOtmcNWK/kVBT71k/aQ/NVKtrRKAJIIw22WvGfnNQaLdSWEeTo7NzcsZZd7aDU\ns6zvf5rS2YQvIr9XOq709VM8RbfC14lpAAF1leANGuHnxV9p8EcskmGAH4pslSbs\n4FVNgex88OnC1IA9LqsDjER4lJx3/qNI3T0pABEBAAG0FWViaWxsQGNhYmxldmlz\naW9uLmNvbYkBKAQTAwIAEgUCVkZMnAIbAwKLCQKVCAIeAQAKCRBp0tizpepmNDCJ\nCACBQATvN7NKhc9MomFreNGcbQuCfSEnE0U2v7yFbVaIMEI6RtHThxbt8A2+E5bw\nsqUZ9f/FvOs+4Ivqk79K5MuVIQ+NKqBsi3brz2u2BxyR3SaXVpUlfn1Mt3K2Krga\nvLRH9jz1OK0arwRrQkZMPB0N55Cb0kJlrl20jPjrPKVkXnNdomg/WP7+VaWsXUlt\ntS/3IGsbqnoSpGRgqTg508y+l2bT8myYoaqjk9yEgpkzLMebNKcxfFa4kDdrjf1I\nnHtBcr1CeMzhcvI7Ag+cNkowmIluRyWvcOM/twZaITt2QY6RggIixpR52zPp572X\noq7Nkhxh4AKYwzt9BK7mV8b5uQENBFZGTJwCCACl7z7R1rbiGQ0rA5aRinmSwR8C\nboUoYtwwyTF9fvofoQfQyaiU0Z4LkTU+RJ0XLXFjyfQ/weEuLp+sDiDkzhbKxIha\n6ZnBgaCUCXRsvPq/nb1fqJuxtLyZ8gmYxcCGQkuNNN0LNC5GChV+bhp/Zlra4WzW\nEkjxXbKtKGBU1Vq0v14cMnd1JUXQTVn2brE3SuPkT7WUtTgCpfgoPdJKyep83vnc\nFIKrJXw486haGU6T8xaZSA8rv/7fYK/+958CvqUsOrKqMhZMQhp8wQwUHGDLrvp7\n2/1pGh6bmElCMnEtrWc1HQ6nMEykhed823W4LW9/j5cTMY8x80cOtSV422VXABEB\nAAGJAR8EGAMCAAkFAlZGTJwCGwwACgkQadLYs6XqZjSCfQf/XYhTbLICW84LMFVe\n6L/3FvW0jln8NVguP0jre8X/4lZVW6WfGx0AJKGwN0bmm+YxbJa0V8QK3TJrykuD\nThTD4bWQiEsDBllvXPuF30X8RAhGlb/AgSkksSMBri8ZOpRfD+FrJWMvnI30KFfY\njhWWTgu6Dc2irQtaTG1cmxaAIaFwiS/iQJYFWchHPhxPXZC4Oh4Xk/u2KphR8x0K\nd70L8ibWpEOyocKd4+m+tCJiTs7wkmgvRgm8Ozw8qBV+PVlX/FbWTtHpMyTrZYLb\n6xGsbnaOHtN8dpGYC0LARjXriUZ/g38OX6vL20Ko8QZgn/gHr4EGSa1K0+WJcCGa\n1mSasg==\n=Y9xj\n-----END PGP PUBLIC KEY BLOCK-----\n";var e,f=openpgp.key.readArmored(key),g=this;e="cardinfo"===d?a.cardnumber:a.paymentAccountNumber,openpgp.encryptMessage(f.keys,e).then(function(e){return"cardinfo"===d?a.cardnumber=e:a.paymentAccountNumber=e,g.handlePostService(a,b,c,d)},function(){console.log("Encryption of credit card number failed")})}};return s}]),angular.module("StubResponseService",[]).factory("StubResponseService",[function(){var a={getXMLBillFileResponse:function(){var a={version:2,account:789551719202,name:"JOHN SAMPLE",addressLine1:"1989 SEAMANS NECK RD",addressLine2:"SEAFORD NY 11783-2540",yourMonthlyStatement:{billingPeriod:{text:"Billing Period",date1:"01/26/15",date2:"02/28/15"},dueDate:{text:"Due Date",date:"02/15/15"},dueAmount:{text:"Amount",amount:"$23.40"},unpaidBalance:null,totalAmountDue:null,conditionalMessaging:null},yourAccountSummary:{content:[{text:"Includes Payment Received By",date:"01/28/15",message:"Any payments and other activities after this date will be on the next bill."},{name:"HorizontalBlueLine",declaredType:"java.lang.Object",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"sample",nil:!1,globalScope:!0,typeSubstituted:!0},{text:"Balance Last Statement",amount:"$0.00"},{text:"Payment(s) - Thank You",amount:"-$208.53 cr"},{text:"Previous Balance",amount:"-$208.53 cr"},{text:"Current Monthly Charges",amount:"$218.30",message:"(Includes credits and adjustments since last statement)"},{text:"Total Taxes & Fees",amount:"$13.63"},{name:"HorizontalBlueLine",declaredType:"java.lang.Object",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"null",nil:!1,globalScope:!0,typeSubstituted:!0},{content:[{name:"Text",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"Total Amount Due by",nil:!1,globalScope:!0,typeSubstituted:!1},{name:"Date",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"02/15/15",nil:!1,globalScope:!0,typeSubstituted:!1},{name:"Amount",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"$23.40",nil:!1,globalScope:!0,typeSubstituted:!1}]},{message:"Total Promotional Savings this month = $25.00. Please see page 3 for details."}]},optimumUpdates:null,savings:{text:"Your Monthly Savings =",amount:"$25.00",message:"See your savings for this month in Your Accounts Details. We hope you're getting the most out of your Optimum products and services.Thanks for being an Optimum customer."},yourAccountDetails:{balanceLastStatement:{text:"BALANCE LAST STATEMENT",amount:"$0.00"},previousBalanceStatement:{text:"PREVIOUS BALANCE (See Account Summary)",amount:"-$208.53 cr"},promotionalMessage:null,detailGroup:[{name:"PAYMENTS",service:[{startDate:"01/26/15",endDate:null,sumcode:"09B00007",serviceName:"Payment-Thank You",amount:"-$208.53 cr",description:null}],totalAmount:{text:"Total PAYMENTS",amount:"-$208.53 cr"}},{name:"PARTIAL MONTH ACTIVITY",service:[{startDate:"01/27/15",endDate:"01/31/15",sumcode:"09B02703",serviceName:"Optimum Value",amount:"$10.47",description:null},{startDate:"01/27/15",endDate:"01/31/15",sumcode:"09B00498",serviceName:"Sports Surcharge",amount:"$0.96",description:null},{startDate:"01/27/15",endDate:"01/31/15",sumcode:"09B02712",serviceName:"Cable Box(es)",amount:"$1.26",description:null},{startDate:"01/27/15",endDate:"01/31/15",sumcode:"09B00625",serviceName:"Optimum Online",amount:"$8.86",description:null},{startDate:"01/27/15",endDate:"01/31/15",sumcode:"09B00635",serviceName:"Optimum Voice",amount:"$5.64",description:null},{startDate:"01/27/15",endDate:"01/31/15",sumcode:"09B00752",serviceName:"Multi-Product",amount:"-$2.42 cr",description:null}],totalAmount:{text:"Total Partial Month Activity",amount:"$24.77"}},{name:"TV",service:[{startDate:"01/26/15",endDate:null,sumcode:"09B01548",serviceName:"Installation",amount:"$39.95",description:null},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B02278",serviceName:"Optimum Value",amount:"$64.95",description:"(Includes Basic at $15.52)"},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B01936",serviceName:"1 Cable Box(es)",amount:"$7.80",description:"(At $7.56 each and remote(s) at $0.24 each)"},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B02413",serviceName:"Surcharge",amount:"$5.98",description:"Sports and Broadcast TV"}],totalAmount:{text:"Total TV",amount:"$118.68"}},{name:"INTERNET",service:[{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B01891",serviceName:"Optimum Online",amount:"$49.95",description:"Incl. $10.00 Multi-Product Savings Plus FREE Unlimited access to WiFi and Newsday.com"},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B02189",serviceName:"Modem Fee",amount:"$4.95",description:null}],totalAmount:{text:"Total Internet",amount:"$54.90"}},{name:"PHONE",service:[{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B01146",serviceName:"Optimum Voice",amount:"$34.95",description:"(Includes over 20 features, certain taxes & fees)"},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B04092",serviceName:"Multi-Product",amount:"-$15.00 cr",description:"Discount Incl. $15.00 Multi-Product Savings Our thanks for being a multi-product customer"}],totalAmount:{text:"Total Phone",amount:"$19.95"}},{name:"TAXES & FEES",service:[{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B00715",serviceName:"TV Taxes and Fees",amount:"$9.07",description:null},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B02750",serviceName:"NY Excise Taxes",amount:"$1.23",description:null},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B02751",serviceName:"Phone Sales Tax",amount:"$2.36",description:null},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B02752",serviceName:"E-911 Fee",amount:"$0.35",description:null},{startDate:"02/01/15",endDate:"02/28/15",sumcode:"09B02753",serviceName:"Federal Universal",amount:"$0.62",description:"Service Fund"}],totalAmount:{text:"Total Taxes & Fees",amount:"$13.63"}}],totalAmountDue:{content:[{name:"Text",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"Total Amount Due",nil:!1,globalScope:!0,typeSubstituted:!1},{name:"Amount",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"$23.40",nil:!1,globalScope:!0,typeSubstituted:!1}]}}};
return a},bpGlobalFileResponse:function(){var a={accountNumber:"0780127554630",csrId:null,recentOTPAmount:null,recentOTPDate:null,currentBalance:0,amountDue:0,dueDate:"10/29/2013",systemDate:"10/24/2013",dueDays:0,currentStatementDate:"10/07/2013",nextStatementDate:"11/07/2013",customerType:"R",defaultPmNickname:null,pastDue:"",pastDueAmount:0,hasScheduledPayment:null,scheduledPayDate:null,scheduledPayAmount:0,scheduledPayNickname:null,scheduledPayCapFailure:"N",hasRecentPayment:"N",recentPayAmount:0,recentPayDate:null,recentPayFailure:"N",recentPayFailureReason:null,creditCardExpiring:null,creditCardExpired:null,hasAutoPay:"N",billCycleStartDate:"10/08/2013",billCycleEndDate:"11/07/2013",payByMailAddress:"P.O. Box 371378",payByMailCity:" Pittsburgh",payByMailState:" PA",payByMailZip:" 15250-7378",hasPaymentMethod:"N",hasAutoPmtMethod:"N",wipDiscoReason:"5",nonPayDisconnect:"N",statementBalance:0,status:{statusCode:"0000",statusDesc:"description",canAccessBillPay:"Y"}};return a},ebillInfoFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"AMSS"},apOptOut:null,discoDate:null,ebillInformationOutputs:[{accountNum:"0789554760202",capAmount:null,classCodeInd:!1,finbl:null,fixAmount:null,hasAutoPay:!0,hasOTScheduled:!1,isFrom:!1,isPaperBill:!0,mailNotifyInd:!1,manualBlockInd:!1,payDayOfMonth:null,payDaysInAdvance:null,paymentMethods:[],scheduledAutoAmount:null,scheduledAutoDate:null,scheduledOTAmount:null,scheduledOTDate:null,tcInd:!1,email:"savanp@amdocs.com"}],mtAknowInd:null,pmOptOut:null};return a},toggleAccountFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"Session"},accounts:[{accountNumber:"0789554760202",accountType:"0",active:!0}]};return a},schedulePaymentsFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"AMSS"},scheduledAutoPayment:null,scheduledOTPayments:[{accountType:"P",addrLine1:"1111 STEWART AV",addrLine2:null,cardType:"V",city:"Bethpage",expDate:"1214",methodType:"C",nameOnAccount:"Biu Test",payAmount:2,payDate:"06/01/2015",payNickname:"Visa-1111",payNumMask:"1111",payType:"CC",paymentID:"587123663",routNum:null,state:"NY",status:"S",zip:"11714"}]};return a},summaryFileResponse:function(){var a={getBillSummaryReturn:{responseInfo:null,billStatements:[{billAmount:408.88,billCloseDate:"02/30/2015",billDueDate:"03/15/2015",documentKey:"07848201502A243406046R",inserts:[{alertText:"Important changes about your service",billID:"07848201502A243406046R",expirationDate:"20150416",frequency:"O",insertDesc:"March 2013 Price Changes for Long Island",insertID:"Z1A",optionalInd:"O",priority:1},{alertText:"Alert Information",billID:"07848201502A243406046R",expirationDate:"20150617",frequency:"M",insertDesc:"Important information",insertID:"Z5Z",optionalInd:"M",priority:1}],payments:[]}]},payments:[]};return a},serviceAddressFileResponse:function(){var a={address1:"65 THIRD AV",address2:null,city:"NEW HYDE PK",state:"NY",zip:"11040",customerName:"Joseph Avitabile",status:{statusCode:"0000",statusDesc:"SUCCESS",canAccessBillPay:null}};return a},createUpdateRemovePayFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"AMSS"}};return a},updateOTPFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"AMSS",message:{mainmsg:"Your scheduled payment has been successfully updated.",additionalInfo:null,additionalInfoMsg:null,note:null,linkText:null,linkURL:null,intro:null,outro:null},ancillaryMessage:null,ancillaryStatusCode:null},confirmNumber:null};return a},removeOTPFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"AMSS"}};return a},submitOTPFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"AMSS",message:{mainmsg:"Your scheduled payment has been successfully submitted.",additionalInfo:null,additionalInfoMsg:null,note:null,linkText:null,linkURL:null,intro:null,outro:null},ancillaryMessage:null,ancillaryStatusCode:null},confirmNumber:null};return a},scheduleUpdateAutoPayFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"Consolidated AMSS",message:{mainmsg:"Congratulations! Automatic payments have been successfully set ups.",additionalInfo:"Your first payment will be processed during the next billing cycle with talpiot.",additionalInfoMsg:null,note:null,linkText:null,linkURL:null,intro:null,outro:null},ancillaryMessage:{autoPay:"Your first payment will be processed during the next billing cycle with talpiot.",payMethod:null,prefComm:null},ancillaryStatusCode:"MTSAPSRCS"},currMonAutoPayDate:null};return a},removeAutoPayNewFileResponse:function(){var a={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"AMSS"}};return a},getCardInfoFileResponse:function(){var a={cardType:"D",status:{statusCode:"0000",statusDesc:"Description",canAccessBillPay:null}};return a}};return a}]),angular.module("phoneService",["config","oolCookie"]).factory("Phone",["$http","Config","ooluser",function(a,b,c){var d=function(){var d=b.getValuesBySelector("endpoint.api.phone"),e=angular.fromJson,f={GET_MESSAGES:"messages",VOICEMAIL_COUNTER:"counter",GET_STATUS:"status"},g={GET_MESSAGES:"messages",VOICEMAIL_COUNTER:"counter"},h={NEW:"new",READ:"read"},i="YYYY-MM-DD HH:MM:SS",j=c.eoid?c.eoid:"",k=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=e(a);c.isValid=!0,c.parsedResponse=d}catch(f){console.error("ERROR parsing => "+b),console.error(f)}return c},l=function(a){var b=k(a,g.WIFI_USAGE),c=null;if(b.isValid){var d=b.parsedResponse;c={count:d.count||0,type:d.type,updated:d.updated}}return c},m=function(a){var b=k(a,g.WIFI_USAGE),c=null;if(b.isValid){var d=[],e=b.parsedResponse;if(e._embedded&&e._embedded.messages){for(var f=e._embedded.messages,j=0,l=f.length;l>j;j++){var m=f[j],n=m.flag.split("|");d.push({id:m.messageid,from:m.from,subject:m.subject,timestamp:moment(m.timestamp,i).unix(),date:m.timestamp,size:m.size,isNew:_.contains(n,h.NEW)?!0:!1,wasRead:_.contains(n,h.READ)?!0:!1})}c={messages:d,messageCount:e.messageCount,phoneNumber:e.tnber}}}return c},n=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})};return this.getVoicemailCounter=function(){var a=d+f.VOICEMAIL_COUNTER+"?eoid="+j;return n(a,"GET",{"X-Requested-With":"XMLHttpRequest"},l,null)},this.getMessages=function(){var a=d+f.GET_MESSAGES+"?eoid="+j;return n(a,"GET",{"X-Requested-With":"XMLHttpRequest"},m,null)},this.getStatus=function(){var a=d+f.GET_STATUS+"?eoid="+j;return n(a,"GET",{"X-Requested-With":"XMLHttpRequest"})},this};return new d}]),angular.module("photosResource",["config"]).factory("PhotosService",["Config","ooluser","$http",function(a,b,c){var d=a.getValuesBySelector("endpoint.api.photos");angular.fromJson;var e={GET_APIKEY:"apikey",POST_PAIR:"pair_fb/:optimumId/:userId"},f={hello:function(){alert("hello")},getApiKey:function(){return c({url:d+e.GET_APIKEY,method:"GET"})},pairAccounts:function(a,f){return c({url:d+e.POST_PAIR.replace(/:optimumId/,b.optimumId).replace(/:userId/,a),method:"POST",params:{accessToken:f}})}};return f}]),angular.module("predictableJSONP",[]).factory("PredictableJSONP",["$http",function(a){var b=function(){this.jsonp=function(b,c,d){if(window[b])throw"Name "+b+" already in use!";var e=a.jsonp(c,d),f=angular.callbacks.counter-1,g=angular.callbacks["_"+f];return window[b]=function(a){g(a),delete window[b]},e}};return new b}]),angular.module("preferences",["config","oolCookie"]).factory("Preferences",["$http","$q","Config","ooluser",function(a,b,c){var d=function(){var a=this,b=c.getValuesBySelector("endpoint.api.preferences"),d={"Content-Type":"application/json"},e={"Content-Type":"application/x-www-form-urlencoded"};a.getModules=function(){var c=b+"get/funmod";return a.makeRequest(c,"GET",null,a.formatModulesResponse,d)},a.setModules=function(c){var d=b+"set/funmod",f={homeFunc1:c.homeFunc1,homeFunc2:c.homeFunc2};return a.makeRequest(d,"POST",a.formatModulesRequest(f),null,e)}};return d.prototype={makeRequest:function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return null})},formatModulesResponse:function(a){var b={},c={Cart:"cart",DVR:"dvr",New_On_Demand:"onDemand",Whats_on_Tonight:"onTonight",Voicemail:"voiceMail",Webmail:"webMail",WiFI_Usage:"wifiUsage"};if(!a)return b;try{return a=angular.fromJson(a),b.left=c[a.homeFunc1],b.right=c[a.homeFunc2],b}catch(d){console.error("ERROR (Preferences Service): error transforming response")}},formatModulesRequest:function(a){var b,c={},d={cart:"Cart",dvr:"DVR",onDemand:"New_On_Demand",onTonight:"Whats_on_Tonight",voiceMail:"Voicemail",webMail:"Webmail",wifiUsage:"WiFI_Usage"};try{return c.homeFunc1=d[a.homeFunc1],c.homeFunc2=d[a.homeFunc2],b="homeFunc1="+c.homeFunc1+"&"+"homeFunc2="+c.homeFunc2}catch(e){console.error("ERROR (Preferences Service): error transforming request")}}},new d}]),angular.module("pricingService",["config","ngResource","ngCookies","onetCookies"]).factory("Pricing",["$http","$resource","Config","$cookies","Cookies",function(a,b,c,d,e){var f=c.getValuesBySelector("endpoint.api.pricing"),g={getBasicPricing:"get_pricing",getFtaArea:"getFTA"},h=function(){this.getBroadcastBasicPrice=_.once(function(){return a.get(f+g.getBasicPricing).then(function(a){var b=a.data;return b},function(){var a=[{price:"Not available. Try again later."},{price:"Not available. Try again later."}];return a})});var b=_.once(function(){return a.get(f+g.getFtaArea).then(function(a){var b=a.data;return b},function(){var a="Not available. Try again later.";return a})});this.getFtaAreaInfo=b;var c=function(a){var b={},c=JSON.parse(e.getCookie("oolp_")),d=!1;if(c.p&&c.p.biz&&1===c.p.biz&&(d=!0),"undefined"==typeof a.IsRegulated)throw"ftaAreaInfo.IsRegulated is undefined";return a.IsRegulated?(b.restoreServicePrice=d?4.99:1.99,b.installationServicePrice=39.95,b.additionalOutletPrice=14.95):(b.restoreServicePrice=4.99,b.installationServicePrice=59.95,b.additionalOutletPrice=24.95),b};this.ftaAreaDetails=c,this.getFtaAreaDetails=function(){return b().then(c)}};return new h}]),angular.module("programDetailsImage",["config"]).factory("programDetailsImage",["Config",function(a){function b(a){this.attributes=_.extend(this.defaults,a)}var c=a.getValuesBySelector("endpoint.api.epgImages"),d=_.template(c+"<%= programId %>?deviceType=Web&artName=<%= artName %>"),e={"Small Desktop":"net_poster_67x89",Mobile:"net_poster_109x145","Medium Desktop":"net_poster_140x187","Mobile Retina":"net_poster_218x290","Large Desktop":"net_poster_222x297"};return b.prototype={url:function(){var a=_.extend(this.attributes,{artName:this.getArtName()});return d(a)},defaults:{size:"Medium Desktop"},getArtName:function(){return e[this.attributes.size]}},function(a){return new b(a)}}]),angular.module("program",["config"]).factory("Event",["$http","Config",function(a,b){var c=function(){},d=_.template(b.getValuesBySelector("endpoint.api.ipad")+"eventdetails.jsp?contentType=json&eventId=<%= id %>");return c.get=function(b,e,f){e=e||angular.noop,f=f||angular.noop;var g=_.extend(new c,b);return a.get(d(g)).then(function(a){return _.extend(g,a.data.content),e(g)},function(a){return f(a)}),g},c}]).factory("Program",["$log",function(a){function b(a){this.attributes=a}return b.prototype={get:function(a){var b="get"+_.str.classify(a);return this[b]&&_.isFunction(this[b])?this[b]():this._getDeep(a.split("."))},_getDeep:function(a){return _.reduce(a,function(a,b){return a[b]},this.attributes)},getEpisodeTitle:function(){var a=this.attributes;return a.episodeTitle||a.episodeinfo.title},getChannelNumber:function(){var b=this.attributes,c=b.num||(b.channel||{}).number;return void 0===c&&a.warn("Channel number undefined"),c},getChannelCallsign:function(){var b=this.attributes,c=b.cs||(b.channel||{}).callSign;return void 0===c&&a.warn("Channel callsign undefined"),c},getStart:function(){return this.attributes.starttime||this.attributes.startTime},getEnd:function(){return this.attributes.endTime||this.attributes.end_time},hasSeries:function(){return this.attributes.hasSeries||!this.isMovie()},isMovie:function(){return this._hasMovieCategory()||this._hasMovieFlag()},_hasMovieCategory:function(){var a=["FEATURE_FILM","FEATURE FILM","SHORT_FILM","SHORT FILM","TV_MOVIE","TV MOVIE"];return this.attributes.programtype=this.attributes.programtype?this.attributes.programtype:this.attributes.programType,this.attributes.programtype?_.contains(a,this.attributes.programtype.toUpperCase()):!1},_hasMovieFlag:function(){return"Y"===this.attributes.movies},toRecording:function(){return{scope:this.hasSeries()?"episode":"movie",title:this.attributes.title,episode:this.get("episode.title"),call_sign:this.get("channel.callsign"),channel_num:this.get("channel.number"),start_time:moment(this.get("start")),end_time:moment(this.get("end"))}}},b}]),angular.module("requestACreditService",["config"]).factory("requestACredit",["$http","Config",function(a,b){var c=function(){};return c.makeRequest=function(b,c,d,e,f){return a({method:c,url:b,data:d,transformResponse:e,headers:f}).success(function(a){return a}).error(function(a){return console.error("[Credit Request Service] makeRequest, call failed with. HTTP"),console.error(a),null})},c.fetchCreditData=function(a){var d=b.getValuesBySelector("endpoint.api.cablesupport"),e=d+"/creditrequest/creditrequest",f=c.makeRequest(e,"POST",a,null,{"Content-Type":"application/json"});return f},c}]),angular.module("searchResource",["config","miniGuideResource","errorHandler","oolCookie","onetCookies"]).factory("formattedResponseTransformer",[function(){return function(a,b,c){return function(d){var e,f;return _.isString(d)?(e=d.split("\n"),f=[],transformed=_.reduce(e,function(c,d,e){var g=$.trim(d).split(a);return _.forEach(g,function(a,d){var g;_.isDefined(b[e])?(g=b[e][d],c[g]=a):f.push(a)}),c},{}),c&&(transformed[c]=f.join(" ")),transformed):d}}}]).factory("SearchService",["$http","Config","MiniGuide","formattedResponseTransformer","ooluser","Cookies",function(a,b,c,d,e,f){function g(b,c){var d=a({url:b,method:"GET",params:c}).success(function(a){return a}).error(function(a){return a});return d}function h(a,b){var c="";return c="gsa"===a?b+"gsa":"google"===a?b+"google":b+m}e.laBoxUser=e.hasOOLSession?e.laBoxUser||e.laboxOrMini:"true"===f.getCookie("labox");var i=b.getValuesBySelector("endpoint.api.suggest"),j=b.getValuesBySelector("endpoint.api.search");b.getValuesBySelector("endpoint.api.tvListingsDVR");var k=5,l=12,m="veveo",n=e.laBoxUser,o=e.elineupId?e.elineupId:"";n&&(m="labox?lineupId="+o);var p={getHubId:function(){return k},setHubId:function(a){k=a,console.log("hubid set to : "+a)},setPN:function(a){l=a},getSuggestions:function(a,b){var c=h(b,i);return g(c,{q:a})},getSearchSupport:function(a){var b=j+"gsa";return g(b,{q:a,site:"support"})},suggestSupport:function(a){var b=i+"gsa";return g(b,{q:a,site:"support"})},onDemandFolderSearch:function(a,b,c){var d=j+m;return g(d,{q:a,folder:b,id:c,isFolderSearch:!0,hub:k,pn:l})},onDemandPageSearch:function(a,b){var c=j+m;return g(c,{q:a,folder:b,hub:k,pn:l})},getSearchResult:function(a,b){var c,d="";return"gsa"===b?(d=j+"gsa",c={q:a}):"google"===b?(d=j+"google",c={q:a}):(d=j+m,c={q:a,hub:k,pn:l}),g(d,c)},getNextorPrevpage:function(a,b,c){var d="";return d="gsa"===b?c?j+"gsaNextPage":j+"gsaPrevPage":"google"===b?c?j+"googleNextPage":j+"googlePrevPage":j+m,g(d,{url:escape(a)})},getNextorPrevSupportpage:function(a,b,c){var d="";return d="gsa"===b?c?j+"gsaNextPage":j+"gsaPrevPage":"google"===b?c?j+"googleNextPage":j+"googlePrevPage":j+m,g(d,{url:escape(a),site:"support"})},searchPageWise:function(a,b,c){var d=h(b,j);return g(d,{q:a,start:c})},searchSupportPagesWise:function(a,b,c){var d=h(b,j);return g(d,{q:a,start:c,site:"support"})}};return p}]),angular.module("serverUserAgentService",["config"]).factory("ServerUserAgent",["$http","Config","$q",function(a,b){var c=b.getValuesBySelector("endpoint.api.useragent"),d=function(){this.getServerUserAgent=_.once(function(){return a({method:"GET",url:c}).then(function(a){return a.data},function(){return""})})};return new d}]),angular.module("serviceAppointmentUtils",["ngResource"]).factory("ServiceAppointmentUtils",["$resource","$http",function(){var a=["8:00am","8:15am","8:30am","8:45am","9:00am","9:15am","9:30am","9:45am","10:00am","10:15am","10:30am","10:45am","11:00am","11:15am","11:30am","11:45am","12:00pm","12:15pm","12:30pm","12:45pm","1:00pm","1:15pm","1:30pm","1:45pm","2:00pm","2:15pm","2:30pm","2:45pm","3:00pm","3:15pm","3:30pm","3:45pm","4:00pm","4:15pm","4:30pm","4:45pm","5:00pm","5:15pm","5:30pm","5:45pm","6:00pm","6:15pm","6:30pm","6:45pm","7:00pm","7:15pm","7:30pm","7:45pm","8:00pm","8:15pm","8:30pm","8:45pm","9:00pm","9:15pm","9:30pm","9:45pm","10:00pm","10:15pm","10:30pm","10:45pm","11:00pm","11:15pm","11:30pm","11:45pm","12:00am"],b={xmlToJSON:function(a){"string"==typeof a&&(a=$.parseXML(a));var b={};if(1===a.nodeType){if(a.attributes.length>0)for(var c=0;c<a.attributes.length;c++){var d=a.attributes.item(c);b[d.nodeName]=d.nodeValue}}else 3===a.nodeType&&(b=a.nodeValue);if(a.hasChildNodes())for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes.item(e),g=f.nodeName;if("undefined"==typeof b[g])b[g]=this.xmlToJSON(f);else{if("undefined"==typeof b[g].push){var h=b[g];b[g]=[],b[g].push(h)}b[g].push(this.xmlToJSON(f))}}return b},truncateName:function(a){var b=23;return isMobile()&&(b=20),a&&a.length>b?(nameArr=a.split("-"),nameArr&&nameArr.length>0&&!isNaN(nameArr[nameArr.length-1])&&nameArr[nameArr.length-1].length<=4?a.substring(0,b-8)+"...-"+nameArr[nameArr.length-1]:a.substring(0,b-3)+"..."):a},errorCodeToMsg:function(a){for(var b=0;b<c.error.length;b++)if(c.error[b]===a)return b+1},getAppointmentResponse:function(){return c},noofdays:function(a,b){var c;return 4===a||6===a||9===a||11===a?c=30:(c=31,2===a&&(c=0!==b/4-parseInt(b/4,0)?28:0!==b/100-parseInt(b/100,0)?29:0!==b/400-parseInt(b/400,0)?28:29)),c},getDaysFromNumber:function(a){var b="";if(6>a||a>0)switch(a){case 0:b="Sun";break;case 1:b="Mon";break;case 2:b="Tue";break;case 3:b="Wed";break;case 4:b="Thur";break;case 5:b="Fri";break;case 6:b="Sat"}return b},parseAppointments:function(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d].quotaGroupDayOfWeek,f=getWeekDayFull(e),g=a[d].quotaGroupDay.split("-"),h=getMonthName(g[1]),i=g[2],j=a[d].slotTimeDesc.split("-"),k=a[d].slotTime,l="",m="";j.length>1&&(l=g[0]+g[1]+g[2]+"-"+k,m=f+" "+h+" "+i+" "+a[d].slotTimeDesc,c.displayTime=m,c.timeToken=l)}return b.push(c),b},getMonthName:function(a){var b="";if(a>0||13>a)switch(a){case 1:case 1:case"1":case"01":b="January";break;case 2:case 2:case"2":case"02":b="February";break;case 3:case 3:case"3":case"03":b="March";break;case 4:case"4":case 4:case"04":b="April";break;case 5:case"5":case 5:case"05":b="May";break;case 6:case"6":case 6:case"06":b="June";break;case 7:case"7":case 7:case"07":b="July";break;case 8:case"8":case 8:case"08":b="August";break;case 9:case"9":case 9:case"09":b="September";break;case 10:case"10":b="October";break;case 11:case"11":b="November";break;case 12:case"12":b="December"}return b},getTimeLineMapping:function(b){for(var c=0;c<a.length;c++)if(a[c]===b)return c+1;return 0}};getWeekDayFull=function(a){var b="";switch(a){case"Sun":b="Sunday";break;case"Mon":b="Monday";break;case"Tue":b="Tuesday";break;case"Wed":b="Wednesday";break;case"Thu":b="Thursday";break;case"Fri":b="Friday";break;case"Sat":b="Saturday"}return b};var c={success:{general:"Completed successfully.",appointmentReschedule:"Appointment rescheduled successfully.",cancelAppointment:"Your appointment has been cancelled",thankyouMsg:"Thank you.Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper",nextAppMsg:"You're the next stop. We'll let you know when he or she is on the way.",nextAppMsgforListPage:"You're the next appointment",technicianArrived:"The technician has arrived."},error:{1:"System error has occurred.",2:"Account does not exist.",3:"DDPID does not exist.",4:"CRMID does not exist.",5:"DDPID is not authorized.",6:"CRMID is not authorized.",7:"No such appointment.",9:"Account pin missing or is incorrect.",10:"No such Time token exists.",11:"Desired Time is no longer available.",CancelAppointment:"Current appointment cannot be canceled.",RescheduleAppointment:"Current appointment cannot be rescheduled.",rescheduleDate:"Please select a valid date to reschedule appointment",installationWindow:"Please select a valid installation window to reschedule appointment",general:"Error occurred while getting appointment slots, Kindly close this window and try again.",ViewDetails:"Error occurred while fetching details for the selected appointment.",pacError:"Error occurred while fetching details using PAC. Please try again.",errorModalHeader:"There is a connection error.",errorModalAlertText:"Cannot connect to server",errorModalDesc:"We are unable to connect to server due to internal error. Please try after sometime.",errMsg:"Error occurred while fetching appointment details.",cancelErrMsg:"Error occurred while cancelling appointment.",errCalenderPage:"We are sorry.........lorem ipsum.",generalError:"We're sorry. Your request cannot be processed at this time.",generalErrorMsg:"Oops. It's too close to your appointment to reschedule.",generalErrorMsgCancel:"Oops. It's too close to your appointment to cancel.",oneHourErrorMsg:"This operation is no more valid, kindly close this window and refresh the underlying page.",oneHourErrorMsgonTMT:"This view is no more applicable to the appointment, kindly close the window and refresh the underlying page.",oneHourErrorMsgDetailPage:"This operation is no more valid, Please refresh the underlying page.",timeOutMsg:"Your session has timed out."},AppointmentType:{SRO:"SRO",TC:"TC"}};return getMonthName=function(a){var b="";if(a>0||13>a)switch(a){case 1:case"1":b="January";break;case 2:case"2":b="February";break;case 3:case"3":b="March";break;case 4:case"4":b="April";break;case 5:case"5":b="May";break;case 6:case"6":b="June";break;case 7:case"7":b="July";break;case 8:case"8":b="August";break;case 9:case"9":b="September";break;case 10:case"10":b="October";break;case 11:case"11":b="November";break;case 12:case"12":b="December"}return b},b}]),angular.module("serviceAppointment",["ngResource","config","serviceAppointmentUtils"]).factory("ServiceAppointment",["$resource","$http","Config","ServiceAppointmentUtils",function(a,b,c,d){var e=c.getValuesBySelector("endpoint.api.appointment"),f={getAppointments:"get_appointments",cancelAppointment:"cancel_appointments",getTimeLine:"get_timeLine",validateNewCustomer:"validate_newCustomerLogin",rescheduleAppointment:"reschedule_appointments",getAppointmentSlots:"get_availableTimeSlots",getAlticeoneSchedulingSlots:"getScheduleInfo"},g=d,h={handleGetService:function(a,c,d){b.get(e+d).success(function(b){a(b)}).error(function(a,b,d,e){c(a,b,d,e)})},handlePostService:function(a,c,d,f){b({method:"POST",url:e+f,data:a,headers:{"Content-Type":"application/x-www-form-urlencoded","cache-control":"no-cache"}}).success(function(a){c(a)}).error(function(a,b,c,e){d(a,b,c,e)})},validateAccountJSON:function(a,b,c){var d=f.validateNewCustomer;return this.handlePostService(a,b,c,d)},getAppointmentsJSON:function(a,b){var c={appointmentDetails:{}},d=f.getAppointments;return this.handlePostService(c,a,b,d)},getAppointmentCountforHeader:function(a,b){var c={appointmentDetails:{PacFlag:!1}},d=f.getAppointments;return this.handlePostService(c,a,b,d)},parseAppointments:function(a){var b=[],c=a;if(null!==c)for(var d=0;d<c.length;d++){var e={},f="";e.APPOINTMENTTOKEN=c[d].appointmentToken,e.APPOINTMENTTYPE=c[d].appointmentType,e.CANRESCHEDULE=c[d].canReschedule,e.CANCANCEL=c[d].canCancel;for(var g=c[d].displayTime,h=g.split(","),i=$.trim(h[2]).split("-"),j=i.length,k=0;j>k;k++){var l="",m=i[k].substring(i[k].length-2,i[k].length),n=m.toLowerCase();if(2!==i[k].split(":").length){n=":00"+n;var o=i[k].substring(0,i[k].length-2)+n;l=o}else l=i[k].substring(0,i[k].length-2)+n;k!==j-1&&(l+=" - "),f+=l}var p=$.trim(f.split("-")[0]),q=p.substring(p.length-2,p.length).toLowerCase(),r=p.split(":");finaltime="pm"===q&&"12"!==r[0]||"am"===q&&"12"===r[0]?12+parseInt(r[0],10):r[0],e.TIME=f;var s=$.trim(g.split(",")[0])+" "+$.trim(g.split(",")[1]),t=new Date(s),u=new Date;e.isToday=t.toDateString()===u.toDateString()?!0:!1;var v=s.split(" ")[0];e.DAY=v,e.DATE="0"===s.split(" ")[2].substring(0,1)?s.split(" ")[1].substring(0,1).toUpperCase()+s.split(" ")[1].substring(1).toLowerCase()+" "+s.split(" ")[2].substring(1)+", "+s.split(" ")[3]:s.split(" ")[1].substring(0,1).toUpperCase()+s.split(" ")[1].substring(1).toLowerCase()+" "+s.split(" ")[2]+", "+s.split(" ")[3],new Date,r[1].split(" ");var w=new Date(e.DATE+" "+finaltime+":"+$.trim(r[1].substring(0,r[1].length-2))+":00");if(e.TASKCODE=c[d].taskCodesList,e.TITLE=c[d].appointmentTitle,("SRO"===e.TITLE||"Completed"===c[d].appointmentStatus)&&(e.doNotShowStatusMsg=!0),null!==c[d].estimatedDuration&&c[d].estimatedDuration.length>0){e.labelDuration="Estimated duration: ",e.duration=c[d].estimatedDuration;var x=c[d].pacDuration,y=Math.floor(x/60),z=x%60,A="";isNaN(y)||isNaN(z)||(A=1===y&&0===z?" an hour":1===y&&1===z?y+" hour "+z+" minute":1===y&&z>1?y+" hour "+z+" minutes":y>1&&1===z?y+" hours "+z+" minute":0===z?y+" hours":0===y?z+" minutes":y+" hours "+z+" minutes"),e.pacDuration=A}else e.duration="";if(e.StatusFlag=!1,null!==c[d].appointmentStatus)if("Completed"===c[d].appointmentStatus)e.StatusFlag=!0,e.StatusDetail="Completed",e.StatusMsg="Your "+e.APPOINTMENTTYPE+" appointment is complete";else if("Started"===c[d].appointmentStatus)e.StatusFlag=!0,e.StatusDetail="Started",e.StatusMsg="The technician has arrived";else if("Pending"===c[d].appointmentStatus&&c[d].nextAppointment)e.StatusFlag=!0,e.StatusDetail="Next",e.StatusMsg="You're the next appointment";else if("Pending"===c[d].appointmentStatus&&null!=c[d].eta){e.ETA=c[d].eta;var B=new Date;if(w.getTime()-B.getTime()<72e5){e.StatusFlag=!0;var C=e.ETA.toLowerCase(),D=C.split("-");e.StatusMsg="The technician will arrive today between "+D[0]+"and"+D[1]}else c[d].nextAppointment&&(e.StatusFlag=!0,e.StatusDetail="Next",e.StatusMsg="You're the next appointment")}b.push(e)}return b},cancelAppointment:function(a,b,c){var d={appointmentDetails:{appointmentToken:a}},e=f.cancelAppointment;return this.handlePostService(d,b,c,e)},rescheduleAppointment:function(a,b,c,d){var e={appointmentDetails:{appointmentToken:a,desiredTimeToken:b}},g=f.rescheduleAppointment;return this.handlePostService(e,c,d,g)},handleError:function(){},getTechTimeLine:function(a,b,c){var d=f.getTimeLine,e={appointmentDetails:{appointmentToken:a}};return this.handlePostService(e,b,c,d)},checkSuccessStatusCode:function(a){var b={};return a.errorCode&&0!==a.errorCode?(a.errorCode,b.error=!0,b.message=g.getAppointmentResponse().error.errMsg):(b.error=!1,b.message=""),b},getAvailableTimeSlots:function(a,b,c,d,e,g){var h={appointmentDetails:{appointmentToken:a,appointmentTitle:b,taskCodeList:c,appointmentDate:d}},i=f.getAppointmentSlots;return this.handlePostService(h,e,g,i)},getAlticeoneSchedulingSlots:function(a){var c=moment(new Date).add(1,"days").format("YYYY-MM-DD"),d={startDate:c,durationDayCount:30,rateCodesToBeAdded:a},g=e+f.getAlticeoneSchedulingSlots,h={method:"POST",url:g,responseType:"json",data:d};return b(h)},getAppointmentResponse:function(){return stubAppointmentResponse},parseTime:function(a){var b=a.split(" "),c=b[0].split(":"),d=0;d=c[1]>=0&&c[1]<=14?"00":c[1]>=15&&c[1]<=29?"15":c[1]>=30&&c[1]<=44?"30":"45";var e=c[0]+":"+d+b[1];return e},parseAppointmentTime:function(a){var b,c=$.trim(a),d=c.substring(0,c.length-2),e=c.slice(-2);if(-1===d.indexOf(":"))d+=":00",b=d+e;else{var f=d.split(":")[0],g=d.split(":")[1];g=g>=0&&14>=g?"00":g>=15&&29>=g?"15":g>=30&&44>=g?"30":"45",b=f+":"+g+e}return b},get15HourCorpId:function(){return c.getValuesBySelector("serviceAppointment.bronxId")},get15HourOrderType:function(){return c.getValuesBySelector("serviceAppointment.bronxOrderType")},getTimeOutMilliSeconds:function(){return c.getValuesBySelector("serviceAppointment.timeOutMilliSeconds")}};return h}]),angular.module("CableTheftResource",["config"]).factory("CableTheftService",["$http","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.cablesupport"),d=b.getValuesBySelector("endpoint.api.support"),e=b.getValuesBySelector("endpoint.api.map"),f={success:{general:"Completed successfully."},error:{general:"Service not available at this time."}},g={suspectInfoMethod:function(a,b,c){var d={};return d.SuspectInfo={},d.SuspectInfo.FirstName=c.firstName,d.SuspectInfo.LastName=c.lastName,d.SuspectInfo.AddressLine1=c.address1,d.SuspectInfo.AddressLine2=c.address2,d.SuspectInfo.City=c.city,d.SuspectInfo.State=c.states.selected,d.SuspectInfo.Description=c.natureOfTheft,this.handlePostService(d,a,b,"theft/")},addressInfoMethod:function(a,b,c){var d=e;return this.handleGetService(d,a,b,c,"/map/geolocate/")},callUsInfoMethod:function(a,b,c){var e=d;return this.handleGetService(e,a,b,c,"number/")},getServerResponses:function(){return f},handlePostService:function(b,d,e,f){var g={};return a({method:"POST",url:c+f,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},data:b}).success(function(a){angular.extend(g,a),d(a)}).error(function(a){e(a)}),g},handleGetService:function(b,c,d,e,f){var g={};return a.get(b+f,{}).success(function(a){angular.extend(g,a),d(a)}).error(function(a,b,c,d){e(a,b,c,d)}),g}};return g}]),angular.module("supportService",["config"]).factory("Support",["$http","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.support_public"),d=b.getValuesBySelector("endpoint.api.user"),e={SUPPORT_NUMBER:c+"number/"},f="device/stb",g=b.getValuesBySelector("endpoint.api.support"),h=b.getValuesBySelector("endpoint.api.support_consent"),i="emailus",j=function(){var b=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a})},c=function(b,c,d,e){var f={};return a.get(e).success(function(a){angular.extend(f,a),c(a)}),f};this.getUserEquipments=function(a,b,e){var g=d+f;return c(a,b,e,g)},this.getSupportNumber=function(a){var c=e.SUPPORT_NUMBER+(a||"");return b(c,"GET",null,null,null)},this.getTemporaryConsent=function(b){var c=h+"getTemporaryConsent?accessCode="+b;return a.get(c)},this.updateTemporaryConsent=function(b,c,d){var e=h+"updateTemporaryConsent",f={method:"POST",url:e,responseType:"json",data:b};return a(f).then(function(a){c(a)},function(a){d(a)})},this.sendEmail=function(b,c,d,e){var f={name:"Customer",email:b,service:"disputereport",subject:"Please keep "+e+" on Optimum"+" - "+d,question:c,templateName:"channeldispute"},h=function(a){var b=new FormData;for(var c in a)b.append(c,a[c]);return b};return a.post(g+i,f,{headers:{"Content-Type":void 0},transformRequest:h})}};return new j}]),angular.module("TutorialResource",["config","oolCookie","onetCookies"]).factory("TutorialService",["$http","Config","ooluser","Cookies",function(a,b,c,d){c.laBoxUser=c.hasOOLSession?c.laBoxUser||c.laboxOrMini:"true"===d.getCookie("labox");var e=b.getValuesBySelector("endpoint.api.cablesupport_public"),f={success:{general:"Completed successfully."},error:{general:"Service not available at this time."}},g={tutorial:function(a,b,d){console.log("inside tutorila function");
var e=c.laBoxUser;return this.handleGetService(b,d,"tutorialvideos/categories/"+a+"?labox="+e)},getStandAloneVideoInfo:function(a,b,c){return console.log("inside tutorila function"),this.handleGetService(b,c,"tutorialvideos/tutorialvideo/"+a)},getStandAloneFeaturedVideo:function(a,b,c){return console.log("inside tutorila function"),this.handleGetService(b,c,"tutorialvideos/categories/Featured/"+a)},getServerResponses:function(){return f},getSSLProxyFeedUrl:function(a){var b="";return a&&a.length>0&&(b=a,a.indexOf("http://")>-1&&(b=a.replace("http://","https://"))),b},getSSLProxyUrl:function(a){var b="";return a&&a.length>0&&a.indexOf("http://")>-1&&(b=a.replace("http://","/cdn/")),b},handleGetService:function(b,c,d){var f={};return console.log("inside get srvice : CACHEABLE_TUTORIAL_API_URL +serviceEnd : "+e+d),a.get(e+d).success(function(a){angular.extend(f,a),b(a)}).error(function(a,b,d,e){c(a,b,d,e)}),f}};return g}]),angular.module("supportedDevices",["config","oolCookie"]).factory("SupportedDevices",["$resource","Config","$rootScope","$q",function(a,b){var c=b.getValuesBySelector("endpoint.api.supportedDevices");return a(c,{},{query:{method:"JSONP",isArray:!0}})}]),angular.module("troubleshootService",["config"]).factory("troubleshoot",["$http","Config",function(a,b){var c=function(){this.logTroubleshootData=function(a,c,e,f){var g=b.getValuesBySelector("endpoint.api.cablesupport"),h=g+"/log/troubleshoot",i={troubleshootingStep:a,troubleshootingActions:c,customerTerm:e,service:f};return d(h,"POST",i,null,{"Content-Type":"application/json"})},this.modemLookup=function(){var a=b.getValuesBySelector("endpoint.api.cablesupport"),e=a+"/device/modemlookup";return d(e,"GET",null,c,{"Content-Type":"application/json"})},this.stbLookup=function(){var a=b.getValuesBySelector("endpoint.api.cablesupport"),e=a+"/device/stblookup";return d(e,"GET",null,c,{"Content-Type":"application/json"})},this.modemReset=function(a){var e=b.getValuesBySelector("endpoint.api.cablesupport"),f=e+"/device/modemreset",g={modems:[{macAddress:a}]};return console.log(g),d(f,"POST",g,c,{"Content-Type":"application/json"})};var c=function(a){return a};this.troubleshootReportIssueChat=function(a,c,e,f,g){var h=b.getValuesBySelector("endpoint.api.cablesupport"),i=h+"/rightnow/reportserviceissue",j={name:a,email:c,phone:g,productName:e,comments:f};return d(i,"POST",j,null,{"Content-Type":"application/json"})},this.troubleshootReportIssueEmail=function(a,c,e,f){var g=b.getValuesBySelector("endpoint.api.cablesupport"),h=g+"/rightnow/reportserviceissue",i={name:a,email:c,phone:e,productName:"Email - Report an Issue",comments:f};return d(h,"POST",i,null,{"Content-Type":"application/json"})};var d=function(b,c,d,e,f){return a({method:c,url:b,data:d,transformResponse:e,headers:f}).success(function(a){return a}).error(function(a){return console.error("[Troubleshoot Service] makeRequest, call failed with. HTTP"),console.error(a),null})}};return new c}]),angular.module("tvListings",["config","miniGuideResource","errorHandler","oolCookie"]).factory("formattedResponseTransformer",[function(){return function(a,b,c){return function(d){var e,f;return _.isString(d)?(e=d.split("\n"),f=[],transformed=_.reduce(e,function(c,d,e){var g=$.trim(d).split(a);return _.forEach(g,function(a,d){var g;_.isDefined(b[e])?(g=b[e][d],c[g]=a):f.push(a)}),c},{}),c&&(transformed[c]=f.join(" ")),transformed):d}}}]).factory("dvrUser",["TVListings","errorHandler","ooluser",function(a,b,c){var d={synced:!1,optimumId:c.optimumId,isPrimary:function(){return c.primary},isSecondary:function(){return!this.isPrimary()},webdvr:{areTermsAccepted:!0,areTermsRead:!1},hasHDBox:!1};return a.getUserDvrDetails(function(a){d.webdvr.areTermsAccepted=a.hasWebDVR,d.synced=!0,d.hasHDBox=-1!==a.sDVRs.indexOf("|HD|")},function(a){b(a)}),d}]).factory("TVListings",["$http","Config","MiniGuide","formattedResponseTransformer",function(a,b,c){var d=b.getValuesBySelector("endpoint.api.user"),e={error:[{StatusCode:-1,StatusDescription:"eventId is required"}]},f={getUserDvrDetails:function(b,c){var e;return e=this,a.get(d+"getdvrdetails").then(function(a){b(a.data)},function(a){var b=e.parseError(a.data);c(b?b:e.getUserDvrDetails.defaultError)})},getValidDirectProviderUrl:function(b,d,e,g,h){var i={};return angular.isFunction(d)||arguments.length<2?(g=d,h=e,d=!0,e=c.getHubId(!d)):(angular.isFunction(e)||arguments.length<3)&&(h=g,g=e,e=c.getHubId(!d)),g=g||angular.noop,h=h||angular.noop,f.get(b,d,e,function(b){angular.isObject(b)&&angular.isObject(b.online)&&angular.isString(b.online.directProviderUrl)&&""!==b.online.directProviderUrl?a.get(b.online.directProviderUrl,{cache:!0}).success(function(){i.url=b.online.directProviderUrl,g(b)}).error(function(){h()}):h()},h),i},get:function(b,d,f,g,h){var i,j={};return angular.isFunction(d)||arguments.length<2?(g=d,h=f,d=!0,f=c.getHubId(!d)):(angular.isFunction(f)||arguments.length<3)&&(h=g,g=f,f=c.getHubId(!d)),angular.isString(f)&&f.match(/^\d+$/)&&(f=parseInt(f,10)),d!==!0&&d!==!1&&(d=!0),angular.isNumber(f)||(f=c.getHubId(!d)),g=g||angular.noop,h=h||angular.noop,angular.isString(b)&&(b=parseInt(b,10)),!angular.isNumber(b)||isNaN(b)?(i=angular.copy(e),h(i,400,function(){},{}),i):(a.get(url,{params:{programId:b,hubId:f,isHd:d}}).success(function(a,b,c,d){angular.extend(j,a),g(a,b,c,d)}).error(function(a,b,c,d){h(a,b,c,d)}),j)},parseError:function(a){function b(a){return/^<html>/.test(a)}var c;return _.isString(a)?b(a)?c:a:c}};return f.getUserDvrDetails.defaultError="Unable to retrieve DVR user information.",f}]),angular.module("userLogin",["config","cookieLoggerService"]).factory("userLogin",["$http","Config","CookieLogger",function(a,b,c){var d=b.getValuesBySelector("endpoint.api.login"),e=d+"login/processLogin",f=d+"login/redirect",g=d+"profile/ooluser",h=d+"reauth",i=d+"logoutAll/optimumid",j={},k=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})};return j.authenticate=function(b,d,f,g,i,j){var k={id:b,password:d,referer:f,remember:!!g};j&&(k.area=j);var l=i?h:e;return a.post(l,k).then(function(a){return a.data.redirect_to},function(a){console.log("http post login error:",a),0===a.status?c.logCookies("different origin or network error on login"):405===a.status&&c.logCookies("HTTP 405 on login");var b=a.data.status,d={code:b.replace("LOGIN_RESP_FAILURE_","")};throw"TEMP_BAN"===d.code?d.ban_info=a.data.ban_info:"BAD_CREDENTIALS"===d.code&&null!=d.ban_info&&(d.attempts_remaining=a.data.ban_info.attempts_remaining,d.failed_attempts=a.data.ban_info.failed_attempts),d})},j.redirect=function(a){return window.location=f+"?to="+a,window.location},j.refreshOoluserCookie=function(){return k(g)},j.logOutAll=function(b){var c={headers:{"Content-Type":"application/x-www-form-urlencoded","cache-control":"no-cache"}},d=i+"/"+b;return a.post(d,c)},j}]),angular.module("userService",["config","ngResource","ngCookies","oolCookie","onetCookies"]).factory("User",["$http","$resource","Config","$cookies","ooluser","Cookies",function(a,b,c,d,e){var f,g=c.getValuesBySelector("endpoint.api.user"),h=c.getValuesBySelector("endpoint.api.multiAuth"),i=c.getValuesBySelector("endpoint.api.vendor_flag"),j=c.getValuesBySelector("endpoint.api.oolSession"),k=c.getValuesBySelector("endpoint.api.getRouterFeaturesByModel"),l={QNA_SYNC:"qna-sync",ACCOUNT_INFO:"accountinfo",ACCOUNT_INFO_BTM:"accountinfo/btm",CPC:"optimumid/:optimumId/cpc",IMS:"optimumid/:optimumId",OPTIMUM_IDS:"optimumid/:optimumId",GET_OPTIMUM_IDS:"optimumid",GET_TRANSFER_ACCOUNT_INFO:"transfer/account",GET_WIP_STATUS:"getWipStatus",TRANSFER_ACCOUNT_MOVE:"transfer/move",DISCO_CHECK:"disco-check",DELETE_IMS:"optimumid/:optimumId/delete",PREMIUM_TIER_DEVICE:"premiumtier/device",PREMIUM_TIER_USER:"premiumtier",SECURITY_SUITE:"secpac/order",SPAM_SCRUB:"spamscrub",SDP_POST:"user/:optimumId/sdp",CHALLENGE_QUESTIONS:"challenge_questions",BEHIND_THE_MODEM:"behind-the-modem",BEHIND_ANY_MODEM:"accountinfo/btm",BEHIND_TRUSTED_IP:"trusted-ip",CREATE_ID_TOKEN:"create-id-primary/token",OPTIMUM_ID_EXISTS:"optimumid/{optumumId}/exists",CHANGE_PASSWORD:"optimumid/:optimumId/password",CHALLENGE_INFO:"optimumid/:optimumId/challenge",CHALLENGE_INFO_POST:"optimumid/:optimumId/challenge/:questionId",CHALLENGE_INFO_UPDATE:"/user/optimumid/:optimumId/challenge/:questionId",CHALLENGE_ANSWER:"optimumid/:optimumId/challenge/check",ACCESS_CODE_INFO:"getAuxPin",SAVE_ACCESS_CODE:"setAuxPin",VERIFY_ACCESS_CODE:"confirmAuxPin",CDX_CUST_INFO:"cdxcustinfo",VERIFY_TEMP_PASS:"optimumid/:optimumId/verifytemporarypassword",VERIFY_ACCOUNT:"optimumid/:optimumId/verifyaccountnumber",CHALLENGE_ANSWER_MULTIAUTH:h+"check",CUST_INFO:"custinfo",RECOVER_ID:"recoverid",RECOVER_OPTIONS:"password_reset/recovery_options",SEND_TEMPORARY_PASS:"password_reset/send_temporary_pass",PRIVACY_SETTINGS:"privacy/settings",KAPTCHA_VALIDATE:"/KaptchaValidate.jsp",TRANSFER_ACCOUNT_PREFILL:"transfer/account/prefill",OPTIMUMID_BLOCKED:"optimumid/:optimumId/isOptimumIdBlocked",USERID_BLOCKED:"optimumid/:optimumId/isUserIdBlocked",GRACECOUNT_GET:"roadblock/graceCount",GRACECOUNT_INSERT_UPDATE:"roadblock/insertUpdateCount",DISCO_ACCOUNT_NUMBER:"transfer/verifyDiscoAccountNumber",CUSTOMER_UPGRADE_INFO:"upgradeinfoV2",SUBMIT_UPGRADE:"submitUpgrade",ADD_REMOVE_RC:"addremoverc",SUBMIT_RENT_ORDER:"submitUpgrade",ORDER_STATUS:"orderStatus",ROUTER_GET_WIRELESS_LAN:"router/getEnhancedWirelessLan",ROUTER_GET_LAN_CONNECTION:"router/getLanConnection",ROUTER_SET_LAN_CONNECTION:"router/setLanConnection",ROUTER_VALIDATE_SUBNET:"router/validateSubnet",ROUTER_SET_WIRELESS_LAN:"router/setWirelessLan",ROUTER_FIND_BEST_CHANNEL:"router/findBestChannel",ROUTER_VALIDATE:"router/validate",ROUTER_GET_NETWORK_MAP:"router/getEnhancedNetworkMap",ROUTER_GET_PORT_FORWARDING:"router/getPortForwardingRules",ROUTER_SET_PORT_FORWARDING:"router/setPortForwardingRule",ROUTER_RESET:"router/resetRouter",EASY_MOVE_LEAD:"easyMoveLead",ACCESSCODE_SHOWN:"accesscodeshown"},m="",n="",o="success",p="provisioned",q="processed",r=angular.fromJson,s={BEHIND_THE_MODEM:"behindTheModem",OPTIMUM_ID:"optimumId",PREMIUM_TIER_DEVICE:"premiumTierDevice",PREMIUM_TIER_USER:"premiumTierUser",PRIVACY_SETTINGS:"privacyPreferences",SECURITY_SUITE:"secutiySuite",SIMPLE_RESPONSE:"simpleResponse",TRANSFER_ACCOUNT_INFO:"transferAccountInfo",TRANSFER_ACCOUNT_MOVE:"transferAccountMove",TRANSFER_ACCOUNT_PREFILL:"transferAccountPrefill"},t=b(g+l.IMS,{optimumId:"@id"},{query:{method:"GET",params:{optimumId:""},isArray:!1},get:{method:"GET",params:{},isArray:!1},current:{method:"GET",params:{optimumId:f},isArray:!1},save:{method:"POST",params:{},isArray:!1}}),u=b(g+l.CPC,{optimumId:"@id"},{get:{method:"GET",isArray:!1},save:{method:"POST",params:{},isArray:!1}});t.prototype.getCPC=u.prototype.$get,delete t.prototype.$current,angular.isUndefined(f)&&(t.current=function(a,b,c,d){var e=null,f={Code:400,Message:"No ooluser.optimumId in cookie"};switch(arguments.length){case 4:e=d;break;case 3:case 2:if(isFunction(b)){if(isFunction(a)){e=b;break}e=c}break;case 1:break;case 0:break;default:throw"Expected between 0-4 arguments [params, data, success, error], got "+arguments.length+" arguments."}return angular.isFunction(e)&&e(f,400,function(){},{}),f});var v=function(){var b=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=r(a);d.Code||"Login required"===d.Message||(c.isValid=!0,c.parsedResponse=d)}catch(e){console.error("ERROR parsing => "+b),console.error(e)}return c},c=function(a){var c=b(a,s.SECURITY_SUITE),d=null;if(c.isValid){var e=c.parsedResponse,f=e.rsnCode||"",g=e.status||"",h=f.toLowerCase(),i=g.toLowerCase(),j=i!==o||h!==q&&h!==p?!1:!0;d={code:f,status:g,success:j,url:e.url}}return d},d=function(a){var c=b(a,s.OPTIMUM_ID),d=null;if(c.isValid){for(var e=c.parsedResponse,f=e._embedded.ids,g=[],h=0,i=f.length;i>h;h++){var j=f[h];g.push({firstName:j.first_name,lastName:j.last_name,isPrimary:j.is_primary,isBillpaySecondary:j.is_billpay_secondary,isParentalControlsSecondary:j.is_parental_controls_secondary,isOptimumVoiceSecondary:j.is_optimum_voice_secondary,isOVP:j.is_ovp,isCSO:j.is_cso,isOAC:j.is_oac,isOACADM:j.is_oacadm,id:j.id,emailEnabled:j.emailEnabled})}d={allowedRemaining:e.allowed_remaining,ids:g,packages:e.packages}}return d},f=function(a){var c=b(a,s.OPTIMUM_ID),d=null;if(c.isValid){var f=c.parsedResponse,g=e.p;d={ids:[{firstName:f.fname,lastName:f.lname,isPrimary:!1,isBillpaySecondary:1===g.bp?!0:!1,isParentalControlsSecondary:1===g.pc?!0:!1,isOptimumVoiceSecondary:1===g.ovps?!0:!1,id:f.id,emailEnabled:f.optedInOptimumEmail}],primaryId:f.primaryId}}return d},i=function(a){var c=b(a,s.PREMIUM_TIER_USER),d=null;if(c.isValid){var e=c.parsedResponse,f=e.webhosting,g=e.ddns;d={hasWebhosting:f,hasDDNS:g}}return d},j=function(a){var c=b(a,s.PREMIUM_TIER_DEVICE),d=null;if(c.isValid){for(var e=c.parsedResponse,f=e&&e.devices?e.devices:[],g=[],h=0,i=f.length;i>h;h++){var j=f[h];g.push({macAddress:j.macAddress,portStatus:{port25:{isEnabled:j.port25},port80:{isEnabled:j.port80}}})}d=g}return d},k=function(a){var c=b(a,s.BEHIND_THE_MODEM),d=null;if(c.isValid){var e=c.parsedResponse;d={isBehindTheModem:e.BehindTheModem,accountNumber:e.AccountNo}}return d},n=function(a){var c=b(a,s.TRANSFER_ACCOUNT_INFO),d=null;if(c.isValid){var e=c.parsedResponse;d={accountNumber:e.account_number,idLimit:e.optimumIdLimit||0,newAccountIds:e.newAccountOptimumIds||[],serviceLevel:e.newAccountServiceLevel||"",currentAccountIds:e.currentAccountOptimumIds||[],status:e.status||"",message:e.message||""}}return d},t=function(a){var c=b(a,s.TRANSFER_ACCOUNT_MOVE),d=null;if(c.isValid){var e=c.parsedResponse;d=e}return d},u=function(a){var c=b(a,s.TRANSFER_ACCOUNT_MOVE),d=null;if(c.isValid){var e=c.parsedResponse;return e}return d},v=function(a){var c=b(a,s.TRANSFER_ACCOUNT_PREFILL),d=null;if(c.isValid){var e=c.parsedResponse;d={accountNumber:e.account_number||"",isPrimary:e.primary||!1,status:e.status.toUpperCase()}}return d},w=function(b,c,d,e,f){return a({method:c,url:b,data:d,transformResponse:e,headers:f}).success(function(a){return a}).error(function(a){return console.error("[User Service] makeRequest, call failed with. HTTP"),console.error(a),null})},x=function(a){var c=b(a,s.PRIVACY_INFO),d=null;if(c.isValid){var e=c.parsedResponse,f=e.recommendations,g=e.promotions;d={recommend:f,promo:g}}return d};this.postRecoverId=function(a,b,c,d){var e=g+l.RECOVER_ID,f={type:a,captcha:b};return"accountinfo"===a&&d?(f.lname=d.lname,f.phone=d.phone,f.account_number=c):f.value=c,w(e,"POST",f,null,{"Content-Type":"application/json"})},this.qnaSync=function(){var a=g+l.QNA_SYNC;return w(a,"POST",null,null,null)},this.setSpamScrubOption=function(a){var b=g+l.SPAM_SCRUB,c="spamOption="+a;return w(b,"POST",c,null,{"Content-Type":"application/x-www-form-urlencoded"})},this.getSpamScrubOption=function(){var a=g+l.SPAM_SCRUB;return w(a,"GET",null,null)},this.getOptimumIds=function(a,b){var c=g+l.GET_OPTIMUM_IDS,e={};return c+=a?"/"+a:"",e=a?f:d,c+="?useCache="+(b?"true":"false"),c+="&fields=package",w(c,"GET",null,e,null)},this.getSecuritySuiteDownloadUrl=function(){var a=g+l.SECURITY_SUITE;return w(a,"POST",null,c,null)},this.getIMS=function(a){var b=g+l.IMS.replace(/:optimumId/,a);return w(b,"GET",angular.isNumber(m)?{cache:m}:null,null,null)},this.getChallengeInfoByToken=function(a,b){var c=g+l.CHALLENGE_INFO.replace(/:optimumId/,a)+"?token="+b;return w(c,"GET",{token:b},null,null).then(function(c){var d=_.map(c.data.questions,function(a){return{id:a.questionId,question:a.question}});return{questions:d,required:c.data.required,id:a,token:b}},function(){throw"UNRECOVERABLE_ERROR"})},this.getUserChallengeQuestions=function(b){var c=(new Date).getTime(),d=l.CHALLENGE_INFO.replace(/:optimumId/,b)+"?cachebreak="+c;return a.get(g+d)},this.getAccessCode=function(){var b=g+l.ACCESS_CODE_INFO;return a.get(b)},this.getCdxCustInfo=function(){var b=g+l.CDX_CUST_INFO;return a.get(b)},this.isUserIdBlocked=function(b){var c=h+l.USERID_BLOCKED.replace(/:optimumId/,b);return a.get(c)},this.IsOptimumIdBlocked=function(a){var b={optimumId:a},c=g+l.OPTIMUMID_BLOCKED.replace(/:optimumId/,a);return w(c,"POST",b,null,{"Content-Type":"application/json"})},this.postUpdateSecurityQuestion=function(a,b,c){var d=l.CHALLENGE_INFO_UPDATE.replace(/:optimumId/,a);d=l.CHALLENGE_INFO_UPDATE.replace(/:questionId/,b);var e={questionId:b,answer:c};return w(d,"POST",e,null,{"Content-Type":"application/json"})},this.getPremiumTierDevice=function(){var a=g+l.PREMIUM_TIER_DEVICE;return w(a,"GET",null,j,null)},this.setPremiumTierDevice=function(a,b,c){var d=g+l.PREMIUM_TIER_DEVICE+"/"+a,e={_links:{self:{href:"/user/premiumtier/device/"+a}},"mac-address":a,port80:c,port25:b};return w(d,"POST",e,null,{"Content-Type":"application/json"})},this.getPremiumTierUser=function(){var a=g+l.PREMIUM_TIER_USER;return w(a,"GET",null,i,null)},this.setPremiumTierUser=function(a,b){var c=g+l.PREMIUM_TIER_USER,d="1=1";a.ddns?d+="&ddns=enabled":b.ddns&&(d+="&ddns=disabled"),a.webhosting?d+="&webhosting=enabled":b.webhosting&&(d+="&webhosting=disabled");var e={"Content-Type":"application/x-www-form-urlencoded"};return w(c,"POST",d,null,e)},this.getRecoveryOptions=function(a,b,c){var d={optimumId:a,challenge:b,answer:c},e=g+l.RECOVER_OPTIONS;return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){return{email:a.data.email,phone:a.data.phone,emailHint:a.data.emailHint,phoneHint:a.data.phoneHint,token:a.data.token}},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw a.data.errorCode})},this.getKaptchaKey=function(){var b,c=new Date;console.log("Sending request to get kaptcha key!!!");var d=a.get(l.KAPTCHA_VALIDATE+"?cachebrk="+c.getTime()).then(function(a){return a||console.log("Getting invalid response from KaptchaValidate.jsp=="+a),console.log("Getting success response from KaptchaValidate.jsp=="+a.data),b=a.data},function(a){return console.log("Getting Error response from KaptchaValidate.jsp=="+a.data),b="kaptcha_error"});return d},this.sendTemporaryPassword=function(a,b,c){var d={token:c};"email"===a?(d.email=b,d.phone=""):"phone"===a&&(d.email="",d.phone=b);var e=g+l.SEND_TEMPORARY_PASS;return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){if(!a.data.status)throw new Error("Incorrect value for reset method")},function(a){if(400===a.status)throw"BAD_REQUEST";if(429===a.status)throw"THROTTLED";throw"UNRECOVERABLE_ERROR"})},this.verifyTemporaryPassword=function(a,b){var c={tempPass:b},d=g+l.VERIFY_TEMP_PASS.replace(/:optimumId/,a);return w(d,"POST",c,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;if("SUCCESS"===b)return a.data.token;throw"BAD_ANSWER"},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw"NOT_AUTHORIZED"})},this.checkSecurityQuestions=function(a,b,c){var d={token:b,questions:_.map(c,function(a){return{questionId:a.id||a.questionId,answer:a.answer}})},e=g+l.CHALLENGE_ANSWER.replace(/:optimumId/,a);return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;if("SUCCESS"===b)return a.data.token;throw"BAD_ANSWER"},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw"NOT_AUTHORIZED"})},this.verifyAccountNumber=function(a,b,c){var d={token:b,accountNumber:c},e=g+l.VERIFY_ACCOUNT.replace(/:optimumId/,a);return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;if("SUCCESS"===b)return a.data.token;throw"BAD_ANSWER"},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw"NOT_AUTHORIZED"})},this.customerUpgradeInfo=function(){var b=g+l.CUSTOMER_UPGRADE_INFO;return a.get(b)},this.checkSecurityQuestionUntrustedIP=function(a,b){var c={questionId:a,answer:b},d=l.CHALLENGE_ANSWER_MULTIAUTH;return w(d,"POST",c,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;"SUCCESS"!==b&&console.error("[User Service] checkSecurityQuestionUntrustedIP -  FAILED 200, Unkown response body from service: ",a.data)},function(a){throw console.error("[User Service] checkSecurityQuestionUntrustedIP - FAILED "+a.status+", response: ",a),a})},this.changePasswordAfterQuestions=function(a,b,c){var d={newPass:c,token:b},e=g+l.CHANGE_PASSWORD.replace(/:optimumId/,a);return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){return a},function(a){switch(a.status){case 400:throw{code:"BAD_PASS",message:a.data.Message};case 401:throw{code:"UNAUTHORIZED",message:""};default:throw{code:"UNKNOWN_ERROR",message:""}}})},this.deleteOptimumId=function(a){var b=g+l.GET_OPTIMUM_IDS+"/"+a;return w(b,"DELETE",null,null,null)},this.saveEntitlements=function(a){var b=g+l.GET_OPTIMUM_IDS+"/"+this.id+"/sdp";console.log("Changed Entitlement=="+a);var c={_links:{self:{href:"/user/optimumid/"+this.id+"/sdp"}},entitlements:{is_billpay_secondary:this.isBillpaySecondary,is_parental_controls_secondary:this.isParentalControlsSecondary}};return"isOptimumVoiceSecondary"===a&&(c.entitlements.is_optimum_voice_secondary=this.isOptimumVoiceSecondary),w(b,"POST",c,null,null)},this.addMailToOptimumId=function(a){var b=g+l.GET_OPTIMUM_IDS+"/"+a+"/onetemail",c={_links:{self:{href:"/user/optimumid/"+a+"/onetemail"}},optedInOptimumEmail:!0};return w(b,"POST",c,null,null)},this.getIsBehindTheModem=function(){var a=g+l.BEHIND_THE_MODEM;return w(a,"GET",null,k,null)},this.getWipStatus=function(){var a=g+l.GET_WIP_STATUS;return w(a,"GET",null,null,null)},this.getIsBehindAnyModem=function(){var a=g+l.BEHIND_ANY_MODEM;return w(a,"GET",null,null,null)};var y="/OPT/"+e.elineupId+"/"+e.laboxOrMini+"/"+1;return this.getPrivacySettings=function(){var a=g+l.PRIVACY_SETTINGS+y;return w(a,"GET",null,x,null)},this.setPrivacySettings=function(a,b){var c=g+l.PRIVACY_SETTINGS+y,d={_links:{self:{href:"/user/privacy/settings"}},recommendations:a,promotions:b};return w(c,"POST",d,null,null)},this.getTransferAccountInfo=function(a,b,c){var d=g+l.GET_TRANSFER_ACCOUNT_INFO,e={_links:{self:{href:"/user/transfer/account/"}},account_number:a,lname:b,phone:c};return w(d,"POST",e,n,{"Content-Type":"application/json"})},this.transferAccountMove=function(a,b,c,d,e,f){var h=g+l.TRANSFER_ACCOUNT_MOVE,i={_links:{self:{href:"/user/transfer/move"}},account_number:a,lname:b,phone:c,moveOptimumIds:d,primaryOptimumId:e,deleteOptimumIds:f};return w(h,"POST",i,t,{"Content-Type":"application/json"})},this.discoCheck=function(){var a=g+l.DISCO_CHECK;return w(a,"GET",null,u)},this.getTransferAccountPrefill=function(){var a=g+l.TRANSFER_ACCOUNT_PREFILL;return w(a,"GET",null,v)},this.getSanitizedPrincipal=function(a){return $.trim(a.replace(/@.*/,"").toLowerCase())},this};return this.verifyDiscoAccountNumber=function(b,c){var d=g+l.DISCO_ACCOUNT_NUMBER;return a.get(d+"?accountNumber="+b+"&token="+c)},v.query=t.query,v.get=t.get,v.current=t.current,v.getChallengeQuestions=function(b){var c={};return"undefined"!=typeof b&&(c["X-OOL-Token"]=b),a.get(g+l.CHALLENGE_QUESTIONS,{headers:c})},v.getBehindTheModem=function(){return a.get(g+l.BEHIND_THE_MODEM)},v.getBehindTrustedIp=function(){return a.get(g+l.BEHIND_TRUSTED_IP)},v.isDisconnected=function(){return a.get(g+l.DISCO_CHECK)},v.getBtmAccountInfo=function(){return a.get(g+l.ACCOUNT_INFO_BTM)},v.getGraceCount=function(){return a.get(g+l.GRACECOUNT_GET)},v.insertUpdateGraceCount=function(){return a.get(g+l.GRACECOUNT_INSERT_UPDATE)},v.getCreateIdToken=function(b,c,d,e){var f={AccountNo:b,LastName:c,HomePhoneNo:d,captcha:e},h=function(a){return angular.toJson(a)};return a.post(g+l.CREATE_ID_TOKEN,f,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:h})},v.getAccountInfo=function(){var b=g+"accountinfo";return a.get(b)},v.getOptimumIds=function(b){var c=g+"optimumid/?fields=package";return"undefined"==typeof b||b||(c+="&useCache=false"),a.get(c)},v.getIMS=function(b){return a.get(g+"optimumid/"+b)},v.getCPC=function(b){return a.get(g+"optimumid/"+b+"/cpc"+(angular.isNumber(n)?"?cache="+n:""))},v.setCPC=function(b,c){return n=(new Date).getTime(),a.post(g+"optimumid/"+b+"/cpc",c)},v.postIMS=function(b,c){return m=(new Date).getTime(),a.post(g+"optimumid/"+b,c)},v.setAltContact=function(b,c){return m=(new Date).getTime(),a.post(g+"optimumid/"+b+"/altcontact",c)},v.updatePassword=function(b,c){return a.post(g+"optimumid/"+b+"/password",c)},v.changePrimaryName=function(b){return a.post(g+"name_change",b)},v.getOptimumIdExists=function(b,c){var d=g+l.OPTIMUM_ID_EXISTS.replace(/\{optumumId\}/,b);return a.get(d,{headers:{"X-OOL-Token":c}})},v.createOptimumId=function(b,c,d,e,f,h,i,j,k,m,n,o,p,q){var r=l.OPTIMUM_IDS.replace(/:optimumId/,b),s={_links:{self:{href:"/user/"+r}},id:b,userType:c,fname:d,lname:e,zipcode:f,passwd:h,enable_billpay:m,enable_parental_controls:n,enable_optimum_voice:o,wants_email:p,passwd_reset:[{type:"email",value:"undefined"==typeof i?"":i},{type:"phone",value:"undefined"==typeof j?"":j}],questions:[]};for(var t in k)s.questions.push({_links:{self:{href:"/user/"+r+"/challenge/"+t}},questionId:t,answer:k[t]});var u=function(a){return angular.toJson(a)},v={};return v=q?{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-OOL-Token":q}:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},a.put(g+r,s,{headers:v,transformRequest:u})},v.getCustInfo=function(b){var c={};return"undefined"!=typeof b&&(c["X-OOL-Token"]=b),a.get(g+l.CUST_INFO,{headers:c})},v.postChallengeQuestions=function(b,c,d){var e=l.CHALLENGE_INFO.replace(/:optimumId/,b),f={_links:{self:{href:"/user/"+e+"/challenge"}},questions:[],deleteGrace:d};for(var h in c)f.questions.push({questionId:h,answer:c[h]});var i=function(a){return angular.toJson(a)};return a.post(g+e,f,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:i})},v.submitUpgrade=function(b,c,d){var e=g+l.SUBMIT_UPGRADE,f={method:"POST",url:e,responseType:"json",data:b};return a(f).then(function(a){c(a)},function(a){d(a)})},v.submitRentOrder=function(b,c,d){var e=g+l.SUBMIT_RENT_ORDER,f={method:"POST",url:e,responseType:"json",data:b};return a(f).then(function(a){c(a)},function(a){d(a)})},v.addRemoveRc=function(b,c,d){var e=g+l.ADD_REMOVE_RC,f={method:"POST",url:e,responseType:"json",data:b};return a(f).then(function(a){c(a)},function(a){d(a)})},v.getOrderStatus=function(b){var c=g+l.ORDER_STATUS,d={};d.serviceCodes=b;var e={method:"POST",url:c,responseType:"json",data:d};return a(e)},v.getVendorFlag=function(b){return FLAG=i+b,a.get(FLAG)},v.accesscodeShown=function(){var b=g+l.ACCESSCODE_SHOWN,c={method:"POST",url:b};return a(c)},v.getoolSession=function(){return a.get(j)},v.saveAccessCode=function(b){var c=g+l.SAVE_ACCESS_CODE,d={method:"POST",url:c,responseType:"json",data:b};return a(d)},v.verifyAccessCode=function(b){var c=g+l.VERIFY_ACCESS_CODE,d={method:"POST",url:c,responseType:"application/json",data:b};return a(d)},v.getRouterWirelessLan=function(b){var c=g+l.ROUTER_GET_WIRELESS_LAN;return void 0!==b&&(c=c+"?mac="+b),a.get(c)},v.getLanConnection=function(b){var c=g+l.ROUTER_GET_LAN_CONNECTION;return void 0!==b&&(c=c+"?mac="+b),a.get(c)},v.setLanConnection=function(b){var c=g+l.ROUTER_SET_LAN_CONNECTION;void 0!==b.macAddress&&(c=c+"?mac="+b.macAddress);var d=function(a){return angular.toJson(a)};return a.post(c,b.lanConnectionData,{headers:{"Content-Type":"application/json"},transformRequest:d})},v.validateSubnet=function(b){var c=g+l.ROUTER_VALIDATE_SUBNET,d=function(a){return angular.toJson(a)};return a.post(c,b,{headers:{"Content-Type":"application/json"},transformRequest:d})},v.setWirelessLan=function(b){var c=g+l.ROUTER_SET_WIRELESS_LAN;void 0!==b.macAddress&&(c=c+"?mac="+b.macAddress);var d=function(a){return angular.toJson(a)};return a.post(c,b.wirelessLanData,{headers:{"Content-Type":"application/json"},transformRequest:d})},v.findBestChannel=function(b){var c=g+l.ROUTER_FIND_BEST_CHANNEL;void 0!==b.macAddress&&(c=c+"?mac="+b.macAddress);var d=function(a){return angular.toJson(a)};return a.post(c,b.data,{headers:{"Content-Type":"application/json"},transformRequest:d})},v.validate=function(b){var c=g+l.ROUTER_VALIDATE;for(var d in b)c=c+"?name="+d+"&value="+b[d];return a.post(c,null,{headers:{"Content-Type":"application/json"}})},v.getNetworkMap=function(b){var c=g+l.ROUTER_GET_NETWORK_MAP;return void 0!==b&&(c=c+"?mac="+b),a.get(c)},v.resetRouter=function(b){var c=g+l.ROUTER_RESET;void 0!==b.macaddress&&(c=c+"?mac="+b.macaddress);var d=function(a){return angular.toJson(a)};return a.post(c,b.data,{headers:{"Content-Type":"application/json"},transformRequest:d})},v.submitLead=function(b){var c=g+l.EASY_MOVE_LEAD,d=function(a){return angular.toJson(a)};return a.post(c,b,{headers:{"Content-Type":"application/json"},transformRequest:d})},v.getPortForwarding=function(b){var c=g+l.ROUTER_GET_PORT_FORWARDING;return void 0!==b&&(c=c+"?mac="+b),a.get(c)},v.setPortForwarding=function(b){var c=g+l.ROUTER_SET_PORT_FORWARDING;void 0!==b.macAddress&&(c=c+"?mac="+b.macAddress);var d=function(a){return angular.toJson(a)};return a.post(c,b,{headers:{"Content-Type":"application/json"},transformRequest:d})},v.getRouterFeaturesByModel=function(b){var c=k+b;return a.get(c)},e._userService=v,v}]),angular.module("vod",["config","oolCookie","alertModal","l","onetCookies"]).factory("Vod",["$http","$q","Config","$log","ooluser","alertModal","l","$rootScope","Cookies",function(a,b,c,d,e,f,g,h,i){function j(){}function k(a,b,c,d,e){if(void 0!==a.result){var f=a.result.titles;void 0!==c&&null!==c&&(f=_.filter(f,function(a){return a.tms_id!==c})),void 0!==c&&null!==c&&null!==c.match("^EP")&&1!==d&&(f=_.filter(f,function(a){var b=a.tms_id;return void 0!==b&&null!==b.match("^EP")?a:void 0})),void 0===c&&e===s&&(f=_.filter(f,function(a){var b=a.tms_id;return void 0!==b&&null!==b.match("^EP")||void 0!==a.show_type&&a.show_type===s?a:void 0})),u>0&&(f=f.slice(0,u)),a.result.carouselItems=_.map(f,function(a){return _.extend(new j,a).toCarouselItem(q,b)})}}var l=c.getValuesBySelector("endpoint.api.vodwebapp"),m=c.getValuesBySelector("endpoint.api.vodonyximage"),n=c.getValuesBySelector("endpoint.api.vod"),o=c.getValuesBySelector("endpoint.api.wpg"),p=c.getValuesBySelector("endpoint.api.epg"),q="More like this",r="episode",s="Series",t=20,u=20,v={ids:[],assets:[],carouselItems:[],stale:!0},w={},x=!1,y=!1,z=[],A=new Date;trackClick="Record_bttm",isMenuItemsAailable=!1,isMenuCallDone=!1,menuList={},getMenuCallBackRegister=[];var B=[{status:500,msg:"Sorry, there was an error. Please try again later."}],C=i.getCookie("epg"),D="?lbsearch=true",E=function(){var c={contains:function(a,b,d){var e={hd_asset:!1,sd_asset:!1,inCart:!1};if(angular.isObject(v)&&null!==v&&v.stale===!1){var f=_.where(v.ids,{hd_asset:a});0===f.length&&(f=_.where(v.ids,{sd_asset:a})),f.length>0&&(e.hd_asset=f[0].inCartHd,e.sd_asset=f[0].inCartSd,e.inCart=f[0].inCart),b(e)}else c.getItems(function(c){if(angular.isObject(c)&&angular.isArray(c.ids)){var d=_.where(c.ids,{hd_asset:a});0===d.length&&(d=_.where(c.ids,{sd_asset:a})),d.length>0&&(e.hd_asset=d[0].inCartHd,e.sd_asset=d[0].inCartSd,e.inCart=d[0].inCart),b(e)}},d)},getItems:function(c,d,f){var g=l+"getCart",i=(new Date).getTime();return c=c||angular.noop,d=d||angular.noop,e.hasOOLSession?y?(console.log("getCart Data is available..so calling success immediately"),c(v),void 0):x&&!y?(console.log("getCart call in progress...wait for response"),z.push(c),void 0):(a.get(g+"?"+i).then(function(a){if("SUCCESS"===a.data.status){var d=a.data.data.result;if(angular.isObject(d)?(v.stale=!1,v.ids.length=0,h.cartCount=a.data.data.result.total,_.each(d.titles,function(a){v.ids.push(a)}),y=!0):(v.ids.length=0,v.assets.length=0,v.carouselItems.length=0),!f){0===z.length&&c(v);for(var e=0;e<z.length;e++)z[e](v)}}else b.reject(a.data)},function(a){d(a)}),x=!0,void 0):(d({Message:"No session.  Login required.",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),void 0)
}};return c}();return E.getItems(),j.prototype.getArtwork=function(a){return"LINEAR"===a?m+this.series_image_name+"&size=280x210":"VOD"===a?m+this.image_name+"&size=280x210&alt_size=200x150":void 0},j.prototype.cart=function(){var a=this;return angular.isUndefined(this._inCartObject)&&(this._inCartObject={}),E.contains(this.id,function(b){a.inCart=b.inCart}),this._inCartObject},j.prototype.toCarouselItem=function(a,b){this.id="LINEAR"===b?this.tms_id:this.title_id;var c=this.callsign;("MOD"===this.callsign||"VOD"===this.callsign)&&(c="On Demand"),"FOD"===this.callsign&&(c="Free On Demand");var d;if(angular.isObject(this._carouselItem))return d=this._carouselItem;if(w.hasOwnProperty(this.id))return d=this._carouselItem=w[this.id];if(d={id:this.id.toString(),title:this.episode_title||this.title,callsign:c,artwork:this.getArtwork(b),epSeasonNumber:this.season_number,network:this.network+" On Demand",epEepisodeNumber:this.episode_number},"LINEAR"===b){var f=this.qualifiers.split(",");if(d._new=-1!==$.inArray("New",f)?!0:!1,d.href="/program/tId:"+this.tms_id,void 0!==this.more_airings){var g=this.more_airings[0].from_date,h=this.more_airings[0].to_date;d.epStartTime=new Date(t+g.split(" ")[0].split("/")[2],parseInt(g.split(" ")[0].split("/")[0],10)-1,g.split(" ")[0].split("/")[1],g.split(" ")[1].split(":")[0],g.split(" ")[1].split(":")[1]).getTime(),d.epEndTime=new Date(t+h.split(" ")[0].split("/")[2],parseInt(h.split(" ")[0].split("/")[0],10)-1,h.split(" ")[0].split("/")[1],h.split(" ")[1].split(":")[0],h.split(" ")[1].split(":")[1]).getTime(),d.callsign=this.more_airings[0].callsign,d.network=this.more_airings[0].callsign,d.ctrlisRecorded=d.ctrlhaveDVR=!1,d.showButton=d.epStartTime>A?!0:!1,d.program={episodeTitle:d.title,title:d.title,cs:d.callsign,starttime:new Date(d.epStartTime),StartTime:new Date(d.epStartTime),start_time:new Date(d.epStartTime),end_time:new Date(d.epEndTime),endTime:new Date(d.epEndTime),num:this.more_airings[0].channel_number,itemRecorde:!1,trackClick:trackClick}}e.hasOOLSession&&(d.recbutton=!0)}if("VOD"===b){var i=this.hd_asset||this.sd_asset,j=this.offer_end_date;d.vodAvailableThrough=new Date(j.split("-")[0],parseInt(j.split("-")[1],10)-1,j.split("-")[2]).getTime(),d._new=d.indicators>>2&!0?!0:!1,d.href="/episode/"+i,d.release_year=this.release_year,void 0!==this.hd_asset&&(d.hd_asset=this.hd_asset),void 0!==this.sd_asset&&(d.sd_asset=this.sd_asset),E.contains(i,function(a){d.inCart=a.inCart,d.inCartHd=a.hd_asset,d.inCartSd=a.sd_asset})}return this._carouselItem=w[this.id]=d,d},{VodMovieCart:E,addToCart:function(b,c,d,e){null!==c&&"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:c}),reporting.setAttrs({prop10:c}),reporting.sendAttrs(!0));var f={};return d=d||angular.noop,e=e||angular.noop,a.get(l+"addToCart/"+b+"?"+(new Date).getTime()).success(function(a,b,c,f){"SUCCESS"===a.status?(y=x=!1,E.getItems(),d(a,b,c,f)):e(a,b,c,f)}).error(function(a,b,c,d){e(a,b,c,d)}),f},removeFromCart:function(b,c,d,e){null!==c&&"undefined"!==reporting&&(reporting.setEvents(["event9"]),reporting.setAttrs({eVar10:c}),reporting.setAttrs({prop10:c}),reporting.sendAttrs(!0));var f={};return d=d||angular.noop,e=e||angular.noop,a.get(l+"removeFromCart/"+b+"?"+(new Date).getTime()).success(function(a,b,c,f){"SUCCESS"===a.status?(y=x=!1,E.getItems(),d(a,b,c,f)):e(a,b,c,f)}).error(function(a,b,c,d){e(a,b,c,d)}),f},getTopPicks:function(){return a({method:"GET",url:n+"getTopPicks"})},getLandingPage:function(){return a({method:"GET",url:l+"getLandingPage"})},getLandingPagewithRequestCount:function(b,c){return a({method:"GET",url:l+"getLandingPage?requestCount="+b+"&pagenum="+c})},getVodMenu:function(b,c){var d=l+"getMenus";return b=b||angular.noop,c=c||angular.noop,isMenuItemsAailable?(b(menuList),void 0):isMenuCallDone&&!isMenuItemsAailable?(getMenuCallBackRegister.push(b),void 0):(a.get(d).then(function(a){if("SUCCESS"===a.data.status){isMenuItemsAailable=!0,menuList=a.data,0===z.length&&b(menuList);for(var c=0;c<getMenuCallBackRegister.length;c++)getMenuCallBackRegister[c](menuList)}}),isMenuCallDone=!0,void 0)},getVodMenuParentMenuId:function(b){return a({method:"GET",url:l+"getMenus/"+b})},getTitles:function(b){return a({method:"GET",url:l+"getTitles/tmsid:"+b})},getTitle:function(b){return a({method:"GET",url:l+"getTitles/"+b})},getMovieDetail:function(b){return a({method:"GET",url:l+"getMovieDetail/"+b})},getMovieDetailSearch:function(b){return a({method:"GET",url:l+"getMovieDetail/"+b+D})},getLinearMovieDetail:function(b,c,d,e,f){return a({method:"GET",url:n+"getMovieDetail/"+b+"/"+c+"/"+d+"/"+e+"/"+f})},getLinearMovieDetailNew:function(b,c,d,e,f){return a({method:"GET",url:n+"getMovieDetail/"+b+"/"+c+"/"+d+"/"+e+"/"+f})},getLinearEventDetail:function(b,c,d){var f={};e.laBoxUser=e.hasOOLSession?e.laBoxUser||e.laboxOrMini:"true"===i.getCookie("labox");var g=e.laBoxUser;return C&&C.length>0&&(f=JSON.parse(C)),(void 0===c||null===c||"undefined"===c||"null"===c||""===c)&&(c=f.hubId?f.hubId:105),(void 0===d||null===d||"undefined"===d||"null"===d||""===d)&&(d=void 0!==f.isHD?f.isHD:!0),ep_url=o+"getEventDetails/"+b+"/"+c+"/"+d,g&&(ep_url=ep_url+"?laBox="+g),a({method:"GET",url:ep_url})},getChannelEventDetail:function(b,c,d,f,g,h){var j={},k=e.hasOOLSession?e.laBoxUser:"true"===i.getCookie("labox");return C&&C.length>0&&(j=JSON.parse(C)),(void 0===d||null===d||"undefined"===d||"null"===d||""===d)&&(d=j.hubId?j.hubId:105),(void 0===f||null===f||"undefined"===f||"null"===f||""===f)&&(f=void 0!==j.isHD?j.isHD:!0),ep_url=o+"getTvAssets/"+b+"/"+c+"/"+d+"/"+f+"/"+g+"/"+h,k&&(ep_url=ep_url+"?laBox="+k),a({method:"GET",url:ep_url})},getLinearProgramDetail:function(b,c,d,f,g,h){var j={},k=e.hasOOLSession?e.laBoxUser:"true"===i.getCookie("labox");return C&&C.length>0&&(j=JSON.parse(C)),(void 0===d||null===d||"undefined"===d||"null"===d||""===d)&&(d=j.hubId?j.hubId:105),(void 0===f||null===f||"undefined"===f||"null"===f||""===f)&&(f=void 0!==j.isHD?j.isHD:!0),ep_url=o+"getProgramDetails/"+b+"/"+c+"/"+d+"/"+f+"/"+g+"/"+h,k&&(ep_url=ep_url+"?laBox="+k),a({method:"GET",url:ep_url})},getEventLinearData:function(b,c,d,f,g,h){var j="";if(c===r)j=l+"getEventLinearData/vodlinear/"+b+"/"+c;else if(null!==d&&null!==f&&null!==g)j=n+"getEventLinearData/linear/"+b+"/"+d+"/"+f+"/"+g+"/"+h;else if(null!==d){var k=null,m=e.hasOOLSession?e.laBoxUser:"true"===i.getCookie("labox");if(C&&C.length>0){var p=JSON.parse(C);(""===h||null===h)&&(h=p.hubId),k=p.isHD}else h=null;j=o+"getEventDetails/"+b+"/"+h+"/"+k,m&&(j=j+"?laBox="+m)}else j="search"===c?l+"getEventLinearData/vodtitle/"+b+D:l+"getEventLinearData/vodtitle/"+b;return a({method:"GET",url:j})},getUpgMoreEventInfo:function(b){return a({method:"GET",url:o+"upgMoreEventInfo/"+b})},getDvrVideos:function(b,c,d){return a({method:"GET",url:n+"getEventLinearData/tribune/"+b+"/"+c+"/"+d})},getSeriesDetailsNew:function(b,c){return a({method:"GET",url:l+"getSeriesDetails/"+b+"/menu/"+c})},getSeriesDetailsBySeriestmsidNew:function(b,c){return a({method:"GET",url:l+"getSeriesDetails/"+b+"/series/"+c})},getSeriesDetails:function(b){return a({method:"GET",url:l+"getSeriesDetails/"+b+"/menu"})},getSeriesDetailsBySeriestmsid:function(b){return a({method:"GET",url:l+"getSeriesDetails/"+b+"/series"})},getSeriesDetailswEp:function(b){return a({method:"GET",url:l+"getSeriesDetails/"+b+"/episode"})},getSeriesDetailswshowCardId:function(b){return a({method:"GET",url:l+"getSeriesDetails/"+b+"/showcard"})},getMoreLikeThis:function(){return null},getLineUp:function(){var b=e.hasOOLSession?e.optimumId:"";return a({method:"GET",url:p+"lineup"+"?optimumId="+b})},getMoreLinearEpisodes:function(b,c,d,e,f){var g={};return e=e||angular.noop,f=f||angular.noop,a.get(l+"getMoreLinearEpisodes/"+b+"/"+c).success(function(a,c,f,h){if("SUCCESS"===a.status){var i=a.data;k(i,d,b,null,null,null),angular.extend(g,i),e(i,c,f,h)}else e(a,c,f,h)}).error(function(a,b,c,d){e(a,b,c,d)}),g},getMoreEpisodes:function(b,c,d,e,f,g,h){var i={};g=g||angular.noop,h=h||angular.noop;var j=b;return a.get(l+"getTitles/"+j).success(function(a,b,j,l){if("SUCCESS"===a.status){var m=a.data;k(m,f,c,d,e),angular.extend(i,m),g(m,b,j,l)}else h(a,b,j,l)}).error(function(a,b,c,d){h(a,b,c,d)}),i},getTvShowings:function(b){return a({method:"GET",url:l+"getTvShowings/"+b})},getSummaryList:function(b,c,d,e,f){return a({method:"GET",url:l+"getTitlesForPagination/"+b+"/"+c+"/"+d+"?sort="+e+"&filter="+f})},getTime:function(a){return new Date(t+a.split(" ")[0].split("/")[2],parseInt(a.split(" ")[0].split("/")[0],10)-1,a.split(" ")[0].split("/")[1],a.split(" ")[1].split(":")[0],a.split(" ")[1].split(":")[1]).getTime()},getrating:function(a){var b={},c={0:"N/R",1:"TV-Y",2:"TV-Y7",3:"TV-G",4:"TV-PG",5:"TV-14",6:"TV-MA",7:"G",8:"PG",9:"PG-13",10:"R",11:"NC-17",12:"NR"};return b.critics_rating=7&a,b.content_rating=c[15&a>>6],b._at=1&a>>12?!0:!1,b._s=1&a>>13?!0:!1,b._bn=1&a>>16?!0:!1,b},getflags:function(a){var b={};return b._hd=1&a>>5?!0:!1,b},getindicators:function(a){var b={};return b._cc=1&a>>4?!0:!1,b._new=a>>2&!0?!0:!1,b._dd=a>>1&!0?!0:!1,b._sap=1&a>>5?!0:!1,b},getestTime:function(a){var b=144e5,c=18e6,d=moment(a),e=a+1e3*60*d.zone(),f=e;return f=f=d.isDST()?e-b:e-c},getErrorMsg:function(a){var b=_.filter(B,{status:a});return void 0!==b?b[0].msg:""}}}]).filter("maxCast",function(){return function(a){return null!==a&&void 0!==a?a.split(",").filter(Boolean).slice(0,5):"0-0"}}).filter("offerEndDate",function(){return function(a){if(void 0!==a&&""!==a&&null!==a){var b=a.split("-");return new Date(b[0],parseInt(b[1],10)-1,b[2]).getTime()}}}).directive("showMore",["$compile",function(){return{restrict:"A",link:function(a,b,c){var d="",e=5;void 0!==c.maxlimit&&(e=parseInt(c.maxlimit,10)),b.click(function(){1===b.parents(".on-tv").length&&(d=".on-tv"),1===b.parents(".ondemand").length&&(d=".ondemand"),b.parents(d).find(".channel-info:visible").last().removeClass("remove-border");var a=b.parents(d).find(".channel-info:visible").length-1;b.parents(d).find(".channel-info:visible").nextAll().slice(a,a+e).removeClass("remove-border").show(),b.parents(d).find(".channel-info:visible").nextAll().slice(a,a+e).addClass("showlessAirings"),b.parents(d).find(".channel-info:visible").last().addClass("remove-border"),JSON.parse(c.items)===b.parents(d).find(".channel-info:visible").length&&(b.hide(),b.parent(".show-more").next("#showless").show())}),b.parent(".show-more").next("#showless").click(function(){b.parents(d).find(".channel-info:visible").length>e&&(b.parents(d).find(".showlessAirings:visible").slice(-e).removeClass("showlessAirings").hide(),b.parents(d).find(".channel-info:visible").last().addClass("remove-border"),0===b.parents(d).find(".showlessAirings:visible").length&&(b.parent(".show-more").next("#showless").hide(),b.show()))})}}}]),angular.module("weather",["ngResource","config","jssi"]).factory("Weather",["$resource","Config","CacheKeyURL",function(a,b,c){var d=c(b.getValuesBySelector("endpoint.api.weather")+"?zip=@Zipcode@");return a(d,{},{})}]),angular.module("webdvrResource",["ngResource","config","oolCookie","dvrRecordingModel","onetCookies"]).value("WebDVRs",[]).factory("WebDVR",["$resource","$http","$q","Config","ooluser","WebDVRs","recordingModel","Cookies",function(a,b,c,d,e,f,g,h){function i(a){return Math.floor(moment().valueOf()/a)}e.laBoxUser=e.hasOOLSession?e.laBoxUser||e.laboxOrMini:"true"===h.getCookie("labox"),angular.toJson,angular.fromJson;var j=e.optimumId||"",k=d.getValuesBySelector("endpoint.api.dvr")+"json/webdvrservicejson.do",l=d.getValuesBySelector("endpoint.api.dvr")+"epg/webdvrRequest.jsp",m=d.getValuesBySelector("webDVR.allowMultipleDVRLookup"),n=d.getValuesBySelector("endpoint.api.dvrwebapp"),o=a(k,{},{});return o.create=function(a){return new o(a)},o.prototype.$get=function(a,d){function f(a){return e.laBoxUser?{boxSerialNumber:a.boxSerialNumber}:{method:"getBoxState",boxSerialNumber:a.boxSerialNumber,boxMACAddress:""}}function g(a){return a.errorMsg}function h(a){return"SUCCESS"===a.data.errorMsg}a=a||angular.noop,d=d||angular.noop;var i=this,j=k;return e.laBoxUser&&(j=n+"labox/getspace"),b.get(j,{params:f(i),cache:!1}).then(function(a){return h(a)?a:c.reject(g(a.data))}).then(function(b){var c=b.data.boxData;return c.boxSerialNumber=b.data.boxSerialNumber,c.boxMACAddresponses=b.data.boxMACAddresponses,c.homeId=b.data.homeId,_.extend(i,c),a(i)},function(a){return reporting.setAttrs({prop35:"Error at DVR box information check"}),reporting.sendAttrs(!0),d(a)}),this},o.query=function(a,c,d){var g={method:"getAlias"};return a=a||angular.noop,c=c||angular.noop,e.hasOOLSession?(d&&(g.killable=!0),b.get(k,{params:g,cache:!0}).then(function(b){f.length=0,f.hasDvrBlocked=!1,void 0===b.data.stb||0!==b.data.stb.length||e.primary?angular.forEach(b.data.stb,function(a){f.push(o.create(a))}):f.hasDvrBlocked=!0,a(f)},function(a){var b;angular.isObject(a)?angular.isObject(a.data)?b=a.data.Message:angular.isString(a.data)&&(b=a.data):b=a,c(b)}),f):(c({Message:"No session.  Login required.",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),void 0)},o.queryMultipleDVRs=function(a,b,c){function d(b){_.each(b,function(b){var c=b.SchProgElement;c.isRecorded=!1,c=g(c),f.length<a&&c.isDependable&&f.push(c)})}var e=4,f=[];return angular.isString(a)&&a.match(/^\d$/)&&(a=parseInt(a,10)),angular.isFunction(a)&&(c=b,b=a,a=e),(!angular.isNumber(a)||1>a)&&(a=e),angular.isFunction(b)||(b=angular.noop),angular.isFunction(c)||(c=angular.noop),m?o.query(function(e){var g,h=0,i=function(){h<g.length&&f.length<a?g[h].query({scheduled:!0},function(a){d(a),h++,i()},function(a){c(a)}):angular.isFunction(b)&&b(f)};e.length?(g=_.map(e,function(a){return a.recording(!0)}),i()):b(f)},function(a){c(a)},!0):o.prototype.recording.call(null,!0).query({scheduled:!0},function(a){d(a),b(f)},function(a){c(a)}),f},o.prototype.recording=function(f){var g=this,h={},m=a(k,{},h);return m.create=function(a){var b=a.RecordedProgElement?"RecordedProgElement":"SchProgElement",c=a[b];return c.id=_.uniqueId(),angular.isArray(c.ImageList)&&_.each(c.ImageList,function(a){angular.isObject(a)&&angular.isString(a.ImgUrl)&&(a.ImgUrl=a.ImgUrl.replace(/^http:\/\/([^\/]+)/,"/iptv-proxy/$1/"))}),new m(a)},m.parseError=function(a){function b(a){return-1!==a.search(/^<html>/)}var c;if(_.isString(a)&&b(a))return c;var d;return _.isString(a)&&(a.indexOf(":")>0?d=$.trim(a).split(": ")[1]:a.indexOf("|")>0&&(d=$.trim(a).split("|")[1])),"null"===d?c:d},m.prototype.$save=function(a,d,f){function h(a){return m.parseError(a)}function i(a){return-1!==$.trim(a.data).search(/SUCCESS$/)}void 0===f?(f=d||angular.noop,d=a||angular.noop):(a=a||{},d=d||angular.noop,f=f||angular.noop);var j=this,k=_.extend(_.clone(j),a,{request_type:"REQUEST_RECORDING",serial_number:g.boxSerialNumber});return e.laBoxUser&&(l=n+"labox/createrecord"),b.post(l,null,{params:k}).then(function(a){return"undefined"!=typeof reporting&&(reporting.setAttrs({eVar1:"Tv | Guide | request_recording",pageName:"Guide",channel:"Tv"}),reporting.sendAttrs(!0)),i(a)?a:c.reject(h(a.data))},function(){return c.reject()}).then(function(){return d(j)},function(a){return reporting.setAttrs({prop35:"Error scheduling recording"}),reporting.sendAttrs(!0),f(a)}),this},m.query=function(a,c,h){a=a||{},c=c||angular.noop,h=h||angular.noop;var k=[],l={request_type:a.scheduled?"GET_SCHEDULED_RECORDINGS":"GET_RECORDED_PROGRAMS",isVODRequest:"FALSE",os:"6.0",isLinearRequest:15,optimum_id:j,hubId:4,deviceType:"Web",artName:"net_poster_67x89",deviceId:"2288baff6e7835065fbb696130d0111d1d739173",cacheId:a.cacheId||i(3e4)};null!==g&&(l.serial_number=g.boxSerialNumber),f&&(l.killable=!0);var o=d.getValuesBySelector("endpoint.api.dvr")+"epg/DVRRequest.jsp";if(e.laBoxUser){var p=a.scheduled?"labox/getscheduledList":"labox/getrecordedList";o=n+p,l={lineupId:e.elineupId}}return b.get(o,{params:l}).then(function(b){var d=a.scheduled?b.data.result.SchProgMap:b.data.result.RecordedProgList;k.length=0,angular.forEach(_.filter(d,function(a){var b=a.RecordedProgElement?"RecordedProgElement":"SchProgElement",c=a[b];return c.Title&&angular.isObject(c.Program)&&c.Program.callsign&&c.Program.StartTime&&c.Program.EndTime?!0:!1}),function(a){k.push(m.create(a))}),c(k)},function(a){h(a.data.StatusMessage),reporting.setAttrs({prop35:"Error scheduling recording"}),reporting.sendAttrs(!0)}),k},m.destroyAll=function(a,c,d){c=c||angular.noop,d=d||angular.noop;var f,h,i;f=[],h=!!a[0].RecordedProgElement,i=h?"RecordedProgElement":"SchProgElement";var j="recording",l=_.map(a,function(a){var b,c,d,f,g;b=a[i].Program,c="MM-DD-YY HHmmss",d=moment(b.StartTime,c).valueOf(),f=moment(b.EndTime,c).valueOf(),g=f-d;var k={isRecorded:h,program:{callSign:b.callsign,startTime:d,endTime:f,programLength:g,channelNumber:b.ChannelNumber}};return e.laBoxUser&&(k.program.assetId=h?b.dvrAssetId?b.dvrAssetId:"":b.dvrSeriesId?b.dvrSeriesId:b.dvrAssetId?b.dvrAssetId:"",b.dvrSeriesId&&null!==b.dvrSeriesId&&void 0!==b.dvrSeriesId&&"undefined"!==b.dvrSeriesId&&(j="series")),k}),m={method:h?"eraseMultipleRecordingsRecorded":"eraseMultipleRecordingsScheduled",arguments:{boxSerialNumber:g.boxSerialNumber,boxMACAddress:"",programs:l}},o=k;if(e.laBoxUser){var p=h?"recording":j;o=n+"labox/delete/"+p}return b.post(o,m).then(function(a){if("null"!==a.data){var b=h?a.data.recordedProgram:a.data.scheduledProgram;if(void 0!==b&&"undefined"!==b){var e=0;angular.forEach(l,function(a){angular.forEach(b,function(b){return b.program.callSign===a.program.callSign&&b.program.startTime===a.program.startTime&&b.program.channelNumber===a.program.channelNumber&&b.program.programLength===a.program.programLength?(d(b.title),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),e++,!1):void 0})}),e>0?reporting.sendAttrs(!0):c(f)}else d(a.data.errorMsg),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)}else d("Please try again later"),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)},function(a){d(a.data.errorMsg),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)}),f},m.destroySingle=function(a,c,d){c=c||angular.noop,d=d||angular.noop;var f,h,i,j,l,m,o=[],p=[];f="YYYYMMDD HHmmss",h=moment(a.start_time,f).valueOf(),i=moment(a.end_time,f).valueOf(),m=moment(a.startTime,"MM-DD-YY HHmm").valueOf(),l=a.call_sign,j=i-h;var q={callSign:l,startTime:m,endTime:i,programLength:j},r=k;e.laBoxUser&&(q.stationId=a.stationId,q.startTime=h,r=n+"labox/deletesingle");var s={isRecorded:!1,program:q};p.push(s);var t={boxSerialNumber:g.boxSerialNumber,boxMACAddress:"",programs:p};e.laBoxUser&&(t.lineupId=e.elineupId);var u={method:"eraseMultipleRecordingsScheduled",arguments:t};return b.post(r,u).then(function(a){if("null"!==a.data&&!e.laBoxUser||""!==a.data&&e.laBoxUser){var b=a.data.scheduledProgram;angular.forEach(b,function(a){o.push(a)}),c(o),"undefined"!=typeof reporting&&(reporting.setAttrs({eVar1:"Tv | Guide| cancel_recording",pageName:"Guide",channel:"Tv"}),reporting.sendAttrs(!0))}else d("Sorry, we are not able to cancel at this moment. Please try again later"),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)},function(a){d(a.data.errorMsg)}),o},m},o.setBoxAlias=function(a,c){return b.post(k,{method:"setAlias",arguments:{boxSerialNumber:a,boxAlias:c}})},o.getAllAlias=function(){return b.get(k,{params:{method:"getAlias",arguments:{}}})},o.setFavorite=function(a,c){return b.post(k,{method:"setFavorite",arguments:{optimumId:a,boxSerialNumber:c,boxMACAddress:""}})},o.setBlacklist=function(a,c){return b.post(k,{method:"setBlacklist",arguments:{boxSerialNumber:a,blacklists:c}})},o.signup=function(a,c){return b.post(k,{method:"signup",arguments:{}}).then(function(b){a(b.data)},function(a){c(a.data)})},o.gteSDHDMapping=function(){var a={request_type:"GET_SD_HD_MAP",serial_number:""};return b.get(l,{params:a})},o}]),angular.module("webmailService",["ngCookies","config","oolCookie"]).factory("Webmail",["$http","$rootScope","$cookies","Config","ooluser",function(a,b,c,d,e){var f=d.getValuesBySelector("endpoint.api.webmail"),g={WEBMAIL_DETAILS:f+"Webmail/Webmail_Details"},h=e.eoid?e.eoid:"";d.getValuesBySelector("endpoint.api.ox_webmail");var i=d.getValuesBySelector("link.mailOxDeepLink"),j=d.getValuesBySelector("link.mailSncrInboxLink"),k=d.getValuesBySelector("endpoint.api.login"),l=d.getValuesBySelector("endpoint.api.email_metadata");subjectLines=function(a,c){var d=/<\s*[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\s*>/i,e=["answered","flagged","draft","deleted","seen","forwarded","unseen"],f=[],g={webmail:[],wasSuccessful:!0};if(a&&a.length){for(var h=0,i=a.length;i>h;h++){var j=a[h];j&&(j[1].split(" "),f.push({from:j[2].replace(d,""),subject:j[0],body:"",date:moment(j[1],"MM/DD/YY HH:mm a"),status:j[3]&&_.contains(e,j[3].toLowerCase())?j[3].toLowerCase():"seen"}))}g.messageCount=c||0,g.webmail=f,g.wasSuccessful=!0,g.dateFormat={calendar:{lastDay:"[Yesterday]",sameDay:"h:mm a",nextDay:"M/D",lastWeek:"dddd",nextWeek:"M/D",sameElse:"M/D"}}}else g.wasSuccessful=!1;b.$emit("webmailDetailsResponse",g)},mailReady=function(){b.$emit("webmailDetailsResponse",{wasSuccessful:!1})};var m=function(){var d=function(c){return a({method:"JSONP",url:c}).then(function(){},function(){("undefined"==typeof subLinesContent||null===subLinesContent)&&b.$emit("refreshEmailCookies",{})})};return this.refreshEmailCookies=function(){return a.get(k+"profile/ooluser/email").then(function(){var a={},b={};a=angular.fromJson(c.ox),b=angular.fromJson(c.sncr),(a.ox||b.sncr)&&window.location.reload(!0)})},this.getEmailDetails=function(){var a=g.WEBMAIL_DETAILS+"?eoid="+h;return d(a)},this.getEmailMetaData=function(){return a({method:"GET",url:l}).then(function(a){var c=[],d={webmail:[],wasSuccessful:!0};if(a.data.recentmails&&a.data.recentmails.length){for(var e=0,f=a.data.recentmails.length;f>e;e++){var g=a.data.recentmails[e];g&&c.push({id:g.id,from:g.from.substr(0,g.from.indexOf(" <")),subject:g.subject,body:"",date:moment(moment(new Date(g.arrival)),"MM/DD/YY HH:mm a"),status:g.seen?"seen":"unseen",link:"sncr"===(a.data.source&&a.data.source.toLowerCase())?j:i+g.id})}d.messageCount=a.data.newmessages.newmessages,d.webmail=c,d.wasSuccessful=!0,d.dateFormat={calendar:{lastDay:"[Yesterday]",sameDay:"h:mm a",nextDay:"M/D",lastWeek:"dddd",nextWeek:"M/D",sameElse:"M/D"}}}else d.wasSuccessful=!1;b.$emit("webmailDetailsResponse",d)},function(){b.$emit("webmailDetailsResponse",{wasSuccessful:!1})})},this};return new m}]),angular.module("wifiService",["config","oolCookie"]).factory("Wifi",["$http","Config","ooluser",function(a,b,c){var d=function(){var d=b.getValuesBySelector("endpoint.api.wifi"),e=b.getValuesBySelector("endpoint.api.wifipass"),f=angular.fromJson,g={ADD_DEVICE:"device/addDevice",DELETE_DEVICE:"device/deleteDevice",DEVICE_INFORMATION:"device/reg",OOLTIER_INFORMATION:"device/regstatus",SESSION_USAGE:"getSessionUsage",UPDATE_DEVICE:"device/updateDevice",DEVICE_TYPES:"device/deviceTypeList",WIFI_ELIGIBILITY:"checkEligibility",GENERATE_TOKEN:"generateToken",GENERATE_EMAIL:"sendTokenEmail"},h="SUCCESS",i={DEVICE_INFORMATION:"deviceInformation",SIMPLE:"simpleResposne",WIFI_USAGE:"wifiSessionUsage"},j=1048576,k=1073741824,l=86400,m={MTD:"MTD",LAST_THIRTY_DAYS:"LAST_THIRTY_DAYS"},n=c.eoid?c.eoid:"",o=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=f(a);c.isValid=!0,c.parsedResponse=d}catch(e){console.error("ERROR parsing => "+b),console.error(e)}return c},p=function(a){var b=o(a,i.SIMPLE),c=null;if(b.isValid){var d=b.parsedResponse,e=d.status,f=d.reason,g=e===h&&f===h?!0:!1;c={message:f,status:e,success:g,resp:d}}return c},q=function(a){var b=o(a,i.WIFI_USAGE),c=null;if(b.isValid&&b.parsedResponse.usage){var d=b.parsedResponse.usage,e=d.total,f=parseInt(e["@bytes"],10),g=parseInt(e["@seconds"],10),h=Math.round(g/l),n=1>h?1:h,p=d["@timePeriod"]===m.LAST_THIRTY_DAYS?"30":n;c={usage:{total:{bytes:f,bytesInMB:parseInt((f/j).toFixed(0),10),bytesInGB:parseFloat((f/k).toFixed(2)),locations:parseInt(e["@activeSessions"],10),devices:parseInt(e["@devices"],10),seconds:g,days:p}},hasUsage:f>0?!0:!1}}return c},r=function(a){var b=o(a,i.DEVICE_INFORMATION),c=null;if(b.isValid&&b.parsedResponse._embedded){for(var d=b.parsedResponse._embedded.devices,e=[],f=0,g=d.length;g>f;f++){var h=d[f],j=h.email&&h.macAddress&&h.name&&h.type;j&&e.push({email:h.email,macAddress:h.macAddress,name:h.name,type:h.type,registeredBy:h.registeredBy})}c={devices:e,registrationStatus:b.parsedResponse._embedded.registrationStatus}}return c},s=function(a){var b=o(a,i.SIMPLE),c=null,d={no:"Choose one"};if(b.isValid&&b.parsedResponse.object){for(var e=b.parsedResponse.object,f=0,g=e.length;g>f;f++){var h=e[f];h&&(d[h]=h)}c={devicesTypes:d}}return c},t=function(a){var b=o(a,i.DEVICE_INFORMATION),c=null;return b.isValid&&b.parsedResponse._embedded&&(c={registrationStatus:b.parsedResponse._embedded.registrationStatus}),c},u=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})};return this.checkWifiEligibility=function(a){var b=e+g.WIFI_ELIGIBILITY;return u(b,"POST",a,p,{"Content-Type":"application/json"})},this.generateWifiToken=function(a){var b=e+g.GENERATE_TOKEN;return u(b,"POST",a,p,{"Content-Type":"application/json"})},this.sendTokenMail=function(a){var b=e+g.GENERATE_EMAIL;return u(b,"POST",a,p,{"Content-Type":"application/json"})},this.addDevice=function(a){var b=d+g.ADD_DEVICE;return u(b,"PUT",a,p,{"Content-Type":"application/json"})},this.deleteDevice=function(a){var b=d+g.DELETE_DEVICE;return u(b,"DELETE",a,null,{"Content-Type":"application/json"})},this.getDeviceInformation=function(){var a=(new Date).getTime(),b=d+g.DEVICE_INFORMATION+"?cachebreak="+a;return u(b,null,null,r,null)},this.getSessionUsage=function(){var a=d+g.SESSION_USAGE+"?timePeriod="+m.LAST_THIRTY_DAYS+"&eoid="+n;return u(a,null,null,q,null)},this.updateDevice=function(a){var b=d+g.UPDATE_DEVICE;return u(b,"POST",a,p,{"Content-Type":"application/json"})},this.getOOLTierInformation=function(){var a=(new Date).getTime(),b=d+g.OOLTIER_INFORMATION+"?cachebreak="+a;return u(b,null,null,t,null)},this.getDeviceTypesList=function(){var a=(new Date).getTime(),b=d+g.DEVICE_TYPES+"?cachebreak="+a;return u(b,null,null,s,null)},this};return new d}]),angular.module("YextAnswers",[]).factory("Yext",[function(){var a=function(){var a="uninitialized",b=[];this.addSearchBar=function(c){"uninitialized"===a?(b.push(c),$.getScript("https://assets.sitescdn.net/answers-search-bar/v1.0/answers.min.js",function(){}),$.ajax("https://assets.sitescdn.net/answers-search-bar/v1.0/answers.min.js",{dataType:"script",cache:!0}).done(function(){ANSWERS.init({apiKey:"dc6f9b81cc9281b6b3847090fd40b9f9",experienceKey:"optimum-answers",experienceVersion:"PRODUCTION",locale:"en",businessId:"483210",templateBundle:TemplateBundle["default"],onReady:function(){b.forEach(function(a){ANSWERS.addComponent("SearchBar",a)}),b=[],a="initialized"}})}),a="initializing"):"initializing"===a?b.push(c):"initialized"===a?ANSWERS.addComponent("SearchBar",c):console.error("Unknown Yext state",a)}};return new a}]);